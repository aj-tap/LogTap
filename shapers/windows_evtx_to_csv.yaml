name: "Windows EVTX"
query: "over this | yield this | fuse | cut CallTrace:=quiet(Event.EventData.CallTrace),GrantedAccess:=quiet(Event.EventData.GrantedAccess),RuleName:=quiet(Event.EventData.RuleName),SourceImage:=quiet(Event.EventData.SourceImage),SourceProcessGUID:=quiet(Event.EventData.SourceProcessGUID),SourceProcessId:=quiet(Event.EventData.SourceProcessId),SourceThreadId:=quiet(Event.EventData.SourceThreadId),TargetImage:=quiet(Event.EventData.TargetImage),TargetProcessGUID:=quiet(Event.EventData.TargetProcessGUID),TargetProcessId:=quiet(Event.EventData.TargetProcessId),UtcTime:=quiet(Event.EventData.UtcTime),CommandLine:=quiet(Event.EventData.CommandLine),Company:=quiet(Event.EventData.Company),CurrentDirectory:=quiet(Event.EventData.CurrentDirectory),Description:=quiet(Event.EventData.Description),FileVersion:=quiet(Event.EventData.FileVersion),Hashes:=quiet(Event.EventData.Hashes),Image:=quiet(Event.EventData.Image),IntegrityLevel:=quiet(Event.EventData.IntegrityLevel),LogonGuid:=quiet(Event.EventData.LogonGuid),LogonId:=quiet(Event.EventData.LogonId),OriginalFileName:=quiet(Event.EventData.OriginalFileName),ParentCommandLine:=quiet(Event.EventData.ParentCommandLine),ParentImage:=quiet(Event.EventData.ParentImage),ParentProcessGuid:=quiet(Event.EventData.ParentProcessGuid),ParentProcessId:=quiet(Event.EventData.ParentProcessId),ProcessGuid:=quiet(Event.EventData.ProcessGuid),ProcessId:=quiet(Event.EventData.ProcessId),Product:=quiet(Event.EventData.Product),TerminalSessionId:=quiet(Event.EventData.TerminalSessionId),User:=quiet(Event.EventData.User),SystemChannel:=quiet(Event.System.Channel),Computer:=quiet(Event.System.Computer),EventID:=quiet(Event.System.EventID),EventRecordID:=quiet(Event.System.EventRecordID),ExecutionProcessID:=quiet(Event.System.Execution.ProcessID),ExecutionThreadID:=quiet(Event.System.Execution.ThreadID),SystemKeywords:=quiet(Event.System.Keywords),SystemLevel:=quiet(Event.System.Level),SystemOpcode:=quiet(Event.System.Opcode),ProviderGuid:=quiet(Event.System.Provider.Guid),ProviderName:=quiet(Event.System.Provider.Name),SecurityUserID:=quiet(Event.System.Security.UserID),SystemTask:=quiet(Event.System.Task),TimeCreated:=quiet(Event.System.TimeCreated.SystemTime),SystemVersion:=quiet(Event.System.Version) | fuse | ts:=time(TimeCreated)"
inputFormat: "json"
outputFormat: "csv"