rules:
- name: 7Zip Compressing Dump Files
  query: (grep('7-Zip', this['ProcessVersionInfoFileDescription']) or grep('\\7z.exe',
    this['FolderPath']) or grep('\\7zr.exe', this['FolderPath']) or grep('\\7za.exe',
    this['FolderPath']) or this['ProcessVersionInfoOriginalFileName'] in ['7z.exe',
    '7za.exe']) and (grep('.dmp', this['ProcessCommandLine']) or grep('.dump', this['ProcessCommandLine'])
    or grep('.hdmp', this['ProcessCommandLine']))
  sigma_id: ec570e53-4c76-45a9-804d-dc3f355ff7a7
- name: Compress Data and Lock With Password for Exfiltration With 7-ZIP
  query: (grep('7-Zip', this['ProcessVersionInfoFileDescription']) or grep('\\7z.exe',
    this['FolderPath']) or grep('\\7zr.exe', this['FolderPath']) or grep('\\7za.exe',
    this['FolderPath']) or this['ProcessVersionInfoOriginalFileName'] in ['7z.exe',
    '7za.exe']) and grep(' -p', this['ProcessCommandLine']) and (grep(' a ', this['ProcessCommandLine'])
    or grep(' u ', this['ProcessCommandLine']))
  sigma_id: 9fbf5927-5261-4284-a71d-f681029ea574
- name: Potential DLL Injection Via AccCheckConsole
  query: (grep('\\AccCheckConsole.exe', this['FolderPath']) or grep('AccCheckConsole.exe',
    this['ProcessVersionInfoOriginalFileName'])) and (grep(' -hwnd', this['ProcessCommandLine'])
    or grep(' -process ', this['ProcessCommandLine']) or grep(' -window ', this['ProcessCommandLine']))
  sigma_id: 0f6da907-5854-4be6-859a-e9958747b0aa
- name: Suspicious AddinUtil.EXE CommandLine Execution
  query: (grep('\\addinutil.exe', this['FolderPath']) or grep('AddInUtil.exe', this['ProcessVersionInfoOriginalFileName']))
    and ((grep('-AddInRoot:', this['ProcessCommandLine']) or grep('-PipelineRoot:',
    this['ProcessCommandLine'])) and (grep('\\AppData\\Local\\Temp\\', this['ProcessCommandLine'])
    or grep('\\Desktop\\', this['ProcessCommandLine']) or grep('\\Downloads\\', this['ProcessCommandLine'])
    or grep('\\Users\\Public\\', this['ProcessCommandLine']) or grep('\\Windows\\Temp\\',
    this['ProcessCommandLine'])) or (grep('-AddInRoot:.', this['ProcessCommandLine'])
    or grep('-AddInRoot:"."', this['ProcessCommandLine']) or grep('-PipelineRoot:.',
    this['ProcessCommandLine']) or grep('-PipelineRoot:"."', this['ProcessCommandLine']))
    and (grep('\\AppData\\Local\\Temp\\', this['CurrentDirectory']) or grep('\\Desktop\\',
    this['CurrentDirectory']) or grep('\\Downloads\\', this['CurrentDirectory']) or
    grep('\\Users\\Public\\', this['CurrentDirectory']) or grep('\\Windows\\Temp\\',
    this['CurrentDirectory'])))
  sigma_id: 631b22a4-70f4-4e2f-9ea8-42f84d9df6d8
- name: Uncommon Child Process Of AddinUtil.EXE
  query: grep('\\addinutil.exe', this['InitiatingProcessFolderPath']) and not (grep(':\\Windows\\System32\\conhost.exe',
    this['FolderPath']) or grep(':\\Windows\\System32\\werfault.exe', this['FolderPath'])
    or grep(':\\Windows\\SysWOW64\\werfault.exe', this['FolderPath']))
  sigma_id: b5746143-59d6-4603-8d06-acbd60e166ee
- name: Uncommon AddinUtil.EXE CommandLine Execution
  query: (grep('\\addinutil.exe', this['FolderPath']) or grep('AddInUtil.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('-AddInRoot:', this['ProcessCommandLine']) or grep('-PipelineRoot:',
    this['ProcessCommandLine'])) and not (grep('-AddInRoot:"C:\\Program Files (x86)\\Common
    Files\\Microsoft Shared\\VSTA', this['ProcessCommandLine']) or grep('-AddInRoot:C:\\Program
    Files (x86)\\Common Files\\Microsoft Shared\\VSTA', this['ProcessCommandLine'])
    or grep('-PipelineRoot:"C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\VSTA',
    this['ProcessCommandLine']) or grep('-PipelineRoot:C:\\Program Files (x86)\\Common
    Files\\Microsoft Shared\\VSTA', this['ProcessCommandLine']))
  sigma_id: 4f2cd9b6-4a17-440f-bb2a-687abb65993a
- name: AddinUtil.EXE Execution From Uncommon Directory
  query: (grep('\\addinutil.exe', this['FolderPath']) or grep('AddInUtil.exe', this['ProcessVersionInfoOriginalFileName']))
    and not (grep(':\\Windows\\Microsoft.NET\\Framework\\', this['FolderPath']) or
    grep(':\\Windows\\Microsoft.NET\\Framework64\\', this['FolderPath']) or grep(':\\Windows\\WinSxS\\',
    this['FolderPath']))
  sigma_id: 6120ac2a-a34b-42c0-a9bd-1fb9f459f348
- name: Potential Adplus.EXE Abuse
  query: (grep('\\adplus.exe', this['FolderPath']) or grep('Adplus.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' -hang ', this['ProcessCommandLine']) or grep(' -pn ', this['ProcessCommandLine'])
    or grep(' -pmn ', this['ProcessCommandLine']) or grep(' -p ', this['ProcessCommandLine'])
    or grep(' -po ', this['ProcessCommandLine']) or grep(' -c ', this['ProcessCommandLine'])
    or grep(' -sc ', this['ProcessCommandLine']))
  sigma_id: 2f869d59-7f6a-4931-992c-cce556ff2d53
- name: AgentExecutor PowerShell Execution
  query: (grep('\\AgentExecutor.exe', this['FolderPath']) or grep('AgentExecutor.exe',
    this['ProcessVersionInfoOriginalFileName'])) and (grep(' -powershell', this['ProcessCommandLine'])
    or grep(' -remediationScript', this['ProcessCommandLine'])) and not grep('\\Microsoft.Management.Services.IntuneWindowsAgent.exe',
    this['InitiatingProcessFolderPath'])
  sigma_id: 7efd2c8d-8b18-45b7-947d-adfe9ed04f61
- name: Suspicious AgentExecutor PowerShell Execution
  query: (grep('\\AgentExecutor.exe', this['FolderPath']) or grep('AgentExecutor.exe',
    this['ProcessVersionInfoOriginalFileName'])) and (grep(' -powershell', this['ProcessCommandLine'])
    or grep(' -remediationScript', this['ProcessCommandLine'])) and not (grep('C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\',
    this['ProcessCommandLine']) or grep('C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\',
    this['ProcessCommandLine']) or grep('\\Microsoft.Management.Services.IntuneWindowsAgent.exe',
    this['InitiatingProcessFolderPath']))
  sigma_id: c0b40568-b1e9-4b03-8d6c-b096da6da9ab
- name: Uncommon Child Process Of Appvlp.EXE
  query: grep('\\appvlp.exe', this['InitiatingProcessFolderPath']) and not (grep(':\\Windows\\SysWOW64\\rundll32.exe',
    this['FolderPath']) or grep(':\\Windows\\System32\\rundll32.exe', this['FolderPath']))
    and not (grep(':\\Program Files\\Microsoft Office', this['FolderPath']) and grep('\\msoasb.exe',
    this['FolderPath']) or grep(':\\Program Files\\Microsoft Office', this['FolderPath'])
    and grep('\\SkypeSrv\\', this['FolderPath']) and grep('\\SKYPESERVER.EXE', this['FolderPath'])
    or grep(':\\Program Files\\Microsoft Office', this['FolderPath']) and grep('\\MSOUC.EXE',
    this['FolderPath']))
  sigma_id: 9c7e131a-0f2c-4ae0-9d43-b04f4e266d43
- name: AspNetCompiler Execution
  query: (grep('C:\\Windows\\Microsoft.NET\\Framework\\', this['FolderPath']) or grep('C:\\Windows\\Microsoft.NET\\Framework64\\',
    this['FolderPath'])) and grep('\\aspnet_compiler.exe', this['FolderPath'])
  sigma_id: a01b8329-5953-4f73-ae2d-aa01e1f35f00
- name: Suspicious Child Process of AspNetCompiler
  query: grep('\\aspnet_compiler.exe', this['InitiatingProcessFolderPath']) and (grep('\\calc.exe',
    this['FolderPath']) or grep('\\notepad.exe', this['FolderPath']) or grep('\\Users\\Public\\',
    this['FolderPath']) or grep('\\AppData\\Local\\Temp\\', this['FolderPath']) or
    grep('\\AppData\\Local\\Roaming\\', this['FolderPath']) or grep(':\\Temp\\', this['FolderPath'])
    or grep(':\\Windows\\Temp\\', this['FolderPath']) or grep(':\\Windows\\System32\\Tasks\\',
    this['FolderPath']) or grep(':\\Windows\\Tasks\\', this['FolderPath']))
  sigma_id: 9ccba514-7cb6-4c5c-b377-700758f2f120
- name: Potentially Suspicious ASP.NET Compilation Via AspNetCompiler
  query: (grep('C:\\Windows\\Microsoft.NET\\Framework\\', this['FolderPath']) or grep('C:\\Windows\\Microsoft.NET\\Framework64\\',
    this['FolderPath'])) and grep('\\aspnet_compiler.exe', this['FolderPath']) and
    (grep('\\Users\\Public\\', this['ProcessCommandLine']) or grep('\\AppData\\Local\\Temp\\',
    this['ProcessCommandLine']) or grep('\\AppData\\Local\\Roaming\\', this['ProcessCommandLine'])
    or grep(':\\Temp\\', this['ProcessCommandLine']) or grep(':\\Windows\\Temp\\',
    this['ProcessCommandLine']) or grep(':\\Windows\\System32\\Tasks\\', this['ProcessCommandLine'])
    or grep(':\\Windows\\Tasks\\', this['ProcessCommandLine']))
  sigma_id: 9f50fe98-fe5c-4a2d-86c7-fad7f63ed622
- name: Interactive AT Job
  query: grep('\\at.exe', this['FolderPath']) and grep('interactive', this['ProcessCommandLine'])
  sigma_id: 60fc936d-2eb0-4543-8a13-911c750a1dfc
- name: Uncommon  Assistive Technology Applications Execution Via AtBroker.EXE
  query: (grep('\\AtBroker.exe', this['FolderPath']) or grep('AtBroker.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('start', this['ProcessCommandLine']) and not (grep('animations', this['ProcessCommandLine'])
    or grep('audiodescription', this['ProcessCommandLine']) or grep('caretbrowsing',
    this['ProcessCommandLine']) or grep('caretwidth', this['ProcessCommandLine'])
    or grep('colorfiltering', this['ProcessCommandLine']) or grep('cursorindicator',
    this['ProcessCommandLine']) or grep('cursorscheme', this['ProcessCommandLine'])
    or grep('filterkeys', this['ProcessCommandLine']) or grep('focusborderheight',
    this['ProcessCommandLine']) or grep('focusborderwidth', this['ProcessCommandLine'])
    or grep('highcontrast', this['ProcessCommandLine']) or grep('keyboardcues', this['ProcessCommandLine'])
    or grep('keyboardpref', this['ProcessCommandLine']) or grep('livecaptions', this['ProcessCommandLine'])
    or grep('magnifierpane', this['ProcessCommandLine']) or grep('messageduration',
    this['ProcessCommandLine']) or grep('minimumhitradius', this['ProcessCommandLine'])
    or grep('mousekeys', this['ProcessCommandLine']) or grep('Narrator', this['ProcessCommandLine'])
    or grep('osk', this['ProcessCommandLine']) or grep('overlappedcontent', this['ProcessCommandLine'])
    or grep('showsounds', this['ProcessCommandLine']) or grep('soundsentry', this['ProcessCommandLine'])
    or grep('speechreco', this['ProcessCommandLine']) or grep('stickykeys', this['ProcessCommandLine'])
    or grep('togglekeys', this['ProcessCommandLine']) or grep('voiceaccess', this['ProcessCommandLine'])
    or grep('windowarranging', this['ProcessCommandLine']) or grep('windowtracking',
    this['ProcessCommandLine']) or grep('windowtrackingtimeout', this['ProcessCommandLine'])
    or grep('windowtrackingzorder', this['ProcessCommandLine'])) and not grep('Oracle_JavaAccessBridge',
    this['ProcessCommandLine'])
  sigma_id: f24bcaea-0cd1-11eb-adc1-0242ac120002
- name: Hiding Files with Attrib.exe
  query: (grep('\\attrib.exe', this['FolderPath']) or grep('ATTRIB.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep(' +h ', this['ProcessCommandLine']) and not grep('\\desktop.ini ', this['ProcessCommandLine'])
    and not (grep('\\cmd.exe', this['InitiatingProcessFolderPath']) and grep('+R +H
    +S +A .cui', this['ProcessCommandLine']) and grep('C:\\WINDOWS\\system32.bat',
    this['InitiatingProcessCommandLine']))
  sigma_id: 4281cb20-2994-4580-aa63-c8b86d019934
- name: Set Suspicious Files as System Files Using Attrib.EXE
  query: (grep('\\attrib.exe', this['FolderPath']) or grep('ATTRIB.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep(' +s', this['ProcessCommandLine']) and (grep(' %', this['ProcessCommandLine'])
    or grep('\\Users\\Public\\', this['ProcessCommandLine']) or grep('\\AppData\\Local\\',
    this['ProcessCommandLine']) or grep('\\ProgramData\\', this['ProcessCommandLine'])
    or grep('\\Downloads\\', this['ProcessCommandLine']) or grep('\\Windows\\Temp\\',
    this['ProcessCommandLine'])) and (grep('.bat', this['ProcessCommandLine']) or
    grep('.dll', this['ProcessCommandLine']) or grep('.exe', this['ProcessCommandLine'])
    or grep('.hta', this['ProcessCommandLine']) or grep('.ps1', this['ProcessCommandLine'])
    or grep('.vbe', this['ProcessCommandLine']) or grep('.vbs', this['ProcessCommandLine']))
    and not (grep('\\Windows\\TEMP\\', this['ProcessCommandLine']) and grep('.exe',
    this['ProcessCommandLine']))
  sigma_id: efec536f-72e8-4656-8960-5e85d091345b
- name: Audit Policy Tampering Via NT Resource Kit Auditpol
  query: grep('/logon:none', this['ProcessCommandLine']) or grep('/system:none', this['ProcessCommandLine'])
    or grep('/sam:none', this['ProcessCommandLine']) or grep('/privilege:none', this['ProcessCommandLine'])
    or grep('/object:none', this['ProcessCommandLine']) or grep('/process:none', this['ProcessCommandLine'])
    or grep('/policy:none', this['ProcessCommandLine'])
  sigma_id: c6c56ada-612b-42d1-9a29-adad3c5c2c1e
- name: Audit Policy Tampering Via Auditpol
  query: (grep('\\auditpol.exe', this['FolderPath']) or grep('AUDITPOL.EXE', this['ProcessVersionInfoOriginalFileName']))
    and (grep('disable', this['ProcessCommandLine']) or grep('clear', this['ProcessCommandLine'])
    or grep('remove', this['ProcessCommandLine']) or grep('restore', this['ProcessCommandLine']))
  sigma_id: 0a13e132-651d-11eb-ae93-0242ac130002
- name: Indirect Inline Command Execution Via Bash.EXE
  query: (grep(':\\Windows\\System32\\bash.exe', this['FolderPath']) or grep(':\\Windows\\SysWOW64\\bash.exe',
    this['FolderPath']) or grep('Bash.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' -c ', this['ProcessCommandLine'])
  sigma_id: 5edc2273-c26f-406c-83f3-f4d948e740dd
- name: Indirect Command Execution From Script File Via Bash.EXE
  query: (grep(':\\Windows\\System32\\bash.exe', this['FolderPath']) or grep(':\\Windows\\SysWOW64\\bash.exe',
    this['FolderPath']) or grep('Bash.exe', this['ProcessVersionInfoOriginalFileName']))
    and not (grep('bash.exe -', this['ProcessCommandLine']) or grep('bash -', this['ProcessCommandLine'])
    or this['ProcessCommandLine']==null or false or this['ProcessCommandLine'] in
    ['bash.exe', 'bash'])
  sigma_id: 2d22a514-e024-4428-9dba-41505bd63a5b
- name: Boot Configuration Tampering Via Bcdedit.EXE
  query: (grep('\\bcdedit.exe', this['FolderPath']) or grep('bcdedit.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('set', this['ProcessCommandLine']) and (grep('bootstatuspolicy', this['ProcessCommandLine'])
    and grep('ignoreallfailures', this['ProcessCommandLine']) or grep('recoveryenabled',
    this['ProcessCommandLine']) and grep('no', this['ProcessCommandLine']))
  sigma_id: 1444443e-6757-43e4-9ea4-c8fc705f79a2
- name: Potential Ransomware or Unauthorized MBR Tampering Via Bcdedit.EXE
  query: (grep('\\bcdedit.exe', this['FolderPath']) or grep('bcdedit.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('delete', this['ProcessCommandLine']) or grep('deletevalue', this['ProcessCommandLine'])
    or grep('import', this['ProcessCommandLine']) or grep('safeboot', this['ProcessCommandLine'])
    or grep('network', this['ProcessCommandLine']))
  sigma_id: c9fbe8e9-119d-40a6-9b59-dd58a5d84429
- name: Data Export From MSSQL Table Via BCP.EXE
  query: (grep('\\bcp.exe', this['FolderPath']) or grep('BCP.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' out ', this['ProcessCommandLine']) or grep(' queryout ', this['ProcessCommandLine']))
  sigma_id: c615d676-f655-46b9-b913-78729021e5d7
- name: Suspicious Child Process Of BgInfo.EXE
  query: (grep('\\bginfo.exe', this['InitiatingProcessFolderPath']) or grep('\\bginfo64.exe',
    this['InitiatingProcessFolderPath'])) and (grep('\\calc.exe', this['FolderPath'])
    or grep('\\cmd.exe', this['FolderPath']) or grep('\\cscript.exe', this['FolderPath'])
    or grep('\\mshta.exe', this['FolderPath']) or grep('\\notepad.exe', this['FolderPath'])
    or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or grep('\\wscript.exe', this['FolderPath']) or grep('\\AppData\\Local\\', this['FolderPath'])
    or grep('\\AppData\\Roaming\\', this['FolderPath']) or grep(':\\Users\\Public\\',
    this['FolderPath']) or grep(':\\Temp\\', this['FolderPath']) or grep(':\\Windows\\Temp\\',
    this['FolderPath']) or grep(':\\PerfLogs\\', this['FolderPath']))
  sigma_id: 811f459f-9231-45d4-959a-0266c6311987
- name: Uncommon Child Process Of BgInfo.EXE
  query: grep('\\bginfo.exe', this['InitiatingProcessFolderPath']) or grep('\\bginfo64.exe',
    this['InitiatingProcessFolderPath'])
  sigma_id: aaf46cdc-934e-4284-b329-34aa701e3771
- name: File Download Via Bitsadmin
  query: (grep('\\bitsadmin.exe', this['FolderPath']) or grep('bitsadmin.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' /transfer ', this['ProcessCommandLine']) or (grep(' /create ', this['ProcessCommandLine'])
    or grep(' /addfile ', this['ProcessCommandLine'])) and grep('http', this['ProcessCommandLine']))
  sigma_id: d059842b-6b9d-4ed1-b5c3-5b89143c6ede
- name: Suspicious Download From Direct IP Via Bitsadmin
  query: (grep('\\bitsadmin.exe', this['FolderPath']) or grep('bitsadmin.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' /transfer ', this['ProcessCommandLine']) or grep(' /create ', this['ProcessCommandLine'])
    or grep(' /addfile ', this['ProcessCommandLine'])) and (grep('://1', this['ProcessCommandLine'])
    or grep('://2', this['ProcessCommandLine']) or grep('://3', this['ProcessCommandLine'])
    or grep('://4', this['ProcessCommandLine']) or grep('://5', this['ProcessCommandLine'])
    or grep('://6', this['ProcessCommandLine']) or grep('://7', this['ProcessCommandLine'])
    or grep('://8', this['ProcessCommandLine']) or grep('://9', this['ProcessCommandLine']))
    and not grep('://7-', this['ProcessCommandLine'])
  sigma_id: 99c840f2-2012-46fd-9141-c761987550ef
- name: Suspicious Download From File-Sharing Website Via Bitsadmin
  query: (grep('\\bitsadmin.exe', this['FolderPath']) or grep('bitsadmin.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' /transfer ', this['ProcessCommandLine']) or grep(' /create ', this['ProcessCommandLine'])
    or grep(' /addfile ', this['ProcessCommandLine'])) and (grep('.githubusercontent.com',
    this['ProcessCommandLine']) or grep('anonfiles.com', this['ProcessCommandLine'])
    or grep('cdn.discordapp.com', this['ProcessCommandLine']) or grep('ddns.net',
    this['ProcessCommandLine']) or grep('dl.dropboxusercontent.com', this['ProcessCommandLine'])
    or grep('ghostbin.co', this['ProcessCommandLine']) or grep('glitch.me', this['ProcessCommandLine'])
    or grep('gofile.io', this['ProcessCommandLine']) or grep('hastebin.com', this['ProcessCommandLine'])
    or grep('mediafire.com', this['ProcessCommandLine']) or grep('mega.nz', this['ProcessCommandLine'])
    or grep('onrender.com', this['ProcessCommandLine']) or grep('pages.dev', this['ProcessCommandLine'])
    or grep('paste.ee', this['ProcessCommandLine']) or grep('pastebin.com', this['ProcessCommandLine'])
    or grep('pastebin.pl', this['ProcessCommandLine']) or grep('pastetext.net', this['ProcessCommandLine'])
    or grep('privatlab.com', this['ProcessCommandLine']) or grep('privatlab.net',
    this['ProcessCommandLine']) or grep('send.exploit.in', this['ProcessCommandLine'])
    or grep('sendspace.com', this['ProcessCommandLine']) or grep('storage.googleapis.com',
    this['ProcessCommandLine']) or grep('storjshare.io', this['ProcessCommandLine'])
    or grep('supabase.co', this['ProcessCommandLine']) or grep('temp.sh', this['ProcessCommandLine'])
    or grep('transfer.sh', this['ProcessCommandLine']) or grep('trycloudflare.com',
    this['ProcessCommandLine']) or grep('ufile.io', this['ProcessCommandLine']) or
    grep('w3spaces.com', this['ProcessCommandLine']) or grep('workers.dev', this['ProcessCommandLine']))
  sigma_id: 8518ed3d-f7c9-4601-a26c-f361a4256a0c
- name: File With Suspicious Extension Downloaded Via Bitsadmin
  query: (grep('\\bitsadmin.exe', this['FolderPath']) or grep('bitsadmin.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' /transfer ', this['ProcessCommandLine']) or grep(' /create ', this['ProcessCommandLine'])
    or grep(' /addfile ', this['ProcessCommandLine'])) and (grep('.7z', this['ProcessCommandLine'])
    or grep('.asax', this['ProcessCommandLine']) or grep('.ashx', this['ProcessCommandLine'])
    or grep('.asmx', this['ProcessCommandLine']) or grep('.asp', this['ProcessCommandLine'])
    or grep('.aspx', this['ProcessCommandLine']) or grep('.bat', this['ProcessCommandLine'])
    or grep('.cfm', this['ProcessCommandLine']) or grep('.cgi', this['ProcessCommandLine'])
    or grep('.chm', this['ProcessCommandLine']) or grep('.cmd', this['ProcessCommandLine'])
    or grep('.dll', this['ProcessCommandLine']) or grep('.gif', this['ProcessCommandLine'])
    or grep('.jpeg', this['ProcessCommandLine']) or grep('.jpg', this['ProcessCommandLine'])
    or grep('.jsp', this['ProcessCommandLine']) or grep('.jspx', this['ProcessCommandLine'])
    or grep('.log', this['ProcessCommandLine']) or grep('.png', this['ProcessCommandLine'])
    or grep('.ps1', this['ProcessCommandLine']) or grep('.psm1', this['ProcessCommandLine'])
    or grep('.rar', this['ProcessCommandLine']) or grep('.scf', this['ProcessCommandLine'])
    or grep('.sct', this['ProcessCommandLine']) or grep('.txt', this['ProcessCommandLine'])
    or grep('.vbe', this['ProcessCommandLine']) or grep('.vbs', this['ProcessCommandLine'])
    or grep('.war', this['ProcessCommandLine']) or grep('.wsf', this['ProcessCommandLine'])
    or grep('.wsh', this['ProcessCommandLine']) or grep('.xll', this['ProcessCommandLine'])
    or grep('.zip', this['ProcessCommandLine']))
  sigma_id: 5b80a791-ad9b-4b75-bcc1-ad4e1e89c200
- name: File Download Via Bitsadmin To A Suspicious Target Folder
  query: (grep('\\bitsadmin.exe', this['FolderPath']) or grep('bitsadmin.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' /transfer ', this['ProcessCommandLine']) or grep(' /create ', this['ProcessCommandLine'])
    or grep(' /addfile ', this['ProcessCommandLine'])) and (grep(':\\Perflogs', this['ProcessCommandLine'])
    or grep(':\\ProgramData\\', this['ProcessCommandLine']) or grep(':\\Temp\\', this['ProcessCommandLine'])
    or grep(':\\Users\\Public\\', this['ProcessCommandLine']) or grep(':\\Windows\\',
    this['ProcessCommandLine']) or grep('\\AppData\\Local\\Temp\\', this['ProcessCommandLine'])
    or grep('\\AppData\\Roaming\\', this['ProcessCommandLine']) or grep('\\Desktop\\',
    this['ProcessCommandLine']) or grep('%ProgramData%', this['ProcessCommandLine'])
    or grep('%public%', this['ProcessCommandLine']))
  sigma_id: 2ddef153-167b-4e89-86b6-757a9e65dcac
- name: File Download Via Bitsadmin To An Uncommon Target Folder
  query: (grep('\\bitsadmin.exe', this['FolderPath']) or grep('bitsadmin.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' /transfer ', this['ProcessCommandLine']) or grep(' /create ', this['ProcessCommandLine'])
    or grep(' /addfile ', this['ProcessCommandLine'])) and (grep('%AppData%', this['ProcessCommandLine'])
    or grep('%temp%', this['ProcessCommandLine']) or grep('%tmp%', this['ProcessCommandLine'])
    or grep('\\AppData\\Local\\', this['ProcessCommandLine']) or grep('C:\\Windows\\Temp\\',
    this['ProcessCommandLine']))
  sigma_id: 6e30c82f-a9f8-4aab-b79c-7c12bce6f248
- name: Monitoring For Persistence Via BITS
  query: (grep('\\bitsadmin.exe', this['FolderPath']) or grep('bitsadmin.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('/SetNotifyCmdLine', this['ProcessCommandLine']) and (grep('%COMSPEC%',
    this['ProcessCommandLine']) or grep('cmd.exe', this['ProcessCommandLine']) or
    grep('regsvr32.exe', this['ProcessCommandLine'])) or grep('/Addfile', this['ProcessCommandLine'])
    and (grep('http:', this['ProcessCommandLine']) or grep('https:', this['ProcessCommandLine'])
    or grep('ftp:', this['ProcessCommandLine']) or grep('ftps:', this['ProcessCommandLine'])))
  sigma_id: b9cbbc17-d00d-4e3d-a827-b06d03d2380d
- name: Potential Data Stealing Via Chromium Headless Debugging
  query: grep('--remote-debugging-', this['ProcessCommandLine']) and grep('--user-data-dir',
    this['ProcessCommandLine']) and grep('--headless', this['ProcessCommandLine'])
  sigma_id: 3e8207c5-fcd2-4ea6-9418-15d45b4890e4
- name: Browser Execution In Headless Mode
  query: (grep('\\brave.exe', this['FolderPath']) or grep('\\chrome.exe', this['FolderPath'])
    or grep('\\msedge.exe', this['FolderPath']) or grep('\\opera.exe', this['FolderPath'])
    or grep('\\vivaldi.exe', this['FolderPath'])) and grep('--headless', this['ProcessCommandLine'])
  sigma_id: ef9dcfed-690c-4c5d-a9d1-482cd422225c
- name: File Download with Headless Browser
  query: (grep('\\brave.exe', this['FolderPath']) or grep('\\chrome.exe', this['FolderPath'])
    or grep('\\msedge.exe', this['FolderPath']) or grep('\\opera.exe', this['FolderPath'])
    or grep('\\vivaldi.exe', this['FolderPath'])) and grep('--headless', this['ProcessCommandLine'])
    and grep('dump-dom', this['ProcessCommandLine']) and grep('http', this['ProcessCommandLine'])
  sigma_id: 0e8cfe08-02c9-4815-a2f8-0d157b7ed33e
- name: Chromium Browser Instance Executed With Custom Extension
  query: (grep('\\brave.exe', this['FolderPath']) or grep('\\chrome.exe', this['FolderPath'])
    or grep('\\msedge.exe', this['FolderPath']) or grep('\\opera.exe', this['FolderPath'])
    or grep('\\vivaldi.exe', this['FolderPath'])) and grep('--load-extension=', this['ProcessCommandLine'])
  sigma_id: 88d6e60c-759d-4ac1-a447-c0f1466c2d21
- name: Chromium Browser Headless Execution To Mockbin Like Site
  query: (grep('\\brave.exe', this['FolderPath']) or grep('\\chrome.exe', this['FolderPath'])
    or grep('\\msedge.exe', this['FolderPath']) or grep('\\opera.exe', this['FolderPath'])
    or grep('\\vivaldi.exe', this['FolderPath'])) and grep('--headless', this['ProcessCommandLine'])
    and (grep('://run.mocky', this['ProcessCommandLine']) or grep('://mockbin', this['ProcessCommandLine']))
  sigma_id: 1c526788-0abe-4713-862f-b520da5e5316
- name: Suspicious Chromium Browser Instance Executed With Custom Extension
  query: (grep('\\cmd.exe', this['InitiatingProcessFolderPath']) or grep('\\cscript.exe',
    this['InitiatingProcessFolderPath']) or grep('\\mshta.exe', this['InitiatingProcessFolderPath'])
    or grep('\\powershell.exe', this['InitiatingProcessFolderPath']) or grep('\\pwsh.exe',
    this['InitiatingProcessFolderPath']) or grep('\\regsvr32.exe', this['InitiatingProcessFolderPath'])
    or grep('\\rundll32.exe', this['InitiatingProcessFolderPath']) or grep('\\wscript.exe',
    this['InitiatingProcessFolderPath'])) and (grep('\\brave.exe', this['FolderPath'])
    or grep('\\chrome.exe', this['FolderPath']) or grep('\\msedge.exe', this['FolderPath'])
    or grep('\\opera.exe', this['FolderPath']) or grep('\\vivaldi.exe', this['FolderPath']))
    and grep('--load-extension=', this['ProcessCommandLine'])
  sigma_id: 27ba3207-dd30-4812-abbf-5d20c57d474e
- name: File Download From Browser Process Via Inline URL
  query: (grep('\\brave.exe', this['FolderPath']) or grep('\\chrome.exe', this['FolderPath'])
    or grep('\\msedge.exe', this['FolderPath']) or grep('\\opera.exe', this['FolderPath'])
    or grep('\\vivaldi.exe', this['FolderPath'])) and grep('http', this['ProcessCommandLine'])
    and (grep('.7z', this['ProcessCommandLine']) or grep('.dat', this['ProcessCommandLine'])
    or grep('.dll', this['ProcessCommandLine']) or grep('.exe', this['ProcessCommandLine'])
    or grep('.hta', this['ProcessCommandLine']) or grep('.ps1', this['ProcessCommandLine'])
    or grep('.psm1', this['ProcessCommandLine']) or grep('.txt', this['ProcessCommandLine'])
    or grep('.vbe', this['ProcessCommandLine']) or grep('.vbs', this['ProcessCommandLine'])
    or grep('.zip', this['ProcessCommandLine']))
  sigma_id: 94771a71-ba41-4b6e-a757-b531372eaab6
- name: Browser Started with Remote Debugging
  query: grep(' --remote-debugging-', this['ProcessCommandLine']) or grep('\\firefox.exe',
    this['FolderPath']) and grep(' -start-debugger-server', this['ProcessCommandLine'])
  sigma_id: b3d34dc5-2efd-4ae3-845f-8ec14921f449
- name: Tor Client/Browser Execution
  query: grep('\\tor.exe', this['FolderPath']) or grep('\\Tor Browser\\Browser\\firefox.exe',
    this['FolderPath'])
  sigma_id: 62f7c9bf-9135-49b2-8aeb-1e54a6ecc13c
- name: Suspicious Calculator Usage
  query: grep('\\calc.exe ', this['ProcessCommandLine']) or grep('\\calc.exe', this['FolderPath'])
    and not (grep(':\\Windows\\System32\\', this['FolderPath']) or grep(':\\Windows\\SysWOW64\\',
    this['FolderPath']) or grep(':\\Windows\\WinSxS\\', this['FolderPath']))
  sigma_id: 737e618a-a410-49b5-bec3-9e55ff7fbc15
- name: Potential Binary Proxy Execution Via Cdb.EXE
  query: (grep('\\cdb.exe', this['FolderPath']) or grep('CDB.Exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' -c ', this['ProcessCommandLine']) or grep(' -cf ', this['ProcessCommandLine']))
  sigma_id: b5c7395f-e501-4a08-94d4-57fe7a9da9d2
- name: New Root Certificate Installed Via CertMgr.EXE
  query: (grep('\\CertMgr.exe', this['FolderPath']) or grep('CERTMGT.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('/add', this['ProcessCommandLine']) and grep('root', this['ProcessCommandLine'])
  sigma_id: ff992eac-6449-4c60-8c1d-91c9722a1d48
- name: File Download via CertOC.EXE
  query: (grep('\\certoc.exe', this['FolderPath']) or grep('CertOC.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('-GetCACAPS', this['ProcessCommandLine']) and grep('http', this['ProcessCommandLine'])
  sigma_id: 70ad0861-d1fe-491c-a45f-fa48148a300d
- name: DLL Loaded via CertOC.EXE
  query: "(grep('\\\\certoc.exe', this['FolderPath']) or grep('CertOC.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep(' -LoadDLL ', this['ProcessCommandLine']) or grep(' /LoadDLL ', this['ProcessCommandLine'])\
    \ or grep(' \u2013LoadDLL ', this['ProcessCommandLine']) or grep(' \u2014LoadDLL\
    \ ', this['ProcessCommandLine']) or grep(' \u2015LoadDLL ', this['ProcessCommandLine']))"
  sigma_id: 242301bc-f92f-4476-8718-78004a6efd9f
- name: Suspicious DLL Loaded via CertOC.EXE
  query: "(grep('\\\\certoc.exe', this['FolderPath']) or grep('CertOC.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep(' -LoadDLL ', this['ProcessCommandLine']) or grep(' /LoadDLL ', this['ProcessCommandLine'])\
    \ or grep(' \u2013LoadDLL ', this['ProcessCommandLine']) or grep(' \u2014LoadDLL\
    \ ', this['ProcessCommandLine']) or grep(' \u2015LoadDLL ', this['ProcessCommandLine']))\
    \ and (grep('\\\\Appdata\\\\Local\\\\Temp\\\\', this['ProcessCommandLine']) or\
    \ grep('\\\\Desktop\\\\', this['ProcessCommandLine']) or grep('\\\\Downloads\\\
    \\', this['ProcessCommandLine']) or grep('\\\\Users\\\\Public\\\\', this['ProcessCommandLine'])\
    \ or grep('C:\\\\Windows\\\\Tasks\\\\', this['ProcessCommandLine']) or grep('C:\\\
    \\Windows\\\\Temp\\\\', this['ProcessCommandLine']))"
  sigma_id: 84232095-ecca-4015-b0d7-7726507ee793
- name: New Root Certificate Installed Via Certutil.EXE
  query: "(grep('\\\\certutil.exe', this['FolderPath']) or grep('CertUtil.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep('-addstore', this['ProcessCommandLine']) or grep('/addstore', this['ProcessCommandLine'])\
    \ or grep('\u2013addstore', this['ProcessCommandLine']) or grep('\u2014addstore',\
    \ this['ProcessCommandLine']) or grep('\u2015addstore', this['ProcessCommandLine']))\
    \ and grep('root', this['ProcessCommandLine'])"
  sigma_id: d2125259-ddea-4c1c-9c22-977eb5b29cf0
- name: File Decoded From Base64/Hex Via Certutil.EXE
  query: "(grep('\\\\certutil.exe', this['FolderPath']) or grep('CertUtil.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep('-decode ', this['ProcessCommandLine']) or grep('/decode ', this['ProcessCommandLine'])\
    \ or grep('\u2013decode ', this['ProcessCommandLine']) or grep('\u2014decode ',\
    \ this['ProcessCommandLine']) or grep('\u2015decode ', this['ProcessCommandLine'])\
    \ or grep('-decodehex ', this['ProcessCommandLine']) or grep('/decodehex ', this['ProcessCommandLine'])\
    \ or grep('\u2013decodehex ', this['ProcessCommandLine']) or grep('\u2014decodehex\
    \ ', this['ProcessCommandLine']) or grep('\u2015decodehex ', this['ProcessCommandLine']))"
  sigma_id: cc9cbe82-7bc0-4ef5-bc23-bbfb83947be7
- name: Suspicious Download Via Certutil.EXE
  query: (grep('\\certutil.exe', this['FolderPath']) or grep('CertUtil.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('urlcache ', this['ProcessCommandLine']) or grep('verifyctl ', this['ProcessCommandLine']))
    and grep('http', this['ProcessCommandLine'])
  sigma_id: 19b08b1c-861d-4e75-a1ef-ea0c1baf202b
- name: Suspicious File Downloaded From Direct IP Via Certutil.EXE
  query: (grep('\\certutil.exe', this['FolderPath']) or grep('CertUtil.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('urlcache ', this['ProcessCommandLine']) or grep('verifyctl ', this['ProcessCommandLine']))
    and (grep('://1', this['ProcessCommandLine']) or grep('://2', this['ProcessCommandLine'])
    or grep('://3', this['ProcessCommandLine']) or grep('://4', this['ProcessCommandLine'])
    or grep('://5', this['ProcessCommandLine']) or grep('://6', this['ProcessCommandLine'])
    or grep('://7', this['ProcessCommandLine']) or grep('://8', this['ProcessCommandLine'])
    or grep('://9', this['ProcessCommandLine'])) and not grep('://7-', this['ProcessCommandLine'])
  sigma_id: 13e6fe51-d478-4c7e-b0f2-6da9b400a829
- name: Suspicious File Downloaded From File-Sharing Website Via Certutil.EXE
  query: (grep('\\certutil.exe', this['FolderPath']) or grep('CertUtil.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('urlcache ', this['ProcessCommandLine']) or grep('verifyctl ', this['ProcessCommandLine']))
    and (grep('.githubusercontent.com', this['ProcessCommandLine']) or grep('anonfiles.com',
    this['ProcessCommandLine']) or grep('cdn.discordapp.com', this['ProcessCommandLine'])
    or grep('ddns.net', this['ProcessCommandLine']) or grep('dl.dropboxusercontent.com',
    this['ProcessCommandLine']) or grep('ghostbin.co', this['ProcessCommandLine'])
    or grep('glitch.me', this['ProcessCommandLine']) or grep('gofile.io', this['ProcessCommandLine'])
    or grep('hastebin.com', this['ProcessCommandLine']) or grep('mediafire.com', this['ProcessCommandLine'])
    or grep('mega.nz', this['ProcessCommandLine']) or grep('onrender.com', this['ProcessCommandLine'])
    or grep('pages.dev', this['ProcessCommandLine']) or grep('paste.ee', this['ProcessCommandLine'])
    or grep('pastebin.com', this['ProcessCommandLine']) or grep('pastebin.pl', this['ProcessCommandLine'])
    or grep('pastetext.net', this['ProcessCommandLine']) or grep('privatlab.com',
    this['ProcessCommandLine']) or grep('privatlab.net', this['ProcessCommandLine'])
    or grep('send.exploit.in', this['ProcessCommandLine']) or grep('sendspace.com',
    this['ProcessCommandLine']) or grep('storage.googleapis.com', this['ProcessCommandLine'])
    or grep('storjshare.io', this['ProcessCommandLine']) or grep('supabase.co', this['ProcessCommandLine'])
    or grep('temp.sh', this['ProcessCommandLine']) or grep('transfer.sh', this['ProcessCommandLine'])
    or grep('trycloudflare.com', this['ProcessCommandLine']) or grep('ufile.io', this['ProcessCommandLine'])
    or grep('w3spaces.com', this['ProcessCommandLine']) or grep('workers.dev', this['ProcessCommandLine']))
  sigma_id: 42a5f1e7-9603-4f6d-97ae-3f37d130d794
- name: File Encoded To Base64 Via Certutil.EXE
  query: "(grep('\\\\certutil.exe', this['FolderPath']) or grep('CertUtil.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep('-encode', this['ProcessCommandLine']) or grep('/encode', this['ProcessCommandLine'])\
    \ or grep('\u2013encode', this['ProcessCommandLine']) or grep('\u2014encode',\
    \ this['ProcessCommandLine']) or grep('\u2015encode', this['ProcessCommandLine']))"
  sigma_id: e62a9f0c-ca1e-46b2-85d5-a6da77f86d1a
- name: Suspicious File Encoded To Base64 Via Certutil.EXE
  query: "(grep('\\\\certutil.exe', this['FolderPath']) or grep('CertUtil.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep('-encode', this['ProcessCommandLine']) or grep('/encode', this['ProcessCommandLine'])\
    \ or grep('\u2013encode', this['ProcessCommandLine']) or grep('\u2014encode',\
    \ this['ProcessCommandLine']) or grep('\u2015encode', this['ProcessCommandLine']))\
    \ and (grep('.acl', this['ProcessCommandLine']) or grep('.bat', this['ProcessCommandLine'])\
    \ or grep('.doc', this['ProcessCommandLine']) or grep('.gif', this['ProcessCommandLine'])\
    \ or grep('.jpeg', this['ProcessCommandLine']) or grep('.jpg', this['ProcessCommandLine'])\
    \ or grep('.mp3', this['ProcessCommandLine']) or grep('.pdf', this['ProcessCommandLine'])\
    \ or grep('.png', this['ProcessCommandLine']) or grep('.ppt', this['ProcessCommandLine'])\
    \ or grep('.tmp', this['ProcessCommandLine']) or grep('.xls', this['ProcessCommandLine'])\
    \ or grep('.xml', this['ProcessCommandLine']))"
  sigma_id: ea0cdc3e-2239-4f26-a947-4e8f8224e464
- name: File In Suspicious Location Encoded To Base64 Via Certutil.EXE
  query: "(grep('\\\\certutil.exe', this['FolderPath']) or grep('CertUtil.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep('-encode', this['ProcessCommandLine']) or grep('/encode', this['ProcessCommandLine'])\
    \ or grep('\u2013encode', this['ProcessCommandLine']) or grep('\u2014encode',\
    \ this['ProcessCommandLine']) or grep('\u2015encode', this['ProcessCommandLine']))\
    \ and (grep('\\\\AppData\\\\Roaming\\\\', this['ProcessCommandLine']) or grep('\\\
    \\Desktop\\\\', this['ProcessCommandLine']) or grep('\\\\Local\\\\Temp\\\\', this['ProcessCommandLine'])\
    \ or grep('\\\\PerfLogs\\\\', this['ProcessCommandLine']) or grep('\\\\Users\\\
    \\Public\\\\', this['ProcessCommandLine']) or grep('\\\\Windows\\\\Temp\\\\',\
    \ this['ProcessCommandLine']) or grep('$Recycle.Bin', this['ProcessCommandLine']))"
  sigma_id: 82a6714f-4899-4f16-9c1e-9a333544d4c3
- name: Certificate Exported Via Certutil.EXE
  query: "(grep('\\\\certutil.exe', this['FolderPath']) or grep('CertUtil.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep('-exportPFX ', this['ProcessCommandLine']) or grep('/exportPFX ',\
    \ this['ProcessCommandLine']) or grep('\u2013exportPFX ', this['ProcessCommandLine'])\
    \ or grep('\u2014exportPFX ', this['ProcessCommandLine']) or grep('\u2015exportPFX\
    \ ', this['ProcessCommandLine']))"
  sigma_id: 3ffd6f51-e6c1-47b7-94b4-c1e61d4117c5
- name: Potential NTLM Coercion Via Certutil.EXE
  query: (grep('\\certutil.exe', this['FolderPath']) or grep('CertUtil.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' -syncwithWU ', this['ProcessCommandLine']) and grep(' \\', this['ProcessCommandLine'])
  sigma_id: 6c6d9280-e6d0-4b9d-80ac-254701b64916
- name: Console CodePage Lookup Via CHCP
  query: "grep('\\\\cmd.exe', this['InitiatingProcessFolderPath']) and (grep(' -c\
    \ ', this['InitiatingProcessCommandLine']) or grep(' /c ', this['InitiatingProcessCommandLine'])\
    \ or grep(' \u2013c ', this['InitiatingProcessCommandLine']) or grep(' \u2014\
    c ', this['InitiatingProcessCommandLine']) or grep(' \u2015c ', this['InitiatingProcessCommandLine'])\
    \ or grep(' -r ', this['InitiatingProcessCommandLine']) or grep(' /r ', this['InitiatingProcessCommandLine'])\
    \ or grep(' \u2013r ', this['InitiatingProcessCommandLine']) or grep(' \u2014\
    r ', this['InitiatingProcessCommandLine']) or grep(' \u2015r ', this['InitiatingProcessCommandLine'])\
    \ or grep(' -k ', this['InitiatingProcessCommandLine']) or grep(' /k ', this['InitiatingProcessCommandLine'])\
    \ or grep(' \u2013k ', this['InitiatingProcessCommandLine']) or grep(' \u2014\
    k ', this['InitiatingProcessCommandLine']) or grep(' \u2015k ', this['InitiatingProcessCommandLine']))\
    \ and grep('\\\\chcp.com', this['FolderPath']) and (grep('chcp', this['ProcessCommandLine'])\
    \ or grep('chcp ', this['ProcessCommandLine']) or grep('chcp  ', this['ProcessCommandLine']))"
  sigma_id: 7090adee-82e2-4269-bd59-80691e7c6338
- name: Suspicious CodePage Switch Via CHCP
  query: grep('\\chcp.com', this['FolderPath']) and (grep(' 936', this['ProcessCommandLine'])
    or grep(' 1258', this['ProcessCommandLine']))
  sigma_id: c7942406-33dd-4377-a564-0f62db0593a3
- name: Deleted Data Overwritten Via Cipher.EXE
  query: (grep('CIPHER.EXE', this['ProcessVersionInfoOriginalFileName']) or grep('\\cipher.exe',
    this['FolderPath'])) and grep(' /w:', this['ProcessCommandLine'])
  sigma_id: 4b046706-5789-4673-b111-66f25fe99534
- name: Process Access via TrolleyExpress Exclusion
  query: grep('\\TrolleyExpress 7', this['ProcessCommandLine']) or grep('\\TrolleyExpress
    8', this['ProcessCommandLine']) or grep('\\TrolleyExpress 9', this['ProcessCommandLine'])
    or grep('\\TrolleyExpress.exe 7', this['ProcessCommandLine']) or grep('\\TrolleyExpress.exe
    8', this['ProcessCommandLine']) or grep('\\TrolleyExpress.exe 9', this['ProcessCommandLine'])
    or grep('\\TrolleyExpress.exe -ma ', this['ProcessCommandLine']) or grep('\\TrolleyExpress.exe',
    this['FolderPath']) and not (grep('CtxInstall', this['ProcessVersionInfoOriginalFileName'])
    or this['ProcessVersionInfoOriginalFileName']==null)
  sigma_id: 4c0aaedc-154c-4427-ada0-d80ef9c9deb6
- name: Cloudflared Portable Execution
  query: grep('\\cloudflared.exe', this['FolderPath']) and not (grep(':\\Program Files
    (x86)\\cloudflared\\', this['FolderPath']) or grep(':\\Program Files\\cloudflared\\',
    this['FolderPath']))
  sigma_id: fadb84f0-4e84-4f6d-a1ce-9ef2bffb6ccd
- name: Cloudflared Quick Tunnel Execution
  query: (grep('\\cloudflared.exe', this['FolderPath']) or grep('\\cloudflared-windows-386.exe',
    this['FolderPath']) or grep('\\cloudflared-windows-amd64.exe', this['FolderPath'])
    or grep('2fb6c04c4f95fb8d158af94c137f90ac820716deaf88d8ebec956254e046cb29', this['SHA256'])
    or grep('b3d21940a10fdef5e415ad70331ce257c24fe3bcf7722262302e0421791f87e8', this['SHA256'])
    or grep('1fbd8362b2d2d2e6a5750ae3db69cd1815e6c1d31da48a98b796450971a8e039', this['SHA256'])
    or grep('0409c9b12f9d0eda86e461ed9bdabeefb00172b26322079681a0bdf48e68dc28', this['SHA256'])
    or grep('7cfb411d04bac42ef93d1f0c93c0a481e38c6f4612b97ae89d4702595988edc7', this['SHA256'])
    or grep('5b3c2d846ab162dc6bc595cce3a49de5731afde5d6060be7066d21b013a28373', this['SHA256'])
    or grep('ce95df7f69664c3df19b76028e115931919a71517b776da7b42d353e2ff4a670', this['SHA256'])
    or grep('1293525a19cfe3bc8296b62fbfe19f083632ed644a1c18c10b045a1d3030d81a', this['SHA256'])
    or grep('af2b9161cfcb654b16408cd6b098afe9d1fb61a037d18d7090a119d4c0c8e0f0', this['SHA256'])
    or grep('39ddceb56a15798826a5fc4892fa2b474c444bb4d7a8bf2fa95e41cab10fa7a1', this['SHA256'])
    or grep('ccd11f2328023a0e7929e845d5b6e7bc783fb4650d65faef3ae090239d4bbce2', this['SHA256'])
    or grep('b6e5c5d2567ae8c69cc012ebcae30e6c9b5359d64a58d17ba75ec89f8bce71ac', this['SHA256'])
    or grep('f813484ea441404f18caad96f28138e8aaf0cb256163c09c2ab8a3acab87f69f', this['SHA256'])
    or grep('fc4a0802ab9c7409b892ca00636bec61e2acfc911bccfdeb9978b8ab5a2f828d', this['SHA256'])
    or grep('083150724b49604c8765c1ba19541fa260b133be0acb0647fcd936d81f054499', this['SHA256'])
    or grep('44303d6572956f28a0f2e4b188934fb9874f2584f5c81fa431a463cfbf28083b', this['SHA256'])
    or grep('5d38c46032a58e28ae5f7d174d8761ec3d64d186677f3ec53af5f51afb9bfd2f', this['SHA256'])
    or grep('e1e70fa42059911bc6685fafef957f9a73fc66f214d0704a9b932683a5204032', this['SHA256'])
    or grep('c01356092a365b84f84f0e66870bd1a05ba3feb53cafd973fa5fea2534bee234', this['SHA256'])
    or grep('b3f9c06151e30ee43d39e788a79cd918a314f24e04fe87f3de8272a2057b624f', this['SHA256'])
    or grep('cd81b2792f0739f473c31c9cb7cf2313154bfa28b839975802b90e8790bb5058', this['SHA256'])
    or grep('9ec7e6c8e1bfd883663d8d9d62c9e4f9ae373b731407181e32491b27a7218a2c', this['SHA256'])
    or grep('c2cfd23fdc6c0e1b1ffa0e545cbe556f18d11b362b4a89ba0713f6ab01c4827f', this['SHA256'])
    or grep('53f8adbd76c0eb16f5e43cadde422474d8a06f9c8f959389c1930042ad8beaa5', this['SHA256'])
    or grep('648c8d2f8001c113d2986dd00b7bbd181593d462bef73522cee212c4f71f95b3', this['SHA256'])
    or grep('ae047e2095e46c3f9c518b2be67ec753f4f0aad23b261a361fcb6144dcdb63b4', this['SHA256'])
    or grep('3153d2baa462978dd22ab33d1c2274ecc88c200225d6a3327f98d5b752d08f5c', this['SHA256'])
    or grep('f49cde976e628012c9db73e1c8d76081944ecf2297cdafeb78bb13290da274c4', this['SHA256'])
    or grep('d2513e58bb03ccc83affde685c6ef987924c37ce6707d8e9857e2524b0d7e90f', this['SHA256'])
    or grep('bb67c7623ba92fe64ffd9816b8d5b3b1ea3013960a30bd4cf6e295b3eb5b1bad', this['SHA256'])
    or grep('b34b3c3a91e3165d1481f0b3ec23eab93a1cfba94345a6cbfe5b18ddbd48eac7', this['SHA256'])
    or grep('f7848034e010d55f15e474ca998f96391e320ff29b00cfcc4c5e536529703e75', this['SHA256'])
    or grep('b6fc9493778cbe3bfc062d73f5cc604bc0ff058bc5e5dc6aac87f3a4008b54b6', this['SHA256'])
    or grep('f5c5e962577e2293c4ad10603816dce7cc273585969615fbf4e4bfa9eaff1688', this['SHA256'])
    or grep('d14c52d9220b606f428a8fe9f7c108b0d6f14cf71e7384749e98e6a95962e68f', this['SHA256'])
    or grep('d3a0e1a79158f3985cd49607ebe0cdfcc49cb9af96b8f43aefd0cdfe2f22e663', this['SHA256'])
    or grep('2fbbfc8299537ff80cadf9d0e27c223fe0ccb9052bf9d8763ad717bbfa521c77', this['SHA256'])
    or grep('19074674c6fbdaa573b3081745e5e26144fdf7a086d14e0e220d1814f1f13078', this['SHA256']))
    and (grep('-url', this['ProcessCommandLine']) and grep('tunnel', this['ProcessCommandLine'])
    or grep('.exe -url', this['ProcessCommandLine']) or grep('.exe --url', this['ProcessCommandLine']))
    or grep('-url', this['ProcessCommandLine']) and grep('-no-autoupdate', this['ProcessCommandLine'])
  sigma_id: 222129f7-f4dc-4568-b0d2-22440a9639ba
- name: Cloudflared Tunnel Connections Cleanup
  query: grep(' tunnel ', this['ProcessCommandLine']) and grep('cleanup ', this['ProcessCommandLine'])
    and (grep('-config ', this['ProcessCommandLine']) or grep('-connector-id ', this['ProcessCommandLine']))
  sigma_id: 7050bba1-1aed-454e-8f73-3f46f09ce56a
- name: Cloudflared Tunnel Execution
  query: grep(' tunnel ', this['ProcessCommandLine']) and grep(' run ', this['ProcessCommandLine'])
    and (grep('-config ', this['ProcessCommandLine']) or grep('-credentials-contents
    ', this['ProcessCommandLine']) or grep('-credentials-file ', this['ProcessCommandLine'])
    or grep('-token ', this['ProcessCommandLine']))
  sigma_id: 9a019ffc-3580-4c9d-8d87-079f7e8d3fd4
- name: Change Default File Association To Executable Via Assoc
  query: (grep('\\cmd.exe', this['FolderPath']) or grep('Cmd.Exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('assoc ', this['ProcessCommandLine']) and grep('exefile', this['ProcessCommandLine'])
    and not grep('.exe=exefile', this['ProcessCommandLine'])
  sigma_id: ae6f14e6-14de-45b0-9f44-c0986f50dc89
- name: Copy .DMP/.DUMP Files From Remote Share Via Cmd.EXE
  query: (grep('\\cmd.exe', this['FolderPath']) or grep('Cmd.Exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('copy ', this['ProcessCommandLine']) and grep(' \\', this['ProcessCommandLine'])
    and (grep('.dmp', this['ProcessCommandLine']) or grep('.dump', this['ProcessCommandLine'])
    or grep('.hdmp', this['ProcessCommandLine']))
  sigma_id: 044ba588-dff4-4918-9808-3f95e8160606
- name: Curl Download And Execute Combination
  query: "(grep(' -c ', this['ProcessCommandLine']) or grep(' /c ', this['ProcessCommandLine'])\
    \ or grep(' \u2013c ', this['ProcessCommandLine']) or grep(' \u2014c ', this['ProcessCommandLine'])\
    \ or grep(' \u2015c ', this['ProcessCommandLine'])) and grep('curl ', this['ProcessCommandLine'])\
    \ and grep('http', this['ProcessCommandLine']) and grep('-o', this['ProcessCommandLine'])\
    \ and grep('&', this['ProcessCommandLine'])"
  sigma_id: 21dd6d38-2b18-4453-9404-a0fe4a0cc288
- name: Greedy File Deletion Using Del
  query: (grep('\\cmd.exe', this['FolderPath']) or grep('Cmd.Exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('del ', this['ProcessCommandLine']) or grep('erase ', this['ProcessCommandLine']))
    and (grep('.au3', this['ProcessCommandLine']) or grep('.dll', this['ProcessCommandLine'])
    or grep('.exe', this['ProcessCommandLine']) or grep('.js', this['ProcessCommandLine']))
  sigma_id: 204b17ae-4007-471b-917b-b917b315c5db
- name: Potential Dosfuscation Activity
  query: grep('^^', this['ProcessCommandLine']) or grep('^|^', this['ProcessCommandLine'])
    or grep(',;,', this['ProcessCommandLine']) or grep(';;;;', this['ProcessCommandLine'])
    or grep(';; ;;', this['ProcessCommandLine']) or grep('(,(,', this['ProcessCommandLine'])
    or grep('%COMSPEC:~', this['ProcessCommandLine']) or grep(' c^m^d', this['ProcessCommandLine'])
    or grep('^c^m^d', this['ProcessCommandLine']) or grep(' c^md', this['ProcessCommandLine'])
    or grep(' cm^d', this['ProcessCommandLine']) or grep('^cm^d', this['ProcessCommandLine'])
    or grep(' s^et ', this['ProcessCommandLine']) or grep(' s^e^t ', this['ProcessCommandLine'])
    or grep(' se^t ', this['ProcessCommandLine'])
  sigma_id: a77c1610-fc73-4019-8e29-0f51efc04a51
- name: Command Line Execution with Suspicious URL and AppData Strings
  query: grep('\\cmd.exe', this['FolderPath']) and grep('http', this['ProcessCommandLine'])
    and grep('://', this['ProcessCommandLine']) and grep('%AppData%', this['ProcessCommandLine'])
  sigma_id: 1ac8666b-046f-4201-8aba-1951aaec03a3
- name: Potential Privilege Escalation Using Symlink Between Osk and Cmd
  query: (grep('\\cmd.exe', this['FolderPath']) or grep('Cmd.Exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('mklink', this['ProcessCommandLine']) and grep('\\osk.exe', this['ProcessCommandLine'])
    and grep('\\cmd.exe', this['ProcessCommandLine'])
  sigma_id: e9b61244-893f-427c-b287-3e708f321c6b
- name: VolumeShadowCopy Symlink Creation Via Mklink
  query: grep('mklink', this['ProcessCommandLine']) and grep('HarddiskVolumeShadowCopy',
    this['ProcessCommandLine'])
  sigma_id: 40b19fa6-d835-400c-b301-41f3a2baacaf
- name: Suspicious File Execution From Internet Hosted WebDav Share
  query: (grep('\\cmd.exe', this['FolderPath']) or grep('Cmd.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep(' net use http', this['ProcessCommandLine']) and grep('& start /b ',
    this['ProcessCommandLine']) and grep('\\DavWWWRoot\\', this['ProcessCommandLine'])
    and (grep('.exe ', this['ProcessCommandLine']) or grep('.dll ', this['ProcessCommandLine'])
    or grep('.bat ', this['ProcessCommandLine']) or grep('.vbs ', this['ProcessCommandLine'])
    or grep('.ps1 ', this['ProcessCommandLine']))
  sigma_id: f0507c0f-a3a2-40f5-acc6-7f543c334993
- name: Cmd.EXE Missing Space Characters Execution Anomaly
  query: (grep('cmd.exe/c', this['ProcessCommandLine']) or grep('\\cmd/c', this['ProcessCommandLine'])
    or grep('"cmd/c', this['ProcessCommandLine']) or grep('cmd.exe/k', this['ProcessCommandLine'])
    or grep('\\cmd/k', this['ProcessCommandLine']) or grep('"cmd/k', this['ProcessCommandLine'])
    or grep('cmd.exe/r', this['ProcessCommandLine']) or grep('\\cmd/r', this['ProcessCommandLine'])
    or grep('"cmd/r', this['ProcessCommandLine']) or grep('/cwhoami', this['ProcessCommandLine'])
    or grep('/cpowershell', this['ProcessCommandLine']) or grep('/cschtasks', this['ProcessCommandLine'])
    or grep('/cbitsadmin', this['ProcessCommandLine']) or grep('/ccertutil', this['ProcessCommandLine'])
    or grep('/kwhoami', this['ProcessCommandLine']) or grep('/kpowershell', this['ProcessCommandLine'])
    or grep('/kschtasks', this['ProcessCommandLine']) or grep('/kbitsadmin', this['ProcessCommandLine'])
    or grep('/kcertutil', this['ProcessCommandLine']) or grep('cmd.exe /c', this['ProcessCommandLine'])
    or grep('cmd /c', this['ProcessCommandLine']) or grep('cmd.exe /k', this['ProcessCommandLine'])
    or grep('cmd /k', this['ProcessCommandLine']) or grep('cmd.exe /r', this['ProcessCommandLine'])
    or grep('cmd /r', this['ProcessCommandLine'])) and not (grep('cmd.exe /c ', this['ProcessCommandLine'])
    or grep('cmd /c ', this['ProcessCommandLine']) or grep('cmd.exe /k ', this['ProcessCommandLine'])
    or grep('cmd /k ', this['ProcessCommandLine']) or grep('cmd.exe /r ', this['ProcessCommandLine'])
    or grep('cmd /r ', this['ProcessCommandLine']) or grep('AppData\\Local\\Programs\\Microsoft
    VS Code\\resources\\app\\node_modules', this['ProcessCommandLine']) or grep('cmd.exe/c
    .', this['ProcessCommandLine']) or grep('cmd.exe /c', this['ProcessCommandLine']))
  sigma_id: a16980c2-0c56-4de0-9a79-17971979efdd
- name: NtdllPipe Like Activity Execution
  query: grep('type %windir%\\system32\\ntdll.dll', this['ProcessCommandLine']) or
    grep('type %systemroot%\\system32\\ntdll.dll', this['ProcessCommandLine']) or
    grep('type c:\\windows\\system32\\ntdll.dll', this['ProcessCommandLine']) or grep('\\ntdll.dll
    > \\.\\pipe\\', this['ProcessCommandLine'])
  sigma_id: bbc865e4-7fcd-45a6-8ff1-95ced28ec5b2
- name: Potential CommandLine Path Traversal Via Cmd.EXE
  query: (grep('\\cmd.exe', this['InitiatingProcessFolderPath']) or grep('\\cmd.exe',
    this['FolderPath']) or grep('cmd.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('/c', this['InitiatingProcessCommandLine']) or grep('/k', this['InitiatingProcessCommandLine'])
    or grep('/r', this['InitiatingProcessCommandLine']) or grep('/c', this['ProcessCommandLine'])
    or grep('/k', this['ProcessCommandLine']) or grep('/r', this['ProcessCommandLine']))
    and (grep('/../../', this['InitiatingProcessCommandLine']) or grep('/../../',
    this['ProcessCommandLine'])) and not grep('\\Tasktop\\keycloak\\bin\\/../../jre\\bin\\java',
    this['ProcessCommandLine'])
  sigma_id: 087790e3-3287-436c-bccf-cbd0184a7db1
- name: Potentially Suspicious Ping/Copy Command Combination
  query: "(grep('\\\\cmd.exe', this['FolderPath']) or grep('Cmd.Exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and grep('ping', this['ProcessCommandLine']) and grep('copy ', this['ProcessCommandLine'])\
    \ and (grep(' -n ', this['ProcessCommandLine']) or grep(' /n ', this['ProcessCommandLine'])\
    \ or grep(' \u2013n ', this['ProcessCommandLine']) or grep(' \u2014n ', this['ProcessCommandLine'])\
    \ or grep(' \u2015n ', this['ProcessCommandLine'])) and (grep(' -y ', this['ProcessCommandLine'])\
    \ or grep(' /y ', this['ProcessCommandLine']) or grep(' \u2013y ', this['ProcessCommandLine'])\
    \ or grep(' \u2014y ', this['ProcessCommandLine']) or grep(' \u2015y ', this['ProcessCommandLine']))"
  sigma_id: ded2b07a-d12f-4284-9b76-653e37b6c8b0
- name: Suspicious Ping/Del Command Combination
  query: "(grep(' -n ', this['ProcessCommandLine']) or grep(' /n ', this['ProcessCommandLine'])\
    \ or grep(' \u2013n ', this['ProcessCommandLine']) or grep(' \u2014n ', this['ProcessCommandLine'])\
    \ or grep(' \u2015n ', this['ProcessCommandLine'])) and grep('Nul', this['ProcessCommandLine'])\
    \ and (grep(' -f ', this['ProcessCommandLine']) or grep(' /f ', this['ProcessCommandLine'])\
    \ or grep(' \u2013f ', this['ProcessCommandLine']) or grep(' \u2014f ', this['ProcessCommandLine'])\
    \ or grep(' \u2015f ', this['ProcessCommandLine']) or grep(' -q ', this['ProcessCommandLine'])\
    \ or grep(' /q ', this['ProcessCommandLine']) or grep(' \u2013q ', this['ProcessCommandLine'])\
    \ or grep(' \u2014q ', this['ProcessCommandLine']) or grep(' \u2015q ', this['ProcessCommandLine']))\
    \ and grep('ping', this['ProcessCommandLine']) and grep('del ', this['ProcessCommandLine'])"
  sigma_id: 54786ddc-5b8a-11ed-9b6a-0242ac120002
- name: Potentially Suspicious CMD Shell Output Redirect
  query: (grep('\\cmd.exe', this['FolderPath']) or grep('Cmd.Exe', this['ProcessVersionInfoOriginalFileName']))
    and ((grep('>', this['ProcessCommandLine']) or grep('%APPDATA%\\', this['ProcessCommandLine']))
    or (grep('>', this['ProcessCommandLine']) or grep('%TEMP%\\', this['ProcessCommandLine']))
    or (grep('>', this['ProcessCommandLine']) or grep('%TMP%\\', this['ProcessCommandLine']))
    or (grep('>', this['ProcessCommandLine']) or grep('%USERPROFILE%\\', this['ProcessCommandLine']))
    or (grep('>', this['ProcessCommandLine']) or grep('C:\\ProgramData\\', this['ProcessCommandLine']))
    or (grep('>', this['ProcessCommandLine']) or grep('C:\\Temp\\', this['ProcessCommandLine']))
    or (grep('>', this['ProcessCommandLine']) or grep('C:\\Users\\Public\\', this['ProcessCommandLine']))
    or (grep('>', this['ProcessCommandLine']) or grep('C:\\Windows\\Temp\\', this['ProcessCommandLine']))
    or (grep(' >', this['ProcessCommandLine']) or grep('">', this['ProcessCommandLine'])
    or grep('\'>', this['ProcessCommandLine'])) and grep('C:\\Users\\', this['ProcessCommandLine'])
    and grep('\\AppData\\Local\\', this['ProcessCommandLine']))
  sigma_id: 8e0bb260-d4b2-4fff-bb8d-3f82118e6892
- name: Copy From VolumeShadowCopy Via Cmd.EXE
  query: 'grep(''copy '', this[''ProcessCommandLine'']) and grep(''(\''\\\'', <SpecialChars.WILDCARD_SINGLE:
    2>, \''\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy\'')'', this[''ProcessCommandLine''])'
  sigma_id: c73124a7-3e89-44a3-bdc1-25fe4df754b1
- name: Read Contents From Stdin Via Cmd.EXE
  query: (grep('Cmd.Exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\cmd.exe',
    this['FolderPath'])) and grep('<', this['ProcessCommandLine'])
  sigma_id: 241e802a-b65e-484f-88cd-c2dc10f9206d
- name: Sticky Key Like Backdoor Execution
  query: grep('\\winlogon.exe', this['InitiatingProcessFolderPath']) and (grep('\\cmd.exe',
    this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']) or grep('\\mshta.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\rundll32.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath']) or grep('\\wt.exe',
    this['FolderPath'])) and (grep('sethc.exe', this['ProcessCommandLine']) or grep('utilman.exe',
    this['ProcessCommandLine']) or grep('osk.exe', this['ProcessCommandLine']) or
    grep('Magnify.exe', this['ProcessCommandLine']) or grep('Narrator.exe', this['ProcessCommandLine'])
    or grep('DisplaySwitch.exe', this['ProcessCommandLine']))
  sigma_id: 2fdefcb3-dbda-401e-ae23-f0db027628bc
- name: Persistence Via Sticky Key Backdoor
  query: grep('copy ', this['ProcessCommandLine']) and grep('/y ', this['ProcessCommandLine'])
    and grep('C:\\windows\\system32\\cmd.exe C:\\windows\\system32\\sethc.exe', this['ProcessCommandLine'])
  sigma_id: 1070db9a-3e5d-412e-8e7b-7183b616e1b3
- name: Potential Download/Upload Activity Using Type Command
  query: grep('type ', this['ProcessCommandLine']) and grep(' > \\', this['ProcessCommandLine'])
    or grep('type \\', this['ProcessCommandLine']) and grep(' > ', this['ProcessCommandLine'])
  sigma_id: aa0b3a82-eacc-4ec3-9150-b5a9a3e3f82f
- name: Unusual Parent Process For Cmd.EXE
  query: grep('\\cmd.exe', this['FolderPath']) and (grep('\\csrss.exe', this['InitiatingProcessFolderPath'])
    or grep('\\ctfmon.exe', this['InitiatingProcessFolderPath']) or grep('\\dllhost.exe',
    this['InitiatingProcessFolderPath']) or grep('\\epad.exe', this['InitiatingProcessFolderPath'])
    or grep('\\FlashPlayerUpdateService.exe', this['InitiatingProcessFolderPath'])
    or grep('\\GoogleUpdate.exe', this['InitiatingProcessFolderPath']) or grep('\\jucheck.exe',
    this['InitiatingProcessFolderPath']) or grep('\\jusched.exe', this['InitiatingProcessFolderPath'])
    or grep('\\LogonUI.exe', this['InitiatingProcessFolderPath']) or grep('\\lsass.exe',
    this['InitiatingProcessFolderPath']) or grep('\\regsvr32.exe', this['InitiatingProcessFolderPath'])
    or grep('\\SearchIndexer.exe', this['InitiatingProcessFolderPath']) or grep('\\SearchProtocolHost.exe',
    this['InitiatingProcessFolderPath']) or grep('\\SIHClient.exe', this['InitiatingProcessFolderPath'])
    or grep('\\sihost.exe', this['InitiatingProcessFolderPath']) or grep('\\slui.exe',
    this['InitiatingProcessFolderPath']) or grep('\\spoolsv.exe', this['InitiatingProcessFolderPath'])
    or grep('\\sppsvc.exe', this['InitiatingProcessFolderPath']) or grep('\\taskhostw.exe',
    this['InitiatingProcessFolderPath']) or grep('\\unsecapp.exe', this['InitiatingProcessFolderPath'])
    or grep('\\WerFault.exe', this['InitiatingProcessFolderPath']) or grep('\\wermgr.exe',
    this['InitiatingProcessFolderPath']) or grep('\\wlanext.exe', this['InitiatingProcessFolderPath'])
    or grep('\\WUDFHost.exe', this['InitiatingProcessFolderPath']))
  sigma_id: 4b991083-3d0e-44ce-8fc4-b254025d8d4b
- name: New Generic Credentials Added Via Cmdkey.EXE
  query: "(grep('\\\\cmdkey.exe', this['FolderPath']) or grep('cmdkey.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep(' -g', this['ProcessCommandLine']) or grep(' /g', this['ProcessCommandLine'])\
    \ or grep(' \u2013g', this['ProcessCommandLine']) or grep(' \u2014g', this['ProcessCommandLine'])\
    \ or grep(' \u2015g', this['ProcessCommandLine'])) and (grep(' -u', this['ProcessCommandLine'])\
    \ or grep(' /u', this['ProcessCommandLine']) or grep(' \u2013u', this['ProcessCommandLine'])\
    \ or grep(' \u2014u', this['ProcessCommandLine']) or grep(' \u2015u', this['ProcessCommandLine']))\
    \ and (grep(' -p', this['ProcessCommandLine']) or grep(' /p', this['ProcessCommandLine'])\
    \ or grep(' \u2013p', this['ProcessCommandLine']) or grep(' \u2014p', this['ProcessCommandLine'])\
    \ or grep(' \u2015p', this['ProcessCommandLine']))"
  sigma_id: b1ec66c6-f4d1-4b5c-96dd-af28ccae7727
- name: Potential Reconnaissance For Cached Credentials Via Cmdkey.EXE
  query: "(grep('\\\\cmdkey.exe', this['FolderPath']) or grep('cmdkey.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep(' -l', this['ProcessCommandLine']) or grep(' /l', this['ProcessCommandLine'])\
    \ or grep(' \u2013l', this['ProcessCommandLine']) or grep(' \u2014l', this['ProcessCommandLine'])\
    \ or grep(' \u2015l', this['ProcessCommandLine']))"
  sigma_id: 07f8bdc2-c9b3-472a-9817-5a670b872f53
- name: Potential Arbitrary File Download Via Cmdl32.EXE
  query: (grep('\\cmdl32.exe', this['FolderPath']) or grep('CMDL32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('/vpn', this['ProcessCommandLine']) and grep('/lan', this['ProcessCommandLine'])
  sigma_id: f37aba28-a9e6-4045-882c-d5004043b337
- name: CMSTP Execution Process Creation
  query: grep('\\cmstp.exe', this['InitiatingProcessFolderPath'])
  sigma_id: 7d4cdc5a-0076-40ca-aac8-f7e714570e47
- name: Arbitrary File Download Via ConfigSecurityPolicy.EXE
  query: (grep('ConfigSecurityPolicy.exe', this['ProcessCommandLine']) or grep('\\ConfigSecurityPolicy.exe',
    this['FolderPath']) or grep('ConfigSecurityPolicy.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('ftp://', this['ProcessCommandLine']) or grep('http://', this['ProcessCommandLine'])
    or grep('https://', this['ProcessCommandLine']))
  sigma_id: 1f0f6176-6482-4027-b151-00071af39d7e
- name: Powershell Executed From Headless ConHost Process
  query: (grep('\\conhost.exe', this['FolderPath']) or grep('CONHOST.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('--headless', this['ProcessCommandLine']) and grep('powershell', this['ProcessCommandLine'])
  sigma_id: 056c7317-9a09-4bd4-9067-d051312752ea
- name: Conhost.exe CommandLine Path Traversal
  query: grep('conhost', this['InitiatingProcessCommandLine']) and grep('/../../',
    this['ProcessCommandLine'])
  sigma_id: ee5e119b-1f75-4b34-add8-3be976961e39
- name: Uncommon Child Process Of Conhost.EXE
  query: grep('\\conhost.exe', this['InitiatingProcessFolderPath']) and not (grep(':\\Windows\\System32\\conhost.exe',
    this['FolderPath']) or this['FolderPath']==null or false) and not grep('SystemTraceProvider-Process',
    this['Provider_Name'])
  sigma_id: 7dc2dedd-7603-461a-bc13-15803d132355
- name: Conhost Spawned By Uncommon Parent Process
  query: grep('\\conhost.exe', this['FolderPath']) and (grep('\\explorer.exe', this['InitiatingProcessFolderPath'])
    or grep('\\lsass.exe', this['InitiatingProcessFolderPath']) or grep('\\regsvr32.exe',
    this['InitiatingProcessFolderPath']) or grep('\\rundll32.exe', this['InitiatingProcessFolderPath'])
    or grep('\\services.exe', this['InitiatingProcessFolderPath']) or grep('\\smss.exe',
    this['InitiatingProcessFolderPath']) or grep('\\spoolsv.exe', this['InitiatingProcessFolderPath'])
    or grep('\\svchost.exe', this['InitiatingProcessFolderPath']) or grep('\\userinit.exe',
    this['InitiatingProcessFolderPath']) or grep('\\wininit.exe', this['InitiatingProcessFolderPath'])
    or grep('\\winlogon.exe', this['InitiatingProcessFolderPath'])) and not (grep('-k
    apphost -s AppHostSvc', this['InitiatingProcessCommandLine']) or grep('-k imgsvc',
    this['InitiatingProcessCommandLine']) or grep('-k localService -p -s RemoteRegistry',
    this['InitiatingProcessCommandLine']) or grep('-k LocalSystemNetworkRestricted
    -p -s NgcSvc', this['InitiatingProcessCommandLine']) or grep('-k NetSvcs -p -s
    NcaSvc', this['InitiatingProcessCommandLine']) or grep('-k netsvcs -p -s NetSetupSvc',
    this['InitiatingProcessCommandLine']) or grep('-k netsvcs -p -s wlidsvc', this['InitiatingProcessCommandLine'])
    or grep('-k NetworkService -p -s DoSvc', this['InitiatingProcessCommandLine'])
    or grep('-k wsappx -p -s AppXSvc', this['InitiatingProcessCommandLine']) or grep('-k
    wsappx -p -s ClipSVC', this['InitiatingProcessCommandLine'])) and not (grep('C:\\Program
    Files (x86)\\Dropbox\\Client\\', this['InitiatingProcessCommandLine']) or grep('C:\\Program
    Files\\Dropbox\\Client\\', this['InitiatingProcessCommandLine']))
  sigma_id: cbb9e3d1-2386-4e59-912e-62f1484f7a89
- name: Control Panel Items
  query: (grep('\\reg.exe', this['FolderPath']) or grep('reg.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('add', this['ProcessCommandLine']) and grep('CurrentVersion\\Control
    Panel\\CPLs', this['ProcessCommandLine']) or grep('.cpl', this['ProcessCommandLine'])
    and not (grep('\\System32\\', this['ProcessCommandLine']) or grep('%System%',
    this['ProcessCommandLine']) or grep('|C:\\Windows\\system32|', this['ProcessCommandLine'])
    or grep('regsvr32 ', this['ProcessCommandLine']) and grep(' /s ', this['ProcessCommandLine'])
    and grep('igfxCPL.cpl', this['ProcessCommandLine']))
  sigma_id: 0ba863e6-def5-4e50-9cea-4dd8c7dc46a4
- name: CreateDump Process Dump
  query: (grep('\\createdump.exe', this['FolderPath']) or grep('FX_VER_INTERNALNAME_STR',
    this['ProcessVersionInfoOriginalFileName'])) and (grep(' -u ', this['ProcessCommandLine'])
    or grep(' --full ', this['ProcessCommandLine']) or grep(' -f ', this['ProcessCommandLine'])
    or grep(' --name ', this['ProcessCommandLine']) or grep('.dmp ', this['ProcessCommandLine']))
  sigma_id: 515c8be5-e5df-4c5e-8f6d-a4a2f05e4b48
- name: Suspicious Csi.exe Usage
  query: (grep('\\csi.exe', this['FolderPath']) or grep('\\rcsi.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['csi.exe', 'rcsi.exe']) and
    grep('Microsoft Corporation', this['ProcessVersionInfoCompanyName'])
  sigma_id: 40b95d31-1afc-469e-8d34-9a3a667d058e
- name: Suspicious Use of CSharp Interactive Console
  query: grep('\\csi.exe', this['FolderPath']) and (grep('\\powershell.exe', this['InitiatingProcessFolderPath'])
    or grep('\\pwsh.exe', this['InitiatingProcessFolderPath']) or grep('\\powershell_ise.exe',
    this['InitiatingProcessFolderPath'])) and grep('csi.exe', this['ProcessVersionInfoOriginalFileName'])
  sigma_id: a9e416a8-e613-4f8b-88b8-a7d1d1af2f61
- name: Active Directory Structure Export Via Csvde.EXE
  query: (grep('\\csvde.exe', this['FolderPath']) or grep('csvde.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' -f', this['ProcessCommandLine']) and not grep(' -i', this['ProcessCommandLine'])
  sigma_id: e5d36acd-acb4-4c6f-a13f-9eb203d50099
- name: Suspicious File Download From File Sharing Domain Via Curl.EXE
  query: (grep('\\curl.exe', this['FolderPath']) or grep('curl.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('.githubusercontent.com', this['ProcessCommandLine']) or grep('anonfiles.com',
    this['ProcessCommandLine']) or grep('cdn.discordapp.com', this['ProcessCommandLine'])
    or grep('ddns.net', this['ProcessCommandLine']) or grep('dl.dropboxusercontent.com',
    this['ProcessCommandLine']) or grep('ghostbin.co', this['ProcessCommandLine'])
    or grep('glitch.me', this['ProcessCommandLine']) or grep('gofile.io', this['ProcessCommandLine'])
    or grep('hastebin.com', this['ProcessCommandLine']) or grep('mediafire.com', this['ProcessCommandLine'])
    or grep('mega.nz', this['ProcessCommandLine']) or grep('onrender.com', this['ProcessCommandLine'])
    or grep('pages.dev', this['ProcessCommandLine']) or grep('paste.ee', this['ProcessCommandLine'])
    or grep('pastebin.com', this['ProcessCommandLine']) or grep('pastebin.pl', this['ProcessCommandLine'])
    or grep('pastetext.net', this['ProcessCommandLine']) or grep('pixeldrain.com',
    this['ProcessCommandLine']) or grep('privatlab.com', this['ProcessCommandLine'])
    or grep('privatlab.net', this['ProcessCommandLine']) or grep('send.exploit.in',
    this['ProcessCommandLine']) or grep('sendspace.com', this['ProcessCommandLine'])
    or grep('storage.googleapis.com', this['ProcessCommandLine']) or grep('storjshare.io',
    this['ProcessCommandLine']) or grep('supabase.co', this['ProcessCommandLine'])
    or grep('temp.sh', this['ProcessCommandLine']) or grep('transfer.sh', this['ProcessCommandLine'])
    or grep('trycloudflare.com', this['ProcessCommandLine']) or grep('ufile.io', this['ProcessCommandLine'])
    or grep('w3spaces.com', this['ProcessCommandLine']) or grep('workers.dev', this['ProcessCommandLine']))
    and grep('http', this['ProcessCommandLine']) and (grep(' -O', this['ProcessCommandLine'])
    or grep('--remote-name', this['ProcessCommandLine']) or grep('--output', this['ProcessCommandLine']))
    and (grep('.ps1', this['ProcessCommandLine']) or grep('.ps1\'', this['ProcessCommandLine'])
    or grep('.ps1"', this['ProcessCommandLine']) or grep('.dat', this['ProcessCommandLine'])
    or grep('.dat\'', this['ProcessCommandLine']) or grep('.dat"', this['ProcessCommandLine'])
    or grep('.msi', this['ProcessCommandLine']) or grep('.msi\'', this['ProcessCommandLine'])
    or grep('.msi"', this['ProcessCommandLine']) or grep('.bat', this['ProcessCommandLine'])
    or grep('.bat\'', this['ProcessCommandLine']) or grep('.bat"', this['ProcessCommandLine'])
    or grep('.exe', this['ProcessCommandLine']) or grep('.exe\'', this['ProcessCommandLine'])
    or grep('.exe"', this['ProcessCommandLine']) or grep('.vbs', this['ProcessCommandLine'])
    or grep('.vbs\'', this['ProcessCommandLine']) or grep('.vbs"', this['ProcessCommandLine'])
    or grep('.vbe', this['ProcessCommandLine']) or grep('.vbe\'', this['ProcessCommandLine'])
    or grep('.vbe"', this['ProcessCommandLine']) or grep('.hta', this['ProcessCommandLine'])
    or grep('.hta\'', this['ProcessCommandLine']) or grep('.hta"', this['ProcessCommandLine'])
    or grep('.dll', this['ProcessCommandLine']) or grep('.dll\'', this['ProcessCommandLine'])
    or grep('.dll"', this['ProcessCommandLine']) or grep('.psm1', this['ProcessCommandLine'])
    or grep('.psm1\'', this['ProcessCommandLine']) or grep('.psm1"', this['ProcessCommandLine']))
  sigma_id: 56454143-524f-49fb-b1c6-3fb8b1ad41fb
- name: Insecure Proxy/DOH Transfer Via Curl.EXE
  query: (grep('\\curl.exe', this['FolderPath']) or grep('curl.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('--doh-insecure', this['ProcessCommandLine']) or grep('--proxy-insecure',
    this['ProcessCommandLine']))
  sigma_id: 2c1486f5-02e8-4f86-9099-b97f2da4ed77
- name: Local File Read Using Curl.EXE
  query: (grep('\\curl.exe', this['FolderPath']) or grep('curl.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('file:///', this['ProcessCommandLine'])
  sigma_id: aa6f6ea6-0676-40dd-b510-6e46f02d8867
- name: Suspicious Curl.EXE Download
  query: (grep('\\curl.exe', this['FolderPath']) or grep('The curl executable', this['ProcessVersionInfoProductName']))
    and (grep('%AppData%', this['ProcessCommandLine']) or grep('%Public%', this['ProcessCommandLine'])
    or grep('%Temp%', this['ProcessCommandLine']) or grep('%tmp%', this['ProcessCommandLine'])
    or grep('\\AppData\\', this['ProcessCommandLine']) or grep('\\Desktop\\', this['ProcessCommandLine'])
    or grep('\\Temp\\', this['ProcessCommandLine']) or grep('\\Users\\Public\\', this['ProcessCommandLine'])
    or grep('C:\\PerfLogs\\', this['ProcessCommandLine']) or grep('C:\\ProgramData\\',
    this['ProcessCommandLine']) or grep('C:\\Windows\\Temp\\', this['ProcessCommandLine'])
    or grep('.dll', this['ProcessCommandLine']) or grep('.gif', this['ProcessCommandLine'])
    or grep('.jpeg', this['ProcessCommandLine']) or grep('.jpg', this['ProcessCommandLine'])
    or grep('.png', this['ProcessCommandLine']) or grep('.temp', this['ProcessCommandLine'])
    or grep('.tmp', this['ProcessCommandLine']) or grep('.txt', this['ProcessCommandLine'])
    or grep('.vbe', this['ProcessCommandLine']) or grep('.vbs', this['ProcessCommandLine']))
    and not (grep('C:\\Program Files\\Git\\usr\\bin\\sh.exe', this['InitiatingProcessFolderPath'])
    and grep('C:\\Program Files\\Git\\mingw64\\bin\\curl.exe', this['FolderPath'])
    and grep('--silent --show-error --output ', this['ProcessCommandLine']) and grep('gfw-httpget-',
    this['ProcessCommandLine']) and grep('AppData', this['ProcessCommandLine']))
  sigma_id: e218595b-bbe7-4ee5-8a96-f32a24ad3468
- name: ManageEngine Endpoint Central Dctask64.EXE Potential Abuse
  query: (grep('\\dctask64.exe', this['FolderPath']) or grep('IMPHASH=6834B1B94E49701D77CCB3C0895E1AFD',
    this['Hashes']) or grep('IMPHASH=1BB6F93B129F398C7C4A76BB97450BBA', this['Hashes'])
    or grep('IMPHASH=FAA2AC19875FADE461C8D89DCF2710A3', this['Hashes']) or grep('IMPHASH=F1039CED4B91572AB7847D26032E6BBF',
    this['Hashes'])) and (grep(' executecmd64 ', this['ProcessCommandLine']) or grep('
    invokeexe ', this['ProcessCommandLine']) or grep(' injectDll ', this['ProcessCommandLine']))
  sigma_id: 6345b048-8441-43a7-9bed-541133633d7a
- name: Uncommon Child Process Of Defaultpack.EXE
  query: grep('\\DefaultPack.exe', this['InitiatingProcessFolderPath'])
  sigma_id: b2309017-4235-44fe-b5af-b15363011957
- name: Remote File Download Via Desktopimgdownldr Utility
  query: grep('\\desktopimgdownldr.exe', this['FolderPath']) and grep('\\desktopimgdownldr.exe',
    this['InitiatingProcessFolderPath']) and grep('/lockscreenurl:http', this['ProcessCommandLine'])
  sigma_id: 214641c2-c579-4ecb-8427-0cf19df6842e
- name: Suspicious Desktopimgdownldr Command
  query: grep(' /lockscreenurl:', this['ProcessCommandLine']) and not (grep('.jpg',
    this['ProcessCommandLine']) or grep('.jpeg', this['ProcessCommandLine']) or grep('.png',
    this['ProcessCommandLine'])) or grep('reg delete', this['ProcessCommandLine'])
    and grep('\\PersonalizationCSP', this['ProcessCommandLine'])
  sigma_id: bb58aa4a-b80b-415a-a2c0-2f65a4c81009
- name: Potential DLL Sideloading Via DeviceEnroller.EXE
  query: (grep('\\deviceenroller.exe', this['FolderPath']) or grep('deviceenroller.exe',
    this['ProcessVersionInfoOriginalFileName'])) and grep('/PhoneDeepLink', this['ProcessCommandLine'])
  sigma_id: e173ad47-4388-4012-ae62-bd13f71c18a8
- name: Arbitrary MSI Download Via Devinit.EXE
  query: grep(' -t msi-install ', this['ProcessCommandLine']) and grep(' -i http',
    this['ProcessCommandLine'])
  sigma_id: 90d50722-0483-4065-8e35-57efaadd354d
- name: Potentially Suspicious Child Process Of ClickOnce Application
  query: grep('\\AppData\\Local\\Apps\\2.0\\', this['InitiatingProcessFolderPath'])
    and (grep('\\calc.exe', this['FolderPath']) or grep('\\cmd.exe', this['FolderPath'])
    or grep('\\cscript.exe', this['FolderPath']) or grep('\\explorer.exe', this['FolderPath'])
    or grep('\\mshta.exe', this['FolderPath']) or grep('\\net.exe', this['FolderPath'])
    or grep('\\net1.exe', this['FolderPath']) or grep('\\nltest.exe', this['FolderPath'])
    or grep('\\notepad.exe', this['FolderPath']) or grep('\\powershell.exe', this['FolderPath'])
    or grep('\\pwsh.exe', this['FolderPath']) or grep('\\reg.exe', this['FolderPath'])
    or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\rundll32.exe', this['FolderPath'])
    or grep('\\schtasks.exe', this['FolderPath']) or grep('\\werfault.exe', this['FolderPath'])
    or grep('\\wscript.exe', this['FolderPath']))
  sigma_id: 67bc0e75-c0a9-4cfc-8754-84a505b63c04
- name: Potentially Suspicious Child Process Of DiskShadow.EXE
  query: grep('\\diskshadow.exe', this['InitiatingProcessFolderPath']) and (grep('\\certutil.exe',
    this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']) or grep('\\mshta.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\rundll32.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath']))
  sigma_id: 9f546b25-5f12-4c8d-8532-5893dcb1e4b8
- name: Diskshadow Script Mode - Uncommon Script Extension Execution
  query: "(grep('diskshadow.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\\
    \\diskshadow.exe', this['FolderPath'])) and (grep('-s ', this['ProcessCommandLine'])\
    \ or grep('/s ', this['ProcessCommandLine']) or grep('\u2013s ', this['ProcessCommandLine'])\
    \ or grep('\u2014s ', this['ProcessCommandLine']) or grep('\u2015s ', this['ProcessCommandLine']))\
    \ and not grep('.txt', this['ProcessCommandLine'])"
  sigma_id: 1dde5376-a648-492e-9e54-4241dd9b0c7f
- name: Diskshadow Script Mode - Execution From Potential Suspicious Location
  query: "(grep('diskshadow.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\\
    \\diskshadow.exe', this['FolderPath'])) and (grep('-s ', this['ProcessCommandLine'])\
    \ or grep('/s ', this['ProcessCommandLine']) or grep('\u2013s ', this['ProcessCommandLine'])\
    \ or grep('\u2014s ', this['ProcessCommandLine']) or grep('\u2015s ', this['ProcessCommandLine']))\
    \ and (grep(':\\\\Temp\\\\', this['ProcessCommandLine']) or grep(':\\\\Windows\\\
    \\Temp\\\\', this['ProcessCommandLine']) or grep('\\\\AppData\\\\Local\\\\', this['ProcessCommandLine'])\
    \ or grep('\\\\AppData\\\\Roaming\\\\', this['ProcessCommandLine']) or grep('\\\
    \\ProgramData\\\\', this['ProcessCommandLine']) or grep('\\\\Users\\\\Public\\\
    \\', this['ProcessCommandLine']))"
  sigma_id: fa1a7e52-3d02-435b-81b8-00da14dd66c1
- name: PowerShell Web Access Feature Enabled Via DISM
  query: (grep('\\dism.exe', this['FolderPath']) or grep('DISM.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('WindowsPowerShellWebAccess', this['ProcessCommandLine']) and grep('/online',
    this['ProcessCommandLine']) and grep('/enable-feature', this['ProcessCommandLine'])
  sigma_id: 7e8f2d3b-9c1a-4f67-b9e8-8d9006e0e51f
- name: Dism Remove Online Package
  query: grep('\\DismHost.exe', this['FolderPath']) and grep('/Online', this['InitiatingProcessCommandLine'])
    and grep('/Disable-Feature', this['InitiatingProcessCommandLine']) or grep('\\Dism.exe',
    this['FolderPath']) and grep('/Online', this['ProcessCommandLine']) and grep('/Disable-Feature',
    this['ProcessCommandLine'])
  sigma_id: 43e32da2-fdd0-4156-90de-50dfd62636f9
- name: DLL Sideloading by VMware Xfer Utility
  query: grep('\\VMwareXferlogs.exe', this['FolderPath']) and not grep('C:\\Program
    Files\\VMware\\', this['FolderPath'])
  sigma_id: ebea773c-a8f1-42ad-a856-00cb221966e8
- name: Dllhost.EXE Execution Anomaly
  query: grep('\\dllhost.exe', this['FolderPath']) and (this['ProcessCommandLine']
    in ['dllhost.exe', 'dllhost']) and not this['ProcessCommandLine']==null
  sigma_id: e7888eb1-13b0-4616-bd99-4bc0c2b054b9
- name: DNS Exfiltration and Tunneling Tools Execution
  query: grep('\\iodine.exe', this['FolderPath']) or grep('\\dnscat2', this['FolderPath'])
  sigma_id: 98a96a5a-64a0-4c42-92c5-489da3866cb0
- name: Unusual Child Process of dns.exe
  query: grep('\\dns.exe', this['InitiatingProcessFolderPath']) and not grep('\\conhost.exe',
    this['FolderPath'])
  sigma_id: a4e3d776-f12e-42c2-8510-9e6ed1f43ec3
- name: Potential Discovery Activity Via Dnscmd.EXE
  query: grep('\\dnscmd.exe', this['FolderPath']) and (grep('/enumrecords', this['ProcessCommandLine'])
    or grep('/enumzones', this['ProcessCommandLine']) or grep('/ZonePrint', this['ProcessCommandLine'])
    or grep('/info', this['ProcessCommandLine']))
  sigma_id: b6457d63-d2a2-4e29-859d-4e7affc153d1
- name: New DNS ServerLevelPluginDll Installed Via Dnscmd.EXE
  query: grep('\\dnscmd.exe', this['FolderPath']) and grep('/config', this['ProcessCommandLine'])
    and grep('/serverlevelplugindll', this['ProcessCommandLine'])
  sigma_id: f63b56ee-3f79-4b8a-97fb-5c48007e8573
- name: Potential Application Whitelisting Bypass via Dnx.EXE
  query: grep('\\dnx.exe', this['FolderPath'])
  sigma_id: 81ebd28b-9607-4478-bf06-974ed9d53ed7
- name: Arbitrary DLL or Csproj Code Execution Via Dotnet.EXE
  query: (grep('\\dotnet.exe', this['FolderPath']) or grep('.NET Host', this['ProcessVersionInfoOriginalFileName']))
    and (grep('.csproj', this['ProcessCommandLine']) or grep('.csproj"', this['ProcessCommandLine'])
    or grep('.dll', this['ProcessCommandLine']) or grep('.dll"', this['ProcessCommandLine'])
    or grep('.csproj\'', this['ProcessCommandLine']) or grep('.dll\'', this['ProcessCommandLine']))
  sigma_id: d80d5c81-04ba-45b4-84e4-92eba40e0ad3
- name: Binary Proxy Execution Via Dotnet-Trace.EXE
  query: (grep('\\dotnet-trace.exe', this['FolderPath']) or grep('dotnet-trace.dll',
    this['ProcessVersionInfoOriginalFileName'])) and grep('-- ', this['ProcessCommandLine'])
    and grep('collect', this['ProcessCommandLine'])
  sigma_id: 9257c05b-4a4a-48e5-a670-b7b073cf401b
- name: Process Memory Dump Via Dotnet-Dump
  query: (grep('\\dotnet-dump.exe', this['FolderPath']) or grep('dotnet-dump.dll',
    this['ProcessVersionInfoOriginalFileName'])) and grep('collect', this['ProcessCommandLine'])
  sigma_id: 53d8d3e1-ca33-4012-adf3-e05a4d652e34
- name: Potential Recon Activity Using DriverQuery.EXE
  query: (grep('driverquery.exe', this['FolderPath']) or grep('drvqry.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('\\cscript.exe', this['InitiatingProcessFolderPath']) or grep('\\mshta.exe',
    this['InitiatingProcessFolderPath']) or grep('\\regsvr32.exe', this['InitiatingProcessFolderPath'])
    or grep('\\rundll32.exe', this['InitiatingProcessFolderPath']) or grep('\\wscript.exe',
    this['InitiatingProcessFolderPath']) or grep('\\AppData\\Local\\', this['InitiatingProcessFolderPath'])
    or grep('\\Users\\Public\\', this['InitiatingProcessFolderPath']) or grep('\\Windows\\Temp\\',
    this['InitiatingProcessFolderPath']))
  sigma_id: 9fc3072c-dc8f-4bf7-b231-18950000fadd
- name: DriverQuery.EXE Execution
  query: (grep('driverquery.exe', this['FolderPath']) or grep('drvqry.exe', this['ProcessVersionInfoOriginalFileName']))
    and not (grep('\\cscript.exe', this['InitiatingProcessFolderPath']) or grep('\\mshta.exe',
    this['InitiatingProcessFolderPath']) or grep('\\regsvr32.exe', this['InitiatingProcessFolderPath'])
    or grep('\\rundll32.exe', this['InitiatingProcessFolderPath']) or grep('\\wscript.exe',
    this['InitiatingProcessFolderPath']) or grep('\\AppData\\Local\\', this['InitiatingProcessFolderPath'])
    or grep('\\Users\\Public\\', this['InitiatingProcessFolderPath']) or grep('\\Windows\\Temp\\',
    this['InitiatingProcessFolderPath']))
  sigma_id: a20def93-0709-4eae-9bd2-31206e21e6b2
- name: Potentially Over Permissive Permissions Granted Using Dsacls.EXE
  query: (grep('\\dsacls.exe', this['FolderPath']) or grep('DSACLS.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep(' /G ', this['ProcessCommandLine']) and (grep('GR', this['ProcessCommandLine'])
    or grep('GE', this['ProcessCommandLine']) or grep('GW', this['ProcessCommandLine'])
    or grep('GA', this['ProcessCommandLine']) or grep('WP', this['ProcessCommandLine'])
    or grep('WD', this['ProcessCommandLine']))
  sigma_id: 01c42d3c-242d-4655-85b2-34f1739632f7
- name: Potential Password Spraying Attempt Using Dsacls.EXE
  query: (grep('\\dsacls.exe', this['FolderPath']) or grep('DSACLS.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('/user:', this['ProcessCommandLine']) and grep('/passwd:', this['ProcessCommandLine'])
  sigma_id: bac9fb54-2da7-44e9-988f-11e9a5edbc0c
- name: Domain Trust Discovery Via Dsquery
  query: (grep('\\dsquery.exe', this['FolderPath']) or grep('dsquery.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('trustedDomain', this['ProcessCommandLine'])
  sigma_id: 3bad990e-4848-4a78-9530-b427d854aac0
- name: Suspicious Kernel Dump Using Dtrace
  query: grep('\\dtrace.exe', this['FolderPath']) and grep('lkd(0)', this['ProcessCommandLine'])
    or grep('syscall:::return', this['ProcessCommandLine']) and grep('lkd(', this['ProcessCommandLine'])
  sigma_id: 7124aebe-4cd7-4ccb-8df0-6d6b93c96795
- name: Potential Windows Defender AV Bypass Via Dump64.EXE Rename
  query: grep(':\\Program Files', this['FolderPath']) and grep('\\Microsoft Visual
    Studio\\', this['FolderPath']) and grep('\\dump64.exe', this['FolderPath']) and
    (grep('procdump', this['ProcessVersionInfoOriginalFileName']) or grep(' -ma ',
    this['ProcessCommandLine']) or grep(' -mp ', this['ProcessCommandLine']))
  sigma_id: 129966c9-de17-4334-a123-8b58172e664d
- name: DumpMinitool Execution
  query: (grep('\\DumpMinitool.exe', this['FolderPath']) or grep('\\DumpMinitool.x86.exe',
    this['FolderPath']) or grep('\\DumpMinitool.arm64.exe', this['FolderPath']) or
    this['ProcessVersionInfoOriginalFileName'] in ['DumpMinitool.exe', 'DumpMinitool.x86.exe',
    'DumpMinitool.arm64.exe']) and (grep(' Full', this['ProcessCommandLine']) or grep('
    Mini', this['ProcessCommandLine']) or grep(' WithHeap', this['ProcessCommandLine']))
  sigma_id: dee0a7a3-f200-4112-a99b-952196d81e42
- name: Suspicious DumpMinitool Execution
  query: (grep('\\DumpMinitool.exe', this['FolderPath']) or grep('\\DumpMinitool.x86.exe',
    this['FolderPath']) or grep('\\DumpMinitool.arm64.exe', this['FolderPath']) or
    this['ProcessVersionInfoOriginalFileName'] in ['DumpMinitool.exe', 'DumpMinitool.x86.exe',
    'DumpMinitool.arm64.exe']) and (not (grep('\\Microsoft Visual Studio\\', this['FolderPath'])
    or grep('\\Extensions\\', this['FolderPath'])) or grep('.txt', this['ProcessCommandLine'])
    or (grep(' Full', this['ProcessCommandLine']) or grep(' Mini', this['ProcessCommandLine'])
    or grep(' WithHeap', this['ProcessCommandLine'])) and not grep('--dumpType', this['ProcessCommandLine']))
  sigma_id: eb1c4225-1c23-4241-8dd4-051389fde4ce
- name: New Capture Session Launched Via DXCap.EXE
  query: (grep('\\DXCap.exe', this['FolderPath']) or grep('DXCap.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' -c ', this['ProcessCommandLine'])
  sigma_id: 60f16a96-db70-42eb-8f76-16763e333590
- name: Esentutl Gather Credentials
  query: grep('esentutl', this['ProcessCommandLine']) and grep(' /p', this['ProcessCommandLine'])
  sigma_id: 7df1713a-1a5b-4a4b-a071-dc83b144a101
- name: Copying Sensitive Files with Credential Data
  query: "(grep('\\\\esentutl.exe', this['FolderPath']) or grep('\\\\esentutl.exe',\
    \ this['ProcessVersionInfoOriginalFileName'])) and (grep('vss', this['ProcessCommandLine'])\
    \ or grep(' -m ', this['ProcessCommandLine']) or grep(' /m ', this['ProcessCommandLine'])\
    \ or grep(' \u2013m ', this['ProcessCommandLine']) or grep(' \u2014m ', this['ProcessCommandLine'])\
    \ or grep(' \u2015m ', this['ProcessCommandLine']) or grep(' -y ', this['ProcessCommandLine'])\
    \ or grep(' /y ', this['ProcessCommandLine']) or grep(' \u2013y ', this['ProcessCommandLine'])\
    \ or grep(' \u2014y ', this['ProcessCommandLine']) or grep(' \u2015y ', this['ProcessCommandLine']))\
    \ or grep('\\\\config\\\\RegBack\\\\sam', this['ProcessCommandLine']) or grep('\\\
    \\config\\\\RegBack\\\\security', this['ProcessCommandLine']) or grep('\\\\config\\\
    \\RegBack\\\\system', this['ProcessCommandLine']) or grep('\\\\config\\\\sam',\
    \ this['ProcessCommandLine']) or grep('\\\\config\\\\security', this['ProcessCommandLine'])\
    \ or grep('\\\\config\\\\system ', this['ProcessCommandLine']) or grep('\\\\repair\\\
    \\sam', this['ProcessCommandLine']) or grep('\\\\repair\\\\security', this['ProcessCommandLine'])\
    \ or grep('\\\\repair\\\\system', this['ProcessCommandLine']) or grep('\\\\windows\\\
    \\ntds\\\\ntds.dit', this['ProcessCommandLine'])"
  sigma_id: e7be6119-fc37-43f0-ad4f-1f3f99be2f9f
- name: Esentutl Steals Browser Information
  query: "(grep('\\\\esentutl.exe', this['FolderPath']) or grep('esentutl.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep('-r', this['ProcessCommandLine']) or grep('/r', this['ProcessCommandLine'])\
    \ or grep('\u2013r', this['ProcessCommandLine']) or grep('\u2014r', this['ProcessCommandLine'])\
    \ or grep('\u2015r', this['ProcessCommandLine'])) and grep('\\\\Windows\\\\WebCache',\
    \ this['ProcessCommandLine'])"
  sigma_id: 6a69f62d-ce75-4b57-8dce-6351eb55b362
- name: Potentially Suspicious Event Viewer Child Process
  query: grep('\\eventvwr.exe', this['InitiatingProcessFolderPath']) and not (grep(':\\Windows\\System32\\mmc.exe',
    this['FolderPath']) or grep(':\\Windows\\System32\\WerFault.exe', this['FolderPath'])
    or grep(':\\Windows\\SysWOW64\\WerFault.exe', this['FolderPath']))
  sigma_id: be344333-921d-4c4d-8bb8-e584cf584780
- name: Potentially Suspicious Cabinet File Expansion
  query: "grep('\\\\expand.exe', this['FolderPath']) and (grep('-F:', this['ProcessCommandLine'])\
    \ or grep('/F:', this['ProcessCommandLine']) or grep('\u2013F:', this['ProcessCommandLine'])\
    \ or grep('\u2014F:', this['ProcessCommandLine']) or grep('\u2015F:', this['ProcessCommandLine']))\
    \ and (grep(':\\\\Perflogs\\\\', this['ProcessCommandLine']) or grep(':\\\\ProgramData',\
    \ this['ProcessCommandLine']) or grep(':\\\\Users\\\\Public\\\\', this['ProcessCommandLine'])\
    \ or grep(':\\\\Windows\\\\Temp\\\\', this['ProcessCommandLine']) or grep('\\\\\
    Admin$\\\\', this['ProcessCommandLine']) or grep('\\\\AppData\\\\Local\\\\Temp\\\
    \\', this['ProcessCommandLine']) or grep('\\\\AppData\\\\Roaming\\\\', this['ProcessCommandLine'])\
    \ or grep('\\\\C$\\\\', this['ProcessCommandLine']) or grep('\\\\Temporary Internet',\
    \ this['ProcessCommandLine']) or grep(':\\\\Users\\\\', this['ProcessCommandLine'])\
    \ and grep('\\\\Favorites\\\\', this['ProcessCommandLine']) or grep(':\\\\Users\\\
    \\', this['ProcessCommandLine']) and grep('\\\\Favourites\\\\', this['ProcessCommandLine'])\
    \ or grep(':\\\\Users\\\\', this['ProcessCommandLine']) and grep('\\\\Contacts\\\
    \\', this['ProcessCommandLine'])) and not (grep('C:\\\\Program Files (x86)\\\\\
    Dell\\\\UpdateService\\\\ServiceShell.exe', this['InitiatingProcessFolderPath'])\
    \ and grep('C:\\\\ProgramData\\\\Dell\\\\UpdateService\\\\Temp\\\\', this['ProcessCommandLine']))"
  sigma_id: 9f107a84-532c-41af-b005-8d12a607639f
- name: Explorer Process Tree Break
  query: "grep('/factory,{75dff2b7-6936-4c06-a8bb-676a7b00b24b}', this['ProcessCommandLine'])\
    \ or (grep('explorer.exe', this['ProcessCommandLine'])) and (grep(' -root,', this['ProcessCommandLine'])\
    \ or grep(' /root,', this['ProcessCommandLine']) or grep(' \u2013root,', this['ProcessCommandLine'])\
    \ or grep(' \u2014root,', this['ProcessCommandLine']) or grep(' \u2015root,',\
    \ this['ProcessCommandLine']))"
  sigma_id: 949f1ffb-6e85-4f00-ae1e-c3c5b190d605
- name: File Explorer Folder Opened Using Explorer Folder Shortcut Via Shell
  query: (grep('\\cmd.exe', this['InitiatingProcessFolderPath']) or grep('\\powershell.exe',
    this['InitiatingProcessFolderPath']) or grep('\\pwsh.exe', this['InitiatingProcessFolderPath']))
    and grep('\\explorer.exe', this['FolderPath']) and grep('shell:mycomputerfolder',
    this['ProcessCommandLine'])
  sigma_id: c3d76afc-93df-461e-8e67-9b2bad3f2ac4
- name: Explorer NOUACCHECK Flag
  query: grep('\\explorer.exe', this['FolderPath']) and grep('/NOUACCHECK', this['ProcessCommandLine'])
    and not (grep('C:\\Windows\\system32\\svchost.exe -k netsvcs -p -s Schedule',
    this['InitiatingProcessCommandLine']) or grep('C:\\Windows\\System32\\svchost.exe',
    this['InitiatingProcessFolderPath']))
  sigma_id: 534f2ef7-e8a2-4433-816d-c91bccde289b
- name: Remote File Download Via Findstr.EXE
  query: "(grep('findstr', this['ProcessCommandLine']) or grep('findstr.exe', this['FolderPath'])\
    \ or grep('FINDSTR.EXE', this['ProcessVersionInfoOriginalFileName'])) and (grep('\
    \ -v ', this['ProcessCommandLine']) or grep(' /v ', this['ProcessCommandLine'])\
    \ or grep(' \u2013v ', this['ProcessCommandLine']) or grep(' \u2014v ', this['ProcessCommandLine'])\
    \ or grep(' \u2015v ', this['ProcessCommandLine'])) and (grep(' -l ', this['ProcessCommandLine'])\
    \ or grep(' /l ', this['ProcessCommandLine']) or grep(' \u2013l ', this['ProcessCommandLine'])\
    \ or grep(' \u2014l ', this['ProcessCommandLine']) or grep(' \u2015l ', this['ProcessCommandLine']))\
    \ and grep('\\\\', this['ProcessCommandLine'])"
  sigma_id: 587254ee-a24b-4335-b3cd-065c0f1f4baa
- name: Findstr GPP Passwords
  query: (grep('\\find.exe', this['FolderPath']) or grep('\\findstr.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['FIND.EXE', 'FINDSTR.EXE'])
    and grep('cpassword', this['ProcessCommandLine']) and grep('\\sysvol\\', this['ProcessCommandLine'])
    and grep('.xml', this['ProcessCommandLine'])
  sigma_id: 91a2c315-9ee6-4052-a853-6f6a8238f90d
- name: Findstr Launching .lnk File
  query: (grep('\\find.exe', this['FolderPath']) or grep('\\findstr.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['FIND.EXE', 'FINDSTR.EXE'])
    and (grep('.lnk', this['ProcessCommandLine']) or grep('.lnk"', this['ProcessCommandLine'])
    or grep('.lnk\'', this['ProcessCommandLine']))
  sigma_id: 33339be3-148b-4e16-af56-ad16ec6c7e7b
- name: LSASS Process Reconnaissance Via Findstr.EXE
  query: "(grep('\\\\find.exe', this['FolderPath']) or grep('\\\\findstr.exe', this['FolderPath'])\
    \ or this['ProcessVersionInfoOriginalFileName'] in ['FIND.EXE', 'FINDSTR.EXE'])\
    \ and grep('lsass', this['ProcessCommandLine']) or grep(' -i \"lsass', this['ProcessCommandLine'])\
    \ or grep(' /i \"lsass', this['ProcessCommandLine']) or grep(' \u2013i \"lsass',\
    \ this['ProcessCommandLine']) or grep(' \u2014i \"lsass', this['ProcessCommandLine'])\
    \ or grep(' \u2015i \"lsass', this['ProcessCommandLine']) or grep(' -i lsass.exe',\
    \ this['ProcessCommandLine']) or grep(' /i lsass.exe', this['ProcessCommandLine'])\
    \ or grep(' \u2013i lsass.exe', this['ProcessCommandLine']) or grep(' \u2014i\
    \ lsass.exe', this['ProcessCommandLine']) or grep(' \u2015i lsass.exe', this['ProcessCommandLine'])\
    \ or grep('findstr \"lsass', this['ProcessCommandLine']) or grep('findstr lsass',\
    \ this['ProcessCommandLine']) or grep('findstr.exe \"lsass', this['ProcessCommandLine'])\
    \ or grep('findstr.exe lsass', this['ProcessCommandLine'])"
  sigma_id: fe63010f-8823-4864-a96b-a7b4a0f7b929
- name: Permission Misconfiguration Reconnaissance Via Findstr.EXE
  query: (grep('\\find.exe', this['FolderPath']) or grep('\\findstr.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['FIND.EXE', 'FINDSTR.EXE'])
    and (grep('"Everyone"', this['ProcessCommandLine']) or grep('\'Everyone\'', this['ProcessCommandLine'])
    or grep('"BUILTIN\\"', this['ProcessCommandLine']) or grep('\'BUILTIN\\\'', this['ProcessCommandLine']))
    or grep('icacls ', this['ProcessCommandLine']) and grep('findstr ', this['ProcessCommandLine'])
    and grep('Everyone', this['ProcessCommandLine'])
  sigma_id: 47e4bab7-c626-47dc-967b-255608c9a920
- name: Recon Command Output Piped To Findstr.EXE
  query: (grep('ipconfig', this['ProcessCommandLine']) or grep('|', this['ProcessCommandLine'])
    or grep('find', this['ProcessCommandLine'])) or (grep('net', this['ProcessCommandLine'])
    or grep('|', this['ProcessCommandLine']) or grep('find', this['ProcessCommandLine']))
    or (grep('netstat', this['ProcessCommandLine']) or grep('|', this['ProcessCommandLine'])
    or grep('find', this['ProcessCommandLine'])) or (grep('ping', this['ProcessCommandLine'])
    or grep('|', this['ProcessCommandLine']) or grep('find', this['ProcessCommandLine']))
    or (grep('systeminfo', this['ProcessCommandLine']) or grep('|', this['ProcessCommandLine'])
    or grep('find', this['ProcessCommandLine'])) or (grep('tasklist', this['ProcessCommandLine'])
    or grep('|', this['ProcessCommandLine']) or grep('find', this['ProcessCommandLine']))
    or (grep('whoami', this['ProcessCommandLine']) or grep('|', this['ProcessCommandLine'])
    or grep('find', this['ProcessCommandLine']))
  sigma_id: ccb5742c-c248-4982-8c5c-5571b9275ad3
- name: Security Tools Keyword Lookup Via Findstr.EXE
  query: (grep('\\find.exe', this['FolderPath']) or grep('\\findstr.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['FIND.EXE', 'FINDSTR.EXE'])
    and (grep(' avira', this['ProcessCommandLine']) or grep(' avira"', this['ProcessCommandLine'])
    or grep(' cb', this['ProcessCommandLine']) or grep(' cb"', this['ProcessCommandLine'])
    or grep(' cylance', this['ProcessCommandLine']) or grep(' cylance"', this['ProcessCommandLine'])
    or grep(' defender', this['ProcessCommandLine']) or grep(' defender"', this['ProcessCommandLine'])
    or grep(' kaspersky', this['ProcessCommandLine']) or grep(' kaspersky"', this['ProcessCommandLine'])
    or grep(' kes', this['ProcessCommandLine']) or grep(' kes"', this['ProcessCommandLine'])
    or grep(' mc', this['ProcessCommandLine']) or grep(' mc"', this['ProcessCommandLine'])
    or grep(' sec', this['ProcessCommandLine']) or grep(' sec"', this['ProcessCommandLine'])
    or grep(' sentinel', this['ProcessCommandLine']) or grep(' sentinel"', this['ProcessCommandLine'])
    or grep(' symantec', this['ProcessCommandLine']) or grep(' symantec"', this['ProcessCommandLine'])
    or grep(' virus', this['ProcessCommandLine']) or grep(' virus"', this['ProcessCommandLine']))
  sigma_id: 4fe074b4-b833-4081-8f24-7dcfeca72b42
- name: Sysmon Discovery Via Default Driver Altitude Using Findstr.EXE
  query: (grep('\\find.exe', this['FolderPath']) or grep('\\findstr.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['FIND.EXE', 'FINDSTR.EXE'])
    and grep(' 385201', this['ProcessCommandLine'])
  sigma_id: 37db85d1-b089-490a-a59a-c7b6f984f480
- name: Finger.EXE Execution
  query: grep('finger.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\finger.exe',
    this['FolderPath'])
  sigma_id: af491bca-e752-4b44-9c86-df5680533dbc
- name: Filter Driver Unloaded Via Fltmc.EXE
  query: (grep('\\fltMC.exe', this['FolderPath']) or grep('fltMC.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('unload', this['ProcessCommandLine']) and not (grep('C:\\Users\\', this['InitiatingProcessFolderPath'])
    and grep('\\AppData\\Local\\Temp\\', this['InitiatingProcessFolderPath']) and
    grep('\\endpoint-protection-installer-x64.tmp', this['InitiatingProcessFolderPath'])
    and grep('unload rtp_filesystem_filter', this['ProcessCommandLine']) or grep('C:\\Program
    Files (x86)\\ManageEngine\\uems_agent\\bin\\dcfaservice64.exe', this['InitiatingProcessFolderPath'])
    and grep('unload DFMFilter', this['ProcessCommandLine']))
  sigma_id: 4931188c-178e-4ee7-a348-39e8a7a56821
- name: Sysmon Driver Unloaded Via Fltmc.EXE
  query: (grep('\\fltMC.exe', this['FolderPath']) or grep('fltMC.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('unload', this['ProcessCommandLine']) and grep('sysmon', this['ProcessCommandLine'])
  sigma_id: 4d7cda18-1b12-4e52-b45c-d28653210df8
- name: Forfiles.EXE Child Process Masquerading
  query: (grep('.exe', this['InitiatingProcessCommandLine']) or grep('.exe"', this['InitiatingProcessCommandLine']))
    and grep('\\cmd.exe', this['FolderPath']) and grep('/c echo "', this['ProcessCommandLine'])
    and not ((grep(':\\Windows\\System32\\', this['InitiatingProcessFolderPath'])
    or grep(':\\Windows\\SysWOW64\\', this['InitiatingProcessFolderPath'])) and grep('\\forfiles.exe',
    this['InitiatingProcessFolderPath']) and (grep(':\\Windows\\System32\\', this['FolderPath'])
    or grep(':\\Windows\\SysWOW64\\', this['FolderPath'])) and grep('\\cmd.exe', this['FolderPath']))
  sigma_id: f53714ec-5077-420e-ad20-907ff9bb2958
- name: Forfiles Command Execution
  query: "(grep('\\\\forfiles.exe', this['FolderPath']) or grep('forfiles.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep(' -c ', this['ProcessCommandLine']) or grep(' /c ', this['ProcessCommandLine'])\
    \ or grep(' \u2013c ', this['ProcessCommandLine']) or grep(' \u2014c ', this['ProcessCommandLine'])\
    \ or grep(' \u2015c ', this['ProcessCommandLine']))"
  sigma_id: 9aa5106d-bce3-4b13-86df-3a20f1d5cf0b
- name: Uncommon FileSystem Load Attempt By Format.com
  query: grep('\\format.com', this['FolderPath']) and grep('/fs:', this['ProcessCommandLine'])
    and not (grep('/fs:exFAT', this['ProcessCommandLine']) or grep('/fs:FAT', this['ProcessCommandLine'])
    or grep('/fs:NTFS', this['ProcessCommandLine']) or grep('/fs:ReFS', this['ProcessCommandLine'])
    or grep('/fs:UDF', this['ProcessCommandLine']))
  sigma_id: 9fb6b26e-7f9e-4517-a48b-8cac4a1b6c60
- name: Use of FSharp Interpreters
  query: grep('\\fsi.exe', this['FolderPath']) or grep('\\fsianycpu.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['fsi.exe', 'fsianycpu.exe']
  sigma_id: b96b2031-7c17-4473-afe7-a30ce714db29
- name: Fsutil Behavior Set SymlinkEvaluation
  query: (grep('\\fsutil.exe', this['FolderPath']) or grep('fsutil.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('behavior ', this['ProcessCommandLine']) and grep('set ', this['ProcessCommandLine'])
    and grep('SymlinkEvaluation', this['ProcessCommandLine'])
  sigma_id: c0b2768a-dd06-4671-8339-b16ca8d1f27f
- name: Fsutil Suspicious Invocation
  query: (grep('\\fsutil.exe', this['FolderPath']) or grep('fsutil.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('deletejournal', this['ProcessCommandLine']) or grep('createjournal',
    this['ProcessCommandLine']) or grep('setZeroData', this['ProcessCommandLine']))
  sigma_id: add64136-62e5-48ea-807e-88638d02df1e
- name: Potential Arbitrary Command Execution Via FTP.EXE
  query: "grep('\\\\ftp.exe', this['InitiatingProcessFolderPath']) or (grep('\\\\\
    ftp.exe', this['FolderPath']) or grep('ftp.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep('-s:', this['ProcessCommandLine']) or grep('/s:', this['ProcessCommandLine'])\
    \ or grep('\u2013s:', this['ProcessCommandLine']) or grep('\u2014s:', this['ProcessCommandLine'])\
    \ or grep('\u2015s:', this['ProcessCommandLine']))"
  sigma_id: 06b401f4-107c-4ff9-947f-9ec1e7649f1e
- name: Arbitrary File Download Via GfxDownloadWrapper.EXE
  query: grep('\\GfxDownloadWrapper.exe', this['FolderPath']) and (grep('http://',
    this['ProcessCommandLine']) or grep('https://', this['ProcessCommandLine'])) and
    not grep('https://gameplayapi.intel.com/', this['ProcessCommandLine'])
  sigma_id: eee00933-a761-4cd0-be70-c42fe91731e7
- name: Suspicious Git Clone
  query: (grep('\\git.exe', this['FolderPath']) or grep('\\git-remote-https.exe',
    this['FolderPath']) or grep('git.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' clone ', this['ProcessCommandLine']) or grep('git-remote-https ',
    this['ProcessCommandLine'])) and (grep('exploit', this['ProcessCommandLine'])
    or grep('Vulns', this['ProcessCommandLine']) or grep('vulnerability', this['ProcessCommandLine'])
    or grep('RemoteCodeExecution', this['ProcessCommandLine']) or grep('Invoke-',
    this['ProcessCommandLine']) or grep('CVE-', this['ProcessCommandLine']) or grep('poc-',
    this['ProcessCommandLine']) or grep('ProofOfConcept', this['ProcessCommandLine'])
    or grep('proxyshell', this['ProcessCommandLine']) or grep('log4shell', this['ProcessCommandLine'])
    or grep('eternalblue', this['ProcessCommandLine']) or grep('eternal-blue', this['ProcessCommandLine'])
    or grep('MS17-', this['ProcessCommandLine']))
  sigma_id: aef9d1f1-7396-4e92-a927-4567c7a495c1
- name: Potentially Suspicious GoogleUpdate Child Process
  query: grep('\\GoogleUpdate.exe', this['InitiatingProcessFolderPath']) and not (grep('\\Google',
    this['FolderPath']) or grep('\\setup.exe', this['FolderPath']) or grep('chrome_updater.exe',
    this['FolderPath']) or grep('chrome_installer.exe', this['FolderPath']) or this['FolderPath']==null)
  sigma_id: 84b1ecf9-6eff-4004-bafb-bae5c0e251b2
- name: File Decryption Using Gpg4win
  query: "(grep('\\\\gpg.exe', this['FolderPath']) or grep('\\\\gpg2.exe', this['FolderPath'])\
    \ or grep('GnuPG\u2019s OpenPGP tool', this['ProcessVersionInfoFileDescription']))\
    \ and grep(' -d ', this['ProcessCommandLine']) and grep('passphrase', this['ProcessCommandLine'])"
  sigma_id: 037dcd71-33a8-4392-bb01-293c94663e5a
- name: File Encryption Using Gpg4win
  query: "(grep('\\\\gpg.exe', this['FolderPath']) or grep('\\\\gpg2.exe', this['FolderPath'])\
    \ or grep('GnuPG\u2019s OpenPGP tool', this['ProcessVersionInfoFileDescription']))\
    \ and grep(' -c ', this['ProcessCommandLine']) and grep('passphrase', this['ProcessCommandLine'])"
  sigma_id: 550bbb84-ce5d-4e61-84ad-e590f0024dcd
- name: Portable Gpg.EXE Execution
  query: "(grep('\\\\gpg.exe', this['FolderPath']) or grep('\\\\gpg2.exe', this['FolderPath'])\
    \ or grep('gpg.exe', this['ProcessVersionInfoOriginalFileName']) or grep('GnuPG\u2019\
    s OpenPGP tool', this['ProcessVersionInfoFileDescription'])) and not (grep(':\\\
    \\Program Files (x86)\\\\GNU\\\\GnuPG\\\\bin\\\\', this['FolderPath']) or grep(':\\\
    \\Program Files (x86)\\\\GnuPG VS-Desktop\\\\', this['FolderPath']) or grep(':\\\
    \\Program Files (x86)\\\\GnuPG\\\\bin\\\\', this['FolderPath']) or grep(':\\\\\
    Program Files (x86)\\\\Gpg4win\\\\bin\\\\', this['FolderPath']))"
  sigma_id: 77df53a5-1d78-4f32-bc5a-0e7465bd8f41
- name: File Encryption/Decryption Via Gpg4win From Suspicious Locations
  query: "(grep('\\\\gpg.exe', this['FolderPath']) or grep('\\\\gpg2.exe', this['FolderPath'])\
    \ or grep('GNU Privacy Guard (GnuPG)', this['ProcessVersionInfoProductName'])\
    \ or grep('GnuPG\u2019s OpenPGP tool', this['ProcessVersionInfoFileDescription']))\
    \ and grep('-passphrase', this['ProcessCommandLine']) and (grep(':\\\\PerfLogs\\\
    \\', this['ProcessCommandLine']) or grep(':\\\\Temp\\\\', this['ProcessCommandLine'])\
    \ or grep(':\\\\Users\\\\Public\\\\', this['ProcessCommandLine']) or grep(':\\\
    \\Windows\\\\Temp\\\\', this['ProcessCommandLine']) or grep('\\\\AppData\\\\Local\\\
    \\Temp\\\\', this['ProcessCommandLine']) or grep('\\\\AppData\\\\Roaming\\\\',\
    \ this['ProcessCommandLine']))"
  sigma_id: e1e0b7d7-e10b-4ee4-ac49-a4bda05d320d
- name: Gpresult Display Group Policy Information
  query: grep('\\gpresult.exe', this['FolderPath']) and (grep('/z', this['ProcessCommandLine'])
    or grep('/v', this['ProcessCommandLine']))
  sigma_id: e56d3073-83ff-4021-90fe-c658e0709e72
- name: Arbitrary Binary Execution Using GUP Utility
  query: grep('\\gup.exe', this['InitiatingProcessFolderPath']) and grep('\\explorer.exe',
    this['FolderPath']) and not (grep('\\explorer.exe', this['FolderPath']) and grep('\\Notepad++\\notepad++.exe',
    this['ProcessCommandLine']) or grep('\\Notepad++\\updater\\', this['InitiatingProcessFolderPath'])
    or this['ProcessCommandLine']==null)
  sigma_id: d65aee4d-2292-4cea-b832-83accd6cfa43
- name: File Download Using Notepad++ GUP Utility
  query: (grep('\\GUP.exe', this['FolderPath']) or grep('gup.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' -unzipTo ', this['ProcessCommandLine']) and grep('http', this['ProcessCommandLine'])
    and not grep('\\notepad++.exe', this['InitiatingProcessFolderPath'])
  sigma_id: 44143844-0631-49ab-97a0-96387d6b2d7c
- name: Suspicious GUP Usage
  query: grep('\\GUP.exe', this['FolderPath']) and not (grep('\\Program Files\\Notepad++\\updater\\GUP.exe',
    this['FolderPath']) or grep('\\Program Files (x86)\\Notepad++\\updater\\GUP.exe',
    this['FolderPath']) or grep('\\Users\\', this['FolderPath']) and (grep('\\AppData\\Local\\Notepad++\\updater\\GUP.exe',
    this['FolderPath']) or grep('\\AppData\\Roaming\\Notepad++\\updater\\GUP.exe',
    this['FolderPath'])))
  sigma_id: 0a4f6091-223b-41f6-8743-f322ec84930b
- name: Remote CHM File Download/Execution Via HH.EXE
  query: (grep('HH.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\hh.exe',
    this['FolderPath'])) and (grep('http://', this['ProcessCommandLine']) or grep('https://',
    this['ProcessCommandLine']) or grep('\\', this['ProcessCommandLine']))
  sigma_id: f57c58b3-ee69-4ef5-9041-455bf39aaa89
- name: HTML Help HH.EXE Suspicious Child Process
  query: grep('\\hh.exe', this['InitiatingProcessFolderPath']) and (grep('\\CertReq.exe',
    this['FolderPath']) or grep('\\CertUtil.exe', this['FolderPath']) or grep('\\cmd.exe',
    this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']) or grep('\\installutil.exe',
    this['FolderPath']) or grep('\\MSbuild.exe', this['FolderPath']) or grep('\\MSHTA.EXE',
    this['FolderPath']) or grep('\\msiexec.exe', this['FolderPath']) or grep('\\powershell.exe',
    this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']) or grep('\\regsvr32.exe',
    this['FolderPath']) or grep('\\rundll32.exe', this['FolderPath']) or grep('\\schtasks.exe',
    this['FolderPath']) or grep('\\wmic.exe', this['FolderPath']) or grep('\\wscript.exe',
    this['FolderPath']))
  sigma_id: 52cad028-0ff0-4854-8f67-d25dfcbc78b4
- name: Suspicious HH.EXE Execution
  query: (grep('HH.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\hh.exe',
    this['FolderPath'])) and (grep('.application', this['ProcessCommandLine']) or
    grep('\\AppData\\Local\\Temp\\', this['ProcessCommandLine']) or grep('\\Content.Outlook\\',
    this['ProcessCommandLine']) or grep('\\Downloads\\', this['ProcessCommandLine'])
    or grep('\\Users\\Public\\', this['ProcessCommandLine']) or grep('\\Windows\\Temp\\',
    this['ProcessCommandLine']))
  sigma_id: e8a95b5e-c891-46e2-b33a-93937d3abc31
- name: HackTool - ADCSPwn Execution
  query: grep(' --adcs ', this['ProcessCommandLine']) and grep(' --port ', this['ProcessCommandLine'])
  sigma_id: cd8c163e-a19b-402e-bdd5-419ff5859f12
- name: HackTool - Bloodhound/Sharphound Execution
  query: grep('SharpHound', this['ProcessVersionInfoProductName']) or grep('SharpHound',
    this['ProcessVersionInfoFileDescription']) or grep('SpecterOps', this['ProcessVersionInfoCompanyName'])
    or grep('evil corp', this['ProcessVersionInfoCompanyName']) or grep('\\Bloodhound.exe',
    this['FolderPath']) or grep('\\SharpHound.exe', this['FolderPath']) or grep('
    -CollectionMethod All ', this['ProcessCommandLine']) or grep(' --CollectionMethods
    Session ', this['ProcessCommandLine']) or grep(' --Loop --Loopduration ', this['ProcessCommandLine'])
    or grep(' --PortScanTimeout ', this['ProcessCommandLine']) or grep('.exe -c All
    -d ', this['ProcessCommandLine']) or grep('Invoke-Bloodhound', this['ProcessCommandLine'])
    or grep('Get-BloodHoundData', this['ProcessCommandLine']) or grep(' -JsonFolder
    ', this['ProcessCommandLine']) and grep(' -ZipFileName ', this['ProcessCommandLine'])
    or grep(' DCOnly ', this['ProcessCommandLine']) and grep(' --NoSaveCache ', this['ProcessCommandLine'])
  sigma_id: f376c8a7-a2d0-4ddc-aa0c-16c17236d962
- name: HackTool - F-Secure C3 Load by Rundll32
  query: grep('rundll32.exe', this['ProcessCommandLine']) and grep('.dll', this['ProcessCommandLine'])
    and grep('StartNodeRelay', this['ProcessCommandLine'])
  sigma_id: b18c9d4c-fac9-4708-bd06-dd5bfacf200f
- name: HackTool - Certify Execution
  query: grep('\\Certify.exe', this['FolderPath']) or grep('Certify.exe', this['ProcessVersionInfoOriginalFileName'])
    or grep('Certify', this['ProcessVersionInfoFileDescription']) or (grep('.exe cas
    ', this['ProcessCommandLine']) or grep('.exe find ', this['ProcessCommandLine'])
    or grep('.exe pkiobjects ', this['ProcessCommandLine']) or grep('.exe request
    ', this['ProcessCommandLine']) or grep('.exe download ', this['ProcessCommandLine']))
    and (grep(' /vulnerable', this['ProcessCommandLine']) or grep(' /template:', this['ProcessCommandLine'])
    or grep(' /altname:', this['ProcessCommandLine']) or grep(' /domain:', this['ProcessCommandLine'])
    or grep(' /path:', this['ProcessCommandLine']) or grep(' /ca:', this['ProcessCommandLine']))
  sigma_id: 762f2482-ff21-4970-8939-0aa317a886bb
- name: HackTool - Certipy Execution
  query: grep('\\Certipy.exe', this['FolderPath']) or grep('Certipy.exe', this['ProcessVersionInfoOriginalFileName'])
    or grep('Certipy', this['ProcessVersionInfoFileDescription']) or (grep(' account
    ', this['ProcessCommandLine']) or grep(' auth ', this['ProcessCommandLine']) or
    grep(' cert ', this['ProcessCommandLine']) or grep(' find ', this['ProcessCommandLine'])
    or grep(' forge ', this['ProcessCommandLine']) or grep(' ptt ', this['ProcessCommandLine'])
    or grep(' relay ', this['ProcessCommandLine']) or grep(' req ', this['ProcessCommandLine'])
    or grep(' shadow ', this['ProcessCommandLine']) or grep(' template ', this['ProcessCommandLine']))
    and (grep(' -bloodhound', this['ProcessCommandLine']) or grep(' -ca-pfx ', this['ProcessCommandLine'])
    or grep(' -dc-ip ', this['ProcessCommandLine']) or grep(' -kirbi', this['ProcessCommandLine'])
    or grep(' -old-bloodhound', this['ProcessCommandLine']) or grep(' -pfx ', this['ProcessCommandLine'])
    or grep(' -target', this['ProcessCommandLine']) or grep(' -template', this['ProcessCommandLine'])
    or grep(' -username ', this['ProcessCommandLine']) or grep(' -vulnerable', this['ProcessCommandLine'])
    or grep('auth -pfx', this['ProcessCommandLine']) or grep('shadow auto', this['ProcessCommandLine'])
    or grep('shadow list', this['ProcessCommandLine']))
  sigma_id: 6938366d-8954-4ddc-baff-c830b3ba8fcd
- name: Operator Bloopers Cobalt Strike Commands
  query: (grep('Cmd.Exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\cmd.exe',
    this['FolderPath'])) and (grep('cmd ', this['ProcessCommandLine']) or grep('cmd.exe',
    this['ProcessCommandLine']) or grep('c:\\windows\\system32\\cmd.exe', this['ProcessCommandLine']))
    and (grep('psinject', this['ProcessCommandLine']) or grep('spawnas', this['ProcessCommandLine'])
    or grep('make_token', this['ProcessCommandLine']) or grep('remote-exec', this['ProcessCommandLine'])
    or grep('rev2self', this['ProcessCommandLine']) or grep('dcsync', this['ProcessCommandLine'])
    or grep('logonpasswords', this['ProcessCommandLine']) or grep('execute-assembly',
    this['ProcessCommandLine']) or grep('getsystem', this['ProcessCommandLine']))
  sigma_id: 647c7b9e-d784-4fda-b9a0-45c565a7b729
- name: Operator Bloopers Cobalt Strike Modules
  query: (grep('Cmd.Exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\cmd.exe',
    this['FolderPath'])) and (grep('Invoke-UserHunter', this['ProcessCommandLine'])
    or grep('Invoke-ShareFinder', this['ProcessCommandLine']) or grep('Invoke-Kerberoast',
    this['ProcessCommandLine']) or grep('Invoke-SMBAutoBrute', this['ProcessCommandLine'])
    or grep('Invoke-Nightmare', this['ProcessCommandLine']) or grep('zerologon', this['ProcessCommandLine'])
    or grep('av_query', this['ProcessCommandLine']))
  sigma_id: 4f154fb6-27d1-4813-a759-78b93e0b9c48
- name: CobaltStrike Load by Rundll32
  query: (grep('\\rundll32.exe', this['FolderPath']) or grep('RUNDLL32.EXE', this['ProcessVersionInfoOriginalFileName'])
    or grep('rundll32.exe', this['ProcessCommandLine']) or grep('rundll32 ', this['ProcessCommandLine']))
    and grep('.dll', this['ProcessCommandLine']) and (grep(' StartW', this['ProcessCommandLine'])
    or grep(',StartW', this['ProcessCommandLine']))
  sigma_id: ae9c6a7c-9521-42a6-915e-5aaa8689d529
- name: Potential CobaltStrike Process Patterns
  query: grep('cmd.exe /C whoami', this['ProcessCommandLine']) and grep('C:\\Temp\\',
    this['InitiatingProcessFolderPath']) or (grep('\\runonce.exe', this['InitiatingProcessFolderPath'])
    or grep('\\dllhost.exe', this['InitiatingProcessFolderPath'])) and grep('cmd.exe
    /c echo', this['ProcessCommandLine']) and grep('> \\.\\pipe', this['ProcessCommandLine'])
    or grep('cmd.exe /C echo', this['InitiatingProcessCommandLine']) and grep(' >
    \\.\\pipe', this['InitiatingProcessCommandLine']) and grep('conhost.exe 0xffffffff
    -ForceV1', this['ProcessCommandLine']) or grep('/C whoami', this['InitiatingProcessCommandLine'])
    and grep('conhost.exe 0xffffffff -ForceV1', this['ProcessCommandLine'])
  sigma_id: f35c5d71-b489-4e22-a115-f003df287317
- name: HackTool - CoercedPotato Execution
  query: grep('\\CoercedPotato.exe', this['FolderPath']) or grep(' --exploitId ',
    this['ProcessCommandLine']) or grep('IMPHASH=A75D7669DB6B2E107A44C4057FF7F7D6',
    this['Hashes']) or grep('IMPHASH=F91624350E2C678C5DCBE5E1F24E22C9', this['Hashes'])
    or grep('IMPHASH=14C81850A079A87E83D50CA41C709A15', this['Hashes'])
  sigma_id: e8d34729-86a4-4140-adfd-0a29c2106307
- name: HackTool - Covenant PowerShell Launcher
  query: grep('-Sta', this['ProcessCommandLine']) and grep('-Nop', this['ProcessCommandLine'])
    and grep('-Window', this['ProcessCommandLine']) and grep('Hidden', this['ProcessCommandLine'])
    and (grep('-Command', this['ProcessCommandLine']) or grep('-EncodedCommand', this['ProcessCommandLine']))
    or grep('sv o (New-Object IO.MemorySteam);sv d ', this['ProcessCommandLine'])
    or grep('mshta file.hta', this['ProcessCommandLine']) or grep('GruntHTTP', this['ProcessCommandLine'])
    or grep('-EncodedCommand cwB2ACAAbwAgA', this['ProcessCommandLine'])
  sigma_id: c260b6db-48ba-4b4a-a76f-2f67644e99d2
- name: HackTool - CrackMapExec Execution
  query: grep('\\crackmapexec.exe', this['FolderPath']) or grep(' -M pe_inject ',
    this['ProcessCommandLine']) or grep(' --local-auth', this['ProcessCommandLine'])
    and grep(' -u ', this['ProcessCommandLine']) and grep(' -x ', this['ProcessCommandLine'])
    or grep(' --local-auth', this['ProcessCommandLine']) and grep(' -u ', this['ProcessCommandLine'])
    and grep(' -p ', this['ProcessCommandLine']) and grep(' -H \'NTHASH\'', this['ProcessCommandLine'])
    or grep(' mssql ', this['ProcessCommandLine']) and grep(' -u ', this['ProcessCommandLine'])
    and grep(' -p ', this['ProcessCommandLine']) and grep(' -M ', this['ProcessCommandLine'])
    and grep(' -d ', this['ProcessCommandLine']) or grep(' smb ', this['ProcessCommandLine'])
    and grep(' -u ', this['ProcessCommandLine']) and grep(' -H ', this['ProcessCommandLine'])
    and grep(' -M ', this['ProcessCommandLine']) and grep(' -o ', this['ProcessCommandLine'])
    or grep(' smb ', this['ProcessCommandLine']) and grep(' -u ', this['ProcessCommandLine'])
    and grep(' -p ', this['ProcessCommandLine']) and grep(' --local-auth', this['ProcessCommandLine'])
    or grep(' --local-auth', this['ProcessCommandLine']) and grep(' -u ', this['ProcessCommandLine'])
    and grep(' -p ', this['ProcessCommandLine']) and grep(' 10.', this['ProcessCommandLine'])
    and grep(' 192.168.', this['ProcessCommandLine']) and grep('/24 ', this['ProcessCommandLine'])
  sigma_id: 42a993dd-bb3e-48c8-b372-4d6684c4106c
- name: HackTool - CrackMapExec Execution Patterns
  query: (grep('cmd.exe /Q /c ', this['ProcessCommandLine']) or grep(' 1> \\', this['ProcessCommandLine'])
    or grep('\\', this['ProcessCommandLine']) or grep('\\', this['ProcessCommandLine'])
    or grep(' 2>&1', this['ProcessCommandLine'])) or (grep('cmd.exe /C ', this['ProcessCommandLine'])
    or grep(' > \\', this['ProcessCommandLine']) or grep('\\', this['ProcessCommandLine'])
    or grep('\\', this['ProcessCommandLine']) or grep(' 2>&1', this['ProcessCommandLine']))
    or (grep('cmd.exe /C ', this['ProcessCommandLine']) or grep(' > ', this['ProcessCommandLine'])
    or grep('\\Temp\\', this['ProcessCommandLine']) or grep(' 2>&1', this['ProcessCommandLine']))
    or grep('powershell.exe -exec bypass -noni -nop -w 1 -C "', this['ProcessCommandLine'])
    or grep('powershell.exe -noni -nop -w 1 -enc ', this['ProcessCommandLine'])
  sigma_id: 058f4380-962d-40a5-afce-50207d36d7e2
- name: HackTool - CrackMapExec Process Patterns
  query: grep('tasklist /fi ', this['ProcessCommandLine']) and grep('Imagename eq
    lsass.exe', this['ProcessCommandLine']) and (grep('cmd.exe /c ', this['ProcessCommandLine'])
    or grep('cmd.exe /r ', this['ProcessCommandLine']) or grep('cmd.exe /k ', this['ProcessCommandLine'])
    or grep('cmd /c ', this['ProcessCommandLine']) or grep('cmd /r ', this['ProcessCommandLine'])
    or grep('cmd /k ', this['ProcessCommandLine'])) and (grep('AUTHORI', this['AccountName'])
    or grep('AUTORI', this['AccountName'])) or grep('do rundll32.exe C:\\windows\\System32\\comsvcs.dll,
    MiniDump', this['ProcessCommandLine']) and grep('\\Windows\\Temp\\', this['ProcessCommandLine'])
    and grep(' full', this['ProcessCommandLine']) and grep('%%B', this['ProcessCommandLine'])
    or grep('tasklist /v /fo csv', this['ProcessCommandLine']) and grep('findstr /i
    "lsass"', this['ProcessCommandLine'])
  sigma_id: f26307d8-14cd-47e3-a26b-4b4769f24af6
- name: HackTool - CrackMapExec PowerShell Obfuscation
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll'])
    and ((grep('join', this['ProcessCommandLine']) or grep('split', this['ProcessCommandLine']))
    or grep('( $ShellId[1]+$ShellId[13]+\'x\')', this['ProcessCommandLine']) or (grep('(
    $PSHome[', this['ProcessCommandLine']) or grep(']+$PSHOME[', this['ProcessCommandLine'])
    or grep(']+', this['ProcessCommandLine'])) or grep('( $env:Public[13]+$env:Public[5]+\'x\')',
    this['ProcessCommandLine']) or (grep('( $env:ComSpec[4,', this['ProcessCommandLine'])
    or grep(',25]-Join\'\')', this['ProcessCommandLine'])) or grep('[1,3]+\'x\'-Join\'\')',
    this['ProcessCommandLine']))
  sigma_id: 6f8b3439-a203-45dc-a88b-abf57ea15ccf
- name: HackTool - CreateMiniDump Execution
  query: grep('\\CreateMiniDump.exe', this['FolderPath']) or grep('IMPHASH=4a07f944a83e8a7c2525efa35dd30e2f',
    this['Hashes'])
  sigma_id: 36d88494-1d43-4dc0-b3fa-35c8fea0ca9d
- name: HackTool - DInjector PowerShell Cradle Execution
  query: grep(' /am51', this['ProcessCommandLine']) and grep(' /password', this['ProcessCommandLine'])
  sigma_id: d78b5d61-187d-44b6-bf02-93486a80de5a
- name: HackTool - Dumpert Process Dumper Execution
  query: grep('09D278F9DE118EF09163C6140255C690', this['MD5']) or grep('Dumpert.dll',
    this['ProcessCommandLine'])
  sigma_id: 2704ab9e-afe2-4854-a3b1-0c0706d03578
- name: HackTool - EDRSilencer Execution
  query: grep('\\EDRSilencer.exe', this['FolderPath']) or grep('EDRSilencer.exe',
    this['ProcessVersionInfoOriginalFileName']) or grep('EDRSilencer', this['ProcessVersionInfoFileDescription'])
  sigma_id: eb2d07d4-49cb-4523-801a-da002df36602
- name: HackTool - Empire PowerShell Launch Parameters
  query: grep(' -NoP -sta -NonI -W Hidden -Enc ', this['ProcessCommandLine']) or grep('
    -noP -sta -w 1 -enc ', this['ProcessCommandLine']) or grep(' -NoP -NonI -W Hidden
    -enc ', this['ProcessCommandLine']) or grep(' -noP -sta -w 1 -enc', this['ProcessCommandLine'])
    or grep(' -enc  SQB', this['ProcessCommandLine']) or grep(' -nop -exec bypass
    -EncodedCommand ', this['ProcessCommandLine'])
  sigma_id: 79f4ede3-402e-41c8-bc3e-ebbf5f162581
- name: HackTool - Empire PowerShell UAC Bypass
  query: grep(' -NoP -NonI -w Hidden -c $x=$((gp HKCU:Software\\Microsoft\\Windows
    Update).Update)', this['ProcessCommandLine']) or grep(' -NoP -NonI -c $x=$((gp
    HKCU:Software\\Microsoft\\Windows Update).Update);', this['ProcessCommandLine'])
  sigma_id: 3268b746-88d8-4cd3-bffc-30077d02c787
- name: HackTool - WinRM Access Via Evil-WinRM
  query: grep('\\ruby.exe', this['FolderPath']) and grep('-i ', this['ProcessCommandLine'])
    and grep('-u ', this['ProcessCommandLine']) and grep('-p ', this['ProcessCommandLine'])
  sigma_id: a197e378-d31b-41c0-9635-cfdf1c1bb423
- name: Hacktool Execution - Imphash
  query: grep('IMPHASH=BCCA3C247B619DCD13C8CDFF5F123932', this['Hashes']) or grep('IMPHASH=3A19059BD7688CB88E70005F18EFC439',
    this['Hashes']) or grep('IMPHASH=bf6223a49e45d99094406777eb6004ba', this['Hashes'])
    or grep('IMPHASH=23867A89C2B8FC733BE6CF5EF902F2D1', this['Hashes']) or grep('IMPHASH=A37FF327F8D48E8A4D2F757E1B6E70BC',
    this['Hashes']) or grep('IMPHASH=F9A28C458284584A93B14216308D31BD', this['Hashes'])
    or grep('IMPHASH=6118619783FC175BC7EBECFF0769B46E', this['Hashes']) or grep('IMPHASH=959A83047E80AB68B368FDB3F4C6E4EA',
    this['Hashes']) or grep('IMPHASH=563233BFA169ACC7892451F71AD5850A', this['Hashes'])
    or grep('IMPHASH=87575CB7A0E0700EB37F2E3668671A08', this['Hashes']) or grep('IMPHASH=13F08707F759AF6003837A150A371BA1',
    this['Hashes']) or grep('IMPHASH=1781F06048A7E58B323F0B9259BE798B', this['Hashes'])
    or grep('IMPHASH=233F85F2D4BC9D6521A6CAAE11A1E7F5', this['Hashes']) or grep('IMPHASH=24AF2584CBF4D60BBE5C6D1B31B3BE6D',
    this['Hashes']) or grep('IMPHASH=632969DDF6DBF4E0F53424B75E4B91F2', this['Hashes'])
    or grep('IMPHASH=713C29B396B907ED71A72482759ED757', this['Hashes']) or grep('IMPHASH=749A7BB1F0B4C4455949C0B2BF7F9E9F',
    this['Hashes']) or grep('IMPHASH=8628B2608957A6B0C6330AC3DE28CE2E', this['Hashes'])
    or grep('IMPHASH=8B114550386E31895DFAB371E741123D', this['Hashes']) or grep('IMPHASH=94CB940A1A6B65BED4D5A8F849CE9793',
    this['Hashes']) or grep('IMPHASH=9D68781980370E00E0BD939EE5E6C141', this['Hashes'])
    or grep('IMPHASH=B18A1401FF8F444056D29450FBC0A6CE', this['Hashes']) or grep('IMPHASH=CB567F9498452721D77A451374955F5F',
    this['Hashes']) or grep('IMPHASH=730073214094CD328547BF1F72289752', this['Hashes'])
    or grep('IMPHASH=17B461A082950FC6332228572138B80C', this['Hashes']) or grep('IMPHASH=DC25EE78E2EF4D36FAA0BADF1E7461C9',
    this['Hashes']) or grep('IMPHASH=819B19D53CA6736448F9325A85736792', this['Hashes'])
    or grep('IMPHASH=829DA329CE140D873B4A8BDE2CBFAA7E', this['Hashes']) or grep('IMPHASH=C547F2E66061A8DFFB6F5A3FF63C0A74',
    this['Hashes']) or grep('IMPHASH=0588081AB0E63BA785938467E1B10CCA', this['Hashes'])
    or grep('IMPHASH=0D9EC08BAC6C07D9987DFD0F1506587C', this['Hashes']) or grep('IMPHASH=BC129092B71C89B4D4C8CDF8EA590B29',
    this['Hashes']) or grep('IMPHASH=4DA924CF622D039D58BCE71CDF05D242', this['Hashes'])
    or grep('IMPHASH=E7A3A5C377E2D29324093377D7DB1C66', this['Hashes']) or grep('IMPHASH=9A9DBEC5C62F0380B4FA5FD31DEFFEDF',
    this['Hashes']) or grep('IMPHASH=AF8A3976AD71E5D5FDFB67DDB8DADFCE', this['Hashes'])
    or grep('IMPHASH=0C477898BBF137BBD6F2A54E3B805FF4', this['Hashes']) or grep('IMPHASH=0CA9F02B537BCEA20D4EA5EB1A9FE338',
    this['Hashes']) or grep('IMPHASH=3AB3655E5A14D4EEFC547F4781BF7F9E', this['Hashes'])
    or grep('IMPHASH=E6F9D5152DA699934B30DAAB206471F6', this['Hashes']) or grep('IMPHASH=3AD59991CCF1D67339B319B15A41B35D',
    this['Hashes']) or grep('IMPHASH=FFDD59E0318B85A3E480874D9796D872', this['Hashes'])
    or grep('IMPHASH=0CF479628D7CC1EA25EC7998A92F5051', this['Hashes']) or grep('IMPHASH=07A2D4DCBD6CB2C6A45E6B101F0B6D51',
    this['Hashes']) or grep('IMPHASH=D6D0F80386E1380D05CB78E871BC72B1', this['Hashes'])
    or grep('IMPHASH=38D9E015591BBFD4929E0D0F47FA0055', this['Hashes']) or grep('IMPHASH=0E2216679CA6E1094D63322E3412D650',
    this['Hashes']) or grep('IMPHASH=ADA161BF41B8E5E9132858CB54CAB5FB', this['Hashes'])
    or grep('IMPHASH=2A1BC4913CD5ECB0434DF07CB675B798', this['Hashes']) or grep('IMPHASH=11083E75553BAAE21DC89CE8F9A195E4',
    this['Hashes']) or grep('IMPHASH=A23D29C9E566F2FA8FFBB79267F5DF80', this['Hashes'])
    or grep('IMPHASH=4A07F944A83E8A7C2525EFA35DD30E2F', this['Hashes']) or grep('IMPHASH=767637C23BB42CD5D7397CF58B0BE688',
    this['Hashes']) or grep('IMPHASH=14C4E4C72BA075E9069EE67F39188AD8', this['Hashes'])
    or grep('IMPHASH=3C782813D4AFCE07BBFC5A9772ACDBDC', this['Hashes']) or grep('IMPHASH=7D010C6BB6A3726F327F7E239166D127',
    this['Hashes']) or grep('IMPHASH=89159BA4DD04E4CE5559F132A9964EB3', this['Hashes'])
    or grep('IMPHASH=6F33F4A5FC42B8CEC7314947BD13F30F', this['Hashes']) or grep('IMPHASH=5834ED4291BDEB928270428EBBAF7604',
    this['Hashes']) or grep('IMPHASH=5A8A8A43F25485E7EE1B201EDCBC7A38', this['Hashes'])
    or grep('IMPHASH=DC7D30B90B2D8ABF664FBED2B1B59894', this['Hashes']) or grep('IMPHASH=41923EA1F824FE63EA5BEB84DB7A3E74',
    this['Hashes']) or grep('IMPHASH=3DE09703C8E79ED2CA3F01074719906B', this['Hashes'])
    or grep('IMPHASH=A53A02B997935FD8EEDCB5F7ABAB9B9F', this['Hashes']) or grep('IMPHASH=E96A73C7BF33A464C510EDE582318BF2',
    this['Hashes']) or grep('IMPHASH=32089B8851BBF8BC2D014E9F37288C83', this['Hashes'])
    or grep('IMPHASH=09D278F9DE118EF09163C6140255C690', this['Hashes']) or grep('IMPHASH=03866661686829d806989e2fc5a72606',
    this['Hashes']) or grep('IMPHASH=e57401fbdadcd4571ff385ab82bd5d6d', this['Hashes'])
    or grep('IMPHASH=84B763C45C0E4A3E7CA5548C710DB4EE', this['Hashes']) or grep('IMPHASH=19584675D94829987952432E018D5056',
    this['Hashes']) or grep('IMPHASH=330768A4F172E10ACB6287B87289D83B', this['Hashes'])
    or grep('IMPHASH=885C99CCFBE77D1CBFCB9C4E7C1A3313', this['Hashes']) or grep('IMPHASH=22A22BC9E4E0D2F189F1EA01748816AC',
    this['Hashes']) or grep('IMPHASH=7FA30E6BB7E8E8A69155636E50BF1B28', this['Hashes'])
    or grep('IMPHASH=96DF3A3731912449521F6F8D183279B1', this['Hashes']) or grep('IMPHASH=7E6CF3FF4576581271AC8A313B2AAB46',
    this['Hashes']) or grep('IMPHASH=51791678F351C03A0EB4E2A7B05C6E17', this['Hashes'])
    or grep('IMPHASH=25CE42B079282632708FC846129E98A5', this['Hashes']) or grep('IMPHASH=021BCCA20BA3381B11BDDE26B4E62F20',
    this['Hashes']) or grep('IMPHASH=59223B5F52D8799D38E0754855CBDF42', this['Hashes'])
    or grep('IMPHASH=81E75D8F1D276C156653D3D8813E4A43', this['Hashes']) or grep('IMPHASH=17244E8B6B8227E57FE709CCAD421420',
    this['Hashes']) or grep('IMPHASH=5B76DA3ACDEDC8A5CDF23A798B5936B4', this['Hashes'])
    or grep('IMPHASH=CB2B65BB77D995CC1C0E5DF1C860133C', this['Hashes']) or grep('IMPHASH=40445337761D80CF465136FAFB1F63E6',
    this['Hashes']) or grep('IMPHASH=8A790F401B29FA87BC1E56F7272B3AA6', this['Hashes'])
    or grep('IMPHASH=B50199E952C875241B9CE06C971CE3C1', this['Hashes'])
  sigma_id: 24e3e58a-646b-4b50-adef-02ef935b9fc8
- name: Hacktool Execution - PE Metadata
  query: grep('Cube0x0', this['ProcessVersionInfoCompanyName'])
  sigma_id: 37c1333a-a0db-48be-b64b-7393b2386e3b
- name: HackTool - GMER Rootkit Detector and Remover Execution
  query: grep('\\gmer.exe', this['FolderPath']) or grep('E9DC058440D321AA17D0600B3CA0AB04',
    this['MD5']) or grep('539C228B6B332F5AA523E5CE358C16647D8BBE57', this['SHA1'])
    or grep('E8A3E804A96C716A3E9B69195DB6FFB0D33E2433AF871E4D4E1EAB3097237173', this['SHA256'])
  sigma_id: 9082ff1f-88ab-4678-a3cc-5bcff99fc74d
- name: HackTool - HandleKatz LSASS Dumper Execution
  query: grep('\\loader.exe', this['FolderPath']) and grep('--pid:', this['ProcessCommandLine'])
    or grep('IMPHASH=38D9E015591BBFD4929E0D0F47FA0055', this['Hashes']) or grep('IMPHASH=0E2216679CA6E1094D63322E3412D650',
    this['Hashes']) or grep('--pid:', this['ProcessCommandLine']) and grep('--outfile:',
    this['ProcessCommandLine']) and (grep('.dmp', this['ProcessCommandLine']) or grep('lsass',
    this['ProcessCommandLine']) or grep('.obf', this['ProcessCommandLine']) or grep('dump',
    this['ProcessCommandLine']))
  sigma_id: ca621ba5-54ab-4035-9942-d378e6fcde3c
- name: HackTool - Hashcat Password Cracker Execution
  query: grep('\\hashcat.exe', this['FolderPath']) or grep('-a ', this['ProcessCommandLine'])
    and grep('-m 1000 ', this['ProcessCommandLine']) and grep('-r ', this['ProcessCommandLine'])
  sigma_id: 39b31e81-5f5f-4898-9c0e-2160cfc0f9bf
- name: HackTool - Htran/NATBypass Execution
  query: grep('\\htran.exe', this['FolderPath']) or grep('\\lcx.exe', this['FolderPath'])
    or grep('.exe -tran ', this['ProcessCommandLine']) or grep('.exe -slave ', this['ProcessCommandLine'])
  sigma_id: f5e3b62f-e577-4e59-931e-0a15b2b94e1e
- name: HackTool - Hydra Password Bruteforce Execution
  query: grep('-u ', this['ProcessCommandLine']) and grep('-p ', this['ProcessCommandLine'])
    and (grep('^USER^', this['ProcessCommandLine']) or grep('^PASS^', this['ProcessCommandLine']))
  sigma_id: aaafa146-074c-11eb-adc1-0242ac120002
- name: HackTool - Potential Impacket Lateral Movement Activity
  query: (grep('\\wmiprvse.exe', this['InitiatingProcessFolderPath']) or grep('\\mmc.exe',
    this['InitiatingProcessFolderPath']) or grep('\\explorer.exe', this['InitiatingProcessFolderPath'])
    or grep('\\services.exe', this['InitiatingProcessFolderPath'])) and grep('cmd.exe',
    this['ProcessCommandLine']) and grep('/Q', this['ProcessCommandLine']) and grep('/c',
    this['ProcessCommandLine']) and grep('\\127.0.0.1\\', this['ProcessCommandLine'])
    and grep('&1', this['ProcessCommandLine']) or (grep('svchost.exe -k netsvcs',
    this['InitiatingProcessCommandLine']) or grep('taskeng.exe', this['InitiatingProcessCommandLine']))
    and grep('cmd.exe', this['ProcessCommandLine']) and grep('/C', this['ProcessCommandLine'])
    and grep('Windows\\Temp\\', this['ProcessCommandLine']) and grep('&1', this['ProcessCommandLine'])
  sigma_id: 10c14723-61c7-4c75-92ca-9af245723ad2
- name: HackTool - Impacket Tools Execution
  query: grep('\\goldenPac', this['FolderPath']) or grep('\\karmaSMB', this['FolderPath'])
    or grep('\\kintercept', this['FolderPath']) or grep('\\ntlmrelayx', this['FolderPath'])
    or grep('\\rpcdump', this['FolderPath']) or grep('\\samrdump', this['FolderPath'])
    or grep('\\secretsdump', this['FolderPath']) or grep('\\smbexec', this['FolderPath'])
    or grep('\\smbrelayx', this['FolderPath']) or grep('\\wmiexec', this['FolderPath'])
    or grep('\\wmipersist', this['FolderPath']) or grep('\\atexec_windows.exe', this['FolderPath'])
    or grep('\\dcomexec_windows.exe', this['FolderPath']) or grep('\\dpapi_windows.exe',
    this['FolderPath']) or grep('\\findDelegation_windows.exe', this['FolderPath'])
    or grep('\\GetADUsers_windows.exe', this['FolderPath']) or grep('\\GetNPUsers_windows.exe',
    this['FolderPath']) or grep('\\getPac_windows.exe', this['FolderPath']) or grep('\\getST_windows.exe',
    this['FolderPath']) or grep('\\getTGT_windows.exe', this['FolderPath']) or grep('\\GetUserSPNs_windows.exe',
    this['FolderPath']) or grep('\\ifmap_windows.exe', this['FolderPath']) or grep('\\mimikatz_windows.exe',
    this['FolderPath']) or grep('\\netview_windows.exe', this['FolderPath']) or grep('\\nmapAnswerMachine_windows.exe',
    this['FolderPath']) or grep('\\opdump_windows.exe', this['FolderPath']) or grep('\\psexec_windows.exe',
    this['FolderPath']) or grep('\\rdp_check_windows.exe', this['FolderPath']) or
    grep('\\sambaPipe_windows.exe', this['FolderPath']) or grep('\\smbclient_windows.exe',
    this['FolderPath']) or grep('\\smbserver_windows.exe', this['FolderPath']) or
    grep('\\sniff_windows.exe', this['FolderPath']) or grep('\\sniffer_windows.exe',
    this['FolderPath']) or grep('\\split_windows.exe', this['FolderPath']) or grep('\\ticketer_windows.exe',
    this['FolderPath'])
  sigma_id: 4627c6ae-6899-46e2-aa0c-6ebcb1becd19
- name: HackTool - Impersonate Execution
  query: grep('impersonate.exe', this['ProcessCommandLine']) and (grep(' list ', this['ProcessCommandLine'])
    or grep(' exec ', this['ProcessCommandLine']) or grep(' adduser ', this['ProcessCommandLine']))
    or grep('9520714AB576B0ED01D1513691377D01', this['MD5']) or grep('E81CC96E2118DC4FBFE5BAD1604E0AC7681960143E2101E1A024D52264BB0A8A',
    this['SHA256'])
  sigma_id: cf0c254b-22f1-4b2b-8221-e137b3c0af94
- name: HackTool - Inveigh Execution
  query: grep('\\Inveigh.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['\\Inveigh.exe', '\\Inveigh.dll'] or grep('Inveigh', this['ProcessVersionInfoFileDescription'])
    or grep(' -SpooferIP', this['ProcessCommandLine']) or grep(' -ReplyToIPs ', this['ProcessCommandLine'])
    or grep(' -ReplyToDomains ', this['ProcessCommandLine']) or grep(' -ReplyToMACs
    ', this['ProcessCommandLine']) or grep(' -SnifferIP', this['ProcessCommandLine'])
  sigma_id: b99a1518-1ad5-4f65-bc95-1ffff97a8fd0
- name: Invoke-Obfuscation CLIP+ Launcher
  query: grep('cmd', this['ProcessCommandLine']) and grep('&&', this['ProcessCommandLine'])
    and grep('clipboard]::', this['ProcessCommandLine']) and grep('-f', this['ProcessCommandLine'])
    and (grep('/c', this['ProcessCommandLine']) or grep('/r', this['ProcessCommandLine']))
  sigma_id: b222df08-0e07-11eb-adc1-0242ac120002
- name: Invoke-Obfuscation COMPRESS OBFUSCATION
  query: grep('new-object', this['ProcessCommandLine']) and grep('text.encoding]::ascii',
    this['ProcessCommandLine']) and (grep('system.io.compression.deflatestream', this['ProcessCommandLine'])
    or grep('system.io.streamreader', this['ProcessCommandLine']) or grep('readtoend(',
    this['ProcessCommandLine']))
  sigma_id: 7eedcc9d-9fdb-4d94-9c54-474e8affc0c7
- name: Invoke-Obfuscation Via Use MSHTA
  query: grep('set', this['ProcessCommandLine']) and grep('&&', this['ProcessCommandLine'])
    and grep('mshta', this['ProcessCommandLine']) and grep('vbscript:createobject',
    this['ProcessCommandLine']) and grep('.run', this['ProcessCommandLine']) and grep('(window.close)',
    this['ProcessCommandLine'])
  sigma_id: ac20ae82-8758-4f38-958e-b44a3140ca88
- name: Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION
  query: grep('&&set', this['ProcessCommandLine']) and grep('cmd', this['ProcessCommandLine'])
    and grep('/c', this['ProcessCommandLine']) and grep('-f', this['ProcessCommandLine'])
    and (grep('{0}', this['ProcessCommandLine']) or grep('{1}', this['ProcessCommandLine'])
    or grep('{2}', this['ProcessCommandLine']) or grep('{3}', this['ProcessCommandLine'])
    or grep('{4}', this['ProcessCommandLine']) or grep('{5}', this['ProcessCommandLine']))
  sigma_id: e9f55347-2928-4c06-88e5-1a7f8169942e
- name: HackTool - Jlaive In-Memory Assembly Execution
  query: grep('\\cmd.exe', this['InitiatingProcessFolderPath']) and grep('.bat', this['InitiatingProcessCommandLine'])
    and (grep('\\xcopy.exe', this['FolderPath']) and grep('powershell.exe', this['ProcessCommandLine'])
    and grep('.bat.exe', this['ProcessCommandLine']) or grep('\\xcopy.exe', this['FolderPath'])
    and grep('pwsh.exe', this['ProcessCommandLine']) and grep('.bat.exe', this['ProcessCommandLine'])
    or grep('\\attrib.exe', this['FolderPath']) and grep('+s', this['ProcessCommandLine'])
    and grep('+h', this['ProcessCommandLine']) and grep('.bat.exe', this['ProcessCommandLine']))
  sigma_id: 0a99eb3e-1617-41bd-b095-13dc767f3def
- name: HackTool - Koadic Execution
  query: (grep('\\cmd.exe', this['FolderPath']) or grep('Cmd.Exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('/q', this['ProcessCommandLine']) and grep('/c', this['ProcessCommandLine'])
    and grep('chcp', this['ProcessCommandLine'])
  sigma_id: 5cddf373-ef00-4112-ad72-960ac29bac34
- name: HackTool - KrbRelay Execution
  query: grep('\\KrbRelay.exe', this['FolderPath']) or grep('KrbRelay.exe', this['ProcessVersionInfoOriginalFileName'])
    or grep(' -spn ', this['ProcessCommandLine']) and grep(' -clsid ', this['ProcessCommandLine'])
    and grep(' -rbcd ', this['ProcessCommandLine']) or grep('shadowcred', this['ProcessCommandLine'])
    and grep('clsid', this['ProcessCommandLine']) and grep('spn', this['ProcessCommandLine'])
    or grep('spn ', this['ProcessCommandLine']) and grep('session ', this['ProcessCommandLine'])
    and grep('clsid ', this['ProcessCommandLine'])
  sigma_id: e96253b8-6b3b-4f90-9e59-3b24b99cf9b4
- name: HackTool - RemoteKrbRelay Execution
  query: grep('\\RemoteKrbRelay.exe', this['FolderPath']) or grep('RemoteKrbRelay.exe',
    this['ProcessVersionInfoOriginalFileName']) or grep(' -clsid ', this['ProcessCommandLine'])
    and grep(' -target ', this['ProcessCommandLine']) and grep(' -victim ', this['ProcessCommandLine'])
    or grep('-rbcd ', this['ProcessCommandLine']) and (grep('-cn ', this['ProcessCommandLine'])
    or grep('--computername ', this['ProcessCommandLine'])) or grep('-chp ', this['ProcessCommandLine'])
    and grep('-chpPass ', this['ProcessCommandLine']) and grep('-chpUser ', this['ProcessCommandLine'])
    or grep('-addgroupmember ', this['ProcessCommandLine']) and grep('-group ', this['ProcessCommandLine'])
    and grep('-groupuser ', this['ProcessCommandLine']) or grep('-smb ', this['ProcessCommandLine'])
    and grep('--smbkeyword ', this['ProcessCommandLine']) and (grep('interactive',
    this['ProcessCommandLine']) or grep('secrets', this['ProcessCommandLine']) or
    grep('service-add', this['ProcessCommandLine']))
  sigma_id: a7664b14-75fb-4a50-a223-cb9bc0afbacf
- name: HackTool - KrbRelayUp Execution
  query: grep('\\KrbRelayUp.exe', this['FolderPath']) or grep('KrbRelayUp.exe', this['ProcessVersionInfoOriginalFileName'])
    or grep(' relay ', this['ProcessCommandLine']) and grep(' -Domain ', this['ProcessCommandLine'])
    and grep(' -ComputerName ', this['ProcessCommandLine']) or grep(' krbscm ', this['ProcessCommandLine'])
    and grep(' -sc ', this['ProcessCommandLine']) or grep(' spawn ', this['ProcessCommandLine'])
    and grep(' -d ', this['ProcessCommandLine']) and grep(' -cn ', this['ProcessCommandLine'])
    and grep(' -cp ', this['ProcessCommandLine'])
  sigma_id: 12827a56-61a4-476a-a9cb-f3068f191073
- name: HackTool - LaZagne Execution
  query: grep('\\lazagne.exe', this['FolderPath']) or (grep(':\\PerfLogs\\', this['FolderPath'])
    or grep(':\\ProgramData\\', this['FolderPath']) or grep(':\\Temp\\', this['FolderPath'])
    or grep(':\\Tmp\\', this['FolderPath']) or grep(':\\Windows\\Temp\\', this['FolderPath'])
    or grep('\\AppData\\', this['FolderPath']) or grep('\\Downloads\\', this['FolderPath'])
    or grep('\\Users\\Public\\', this['FolderPath'])) and (grep('.exe all', this['ProcessCommandLine'])
    or grep('.exe browsers', this['ProcessCommandLine']) or grep('.exe chats', this['ProcessCommandLine'])
    or grep('.exe databases', this['ProcessCommandLine']) or grep('.exe games', this['ProcessCommandLine'])
    or grep('.exe git', this['ProcessCommandLine']) or grep('.exe mails', this['ProcessCommandLine'])
    or grep('.exe maven', this['ProcessCommandLine']) or grep('.exe memory', this['ProcessCommandLine'])
    or grep('.exe multimedia', this['ProcessCommandLine']) or grep('.exe sysadmin',
    this['ProcessCommandLine']) or grep('.exe unused', this['ProcessCommandLine'])
    or grep('.exe wifi', this['ProcessCommandLine']) or grep('.exe windows', this['ProcessCommandLine']))
    or (grep('all ', this['ProcessCommandLine']) or grep('browsers ', this['ProcessCommandLine'])
    or grep('chats ', this['ProcessCommandLine']) or grep('databases ', this['ProcessCommandLine'])
    or grep('games ', this['ProcessCommandLine']) or grep('git ', this['ProcessCommandLine'])
    or grep('mails ', this['ProcessCommandLine']) or grep('maven ', this['ProcessCommandLine'])
    or grep('memory ', this['ProcessCommandLine']) or grep('multimedia ', this['ProcessCommandLine'])
    or grep('php ', this['ProcessCommandLine']) or grep('svn ', this['ProcessCommandLine'])
    or grep('sysadmin ', this['ProcessCommandLine']) or grep('unused ', this['ProcessCommandLine'])
    or grep('wifi ', this['ProcessCommandLine']) or grep('windows ', this['ProcessCommandLine']))
    and (grep('-oA', this['ProcessCommandLine']) or grep('-oJ', this['ProcessCommandLine'])
    or grep('-oN', this['ProcessCommandLine']) or grep('-output', this['ProcessCommandLine'])
    or grep('-password', this['ProcessCommandLine']) or grep('-1Password', this['ProcessCommandLine'])
    or grep('-apachedirectorystudio', this['ProcessCommandLine']) or grep('-autologon',
    this['ProcessCommandLine']) or grep('-ChromiumBased', this['ProcessCommandLine'])
    or grep('-composer', this['ProcessCommandLine']) or grep('-coreftp', this['ProcessCommandLine'])
    or grep('-credfiles', this['ProcessCommandLine']) or grep('-credman', this['ProcessCommandLine'])
    or grep('-cyberduck', this['ProcessCommandLine']) or grep('-dbvis', this['ProcessCommandLine'])
    or grep('-EyeCon', this['ProcessCommandLine']) or grep('-filezilla', this['ProcessCommandLine'])
    or grep('-filezillaserver', this['ProcessCommandLine']) or grep('-ftpnavigator',
    this['ProcessCommandLine']) or grep('-galconfusion', this['ProcessCommandLine'])
    or grep('-gitforwindows', this['ProcessCommandLine']) or grep('-hashdump', this['ProcessCommandLine'])
    or grep('-iisapppool', this['ProcessCommandLine']) or grep('-IISCentralCertP',
    this['ProcessCommandLine']) or grep('-kalypsomedia', this['ProcessCommandLine'])
    or grep('-keepass', this['ProcessCommandLine']) or grep('-keepassconfig', this['ProcessCommandLine'])
    or grep('-lsa_secrets', this['ProcessCommandLine']) or grep('-mavenrepositories',
    this['ProcessCommandLine']) or grep('-memory_dump', this['ProcessCommandLine'])
    or grep('-Mozilla', this['ProcessCommandLine']) or grep('-mRemoteNG', this['ProcessCommandLine'])
    or grep('-mscache', this['ProcessCommandLine']) or grep('-opensshforwindows',
    this['ProcessCommandLine']) or grep('-openvpn', this['ProcessCommandLine']) or
    grep('-outlook', this['ProcessCommandLine']) or grep('-pidgin', this['ProcessCommandLine'])
    or grep('-postgresql', this['ProcessCommandLine']) or grep('-psi-im', this['ProcessCommandLine'])
    or grep('-puttycm', this['ProcessCommandLine']) or grep('-pypykatz', this['ProcessCommandLine'])
    or grep('-Rclone', this['ProcessCommandLine']) or grep('-rdpmanager', this['ProcessCommandLine'])
    or grep('-robomongo', this['ProcessCommandLine']) or grep('-roguestale', this['ProcessCommandLine'])
    or grep('-skype', this['ProcessCommandLine']) or grep('-SQLDeveloper', this['ProcessCommandLine'])
    or grep('-squirrel', this['ProcessCommandLine']) or grep('-tortoise', this['ProcessCommandLine'])
    or grep('-turba', this['ProcessCommandLine']) or grep('-UCBrowser', this['ProcessCommandLine'])
    or grep('-unattended', this['ProcessCommandLine']) or grep('-vault', this['ProcessCommandLine'])
    or grep('-vaultfiles', this['ProcessCommandLine']) or grep('-vnc', this['ProcessCommandLine'])
    or grep('-windows', this['ProcessCommandLine']) or grep('-winscp', this['ProcessCommandLine'])
    or grep('-wsl', this['ProcessCommandLine']))
  sigma_id: c2b86e67-b880-4eec-b045-50bc98ef4844
- name: HackTool - LocalPotato Execution
  query: grep('\\LocalPotato.exe', this['FolderPath']) or grep('.exe -i C:\\', this['ProcessCommandLine'])
    and grep('-o Windows\\', this['ProcessCommandLine']) or grep('IMPHASH=E1742EE971D6549E8D4D81115F88F1FC',
    this['Hashes']) or grep('IMPHASH=DD82066EFBA94D7556EF582F247C8BB5', this['Hashes'])
  sigma_id: 6bd75993-9888-4f91-9404-e1e4e4e34b77
- name: Potential Meterpreter/CobaltStrike Activity
  query: grep('\\services.exe', this['InitiatingProcessFolderPath']) and (grep('/c',
    this['ProcessCommandLine']) and grep('echo', this['ProcessCommandLine']) and grep('\\pipe\\',
    this['ProcessCommandLine']) and (grep('cmd', this['ProcessCommandLine']) or grep('%COMSPEC%',
    this['ProcessCommandLine'])) or grep('rundll32', this['ProcessCommandLine']) and
    grep('.dll,a', this['ProcessCommandLine']) and grep('/p:', this['ProcessCommandLine']))
    and not grep('MpCmdRun', this['ProcessCommandLine'])
  sigma_id: 15619216-e993-4721-b590-4c520615a67d
- name: HackTool - Mimikatz Execution
  query: grep('DumpCreds', this['ProcessCommandLine']) or grep('mimikatz', this['ProcessCommandLine'])
    or grep('::aadcookie', this['ProcessCommandLine']) or grep('::detours', this['ProcessCommandLine'])
    or grep('::memssp', this['ProcessCommandLine']) or grep('::mflt', this['ProcessCommandLine'])
    or grep('::ncroutemon', this['ProcessCommandLine']) or grep('::ngcsign', this['ProcessCommandLine'])
    or grep('::printnightmare', this['ProcessCommandLine']) or grep('::skeleton',
    this['ProcessCommandLine']) or grep('::preshutdown', this['ProcessCommandLine'])
    or grep('::mstsc', this['ProcessCommandLine']) or grep('::multirdp', this['ProcessCommandLine'])
    or grep('rpc::', this['ProcessCommandLine']) or grep('token::', this['ProcessCommandLine'])
    or grep('crypto::', this['ProcessCommandLine']) or grep('dpapi::', this['ProcessCommandLine'])
    or grep('sekurlsa::', this['ProcessCommandLine']) or grep('kerberos::', this['ProcessCommandLine'])
    or grep('lsadump::', this['ProcessCommandLine']) or grep('privilege::', this['ProcessCommandLine'])
    or grep('process::', this['ProcessCommandLine']) or grep('vault::', this['ProcessCommandLine'])
  sigma_id: a642964e-bead-4bed-8910-1bb4d63e3b4d
- name: HackTool - PCHunter Execution
  query: grep('\\PCHunter64.exe', this['FolderPath']) or grep('\\PCHunter32.exe',
    this['FolderPath']) or grep('PCHunter.exe', this['ProcessVersionInfoOriginalFileName'])
    or grep('Epoolsoft Windows Information View Tools', this['ProcessVersionInfoFileDescription'])
    or grep('5F1CBC3D99558307BC1250D084FA968521482025', this['SHA1']) or grep('3FB89787CB97D902780DA080545584D97FB1C2EB',
    this['SHA1']) or grep('987B65CD9B9F4E9A1AFD8F8B48CF64A7', this['MD5']) or grep('228DD0C2E6287547E26FFBD973A40F14',
    this['MD5']) or grep('2B214BDDAAB130C274DE6204AF6DBA5AEEC7433DA99AA950022FA306421A6D32',
    this['SHA256']) or grep('55F041BF4E78E9BFA6D4EE68BE40E496CE3A1353E1CA4306598589E19802522C',
    this['SHA256'])
  sigma_id: fca949cc-79ca-446e-8064-01aa7e52ece5
- name: HackTool - Default PowerSploit/Empire Scheduled Task Creation
  query: (grep('\\powershell.exe', this['InitiatingProcessFolderPath']) or grep('\\pwsh.exe',
    this['InitiatingProcessFolderPath'])) and grep('\\schtasks.exe', this['FolderPath'])
    and grep('/Create', this['ProcessCommandLine']) and grep('powershell.exe -NonI',
    this['ProcessCommandLine']) and grep('/TN Updater /TR', this['ProcessCommandLine'])
    and (grep('/SC ONLOGON', this['ProcessCommandLine']) or grep('/SC DAILY /ST',
    this['ProcessCommandLine']) or grep('/SC ONIDLE', this['ProcessCommandLine'])
    or grep('/SC HOURLY', this['ProcessCommandLine']))
  sigma_id: 56c217c3-2de2-479b-990f-5c109ba8458f
- name: HackTool - PowerTool Execution
  query: grep('\\PowerTool.exe', this['FolderPath']) or grep('\\PowerTool64.exe',
    this['FolderPath']) or grep('PowerTool.exe', this['ProcessVersionInfoOriginalFileName'])
  sigma_id: a34f79a3-8e5f-4cc3-b765-de00695452c2
- name: HackTool - PurpleSharp Execution
  query: grep('\\purplesharp', this['FolderPath']) or grep('PurpleSharp.exe', this['ProcessVersionInfoOriginalFileName'])
    or grep('xyz123456.exe', this['ProcessCommandLine']) or grep('PurpleSharp', this['ProcessCommandLine'])
  sigma_id: ff23ffbc-3378-435e-992f-0624dcf93ab4
- name: HackTool - Pypykatz Credentials Dumping Activity
  query: (grep('\\pypykatz.exe', this['FolderPath']) or grep('\\python.exe', this['FolderPath']))
    and grep('live', this['ProcessCommandLine']) and grep('registry', this['ProcessCommandLine'])
  sigma_id: a29808fd-ef50-49ff-9c7a-59a9b040b404
- name: HackTool - Quarks PwDump Execution
  query: grep('\\QuarksPwDump.exe', this['FolderPath']) or this['ProcessCommandLine']
    in [' -dhl', ' --dump-hash-local', ' -dhdc', ' --dump-hash-domain-cached', ' --dump-bitlocker',
    ' -dhd ', ' --dump-hash-domain ', '--ntds-file']
  sigma_id: 0685b176-c816-4837-8e7b-1216f346636b
- name: HackTool - RedMimicry Winnti Playbook Execution
  query: (grep('\\rundll32.exe', this['FolderPath']) or grep('\\cmd.exe', this['FolderPath']))
    and (grep('gthread-3.6.dll', this['ProcessCommandLine']) or grep('\\Windows\\Temp\\tmp.bat',
    this['ProcessCommandLine']) or grep('sigcmm-2.4.dll', this['ProcessCommandLine']))
  sigma_id: 95022b85-ff2a-49fa-939a-d7b8f56eeb9b
- name: Potential SMB Relay Attack Tool Execution
  query: (grep('PetitPotam', this['FolderPath']) or grep('RottenPotato', this['FolderPath'])
    or grep('HotPotato', this['FolderPath']) or grep('JuicyPotato', this['FolderPath'])
    or grep('\\just_dce_', this['FolderPath']) or grep('Juicy Potato', this['FolderPath'])
    or grep('\\temp\\rot.exe', this['FolderPath']) or grep('\\Potato.exe', this['FolderPath'])
    or grep('\\SpoolSample.exe', this['FolderPath']) or grep('\\Responder.exe', this['FolderPath'])
    or grep('\\smbrelayx', this['FolderPath']) or grep('\\ntlmrelayx', this['FolderPath'])
    or grep('\\LocalPotato', this['FolderPath']) or grep('Invoke-Tater', this['ProcessCommandLine'])
    or grep(' smbrelay', this['ProcessCommandLine']) or grep(' ntlmrelay', this['ProcessCommandLine'])
    or grep('cme smb ', this['ProcessCommandLine']) or grep(' /ntlm:NTLMhash ', this['ProcessCommandLine'])
    or grep('Invoke-PetitPotam', this['ProcessCommandLine']) or (grep('.exe -t ',
    this['ProcessCommandLine']) or grep(' -p ', this['ProcessCommandLine'])) or grep('.exe
    -c "{', this['ProcessCommandLine']) and grep('}" -z', this['ProcessCommandLine']))
    and not (grep('HotPotatoes6', this['FolderPath']) or grep('HotPotatoes7', this['FolderPath'])
    or grep('HotPotatoes ', this['FolderPath']))
  sigma_id: 5589ab4f-a767-433c-961d-c91f3f704db1
- name: HackTool - Rubeus Execution
  query: grep('\\Rubeus.exe', this['FolderPath']) or grep('Rubeus.exe', this['ProcessVersionInfoOriginalFileName'])
    or grep('Rubeus', this['ProcessVersionInfoFileDescription']) or grep('asreproast
    ', this['ProcessCommandLine']) or grep('dump /service:krbtgt ', this['ProcessCommandLine'])
    or grep('dump /luid:0x', this['ProcessCommandLine']) or grep('kerberoast ', this['ProcessCommandLine'])
    or grep('createnetonly /program:', this['ProcessCommandLine']) or grep('ptt /ticket:',
    this['ProcessCommandLine']) or grep('/impersonateuser:', this['ProcessCommandLine'])
    or grep('renew /ticket:', this['ProcessCommandLine']) or grep('asktgt /user:',
    this['ProcessCommandLine']) or grep('harvest /interval:', this['ProcessCommandLine'])
    or grep('s4u /user:', this['ProcessCommandLine']) or grep('s4u /ticket:', this['ProcessCommandLine'])
    or grep('hash /password:', this['ProcessCommandLine']) or grep('golden /aes256:',
    this['ProcessCommandLine']) or grep('silver /user:', this['ProcessCommandLine'])
  sigma_id: 7ec2c172-dceb-4c10-92c9-87c1881b7e18
- name: HackTool - SafetyKatz Execution
  query: grep('\\SafetyKatz.exe', this['FolderPath']) or grep('SafetyKatz.exe', this['ProcessVersionInfoOriginalFileName'])
    or grep('SafetyKatz', this['ProcessVersionInfoFileDescription'])
  sigma_id: b1876533-4ed5-4a83-90f3-b8645840a413
- name: HackTool - SecurityXploded Execution
  query: grep('SecurityXploded', this['ProcessVersionInfoCompanyName']) or grep('PasswordDump.exe',
    this['FolderPath']) or grep('PasswordDump.exe', this['ProcessVersionInfoOriginalFileName'])
  sigma_id: 7679d464-4f74-45e2-9e01-ac66c5eb041a
- name: HackTool - PPID Spoofing SelectMyParent Tool Execution
  query: grep('\\SelectMyParent.exe', this['FolderPath']) or grep('PPID-spoof', this['ProcessCommandLine'])
    or grep('ppid_spoof', this['ProcessCommandLine']) or grep('spoof-ppid', this['ProcessCommandLine'])
    or grep('spoof_ppid', this['ProcessCommandLine']) or grep('ppidspoof', this['ProcessCommandLine'])
    or grep('spoofppid', this['ProcessCommandLine']) or grep('spoofedppid', this['ProcessCommandLine'])
    or grep(' -spawnto ', this['ProcessCommandLine']) or grep('PPID-spoof', this['ProcessVersionInfoOriginalFileName'])
    or grep('ppid_spoof', this['ProcessVersionInfoOriginalFileName']) or grep('spoof-ppid',
    this['ProcessVersionInfoOriginalFileName']) or grep('spoof_ppid', this['ProcessVersionInfoOriginalFileName'])
    or grep('ppidspoof', this['ProcessVersionInfoOriginalFileName']) or grep('spoofppid',
    this['ProcessVersionInfoOriginalFileName']) or grep('spoofedppid', this['ProcessVersionInfoOriginalFileName'])
    or grep('SelectMyParent', this['ProcessVersionInfoFileDescription']) or grep('IMPHASH=04D974875BD225F00902B4CAD9AF3FBC',
    this['Hashes']) or grep('IMPHASH=A782AF154C9E743DDF3F3EB2B8F3D16E', this['Hashes'])
    or grep('IMPHASH=89059503D7FBF470E68F7E63313DA3AD', this['Hashes']) or grep('IMPHASH=CA28337632625C8281AB8A130B3D6BAD',
    this['Hashes'])
  sigma_id: 52ff7941-8211-46f9-84f8-9903efb7077d
- name: HackTool - SharpChisel Execution
  query: grep('\\SharpChisel.exe', this['FolderPath']) or grep('SharpChisel', this['ProcessVersionInfoProductName'])
  sigma_id: cf93e05e-d798-4d9e-b522-b0248dc61eaf
- name: HackTool - SharpDPAPI Execution
  query: grep('\\SharpDPAPI.exe', this['FolderPath']) or grep('SharpDPAPI.exe', this['ProcessVersionInfoOriginalFileName'])
    or (grep(' backupkey ', this['ProcessCommandLine']) or grep(' blob ', this['ProcessCommandLine'])
    or grep(' certificates ', this['ProcessCommandLine']) or grep(' credentials ',
    this['ProcessCommandLine']) or grep(' keepass ', this['ProcessCommandLine']) or
    grep(' masterkeys ', this['ProcessCommandLine']) or grep(' rdg ', this['ProcessCommandLine'])
    or grep(' vaults ', this['ProcessCommandLine'])) and (grep(' {', this['ProcessCommandLine'])
    and grep('}:', this['ProcessCommandLine']) or grep(' /file:', this['ProcessCommandLine'])
    or grep(' /machine', this['ProcessCommandLine']) or grep(' /mkfile:', this['ProcessCommandLine'])
    or grep(' /password:', this['ProcessCommandLine']) or grep(' /pvk:', this['ProcessCommandLine'])
    or grep(' /server:', this['ProcessCommandLine']) or grep(' /target:', this['ProcessCommandLine'])
    or grep(' /unprotect', this['ProcessCommandLine']))
  sigma_id: c7d33b50-f690-4b51-8cfb-0fb912a31e57
- name: HackTool - SharpImpersonation Execution
  query: grep('\\SharpImpersonation.exe', this['FolderPath']) or grep('SharpImpersonation.exe',
    this['ProcessVersionInfoOriginalFileName']) or grep(' user:', this['ProcessCommandLine'])
    and grep(' binary:', this['ProcessCommandLine']) or grep(' user:', this['ProcessCommandLine'])
    and grep(' shellcode:', this['ProcessCommandLine']) or grep(' technique:CreateProcessAsUserW',
    this['ProcessCommandLine']) or grep(' technique:ImpersonateLoggedOnuser', this['ProcessCommandLine'])
  sigma_id: f89b08d0-77ad-4728-817b-9b16c5a69c7a
- name: HackTool - SharpLDAPmonitor Execution
  query: grep('\\SharpLDAPmonitor.exe', this['FolderPath']) or grep('SharpLDAPmonitor.exe',
    this['ProcessVersionInfoOriginalFileName']) or grep('/user:', this['ProcessCommandLine'])
    and grep('/pass:', this['ProcessCommandLine']) and grep('/dcip:', this['ProcessCommandLine'])
  sigma_id: 9f8fc146-1d1a-4dbf-b8fd-dfae15e08541
- name: HackTool - SharPersist Execution
  query: grep('\\SharPersist.exe', this['FolderPath']) or grep('SharPersist', this['ProcessVersionInfoProductName'])
    or grep(' -t schtask -c ', this['ProcessCommandLine']) or grep(' -t startupfolder
    -c ', this['ProcessCommandLine']) or grep(' -t reg -c ', this['ProcessCommandLine'])
    and grep(' -m add', this['ProcessCommandLine']) or grep(' -t service -c ', this['ProcessCommandLine'])
    and grep(' -m add', this['ProcessCommandLine']) or grep(' -t schtask -c ', this['ProcessCommandLine'])
    and grep(' -m add', this['ProcessCommandLine'])
  sigma_id: 26488ad0-f9fd-4536-876f-52fea846a2e4
- name: HackTool - SharpEvtMute Execution
  query: grep('\\SharpEvtMute.exe', this['FolderPath']) or grep('SharpEvtMute', this['ProcessVersionInfoFileDescription'])
    or grep('--Filter "rule ', this['ProcessCommandLine']) or grep('--Encoded --Filter
    \\"', this['ProcessCommandLine'])
  sigma_id: bedfc8ad-d1c7-4e37-a20e-e2b0dbee759c
- name: HackTool - SharpLdapWhoami Execution
  query: grep('\\SharpLdapWhoami.exe', this['FolderPath']) or grep('SharpLdapWhoami',
    this['ProcessVersionInfoOriginalFileName']) or grep('SharpLdapWhoami', this['ProcessVersionInfoProductName'])
    or grep(' /method:ntlm', this['ProcessCommandLine']) or grep(' /method:kerb',
    this['ProcessCommandLine']) or grep(' /method:nego', this['ProcessCommandLine'])
    or grep(' /m:nego', this['ProcessCommandLine']) or grep(' /m:ntlm', this['ProcessCommandLine'])
    or grep(' /m:kerb', this['ProcessCommandLine'])
  sigma_id: d9367cbb-c2e0-47ce-bdc0-128cb6da898d
- name: HackTool - SharpMove Tool Execution
  query: grep('\\SharpMove.exe', this['FolderPath']) or grep('SharpMove.exe', this['ProcessVersionInfoOriginalFileName'])
    or grep('computername=', this['ProcessCommandLine']) and (grep('action=create',
    this['ProcessCommandLine']) or grep('action=dcom', this['ProcessCommandLine'])
    or grep('action=executevbs', this['ProcessCommandLine']) or grep('action=hijackdcom',
    this['ProcessCommandLine']) or grep('action=modschtask', this['ProcessCommandLine'])
    or grep('action=modsvc', this['ProcessCommandLine']) or grep('action=query', this['ProcessCommandLine'])
    or grep('action=scm', this['ProcessCommandLine']) or grep('action=startservice',
    this['ProcessCommandLine']) or grep('action=taskscheduler', this['ProcessCommandLine']))
  sigma_id: 055fb54c-a8f4-4aee-bd44-f74cf30a0d9d
- name: HackTool - SharpUp PrivEsc Tool Execution
  query: grep('\\SharpUp.exe', this['FolderPath']) or grep('SharpUp', this['ProcessVersionInfoFileDescription'])
    or grep('HijackablePaths', this['ProcessCommandLine']) or grep('UnquotedServicePath',
    this['ProcessCommandLine']) or grep('ProcessDLLHijack', this['ProcessCommandLine'])
    or grep('ModifiableServiceBinaries', this['ProcessCommandLine']) or grep('ModifiableScheduledTask',
    this['ProcessCommandLine']) or grep('DomainGPPPassword', this['ProcessCommandLine'])
    or grep('CachedGPPPassword', this['ProcessCommandLine'])
  sigma_id: c484e533-ee16-4a93-b6ac-f0ea4868b2f1
- name: HackTool - SharpView Execution
  query: grep('SharpView.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\SharpView.exe',
    this['FolderPath']) or grep('Add-RemoteConnection', this['ProcessCommandLine'])
    or grep('Convert-ADName', this['ProcessCommandLine']) or grep('ConvertFrom-SID',
    this['ProcessCommandLine']) or grep('ConvertFrom-UACValue', this['ProcessCommandLine'])
    or grep('Convert-SidToName', this['ProcessCommandLine']) or grep('Export-PowerViewCSV',
    this['ProcessCommandLine']) or grep('Find-DomainObjectPropertyOutlier', this['ProcessCommandLine'])
    or grep('Find-DomainProcess', this['ProcessCommandLine']) or grep('Find-DomainShare',
    this['ProcessCommandLine']) or grep('Find-DomainUserEvent', this['ProcessCommandLine'])
    or grep('Find-DomainUserLocation', this['ProcessCommandLine']) or grep('Find-ForeignGroup',
    this['ProcessCommandLine']) or grep('Find-ForeignUser', this['ProcessCommandLine'])
    or grep('Find-GPOComputerAdmin', this['ProcessCommandLine']) or grep('Find-GPOLocation',
    this['ProcessCommandLine']) or grep('Find-Interesting', this['ProcessCommandLine'])
    or grep('Find-LocalAdminAccess', this['ProcessCommandLine']) or grep('Find-ManagedSecurityGroups',
    this['ProcessCommandLine']) or grep('Get-CachedRDPConnection', this['ProcessCommandLine'])
    or grep('Get-DFSshare', this['ProcessCommandLine']) or grep('Get-DomainComputer',
    this['ProcessCommandLine']) or grep('Get-DomainController', this['ProcessCommandLine'])
    or grep('Get-DomainDFSShare', this['ProcessCommandLine']) or grep('Get-DomainDNSRecord',
    this['ProcessCommandLine']) or grep('Get-DomainFileServer', this['ProcessCommandLine'])
    or grep('Get-DomainForeign', this['ProcessCommandLine']) or grep('Get-DomainGPO',
    this['ProcessCommandLine']) or grep('Get-DomainGroup', this['ProcessCommandLine'])
    or grep('Get-DomainGUIDMap', this['ProcessCommandLine']) or grep('Get-DomainManagedSecurityGroup',
    this['ProcessCommandLine']) or grep('Get-DomainObject', this['ProcessCommandLine'])
    or grep('Get-DomainOU', this['ProcessCommandLine']) or grep('Get-DomainPolicy',
    this['ProcessCommandLine']) or grep('Get-DomainSID', this['ProcessCommandLine'])
    or grep('Get-DomainSite', this['ProcessCommandLine']) or grep('Get-DomainSPNTicket',
    this['ProcessCommandLine']) or grep('Get-DomainSubnet', this['ProcessCommandLine'])
    or grep('Get-DomainTrust', this['ProcessCommandLine']) or grep('Get-DomainUserEvent',
    this['ProcessCommandLine']) or grep('Get-ForestDomain', this['ProcessCommandLine'])
    or grep('Get-ForestGlobalCatalog', this['ProcessCommandLine']) or grep('Get-ForestTrust',
    this['ProcessCommandLine']) or grep('Get-GptTmpl', this['ProcessCommandLine'])
    or grep('Get-GroupsXML', this['ProcessCommandLine']) or grep('Get-LastLoggedOn',
    this['ProcessCommandLine']) or grep('Get-LoggedOnLocal', this['ProcessCommandLine'])
    or grep('Get-NetComputer', this['ProcessCommandLine']) or grep('Get-NetDomain',
    this['ProcessCommandLine']) or grep('Get-NetFileServer', this['ProcessCommandLine'])
    or grep('Get-NetForest', this['ProcessCommandLine']) or grep('Get-NetGPO', this['ProcessCommandLine'])
    or grep('Get-NetGroupMember', this['ProcessCommandLine']) or grep('Get-NetLocalGroup',
    this['ProcessCommandLine']) or grep('Get-NetLoggedon', this['ProcessCommandLine'])
    or grep('Get-NetOU', this['ProcessCommandLine']) or grep('Get-NetProcess', this['ProcessCommandLine'])
    or grep('Get-NetRDPSession', this['ProcessCommandLine']) or grep('Get-NetSession',
    this['ProcessCommandLine']) or grep('Get-NetShare', this['ProcessCommandLine'])
    or grep('Get-NetSite', this['ProcessCommandLine']) or grep('Get-NetSubnet', this['ProcessCommandLine'])
    or grep('Get-NetUser', this['ProcessCommandLine']) or grep('Get-PathAcl', this['ProcessCommandLine'])
    or grep('Get-PrincipalContext', this['ProcessCommandLine']) or grep('Get-RegistryMountedDrive',
    this['ProcessCommandLine']) or grep('Get-RegLoggedOn', this['ProcessCommandLine'])
    or grep('Get-WMIRegCachedRDPConnection', this['ProcessCommandLine']) or grep('Get-WMIRegLastLoggedOn',
    this['ProcessCommandLine']) or grep('Get-WMIRegMountedDrive', this['ProcessCommandLine'])
    or grep('Get-WMIRegProxy', this['ProcessCommandLine']) or grep('Invoke-ACLScanner',
    this['ProcessCommandLine']) or grep('Invoke-CheckLocalAdminAccess', this['ProcessCommandLine'])
    or grep('Invoke-Kerberoast', this['ProcessCommandLine']) or grep('Invoke-MapDomainTrust',
    this['ProcessCommandLine']) or grep('Invoke-RevertToSelf', this['ProcessCommandLine'])
    or grep('Invoke-Sharefinder', this['ProcessCommandLine']) or grep('Invoke-UserImpersonation',
    this['ProcessCommandLine']) or grep('Remove-DomainObjectAcl', this['ProcessCommandLine'])
    or grep('Remove-RemoteConnection', this['ProcessCommandLine']) or grep('Request-SPNTicket',
    this['ProcessCommandLine']) or grep('Set-DomainObject', this['ProcessCommandLine'])
    or grep('Test-AdminAccess', this['ProcessCommandLine'])
  sigma_id: b2317cfa-4a47-4ead-b3ff-297438c0bc2d
- name: HackTool - SharpWSUS/WSUSpendu Execution
  query: grep(' -Inject ', this['ProcessCommandLine']) and (grep(' -PayloadArgs ',
    this['ProcessCommandLine']) or grep(' -PayloadFile ', this['ProcessCommandLine']))
    or (grep(' approve ', this['ProcessCommandLine']) or grep(' create ', this['ProcessCommandLine'])
    or grep(' check ', this['ProcessCommandLine']) or grep(' delete ', this['ProcessCommandLine']))
    and (grep(' /payload:', this['ProcessCommandLine']) or grep(' /payload=', this['ProcessCommandLine'])
    or grep(' /updateid:', this['ProcessCommandLine']) or grep(' /updateid=', this['ProcessCommandLine']))
  sigma_id: b0ce780f-10bd-496d-9067-066d23dc3aa5
- name: HackTool - SILENTTRINITY Stager Execution
  query: grep('st2stager', this['ProcessVersionInfoFileDescription'])
  sigma_id: 03552375-cc2c-4883-bbe4-7958d5a980be
- name: HackTool - Sliver C2 Implant Activity Pattern
  query: grep('-NoExit -Command [Console]::OutputEncoding=[Text.UTF8Encoding]::UTF8',
    this['ProcessCommandLine'])
  sigma_id: 42333b2c-b425-441c-b70e-99404a17170f
- name: HackTool - SOAPHound Execution
  query: (grep(' --buildcache ', this['ProcessCommandLine']) or grep(' --bhdump ',
    this['ProcessCommandLine']) or grep(' --certdump ', this['ProcessCommandLine'])
    or grep(' --dnsdump ', this['ProcessCommandLine'])) and (grep(' -c ', this['ProcessCommandLine'])
    or grep(' --cachefilename ', this['ProcessCommandLine']) or grep(' -o ', this['ProcessCommandLine'])
    or grep(' --outputdirectory', this['ProcessCommandLine']))
  sigma_id: e92a4287-e072-4a40-9739-370c106bb750
- name: HackTool - Stracciatella Execution
  query: grep('\\Stracciatella.exe', this['FolderPath']) or grep('Stracciatella.exe',
    this['ProcessVersionInfoOriginalFileName']) or grep('Stracciatella', this['ProcessVersionInfoFileDescription'])
    or grep('9d25e61ec1527e2a69d7c2a4e3fe2fe15890710c198a66a9f25d99fdf6c7b956', this['SHA256'])
    or grep('fd16609bd9830c63b9413671678bb159b89c357d21942ddbb6b93add808d121a', this['SHA256'])
  sigma_id: 7a4d9232-92fc-404d-8ce1-4c92e7caf539
- name: HackTool - SysmonEOP Execution
  query: grep('\\SysmonEOP.exe', this['FolderPath']) or grep('IMPHASH=22F4089EB8ABA31E1BB162C6D9BF72E5',
    this['Hashes']) or grep('IMPHASH=5123FA4C4384D431CD0D893EEB49BBEC', this['Hashes'])
  sigma_id: 8a7e90c5-fe6e-45dc-889e-057fe4378bd9
- name: HackTool - TruffleSnout Execution
  query: grep('TruffleSnout.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\TruffleSnout.exe',
    this['FolderPath'])
  sigma_id: 69ca006d-b9a9-47f5-80ff-ecd4d25d481a
- name: HackTool - UACMe Akagi Execution
  query: grep('UACMe', this['ProcessVersionInfoProductName']) or this['ProcessVersionInfoCompanyName']
    in ['REvol Corp', 'APT 92', 'UG North', 'Hazardous Environments', 'CD Project
    Rekt'] or this['ProcessVersionInfoFileDescription'] in ['UACMe main module', 'Pentesting
    utility'] or this['ProcessVersionInfoOriginalFileName'] in ['Akagi.exe', 'Akagi64.exe']
    or grep('\\Akagi64.exe', this['FolderPath']) or grep('\\Akagi.exe', this['FolderPath'])
    or grep('IMPHASH=767637C23BB42CD5D7397CF58B0BE688', this['Hashes']) or grep('IMPHASH=14C4E4C72BA075E9069EE67F39188AD8',
    this['Hashes']) or grep('IMPHASH=3C782813D4AFCE07BBFC5A9772ACDBDC', this['Hashes'])
    or grep('IMPHASH=7D010C6BB6A3726F327F7E239166D127', this['Hashes']) or grep('IMPHASH=89159BA4DD04E4CE5559F132A9964EB3',
    this['Hashes']) or grep('IMPHASH=6F33F4A5FC42B8CEC7314947BD13F30F', this['Hashes'])
    or grep('IMPHASH=5834ED4291BDEB928270428EBBAF7604', this['Hashes']) or grep('IMPHASH=5A8A8A43F25485E7EE1B201EDCBC7A38',
    this['Hashes']) or grep('IMPHASH=DC7D30B90B2D8ABF664FBED2B1B59894', this['Hashes'])
    or grep('IMPHASH=41923EA1F824FE63EA5BEB84DB7A3E74', this['Hashes']) or grep('IMPHASH=3DE09703C8E79ED2CA3F01074719906B',
    this['Hashes'])
  sigma_id: d38d2fa4-98e6-4a24-aff1-410b0c9ad177
- name: HackTool - Windows Credential Editor (WCE) Execution
  query: (grep('IMPHASH=a53a02b997935fd8eedcb5f7abab9b9f', this['Hashes']) or grep('IMPHASH=e96a73c7bf33a464c510ede582318bf2',
    this['Hashes']) or grep('.exe -S', this['ProcessCommandLine']) and grep('\\services.exe',
    this['InitiatingProcessFolderPath'])) and not grep('\\clussvc.exe', this['FolderPath'])
  sigma_id: 7aa7009a-28b9-4344-8c1f-159489a390df
- name: HackTool - winPEAS Execution
  query: grep('winPEAS.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\winPEASany_ofs.exe',
    this['FolderPath']) or grep('\\winPEASany.exe', this['FolderPath']) or grep('\\winPEASx64_ofs.exe',
    this['FolderPath']) or grep('\\winPEASx64.exe', this['FolderPath']) or grep('\\winPEASx86_ofs.exe',
    this['FolderPath']) or grep('\\winPEASx86.exe', this['FolderPath']) or grep('
    applicationsinfo', this['ProcessCommandLine']) or grep(' browserinfo', this['ProcessCommandLine'])
    or grep(' eventsinfo', this['ProcessCommandLine']) or grep(' fileanalysis', this['ProcessCommandLine'])
    or grep(' filesinfo', this['ProcessCommandLine']) or grep(' processinfo', this['ProcessCommandLine'])
    or grep(' servicesinfo', this['ProcessCommandLine']) or grep(' windowscreds',
    this['ProcessCommandLine']) or grep('https://github.com/carlospolop/PEASS-ng/releases/latest/download/',
    this['ProcessCommandLine']) or grep(' -linpeas', this['InitiatingProcessCommandLine'])
    or grep(' -linpeas', this['ProcessCommandLine'])
  sigma_id: 98b53e78-ebaf-46f8-be06-421aafd176d9
- name: HackTool - WinPwn Execution
  query: grep('Offline_Winpwn', this['ProcessCommandLine']) or grep('WinPwn ', this['ProcessCommandLine'])
    or grep('WinPwn.exe', this['ProcessCommandLine']) or grep('WinPwn.ps1', this['ProcessCommandLine'])
  sigma_id: d557dc06-62e8-4468-a8e8-7984124908ce
- name: HackTool - Wmiexec Default Powershell Command
  query: grep('-NoP -NoL -sta -NonI -W Hidden -Exec Bypass -Enc', this['ProcessCommandLine'])
  sigma_id: 022eaba8-f0bf-4dd9-9217-4604b0bb3bb0
- name: HackTool - XORDump Execution
  query: grep('\\xordump.exe', this['FolderPath']) or grep(' -process lsass.exe ',
    this['ProcessCommandLine']) or grep(' -m comsvcs ', this['ProcessCommandLine'])
    or grep(' -m dbghelp ', this['ProcessCommandLine']) or grep(' -m dbgcore ', this['ProcessCommandLine'])
  sigma_id: 66e563f9-1cbd-4a22-a957-d8b7c0f44372
- name: Suspicious ZipExec Execution
  query: grep('/generic:Microsoft_Windows_Shell_ZipFolder:filename=', this['ProcessCommandLine'])
    and grep('.zip', this['ProcessCommandLine']) and grep('/pass:', this['ProcessCommandLine'])
    and grep('/user:', this['ProcessCommandLine']) or grep('/delete', this['ProcessCommandLine'])
    and grep('Microsoft_Windows_Shell_ZipFolder:filename=', this['ProcessCommandLine'])
    and grep('.zip', this['ProcessCommandLine'])
  sigma_id: 90dcf730-1b71-4ae7-9ffc-6fcf62bd0132
- name: Suspicious HWP Sub Processes
  query: grep('\\Hwp.exe', this['InitiatingProcessFolderPath']) and grep('\\gbb.exe',
    this['FolderPath'])
  sigma_id: 023394c4-29d5-46ab-92b8-6a534c6f447b
- name: Potential Fake Instance Of Hxtsr.EXE Executed
  query: grep('\\hxtsr.exe', this['FolderPath']) and not (grep(':\\program files\\windowsapps\\microsoft.windowscommunicationsapps_',
    this['FolderPath']) and grep('\\hxtsr.exe', this['FolderPath']))
  sigma_id: 4e762605-34a8-406d-b72e-c1a089313320
- name: Use Icacls to Hide File to Everyone
  query: (grep('iCACLS.EXE', this['ProcessVersionInfoOriginalFileName']) or grep('\\icacls.exe',
    this['FolderPath'])) and grep('/deny', this['ProcessCommandLine']) and grep('S-1-1-0:',
    this['ProcessCommandLine'])
  sigma_id: 4ae81040-fc1c-4249-bfa3-938d260214d9
- name: File Download And Execution Via IEExec.EXE
  query: (grep('\\IEExec.exe', this['FolderPath']) or grep('IEExec.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('http://', this['ProcessCommandLine']) or grep('https://', this['ProcessCommandLine']))
  sigma_id: 9801abb8-e297-4dbf-9fbd-57dde0e830ad
- name: Self Extracting Package Creation Via Iexpress.EXE From Potentially Suspicious
    Location
  query: "(grep('\\\\iexpress.exe', this['FolderPath']) or grep('IEXPRESS.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep(' -n ', this['ProcessCommandLine']) or grep(' /n ', this['ProcessCommandLine'])\
    \ or grep(' \u2013n ', this['ProcessCommandLine']) or grep(' \u2014n ', this['ProcessCommandLine'])\
    \ or grep(' \u2015n ', this['ProcessCommandLine'])) and (grep(':\\\\ProgramData\\\
    \\', this['ProcessCommandLine']) or grep(':\\\\Temp\\\\', this['ProcessCommandLine'])\
    \ or grep(':\\\\Windows\\\\System32\\\\Tasks\\\\', this['ProcessCommandLine'])\
    \ or grep(':\\\\Windows\\\\Tasks\\\\', this['ProcessCommandLine']) or grep(':\\\
    \\Windows\\\\Temp\\\\', this['ProcessCommandLine']) or grep('\\\\AppData\\\\Local\\\
    \\Temp\\\\', this['ProcessCommandLine']))"
  sigma_id: b2b048b0-7857-4380-b0fb-d3f0ab820b71
- name: Disable Windows IIS HTTP Logging
  query: (grep('\\appcmd.exe', this['FolderPath']) or grep('appcmd.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('set', this['ProcessCommandLine']) and grep('config', this['ProcessCommandLine'])
    and grep('section:httplogging', this['ProcessCommandLine']) and grep('dontLog:true',
    this['ProcessCommandLine'])
  sigma_id: e4ed6030-ffe5-4e6a-8a8a-ab3c1ab9d94e
- name: Microsoft IIS Service Account Password Dumped
  query: '(grep(''\\appcmd.exe'', this[''FolderPath'']) or grep(''appcmd.exe'', this[''ProcessVersionInfoOriginalFileName'']))
    and grep(''list '', this[''ProcessCommandLine'']) and (grep('' /config'', this[''ProcessCommandLine''])
    or grep('' /xml'', this[''ProcessCommandLine'']) or grep('' -config'', this[''ProcessCommandLine''])
    or grep('' -xml'', this[''ProcessCommandLine'']) or (grep('' /@t'', this[''ProcessCommandLine''])
    or grep('' /text'', this[''ProcessCommandLine'']) or grep('' /show'', this[''ProcessCommandLine''])
    or grep('' -@t'', this[''ProcessCommandLine'']) or grep('' -text'', this[''ProcessCommandLine''])
    or grep('' -show'', this[''ProcessCommandLine''])) and (grep(''(\'':\'', <SpecialChars.WILDCARD_MULTI:
    1>)'', this[''ProcessCommandLine'']) or grep(''password'', this[''ProcessCommandLine''])))'
  sigma_id: 2d3cdeec-c0db-45b4-aa86-082f7eb75701
- name: IIS Native-Code Module Command Line Installation
  query: "(grep('\\\\appcmd.exe', this['FolderPath']) or grep('appcmd.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and grep('install', this['ProcessCommandLine']) and grep('module', this['ProcessCommandLine'])\
    \ and (grep('-name:', this['ProcessCommandLine']) or grep('/name:', this['ProcessCommandLine'])\
    \ or grep('\u2013name:', this['ProcessCommandLine']) or grep('\u2014name:', this['ProcessCommandLine'])\
    \ or grep('\u2015name:', this['ProcessCommandLine'])) and not grep('C:\\\\Windows\\\
    \\System32\\\\inetsrv\\\\iissetup.exe', this['InitiatingProcessFolderPath'])"
  sigma_id: 9465ddf4-f9e4-4ebd-8d98-702df3a93239
- name: Suspicious IIS URL GlobalRules Rewrite Via AppCmd
  query: (grep('\\appcmd.exe', this['FolderPath']) or grep('appcmd.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('set', this['ProcessCommandLine']) and grep('config', this['ProcessCommandLine'])
    and grep('section:system.webServer/rewrite/globalRules', this['ProcessCommandLine'])
    and grep('commit:', this['ProcessCommandLine'])
  sigma_id: 7c8af9b2-dcae-41a2-a9db-b28c288b5f08
- name: Microsoft IIS Connection Strings Decryption
  query: (grep('\\aspnet_regiis.exe', this['FolderPath']) or grep('aspnet_regiis.exe',
    this['ProcessVersionInfoOriginalFileName'])) and grep('connectionStrings', this['ProcessCommandLine'])
    and grep(' -pdf', this['ProcessCommandLine'])
  sigma_id: 97dbf6e2-e436-44d8-abee-4261b24d3e41
- name: Suspicious IIS Module Registration
  query: grep('\\w3wp.exe', this['InitiatingProcessFolderPath']) and (grep('appcmd.exe
    add module', this['ProcessCommandLine']) or grep(' system.enterpriseservices.internal.publish',
    this['ProcessCommandLine']) and grep('\\powershell.exe', this['FolderPath']) or
    grep('gacutil', this['ProcessCommandLine']) and grep(' /I', this['ProcessCommandLine']))
  sigma_id: 043c4b8b-3a54-4780-9682-081cb6b8185c
- name: C# IL Code Compilation Via Ilasm.EXE
  query: (grep('\\ilasm.exe', this['FolderPath']) or grep('ilasm.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' /dll', this['ProcessCommandLine']) or grep(' /exe', this['ProcessCommandLine']))
  sigma_id: 850d55f9-6eeb-4492-ad69-a72338f65ba4
- name: ImagingDevices Unusual Parent/Child Processes
  query: (grep('\\WmiPrvSE.exe', this['InitiatingProcessFolderPath']) or grep('\\svchost.exe',
    this['InitiatingProcessFolderPath']) or grep('\\dllhost.exe', this['InitiatingProcessFolderPath']))
    and grep('\\ImagingDevices.exe', this['FolderPath']) or grep('\\ImagingDevices.exe',
    this['InitiatingProcessFolderPath'])
  sigma_id: f11f2808-adb4-46c0-802a-8660db50fa99
- name: Arbitrary File Download Via IMEWDBLD.EXE
  query: (grep('\\IMEWDBLD.exe', this['FolderPath']) or grep('imewdbld.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('http://', this['ProcessCommandLine']) or grep('https://', this['ProcessCommandLine']))
  sigma_id: 863218bd-c7d0-4c52-80cd-0a96c09f54af
- name: InfDefaultInstall.exe .inf Execution
  query: grep('InfDefaultInstall.exe ', this['ProcessCommandLine']) and grep('.inf',
    this['ProcessCommandLine'])
  sigma_id: ce7cf472-6fcc-490a-9481-3786840b5d9b
- name: File Download Via InstallUtil.EXE
  query: (grep('\\InstallUtil.exe', this['FolderPath']) or grep('InstallUtil.exe',
    this['ProcessVersionInfoOriginalFileName'])) and (grep('ftp://', this['ProcessCommandLine'])
    or grep('http://', this['ProcessCommandLine']) or grep('https://', this['ProcessCommandLine']))
  sigma_id: 75edd216-1939-4c73-8d61-7f3a0d85b5cc
- name: Suspicious Execution of InstallUtil Without Log
  query: grep('\\InstallUtil.exe', this['FolderPath']) and grep('Microsoft.NET\\Framework',
    this['FolderPath']) and grep('/logfile= ', this['ProcessCommandLine']) and grep('/LogToConsole=false',
    this['ProcessCommandLine'])
  sigma_id: d042284c-a296-4988-9be5-f424fadcc28c
- name: Suspicious Shells Spawn by Java Utility Keytool
  query: grep('\\keytool.exe', this['InitiatingProcessFolderPath']) and (grep('\\cmd.exe',
    this['FolderPath']) or grep('\\sh.exe', this['FolderPath']) or grep('\\bash.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\schtasks.exe', this['FolderPath']) or grep('\\certutil.exe',
    this['FolderPath']) or grep('\\whoami.exe', this['FolderPath']) or grep('\\bitsadmin.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath']) or grep('\\cscript.exe',
    this['FolderPath']) or grep('\\scrcons.exe', this['FolderPath']) or grep('\\regsvr32.exe',
    this['FolderPath']) or grep('\\hh.exe', this['FolderPath']) or grep('\\wmic.exe',
    this['FolderPath']) or grep('\\mshta.exe', this['FolderPath']) or grep('\\rundll32.exe',
    this['FolderPath']) or grep('\\forfiles.exe', this['FolderPath']) or grep('\\scriptrunner.exe',
    this['FolderPath']) or grep('\\mftrace.exe', this['FolderPath']) or grep('\\AppVLP.exe',
    this['FolderPath']) or grep('\\systeminfo.exe', this['FolderPath']) or grep('\\reg.exe',
    this['FolderPath']) or grep('\\query.exe', this['FolderPath']))
  sigma_id: 90fb5e62-ca1f-4e22-b42e-cc521874c938
- name: Suspicious Child Process Of Manage Engine ServiceDesk
  query: grep('\\ManageEngine\\ServiceDesk\\', this['InitiatingProcessFolderPath'])
    and grep('\\java.exe', this['InitiatingProcessFolderPath']) and (grep('\\AppVLP.exe',
    this['FolderPath']) or grep('\\bash.exe', this['FolderPath']) or grep('\\bitsadmin.exe',
    this['FolderPath']) or grep('\\calc.exe', this['FolderPath']) or grep('\\certutil.exe',
    this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']) or grep('\\curl.exe',
    this['FolderPath']) or grep('\\forfiles.exe', this['FolderPath']) or grep('\\mftrace.exe',
    this['FolderPath']) or grep('\\mshta.exe', this['FolderPath']) or grep('\\net.exe',
    this['FolderPath']) or grep('\\net1.exe', this['FolderPath']) or grep('\\notepad.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\query.exe', this['FolderPath']) or grep('\\reg.exe',
    this['FolderPath']) or grep('\\schtasks.exe', this['FolderPath']) or grep('\\scrcons.exe',
    this['FolderPath']) or grep('\\sh.exe', this['FolderPath']) or grep('\\systeminfo.exe',
    this['FolderPath']) or grep('\\whoami.exe', this['FolderPath']) or grep('\\wmic.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath'])) and not ((grep('\\net.exe',
    this['FolderPath']) or grep('\\net1.exe', this['FolderPath'])) and grep(' stop',
    this['ProcessCommandLine']))
  sigma_id: cea2b7ea-792b-405f-95a1-b903ea06458f
- name: Java Running with Remote Debugging
  query: grep('transport=dt_socket,address=', this['ProcessCommandLine']) and (grep('jre1.',
    this['ProcessCommandLine']) or grep('jdk1.', this['ProcessCommandLine'])) and
    not (grep('address=127.0.0.1', this['ProcessCommandLine']) or grep('address=localhost',
    this['ProcessCommandLine']))
  sigma_id: 8f88e3f6-2a49-48f5-a5c4-2f7eedf78710
- name: Suspicious Processes Spawned by Java.EXE
  query: grep('\\java.exe', this['InitiatingProcessFolderPath']) and (grep('\\AppVLP.exe',
    this['FolderPath']) or grep('\\bitsadmin.exe', this['FolderPath']) or grep('\\certutil.exe',
    this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']) or grep('\\curl.exe',
    this['FolderPath']) or grep('\\forfiles.exe', this['FolderPath']) or grep('\\hh.exe',
    this['FolderPath']) or grep('\\mftrace.exe', this['FolderPath']) or grep('\\mshta.exe',
    this['FolderPath']) or grep('\\net.exe', this['FolderPath']) or grep('\\net1.exe',
    this['FolderPath']) or grep('\\query.exe', this['FolderPath']) or grep('\\reg.exe',
    this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\rundll32.exe',
    this['FolderPath']) or grep('\\schtasks.exe', this['FolderPath']) or grep('\\scrcons.exe',
    this['FolderPath']) or grep('\\scriptrunner.exe', this['FolderPath']) or grep('\\sh.exe',
    this['FolderPath']) or grep('\\systeminfo.exe', this['FolderPath']) or grep('\\whoami.exe',
    this['FolderPath']) or grep('\\wmic.exe', this['FolderPath']) or grep('\\wscript.exe',
    this['FolderPath']))
  sigma_id: 0d34ed8b-1c12-4ff2-828c-16fc860b766d
- name: Shell Process Spawned by Java.EXE
  query: grep('\\java.exe', this['InitiatingProcessFolderPath']) and (grep('\\bash.exe',
    this['FolderPath']) or grep('\\cmd.exe', this['FolderPath']) or grep('\\powershell.exe',
    this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])) and not (grep('build',
    this['InitiatingProcessFolderPath']) and grep('build', this['ProcessCommandLine']))
  sigma_id: dff1e1cc-d3fd-47c8-bfc2-aeb878a754c0
- name: Suspicious SysAidServer Child
  query: (grep('\\java.exe', this['InitiatingProcessFolderPath']) or grep('\\javaw.exe',
    this['InitiatingProcessFolderPath'])) and grep('SysAidServer', this['InitiatingProcessCommandLine'])
  sigma_id: 60bfeac3-0d35-4302-8efb-1dd16f715bc6
- name: Kavremover Dropped Binary LOLBIN Usage
  query: grep(' run run-cmd ', this['ProcessCommandLine']) and not (grep('\\cleanapi.exe',
    this['InitiatingProcessFolderPath']) or grep('\\kavremover.exe', this['InitiatingProcessFolderPath']))
  sigma_id: d047726b-c71c-4048-a99b-2e2f50dc107d
- name: Windows Kernel Debugger Execution
  query: grep('\\kd.exe', this['FolderPath']) or grep('kd.exe', this['ProcessVersionInfoOriginalFileName'])
  sigma_id: 27ee9438-90dc-4bef-904b-d3ef927f5e7e
- name: Potentially Suspicious Child Process of KeyScrambler.exe
  query: grep('\\KeyScrambler.exe', this['InitiatingProcessFolderPath']) and (grep('\\cmd.exe',
    this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']) or grep('\\mshta.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\rundll32.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['Cmd.Exe', 'cscript.exe', 'mshta.exe', 'PowerShell.EXE', 'pwsh.dll', 'regsvr32.exe',
    'RUNDLL32.EXE', 'wscript.exe'])
  sigma_id: ca5583e9-8f80-46ac-ab91-7f314d13b984
- name: Computer Password Change Via Ksetup.EXE
  query: (grep('\\ksetup.exe', this['FolderPath']) or grep('ksetup.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' /setcomputerpassword ', this['ProcessCommandLine'])
  sigma_id: de16d92c-c446-4d53-8938-10aeef41c8b6
- name: Logged-On User Password Change Via Ksetup.EXE
  query: (grep('\\ksetup.exe', this['FolderPath']) or grep('ksetup.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' /ChangePassword ', this['ProcessCommandLine'])
  sigma_id: c9783e20-4793-4164-ba96-d9ee483992c4
- name: Active Directory Structure Export Via Ldifde.EXE
  query: (grep('\\ldifde.exe', this['FolderPath']) or grep('ldifde.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('-f', this['ProcessCommandLine']) and not grep(' -i', this['ProcessCommandLine'])
  sigma_id: 4f7a6757-ff79-46db-9687-66501a02d9ec
- name: Import LDAP Data Interchange Format File Via Ldifde.EXE
  query: (grep('\\ldifde.exe', this['FolderPath']) or grep('ldifde.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('-i', this['ProcessCommandLine']) and grep('-f', this['ProcessCommandLine'])
  sigma_id: 6f535e01-ca1f-40be-ab8d-45b19c0c8b7f
- name: Uncommon Link.EXE Parent Process
  query: grep('\\link.exe', this['FolderPath']) and grep('LINK /', this['ProcessCommandLine'])
    and not ((grep('C:\\Program Files\\Microsoft Visual Studio\\', this['InitiatingProcessFolderPath'])
    or grep('C:\\Program Files (x86)\\Microsoft Visual Studio\\', this['InitiatingProcessFolderPath']))
    and (grep('\\VC\\bin\\', this['InitiatingProcessFolderPath']) or grep('\\VC\\Tools\\',
    this['InitiatingProcessFolderPath'])))
  sigma_id: 6e968eb1-5f05-4dac-94e9-fd0c5cb49fd6
- name: Rebuild Performance Counter Values Via Lodctr.EXE
  query: "grep('\\\\lodctr.exe', this['FolderPath']) and grep('LODCTR.EXE', this['ProcessVersionInfoOriginalFileName'])\
    \ and (grep(' -r', this['ProcessCommandLine']) or grep(' /r', this['ProcessCommandLine'])\
    \ or grep(' \u2013r', this['ProcessCommandLine']) or grep(' \u2014r', this['ProcessCommandLine'])\
    \ or grep(' \u2015r', this['ProcessCommandLine']))"
  sigma_id: cc9d3712-6310-4320-b2df-7cb408274d53
- name: Suspicious Windows Trace ETW Session Tamper Via Logman.EXE
  query: (grep('\\logman.exe', this['FolderPath']) or grep('Logman.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('stop ', this['ProcessCommandLine']) or grep('delete ', this['ProcessCommandLine']))
    and (grep('Circular Kernel Context Logger', this['ProcessCommandLine']) or grep('EventLog-',
    this['ProcessCommandLine']) or grep('SYSMON TRACE', this['ProcessCommandLine'])
    or grep('SysmonDnsEtwSession', this['ProcessCommandLine']))
  sigma_id: cd1f961e-0b96-436b-b7c6-38da4583ec00
- name: Suspicious CustomShellHost Execution
  query: grep('\\CustomShellHost.exe', this['InitiatingProcessFolderPath']) and not
    grep('C:\\Windows\\explorer.exe', this['FolderPath'])
  sigma_id: 84b14121-9d14-416e-800b-f3b829c5a14d
- name: LOLBAS Data Exfiltration by DataSvcUtil.exe
  query: (grep('/in:', this['ProcessCommandLine']) or grep('/out:', this['ProcessCommandLine'])
    or grep('/uri:', this['ProcessCommandLine'])) and (grep('\\DataSvcUtil.exe', this['FolderPath'])
    or grep('DataSvcUtil.exe', this['ProcessVersionInfoOriginalFileName']))
  sigma_id: e290b10b-1023-4452-a4a9-eb31a9013b3a
- name: DeviceCredentialDeployment Execution
  query: grep('\\DeviceCredentialDeployment.exe', this['FolderPath'])
  sigma_id: b8b1b304-a60f-4999-9a6e-c547bde03ffd
- name: Devtoolslauncher.exe Executes Specified Binary
  query: grep('\\devtoolslauncher.exe', this['FolderPath']) and grep('LaunchForDeploy',
    this['ProcessCommandLine'])
  sigma_id: cc268ac1-42d9-40fd-9ed3-8c4e1a5b87e6
- name: Suspicious Diantz Download and Compress Into a CAB File
  query: grep('diantz.exe', this['ProcessCommandLine']) and grep(' \\', this['ProcessCommandLine'])
    and grep('.cab', this['ProcessCommandLine'])
  sigma_id: 185d7418-f250-42d0-b72e-0c8b70661e93
- name: Suspicious Extrac32 Execution
  query: (grep('extrac32.exe', this['ProcessCommandLine']) or grep('\\extrac32.exe',
    this['FolderPath']) or grep('extrac32.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('.cab', this['ProcessCommandLine']) and (grep('/C', this['ProcessCommandLine'])
    or grep('/Y', this['ProcessCommandLine']) or grep(' \\', this['ProcessCommandLine']))
  sigma_id: aa8e035d-7be4-48d3-a944-102aec04400d
- name: Potential Reconnaissance Activity Via GatherNetworkInfo.VBS
  query: (grep('\\cscript.exe', this['FolderPath']) or grep('\\wscript.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['cscript.exe', 'wscript.exe'])
    and grep('gatherNetworkInfo.vbs', this['ProcessCommandLine'])
  sigma_id: 575dce0c-8139-4e30-9295-1ee75969f7fe
- name: Gpscript Execution
  query: (grep('\\gpscript.exe', this['FolderPath']) or grep('GPSCRIPT.EXE', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' /logon', this['ProcessCommandLine']) or grep(' /startup', this['ProcessCommandLine']))
    and not grep('C:\\windows\\system32\\svchost.exe -k netsvcs -p -s gpsvc', this['InitiatingProcessCommandLine'])
  sigma_id: 1e59c230-6670-45bf-83b0-98903780607e
- name: Ie4uinit Lolbin Use From Invalid Path
  query: (grep('\\ie4uinit.exe', this['FolderPath']) or grep('IE4UINIT.EXE', this['ProcessVersionInfoOriginalFileName']))
    and not (this['CurrentDirectory'] in ['c:\\windows\\system32\\', 'c:\\windows\\sysWOW64\\']
    or this['CurrentDirectory']==null)
  sigma_id: d3bf399f-b0cf-4250-8bb4-dfc192ab81dc
- name: Launch-VsDevShell.PS1 Proxy Execution
  query: grep('Launch-VsDevShell.ps1', this['ProcessCommandLine']) and (grep('VsWherePath
    ', this['ProcessCommandLine']) or grep('VsInstallationPath ', this['ProcessCommandLine']))
  sigma_id: 45d3a03d-f441-458c-8883-df101a3bb146
- name: Potential Manage-bde.wsf Abuse To Proxy Execution
  query: (grep('\\wscript.exe', this['FolderPath']) or grep('wscript.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('manage-bde.wsf', this['ProcessCommandLine']) or (grep('\\cscript.exe',
    this['InitiatingProcessFolderPath']) or grep('\\wscript.exe', this['InitiatingProcessFolderPath']))
    and grep('manage-bde.wsf', this['InitiatingProcessCommandLine']) and not grep('\\cmd.exe',
    this['FolderPath'])
  sigma_id: c363385c-f75d-4753-a108-c1a8e28bdbda
- name: Mavinject Inject DLL Into Running Process
  query: grep(' /INJECTRUNNING ', this['ProcessCommandLine']) and not grep('C:\\Windows\\System32\\AppVClient.exe',
    this['InitiatingProcessFolderPath'])
  sigma_id: 4f73421b-5a0b-4bbf-a892-5a7fb99bea66
- name: MpiExec Lolbin
  query: (grep('\\mpiexec.exe', this['FolderPath']) or grep('IMPHASH=d8b52ef6aaa3a81501bdfff9dbb96217',
    this['Hashes'])) and (grep(' /n 1 ', this['ProcessCommandLine']) or grep(' -n
    1 ', this['ProcessCommandLine']))
  sigma_id: 729ce0ea-5d8f-4769-9762-e35de441586d
- name: Execute Files with Msdeploy.exe
  query: grep('verb:sync', this['ProcessCommandLine']) and grep('-source:RunCommand',
    this['ProcessCommandLine']) and grep('-dest:runCommand', this['ProcessCommandLine'])
    and grep('\\msdeploy.exe', this['FolderPath'])
  sigma_id: 646bc99f-6682-4b47-a73a-17b1b64c9d34
- name: Execute MSDT Via Answer File
  query: grep('\\msdt.exe', this['FolderPath']) and grep('\\WINDOWS\\diagnostics\\index\\PCWDiagnostic.xml',
    this['ProcessCommandLine']) and (grep(' -af ', this['ProcessCommandLine']) or
    grep(' /af ', this['ProcessCommandLine'])) and not grep('\\pcwrun.exe', this['InitiatingProcessFolderPath'])
  sigma_id: 9c8c7000-3065-44a8-a555-79bcba5d9955
- name: Use of OpenConsole
  query: (grep('OpenConsole.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\OpenConsole.exe',
    this['FolderPath'])) and not grep('C:\\Program Files\\WindowsApps\\Microsoft.WindowsTerminal',
    this['FolderPath'])
  sigma_id: 814c95cc-8192-4378-a70a-f1aafd877af1
- name: OpenWith.exe Executes Specified Binary
  query: grep('\\OpenWith.exe', this['FolderPath']) and grep('/c', this['ProcessCommandLine'])
  sigma_id: cec8e918-30f7-4e2d-9bfa-a59cc97ae60f
- name: Use of Pcalua For Execution
  query: grep('\\pcalua.exe', this['FolderPath']) and grep(' -a', this['ProcessCommandLine'])
  sigma_id: 0955e4e1-c281-4fb9-9ee1-5ee7b4b754d2
- name: Execute Pcwrun.EXE To Leverage Follina
  query: grep('\\pcwrun.exe', this['FolderPath']) and grep('../', this['ProcessCommandLine'])
  sigma_id: 6004abd0-afa4-4557-ba90-49d172e0a299
- name: Code Execution via Pcwutl.dll
  query: (grep('\\rundll32.exe', this['FolderPath']) or grep('RUNDLL32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('pcwutl', this['ProcessCommandLine']) and grep('LaunchApplication', this['ProcessCommandLine'])
  sigma_id: 9386d78a-7207-4048-9c9f-a93a7c2d1c05
- name: Execute Code with Pester.bat as Parent
  query: (grep('\\powershell.exe', this['InitiatingProcessFolderPath']) or grep('\\pwsh.exe',
    this['InitiatingProcessFolderPath'])) and grep('\\WindowsPowerShell\\Modules\\Pester\\',
    this['InitiatingProcessCommandLine']) and (grep('{ Invoke-Pester -EnableExit ;',
    this['InitiatingProcessCommandLine']) or grep('{ Get-Help "', this['InitiatingProcessCommandLine']))
  sigma_id: 18988e1b-9087-4f8a-82fe-0414dce49878
- name: Execute Code with Pester.bat
  query: '(grep(''\\powershell.exe'', this[''FolderPath'']) or grep(''\\pwsh.exe'',
    this[''FolderPath''])) and grep(''Pester'', this[''ProcessCommandLine'']) and
    grep(''Get-Help'', this[''ProcessCommandLine'']) or grep(''\\cmd.exe'', this[''FolderPath''])
    and grep(''pester'', this[''ProcessCommandLine'']) and grep('';'', this[''ProcessCommandLine''])
    and (grep(''help'', this[''ProcessCommandLine'']) or grep(''(<SpecialChars.WILDCARD_SINGLE:
    2>,)'', this[''ProcessCommandLine'']))'
  sigma_id: 59e938ff-0d6d-4dc3-b13f-36cc28734d4e
- name: PrintBrm ZIP Creation of Extraction
  query: grep('\\PrintBrm.exe', this['FolderPath']) and grep(' -f', this['ProcessCommandLine'])
    and grep('.zip', this['ProcessCommandLine'])
  sigma_id: cafeeba3-01da-4ab4-b6c4-a31b1d9730c7
- name: Pubprn.vbs Proxy Execution
  query: grep('\\pubprn.vbs', this['ProcessCommandLine']) and grep('script:', this['ProcessCommandLine'])
  sigma_id: 1fb76ab8-fa60-4b01-bddd-71e89bf555da
- name: DLL Execution via Rasautou.exe
  query: (grep('\\rasautou.exe', this['FolderPath']) or grep('rasdlui.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' -d ', this['ProcessCommandLine']) and grep(' -p ', this['ProcessCommandLine'])
  sigma_id: cd3d1298-eb3b-476c-ac67-12847de55813
- name: REGISTER_APP.VBS Proxy Execution
  query: grep('\\register_app.vbs', this['ProcessCommandLine']) and grep('-register',
    this['ProcessCommandLine'])
  sigma_id: 1c8774a0-44d4-4db0-91f8-e792359c70bd
- name: Use of Remote.exe
  query: grep('\\remote.exe', this['FolderPath']) or grep('remote.exe', this['ProcessVersionInfoOriginalFileName'])
  sigma_id: 4eddc365-79b4-43ff-a9d7-99422dc34b93
- name: Replace.exe Usage
  query: "grep('\\\\replace.exe', this['FolderPath']) and (grep('-a', this['ProcessCommandLine'])\
    \ or grep('/a', this['ProcessCommandLine']) or grep('\u2013a', this['ProcessCommandLine'])\
    \ or grep('\u2014a', this['ProcessCommandLine']) or grep('\u2015a', this['ProcessCommandLine']))"
  sigma_id: 9292293b-8496-4715-9db6-37028dcda4b3
- name: Lolbin Runexehelper Use As Proxy
  query: grep('\\runexehelper.exe', this['InitiatingProcessFolderPath'])
  sigma_id: cd71385d-fd9b-4691-9b98-2b1f7e508714
- name: Suspicious Runscripthelper.exe
  query: grep('\\Runscripthelper.exe', this['FolderPath']) and grep('surfacecheck',
    this['ProcessCommandLine'])
  sigma_id: eca49c87-8a75-4f13-9c73-a5a29e845f03
- name: Use of Scriptrunner.exe
  query: (grep('\\ScriptRunner.exe', this['FolderPath']) or grep('ScriptRunner.exe',
    this['ProcessVersionInfoOriginalFileName'])) and grep(' -appvscript ', this['ProcessCommandLine'])
  sigma_id: 64760eef-87f7-4ed3-93fd-655668ea9420
- name: Using SettingSyncHost.exe as LOLBin
  query: not (grep('C:\\Windows\\System32\\', this['FolderPath']) or grep('C:\\Windows\\SysWOW64\\',
    this['FolderPath'])) and grep('cmd.exe /c', this['InitiatingProcessCommandLine'])
    and grep('RoamDiag.cmd', this['InitiatingProcessCommandLine']) and grep('-outputpath',
    this['InitiatingProcessCommandLine'])
  sigma_id: b2ddd389-f676-4ac4-845a-e00781a48e5f
- name: Use Of The SFTP.EXE Binary As A LOLBIN
  query: grep('\\sftp.exe', this['FolderPath']) and (grep(' -D ..', this['ProcessCommandLine'])
    or grep(' -D C:\\', this['ProcessCommandLine']))
  sigma_id: a85ffc3a-e8fd-4040-93bf-78aff284d801
- name: Suspicious Certreq Command to Download
  query: (grep('\\certreq.exe', this['FolderPath']) or grep('CertReq.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' -Post ', this['ProcessCommandLine']) and grep(' -config ', this['ProcessCommandLine'])
    and grep(' http', this['ProcessCommandLine']) and grep(' C:\\windows\\win.ini
    ', this['ProcessCommandLine'])
  sigma_id: 4480827a-9799-4232-b2c4-ccc6c4e9e12b
- name: Suspicious Driver Install by pnputil.exe
  query: (grep('-i', this['ProcessCommandLine']) or grep('/install', this['ProcessCommandLine'])
    or grep('-a', this['ProcessCommandLine']) or grep('/add-driver', this['ProcessCommandLine'])
    or grep('.inf', this['ProcessCommandLine'])) and grep('\\pnputil.exe', this['FolderPath'])
  sigma_id: a2ea3ae7-d3d0-40a0-a55c-25a45c87cac1
- name: Suspicious GrpConv Execution
  query: grep('grpconv.exe -o', this['ProcessCommandLine']) or grep('grpconv -o',
    this['ProcessCommandLine'])
  sigma_id: f14e169e-9978-4c69-acb3-1cff8200bc36
- name: Dumping Process via Sqldumper.exe
  query: grep('\\sqldumper.exe', this['FolderPath']) and (grep('0x0110', this['ProcessCommandLine'])
    or grep('0x01100:40', this['ProcessCommandLine']))
  sigma_id: 23ceaf5c-b6f1-4a32-8559-f2ff734be516
- name: SyncAppvPublishingServer Execute Arbitrary PowerShell Code
  query: (grep('\\SyncAppvPublishingServer.exe', this['FolderPath']) or grep('syncappvpublishingserver.exe',
    this['ProcessVersionInfoOriginalFileName'])) and grep('"n; ', this['ProcessCommandLine'])
  sigma_id: fbd7c32d-db2a-4418-b92c-566eb8911133
- name: SyncAppvPublishingServer VBS Execute Arbitrary PowerShell Code
  query: grep('\\SyncAppvPublishingServer.vbs', this['ProcessCommandLine']) and grep(';',
    this['ProcessCommandLine'])
  sigma_id: 36475a7d-0f6d-4dce-9b01-6aeb473bbaf1
- name: Potential DLL Injection Or Execution Using Tracker.exe
  query: (grep('\\tracker.exe', this['FolderPath']) or grep('Tracker', this['ProcessVersionInfoFileDescription']))
    and (grep(' /d ', this['ProcessCommandLine']) or grep(' /c ', this['ProcessCommandLine']))
    and not (grep(' /ERRORREPORT:PROMPT ', this['ProcessCommandLine']) or grep('\\Msbuild\\Current\\Bin\\MSBuild.exe',
    this['InitiatingProcessFolderPath']) or grep('\\Msbuild\\Current\\Bin\\amd64\\MSBuild.exe',
    this['InitiatingProcessFolderPath']))
  sigma_id: 148431ce-4b70-403d-8525-fcc2993f29ea
- name: Use of TTDInject.exe
  query: grep('ttdinject.exe', this['FolderPath']) or grep('TTDInject.EXE', this['ProcessVersionInfoOriginalFileName'])
  sigma_id: b27077d6-23e6-45d2-81a0-e2b356eea5fd
- name: Time Travel Debugging Utility Usage
  query: grep('\\tttracer.exe', this['InitiatingProcessFolderPath'])
  sigma_id: 0b4ae027-2a2d-4b93-8c7e-962caaba5b2a
- name: Lolbin Unregmp2.exe Use As Proxy
  query: "(grep('\\\\unregmp2.exe', this['FolderPath']) or grep('unregmp2.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep(' -HideWMP', this['ProcessCommandLine']) or grep(' /HideWMP', this['ProcessCommandLine'])\
    \ or grep(' \u2013HideWMP', this['ProcessCommandLine']) or grep(' \u2014HideWMP',\
    \ this['ProcessCommandLine']) or grep(' \u2015HideWMP', this['ProcessCommandLine']))"
  sigma_id: 727454c0-d851-48b0-8b89-385611ab0704
- name: UtilityFunctions.ps1 Proxy Dll
  query: grep('UtilityFunctions.ps1', this['ProcessCommandLine']) or grep('RegSnapin
    ', this['ProcessCommandLine'])
  sigma_id: 0403d67d-6227-4ea8-8145-4e72db7da120
- name: Visual Basic Command Line Compiler Usage
  query: grep('\\vbc.exe', this['InitiatingProcessFolderPath']) and grep('\\cvtres.exe',
    this['FolderPath'])
  sigma_id: 7b10f171-7f04-47c7-9fa2-5be43c76e535
- name: Use of VisualUiaVerifyNative.exe
  query: grep('\\VisualUiaVerifyNative.exe', this['FolderPath']) or grep('VisualUiaVerifyNative.exe',
    this['ProcessVersionInfoOriginalFileName'])
  sigma_id: b30a8bc5-e21b-4ca2-9420-0a94019ac56a
- name: Use of VSIISExeLauncher.exe
  query: (grep('\\VSIISExeLauncher.exe', this['FolderPath']) or grep('VSIISExeLauncher.exe',
    this['ProcessVersionInfoOriginalFileName'])) and (grep(' -p ', this['ProcessCommandLine'])
    or grep(' -a ', this['ProcessCommandLine']))
  sigma_id: 18749301-f1c5-4efc-a4c3-276ff1f5b6f8
- name: Use of Wfc.exe
  query: grep('\\wfc.exe', this['FolderPath']) or grep('wfc.exe', this['ProcessVersionInfoOriginalFileName'])
  sigma_id: 49be8799-7b4d-4fda-ad23-cafbefdebbc5
- name: Potential Register_App.Vbs LOLScript Abuse
  query: (grep('\\cscript.exe', this['FolderPath']) or grep('\\wscript.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['cscript.exe', 'wscript.exe'])
    and grep('.vbs -register ', this['ProcessCommandLine'])
  sigma_id: 28c8f68b-098d-45af-8d43-8089f3e35403
- name: Potential Credential Dumping Via LSASS Process Clone
  query: grep('\\Windows\\System32\\lsass.exe', this['InitiatingProcessFolderPath'])
    and grep('\\Windows\\System32\\lsass.exe', this['FolderPath'])
  sigma_id: c8da0dfd-4ed0-4b68-962d-13c9c884384e
- name: Potential Mftrace.EXE Abuse
  query: grep('\\mftrace.exe', this['InitiatingProcessFolderPath'])
  sigma_id: 3d48c9d3-1aa6-418d-98d3-8fd3c01a564e
- name: MMC20 Lateral Movement
  query: grep('\\svchost.exe', this['InitiatingProcessFolderPath']) and grep('\\mmc.exe',
    this['FolderPath']) and grep('-Embedding', this['ProcessCommandLine'])
  sigma_id: f1f3bf22-deb2-418d-8cce-e1a45e46a5bd
- name: MMC Spawning Windows Shell
  query: grep('\\mmc.exe', this['InitiatingProcessFolderPath']) and (grep('\\cmd.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath']) or grep('\\cscript.exe',
    this['FolderPath']) or grep('\\sh.exe', this['FolderPath']) or grep('\\bash.exe',
    this['FolderPath']) or grep('\\reg.exe', this['FolderPath']) or grep('\\regsvr32.exe',
    this['FolderPath']) or grep('\\BITSADMIN', this['FolderPath']))
  sigma_id: 05a2ab7e-ce11-4b63-86db-ab32e763e11d
- name: CodePage Modification Via MODE.COM To Russian Language
  query: (grep('\\mode.com', this['FolderPath']) or grep('MODE.COM', this['ProcessVersionInfoOriginalFileName']))
    and grep(' con ', this['ProcessCommandLine']) and grep(' cp ', this['ProcessCommandLine'])
    and grep(' select=', this['ProcessCommandLine']) and (grep('=1251', this['ProcessCommandLine'])
    or grep('=866', this['ProcessCommandLine']))
  sigma_id: 12fbff88-16b5-4b42-9754-cd001a789fb3
- name: Potential Suspicious Mofcomp Execution
  query: (grep('\\mofcomp.exe', this['FolderPath']) or grep('mofcomp.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('\\cmd.exe', this['InitiatingProcessFolderPath']) or grep('\\powershell.exe',
    this['InitiatingProcessFolderPath']) or grep('\\pwsh.exe', this['InitiatingProcessFolderPath'])
    or grep('\\wsl.exe', this['InitiatingProcessFolderPath']) or grep('\\wscript.exe',
    this['InitiatingProcessFolderPath']) or grep('\\cscript.exe', this['InitiatingProcessFolderPath'])
    or grep('\\AppData\\Local\\Temp', this['ProcessCommandLine']) or grep('\\Users\\Public\\',
    this['ProcessCommandLine']) or grep('\\WINDOWS\\Temp\\', this['ProcessCommandLine'])
    or grep('%temp%', this['ProcessCommandLine']) or grep('%tmp%', this['ProcessCommandLine'])
    or grep('%appdata%', this['ProcessCommandLine'])) and not (grep('C:\\Windows\\System32\\wbem\\WmiPrvSE.exe',
    this['InitiatingProcessFolderPath']) and grep('C:\\Windows\\TEMP\\', this['ProcessCommandLine'])
    and grep('.mof', this['ProcessCommandLine'])) and not (grep('C:\\Windows\\TEMP\\',
    this['ProcessCommandLine']) and grep('.mof', this['ProcessCommandLine']))
  sigma_id: 1dd05363-104e-4b4a-b963-196a534b03a1
- name: Potential Mpclient.DLL Sideloading Via Defender Binaries
  query: (grep('\\MpCmdRun.exe', this['FolderPath']) or grep('\\NisSrv.exe', this['FolderPath']))
    and not (grep('C:\\Program Files (x86)\\Windows Defender\\', this['FolderPath'])
    or grep('C:\\Program Files\\Microsoft Security Client\\', this['FolderPath'])
    or grep('C:\\Program Files\\Windows Defender\\', this['FolderPath']) or grep('C:\\ProgramData\\Microsoft\\Windows
    Defender\\Platform\\', this['FolderPath']) or grep('C:\\Windows\\WinSxS\\', this['FolderPath']))
  sigma_id: 7002aa10-b8d4-47ae-b5ba-51ab07e228b9
- name: File Download Via Windows Defender MpCmpRun.EXE
  query: (grep('MpCmdRun.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\MpCmdRun.exe',
    this['FolderPath']) or grep('MpCmdRun.exe', this['ProcessCommandLine']) or grep('Microsoft
    Malware Protection Command Line Utility', this['ProcessVersionInfoFileDescription']))
    and grep('DownloadFile', this['ProcessCommandLine']) and grep('url', this['ProcessCommandLine'])
  sigma_id: 46123129-1024-423e-9fae-43af4a0fa9a5
- name: Windows Defender Definition Files Removed
  query: (grep('\\MpCmdRun.exe', this['FolderPath']) or grep('MpCmdRun.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' -RemoveDefinitions', this['ProcessCommandLine']) and grep(' -All',
    this['ProcessCommandLine'])
  sigma_id: 9719a8aa-401c-41af-8108-ced7ec9cd75c
- name: Suspicious Msbuild Execution By Uncommon Parent Process
  query: (grep('\\MSBuild.exe', this['FolderPath']) or grep('MSBuild.exe', this['ProcessVersionInfoOriginalFileName']))
    and not (grep('\\devenv.exe', this['InitiatingProcessFolderPath']) or grep('\\cmd.exe',
    this['InitiatingProcessFolderPath']) or grep('\\msbuild.exe', this['InitiatingProcessFolderPath'])
    or grep('\\python.exe', this['InitiatingProcessFolderPath']) or grep('\\explorer.exe',
    this['InitiatingProcessFolderPath']) or grep('\\nuget.exe', this['InitiatingProcessFolderPath']))
  sigma_id: 33be4333-2c6b-44f4-ae28-102cdbde0a31
- name: Potential Arbitrary Command Execution Using Msdt.EXE
  query: "(grep('\\\\msdt.exe', this['FolderPath']) or grep('msdt.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep('IT_BrowseForFile=', this['ProcessCommandLine']) or grep(' PCWDiagnostic',\
    \ this['ProcessCommandLine']) and (grep(' -af ', this['ProcessCommandLine']) or\
    \ grep(' /af ', this['ProcessCommandLine']) or grep(' \u2013af ', this['ProcessCommandLine'])\
    \ or grep(' \u2014af ', this['ProcessCommandLine']) or grep(' \u2015af ', this['ProcessCommandLine'])))"
  sigma_id: 258fc8ce-8352-443a-9120-8a11e4857fa5
- name: Suspicious Cabinet File Execution Via Msdt.EXE
  query: "(grep('\\\\msdt.exe', this['FolderPath']) or grep('msdt.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep(' -cab ', this['ProcessCommandLine']) or grep(' /cab ', this['ProcessCommandLine'])\
    \ or grep(' \u2013cab ', this['ProcessCommandLine']) or grep(' \u2014cab ', this['ProcessCommandLine'])\
    \ or grep(' \u2015cab ', this['ProcessCommandLine']))"
  sigma_id: dc4576d4-7467-424f-9eee-fd2b02855fe0
- name: Suspicious MSDT Parent Process
  query: (grep('\\cmd.exe', this['InitiatingProcessFolderPath']) or grep('\\cscript.exe',
    this['InitiatingProcessFolderPath']) or grep('\\mshta.exe', this['InitiatingProcessFolderPath'])
    or grep('\\powershell.exe', this['InitiatingProcessFolderPath']) or grep('\\pwsh.exe',
    this['InitiatingProcessFolderPath']) or grep('\\regsvr32.exe', this['InitiatingProcessFolderPath'])
    or grep('\\rundll32.exe', this['InitiatingProcessFolderPath']) or grep('\\schtasks.exe',
    this['InitiatingProcessFolderPath']) or grep('\\wmic.exe', this['InitiatingProcessFolderPath'])
    or grep('\\wscript.exe', this['InitiatingProcessFolderPath']) or grep('\\wsl.exe',
    this['InitiatingProcessFolderPath'])) and (grep('\\msdt.exe', this['FolderPath'])
    or grep('msdt.exe', this['ProcessVersionInfoOriginalFileName']))
  sigma_id: 7a74da6b-ea76-47db-92cc-874ad90df734
- name: Arbitrary File Download Via MSEDGE_PROXY.EXE
  query: (grep('\\msedge_proxy.exe', this['FolderPath']) or grep('msedge_proxy.exe',
    this['ProcessVersionInfoOriginalFileName'])) and (grep('http://', this['ProcessCommandLine'])
    or grep('https://', this['ProcessCommandLine']))
  sigma_id: e84d89c4-f544-41ca-a6af-4b92fd38b023
- name: Remotely Hosted HTA File Executed Via Mshta.EXE
  query: (grep('\\mshta.exe', this['FolderPath']) or grep('MSHTA.EXE', this['ProcessVersionInfoOriginalFileName']))
    and (grep('http://', this['ProcessCommandLine']) or grep('https://', this['ProcessCommandLine'])
    or grep('ftp://', this['ProcessCommandLine']))
  sigma_id: b98d0db6-511d-45de-ad02-e82a98729620
- name: Wscript Shell Run In CommandLine
  query: grep('Wscript.', this['ProcessCommandLine']) and grep('.Shell', this['ProcessCommandLine'])
    and grep('.Run', this['ProcessCommandLine'])
  sigma_id: 2c28c248-7f50-417a-9186-a85b223010ee
- name: Suspicious JavaScript Execution Via Mshta.EXE
  query: (grep('\\mshta.exe', this['FolderPath']) or grep('MSHTA.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('javascript', this['ProcessCommandLine'])
  sigma_id: 67f113fa-e23d-4271-befa-30113b3e08b1
- name: Potential LethalHTA Technique Execution
  query: grep('\\svchost.exe', this['InitiatingProcessFolderPath']) and grep('\\mshta.exe',
    this['FolderPath'])
  sigma_id: ed5d72a6-f8f4-479d-ba79-02f6a80d7471
- name: Suspicious MSHTA Child Process
  query: grep('\\mshta.exe', this['InitiatingProcessFolderPath']) and (grep('\\cmd.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath']) or grep('\\cscript.exe',
    this['FolderPath']) or grep('\\sh.exe', this['FolderPath']) or grep('\\bash.exe',
    this['FolderPath']) or grep('\\reg.exe', this['FolderPath']) or grep('\\regsvr32.exe',
    this['FolderPath']) or grep('\\bitsadmin.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['Cmd.Exe', 'PowerShell.EXE', 'pwsh.dll', 'wscript.exe', 'cscript.exe', 'Bash.exe',
    'reg.exe', 'REGSVR32.EXE', 'bitsadmin.exe'])
  sigma_id: 03cc0c25-389f-4bf8-b48d-11878079f1ca
- name: MSHTA Suspicious Execution 01
  query: grep('\\mshta.exe', this['FolderPath']) and (grep('vbscript', this['ProcessCommandLine'])
    or grep('.jpg', this['ProcessCommandLine']) or grep('.png', this['ProcessCommandLine'])
    or grep('.lnk', this['ProcessCommandLine']) or grep('.xls', this['ProcessCommandLine'])
    or grep('.doc', this['ProcessCommandLine']) or grep('.zip', this['ProcessCommandLine'])
    or grep('.dll', this['ProcessCommandLine']))
  sigma_id: cc7abbd0-762b-41e3-8a26-57ad50d2eea3
- name: Suspicious Mshta.EXE Execution Patterns
  query: (grep('\\mshta.exe', this['FolderPath']) or grep('MSHTA.EXE', this['ProcessVersionInfoOriginalFileName']))
    and (grep('\\cmd.exe', this['InitiatingProcessFolderPath']) or grep('\\cscript.exe',
    this['InitiatingProcessFolderPath']) or grep('\\powershell.exe', this['InitiatingProcessFolderPath'])
    or grep('\\pwsh.exe', this['InitiatingProcessFolderPath']) or grep('\\regsvr32.exe',
    this['InitiatingProcessFolderPath']) or grep('\\rundll32.exe', this['InitiatingProcessFolderPath'])
    or grep('\\wscript.exe', this['InitiatingProcessFolderPath'])) and (grep('\\AppData\\Local\\',
    this['ProcessCommandLine']) or grep('C:\\ProgramData\\', this['ProcessCommandLine'])
    or grep('C:\\Users\\Public\\', this['ProcessCommandLine']) or grep('C:\\Windows\\Temp\\',
    this['ProcessCommandLine'])) or (grep('\\mshta.exe', this['FolderPath']) or grep('MSHTA.EXE',
    this['ProcessVersionInfoOriginalFileName'])) and not (grep('C:\\Windows\\System32\\',
    this['FolderPath']) or grep('C:\\Windows\\SysWOW64\\', this['FolderPath']) or
    grep('.htm', this['ProcessCommandLine']) or grep('.hta', this['ProcessCommandLine'])
    or grep('mshta.exe', this['ProcessCommandLine']) or grep('mshta', this['ProcessCommandLine']))
  sigma_id: e32f92d1-523e-49c3-9374-bdb13b46a3ba
- name: DllUnregisterServer Function Call Via Msiexec.EXE
  query: "(grep('\\\\msiexec.exe', this['FolderPath']) or grep('\\\\msiexec.exe',\
    \ this['ProcessVersionInfoOriginalFileName'])) and (grep(' -z ', this['ProcessCommandLine'])\
    \ or grep(' /z ', this['ProcessCommandLine']) or grep(' \u2013z ', this['ProcessCommandLine'])\
    \ or grep(' \u2014z ', this['ProcessCommandLine']) or grep(' \u2015z ', this['ProcessCommandLine']))\
    \ and grep('.dll', this['ProcessCommandLine'])"
  sigma_id: 84f52741-8834-4a8c-a413-2eb2269aa6c8
- name: Suspicious MsiExec Embedding Parent
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or grep('\\cmd.exe', this['FolderPath'])) and grep('MsiExec.exe', this['InitiatingProcessCommandLine'])
    and grep('-Embedding ', this['InitiatingProcessCommandLine']) and not (grep(':\\Windows\\System32\\cmd.exe',
    this['FolderPath']) and grep('C:\\Program Files\\SplunkUniversalForwarder\\bin\\',
    this['ProcessCommandLine']) or grep('\\DismFoDInstall.cmd', this['ProcessCommandLine'])
    or grep('\\MsiExec.exe -Embedding ', this['InitiatingProcessCommandLine']) and
    grep('Global\\MSI0000', this['InitiatingProcessCommandLine']))
  sigma_id: 4a2a2c3e-209f-4d01-b513-4155a540b469
- name: Suspicious Msiexec Execute Arbitrary DLL
  query: "grep('\\\\msiexec.exe', this['FolderPath']) and (grep(' -y', this['ProcessCommandLine'])\
    \ or grep(' /y', this['ProcessCommandLine']) or grep(' \u2013y', this['ProcessCommandLine'])\
    \ or grep(' \u2014y', this['ProcessCommandLine']) or grep(' \u2015y', this['ProcessCommandLine']))\
    \ and not (grep('\\\\MsiExec.exe\" /Y \"C:\\\\Program Files\\\\Bonjour\\\\mdnsNSP.dll',\
    \ this['ProcessCommandLine']) or grep('\\\\MsiExec.exe\" /Y \"C:\\\\Program Files\
    \ (x86)\\\\Bonjour\\\\mdnsNSP.dll', this['ProcessCommandLine']) or grep('\\\\\
    MsiExec.exe\" /Y \"C:\\\\Program Files (x86)\\\\Apple Software Update\\\\ScriptingObjectModel.dll',\
    \ this['ProcessCommandLine']) or grep('\\\\MsiExec.exe\" /Y \"C:\\\\Program Files\
    \ (x86)\\\\Apple Software Update\\\\SoftwareUpdateAdmin.dll', this['ProcessCommandLine'])\
    \ or grep('\\\\MsiExec.exe\" /Y \"C:\\\\Windows\\\\CCM\\\\', this['ProcessCommandLine'])\
    \ or grep('\\\\MsiExec.exe\" /Y C:\\\\Windows\\\\CCM\\\\', this['ProcessCommandLine'])\
    \ or grep('\\\\MsiExec.exe\" -Y \"C:\\\\Program Files\\\\Bonjour\\\\mdnsNSP.dll',\
    \ this['ProcessCommandLine']) or grep('\\\\MsiExec.exe\" -Y \"C:\\\\Program Files\
    \ (x86)\\\\Bonjour\\\\mdnsNSP.dll', this['ProcessCommandLine']) or grep('\\\\\
    MsiExec.exe\" -Y \"C:\\\\Program Files (x86)\\\\Apple Software Update\\\\ScriptingObjectModel.dll',\
    \ this['ProcessCommandLine']) or grep('\\\\MsiExec.exe\" -Y \"C:\\\\Program Files\
    \ (x86)\\\\Apple Software Update\\\\SoftwareUpdateAdmin.dll', this['ProcessCommandLine'])\
    \ or grep('\\\\MsiExec.exe\" -Y \"C:\\\\Windows\\\\CCM\\\\', this['ProcessCommandLine'])\
    \ or grep('\\\\MsiExec.exe\" -Y C:\\\\Windows\\\\CCM\\\\', this['ProcessCommandLine']))"
  sigma_id: 6f4191bb-912b-48a8-9ce7-682769541e6d
- name: Msiexec Quiet Installation
  query: "(grep('\\\\msiexec.exe', this['FolderPath']) or grep('msiexec.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep('-i', this['ProcessCommandLine']) or grep('/i', this['ProcessCommandLine'])\
    \ or grep('\u2013i', this['ProcessCommandLine']) or grep('\u2014i', this['ProcessCommandLine'])\
    \ or grep('\u2015i', this['ProcessCommandLine']) or grep('-package', this['ProcessCommandLine'])\
    \ or grep('/package', this['ProcessCommandLine']) or grep('\u2013package', this['ProcessCommandLine'])\
    \ or grep('\u2014package', this['ProcessCommandLine']) or grep('\u2015package',\
    \ this['ProcessCommandLine']) or grep('-a', this['ProcessCommandLine']) or grep('/a',\
    \ this['ProcessCommandLine']) or grep('\u2013a', this['ProcessCommandLine']) or\
    \ grep('\u2014a', this['ProcessCommandLine']) or grep('\u2015a', this['ProcessCommandLine'])\
    \ or grep('-j', this['ProcessCommandLine']) or grep('/j', this['ProcessCommandLine'])\
    \ or grep('\u2013j', this['ProcessCommandLine']) or grep('\u2014j', this['ProcessCommandLine'])\
    \ or grep('\u2015j', this['ProcessCommandLine'])) and (grep('-q', this['ProcessCommandLine'])\
    \ or grep('/q', this['ProcessCommandLine']) or grep('\u2013q', this['ProcessCommandLine'])\
    \ or grep('\u2014q', this['ProcessCommandLine']) or grep('\u2015q', this['ProcessCommandLine']))\
    \ and not (grep('C:\\\\Users\\\\', this['InitiatingProcessFolderPath']) and grep('\\\
    \\AppData\\\\Local\\\\Temp\\\\', this['InitiatingProcessFolderPath']) or grep('C:\\\
    \\Windows\\\\Temp\\\\', this['InitiatingProcessFolderPath']) or grep('C:\\\\Windows\\\
    \\CCM\\\\Ccm32BitLauncher.exe', this['InitiatingProcessFolderPath']) and (this['ProcessIntegrityLevel']\
    \ in ['System', 'S-1-16-16384']))"
  sigma_id: 79a87aa6-e4bd-42fc-a5bb-5e6fbdcd62f5
- name: Suspicious Msiexec Quiet Install From Remote Location
  query: "(grep('\\\\msiexec.exe', this['FolderPath']) or grep('msiexec.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep('-i', this['ProcessCommandLine']) or grep('/i', this['ProcessCommandLine'])\
    \ or grep('\u2013i', this['ProcessCommandLine']) or grep('\u2014i', this['ProcessCommandLine'])\
    \ or grep('\u2015i', this['ProcessCommandLine']) or grep('-package', this['ProcessCommandLine'])\
    \ or grep('/package', this['ProcessCommandLine']) or grep('\u2013package', this['ProcessCommandLine'])\
    \ or grep('\u2014package', this['ProcessCommandLine']) or grep('\u2015package',\
    \ this['ProcessCommandLine']) or grep('-a', this['ProcessCommandLine']) or grep('/a',\
    \ this['ProcessCommandLine']) or grep('\u2013a', this['ProcessCommandLine']) or\
    \ grep('\u2014a', this['ProcessCommandLine']) or grep('\u2015a', this['ProcessCommandLine'])\
    \ or grep('-j', this['ProcessCommandLine']) or grep('/j', this['ProcessCommandLine'])\
    \ or grep('\u2013j', this['ProcessCommandLine']) or grep('\u2014j', this['ProcessCommandLine'])\
    \ or grep('\u2015j', this['ProcessCommandLine'])) and (grep('-q', this['ProcessCommandLine'])\
    \ or grep('/q', this['ProcessCommandLine']) or grep('\u2013q', this['ProcessCommandLine'])\
    \ or grep('\u2014q', this['ProcessCommandLine']) or grep('\u2015q', this['ProcessCommandLine']))\
    \ and (grep('http', this['ProcessCommandLine']) or grep('\\\\', this['ProcessCommandLine']))"
  sigma_id: 8150732a-0c9d-4a99-82b9-9efb9b90c40c
- name: Potential MsiExec Masquerading
  query: (grep('\\msiexec.exe', this['FolderPath']) or grep('\\msiexec.exe', this['ProcessVersionInfoOriginalFileName']))
    and not (grep('C:\\Windows\\System32\\', this['FolderPath']) or grep('C:\\Windows\\SysWOW64\\',
    this['FolderPath']) or grep('C:\\Windows\\WinSxS\\', this['FolderPath']))
  sigma_id: e22a6eb2-f8a5-44b5-8b44-a2dbd47b1144
- name: MsiExec Web Install
  query: grep(' msiexec', this['ProcessCommandLine']) and grep('://', this['ProcessCommandLine'])
  sigma_id: f7b5f842-a6af-4da5-9e95-e32478f3cd2f
- name: Arbitrary File Download Via MSOHTMED.EXE
  query: (grep('\\MSOHTMED.exe', this['FolderPath']) or grep('MsoHtmEd.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('ftp://', this['ProcessCommandLine']) or grep('http://', this['ProcessCommandLine'])
    or grep('https://', this['ProcessCommandLine']))
  sigma_id: 459f2f98-397b-4a4a-9f47-6a5ec2f1c69d
- name: Arbitrary File Download Via MSPUB.EXE
  query: (grep('\\MSPUB.exe', this['FolderPath']) or grep('MSPUB.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('ftp://', this['ProcessCommandLine']) or grep('http://', this['ProcessCommandLine'])
    or grep('https://', this['ProcessCommandLine']))
  sigma_id: 3b3c7f55-f771-4dd6-8a6e-08d057a17caf
- name: Potential Process Injection Via Msra.EXE
  query: grep('\\msra.exe', this['InitiatingProcessFolderPath']) and grep('msra.exe',
    this['InitiatingProcessCommandLine']) and (grep('\\arp.exe', this['FolderPath'])
    or grep('\\cmd.exe', this['FolderPath']) or grep('\\net.exe', this['FolderPath'])
    or grep('\\netstat.exe', this['FolderPath']) or grep('\\nslookup.exe', this['FolderPath'])
    or grep('\\route.exe', this['FolderPath']) or grep('\\schtasks.exe', this['FolderPath'])
    or grep('\\whoami.exe', this['FolderPath']))
  sigma_id: 744a188b-0415-4792-896f-11ddb0588dbc
- name: Detection of PowerShell Execution via Sqlps.exe
  query: grep('\\sqlps.exe', this['InitiatingProcessFolderPath']) or (grep('\\sqlps.exe',
    this['FolderPath']) or grep('sqlps.exe', this['ProcessVersionInfoOriginalFileName']))
    and not grep('\\sqlagent.exe', this['InitiatingProcessFolderPath'])
  sigma_id: 0152550d-3a26-4efd-9f0e-54a0b28ae2f3
- name: SQL Client Tools PowerShell Session Detection
  query: (grep('\\sqltoolsps.exe', this['FolderPath']) or grep('\\sqltoolsps.exe',
    this['InitiatingProcessFolderPath']) or grep('\\sqltoolsps.exe', this['ProcessVersionInfoOriginalFileName']))
    and not grep('\\smss.exe', this['InitiatingProcessFolderPath'])
  sigma_id: a746c9b8-a2fb-4ee5-a428-92bee9e99060
- name: Suspicious Child Process Of SQL Server
  query: grep('\\sqlservr.exe', this['InitiatingProcessFolderPath']) and (grep('\\bash.exe',
    this['FolderPath']) or grep('\\bitsadmin.exe', this['FolderPath']) or grep('\\cmd.exe',
    this['FolderPath']) or grep('\\netstat.exe', this['FolderPath']) or grep('\\nltest.exe',
    this['FolderPath']) or grep('\\ping.exe', this['FolderPath']) or grep('\\powershell.exe',
    this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']) or grep('\\regsvr32.exe',
    this['FolderPath']) or grep('\\rundll32.exe', this['FolderPath']) or grep('\\sh.exe',
    this['FolderPath']) or grep('\\systeminfo.exe', this['FolderPath']) or grep('\\tasklist.exe',
    this['FolderPath']) or grep('\\wsl.exe', this['FolderPath'])) and not (grep('C:\\Program
    Files\\Microsoft SQL Server\\', this['InitiatingProcessFolderPath']) and grep('DATEV_DBENGINE\\MSSQL\\Binn\\sqlservr.exe',
    this['InitiatingProcessFolderPath']) and grep('C:\\Windows\\System32\\cmd.exe',
    this['FolderPath']) and grep('"C:\\Windows\\system32\\cmd.exe" ', this['ProcessCommandLine']))
  sigma_id: 869b9ca7-9ea2-4a5a-8325-e80e62f75445
- name: Suspicious Child Process Of Veeam Dabatase
  query: grep('\\sqlservr.exe', this['InitiatingProcessFolderPath']) and grep('VEEAMSQL',
    this['InitiatingProcessCommandLine']) and ((grep('\\cmd.exe', this['FolderPath'])
    or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or grep('\\wsl.exe', this['FolderPath']) or grep('\\wt.exe', this['FolderPath']))
    and (grep('-ex ', this['ProcessCommandLine']) or grep('bypass', this['ProcessCommandLine'])
    or grep('cscript', this['ProcessCommandLine']) or grep('DownloadString', this['ProcessCommandLine'])
    or grep('http://', this['ProcessCommandLine']) or grep('https://', this['ProcessCommandLine'])
    or grep('mshta', this['ProcessCommandLine']) or grep('regsvr32', this['ProcessCommandLine'])
    or grep('rundll32', this['ProcessCommandLine']) or grep('wscript', this['ProcessCommandLine'])
    or grep('copy ', this['ProcessCommandLine'])) or grep('\\net.exe', this['FolderPath'])
    or grep('\\net1.exe', this['FolderPath']) or grep('\\netstat.exe', this['FolderPath'])
    or grep('\\nltest.exe', this['FolderPath']) or grep('\\ping.exe', this['FolderPath'])
    or grep('\\tasklist.exe', this['FolderPath']) or grep('\\whoami.exe', this['FolderPath']))
  sigma_id: d55b793d-f847-4eea-b59a-5ab09908ac90
- name: Potential MSTSC Shadowing Activity
  query: grep('noconsentprompt', this['ProcessCommandLine']) and grep('shadow:', this['ProcessCommandLine'])
  sigma_id: 6ba5a05f-b095-4f0a-8654-b825f4f16334
- name: New Remote Desktop Connection Initiated Via Mstsc.EXE
  query: "(grep('\\\\mstsc.exe', this['FolderPath']) or grep('mstsc.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep(' -v:', this['ProcessCommandLine']) or grep(' /v:', this['ProcessCommandLine'])\
    \ or grep(' \u2013v:', this['ProcessCommandLine']) or grep(' \u2014v:', this['ProcessCommandLine'])\
    \ or grep(' \u2015v:', this['ProcessCommandLine'])) and not (grep('C:\\\\Windows\\\
    \\System32\\\\lxss\\\\wslhost.exe', this['InitiatingProcessFolderPath']) and grep('C:\\\
    \\ProgramData\\\\Microsoft\\\\WSL\\\\wslg.rdp', this['ProcessCommandLine']))"
  sigma_id: 954f0af7-62dd-418f-b3df-a84bc2c7a774
- name: Suspicious Mstsc.EXE Execution With Local RDP File
  query: (grep('\\mstsc.exe', this['FolderPath']) or grep('mstsc.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('.rdp', this['ProcessCommandLine']) or grep('.rdp"', this['ProcessCommandLine']))
    and (grep(':\\Users\\Public\\', this['ProcessCommandLine']) or grep(':\\Windows\\System32\\spool\\drivers\\color',
    this['ProcessCommandLine']) or grep(':\\Windows\\System32\\Tasks_Migrated ', this['ProcessCommandLine'])
    or grep(':\\Windows\\Tasks\\', this['ProcessCommandLine']) or grep(':\\Windows\\Temp\\',
    this['ProcessCommandLine']) or grep(':\\Windows\\Tracing\\', this['ProcessCommandLine'])
    or grep('\\AppData\\Local\\Temp\\', this['ProcessCommandLine']) or grep('\\Downloads\\',
    this['ProcessCommandLine']))
  sigma_id: 6e22722b-dfb1-4508-a911-49ac840b40f8
- name: Mstsc.EXE Execution From Uncommon Parent
  query: (grep('\\brave.exe', this['InitiatingProcessFolderPath']) or grep('\\CCleanerBrowser.exe',
    this['InitiatingProcessFolderPath']) or grep('\\chrome.exe', this['InitiatingProcessFolderPath'])
    or grep('\\chromium.exe', this['InitiatingProcessFolderPath']) or grep('\\firefox.exe',
    this['InitiatingProcessFolderPath']) or grep('\\iexplore.exe', this['InitiatingProcessFolderPath'])
    or grep('\\microsoftedge.exe', this['InitiatingProcessFolderPath']) or grep('\\msedge.exe',
    this['InitiatingProcessFolderPath']) or grep('\\opera.exe', this['InitiatingProcessFolderPath'])
    or grep('\\vivaldi.exe', this['InitiatingProcessFolderPath']) or grep('\\whale.exe',
    this['InitiatingProcessFolderPath']) or grep('\\outlook.exe', this['InitiatingProcessFolderPath']))
    and (grep('\\mstsc.exe', this['FolderPath']) or grep('mstsc.exe', this['ProcessVersionInfoOriginalFileName']))
  sigma_id: ff3b6b39-e765-42f9-bb2c-ea6761e0e0f6
- name: Msxsl.EXE Execution
  query: grep('\\msxsl.exe', this['FolderPath'])
  sigma_id: 9e50a8b3-dd05-4eb8-9153-bdb6b79d50b0
- name: Remote XSL Execution Via Msxsl.EXE
  query: grep('\\msxsl.exe', this['FolderPath']) and grep('http', this['ProcessCommandLine'])
  sigma_id: 75d0a94e-6252-448d-a7be-d953dff527bb
- name: Suspicious Group And Account Reconnaissance Activity Using Net.EXE
  query: "(grep('\\\\net.exe', this['FolderPath']) or grep('\\\\net1.exe', this['FolderPath'])\
    \ or this['ProcessVersionInfoOriginalFileName'] in ['net.exe', 'net1.exe']) and\
    \ ((grep(' group ', this['ProcessCommandLine']) or grep(' localgroup ', this['ProcessCommandLine']))\
    \ and (grep('domain admins', this['ProcessCommandLine']) or grep(' administrator',\
    \ this['ProcessCommandLine']) or grep(' administrateur', this['ProcessCommandLine'])\
    \ or grep('enterprise admins', this['ProcessCommandLine']) or grep('Exchange Trusted\
    \ Subsystem', this['ProcessCommandLine']) or grep('Remote Desktop Users', this['ProcessCommandLine'])\
    \ or grep('Utilisateurs du Bureau \xE0 distance', this['ProcessCommandLine'])\
    \ or grep('Usuarios de escritorio remoto', this['ProcessCommandLine']) or grep('\
    \ /do', this['ProcessCommandLine'])) and not grep(' /add', this['ProcessCommandLine'])\
    \ or grep(' accounts ', this['ProcessCommandLine']) and grep(' /do', this['ProcessCommandLine']))"
  sigma_id: d95de845-b83c-4a9a-8a6a-4fc802ebf6c0
- name: Windows Admin Share Mount Via Net.EXE
  query: (grep('\\net.exe', this['FolderPath']) or grep('\\net1.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['net.exe', 'net1.exe']) and
    grep(' use ', this['ProcessCommandLine']) and (grep(' \\', this['ProcessCommandLine'])
    or grep('\\', this['ProcessCommandLine']) or grep('$', this['ProcessCommandLine']))
  sigma_id: 3abd6094-7027-475f-9630-8ab9be7b9725
- name: Windows Internet Hosted WebDav Share Mount Via Net.EXE
  query: (grep('\\net.exe', this['FolderPath']) or grep('\\net1.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['net.exe', 'net1.exe']) and
    grep(' use ', this['ProcessCommandLine']) and grep(' http', this['ProcessCommandLine'])
  sigma_id: 7e6237fe-3ddb-438f-9381-9bf9de5af8d0
- name: Password Provided In Command Line Of Net.EXE
  query: (grep('\\net.exe', this['FolderPath']) or grep('\\net1.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['net.exe', 'net1.exe']) and
    grep(' use ', this['ProcessCommandLine']) and (grep(':', this['ProcessCommandLine'])
    or grep('\\', this['ProcessCommandLine'])) and (grep('/USER:', this['ProcessCommandLine'])
    or grep(' ', this['ProcessCommandLine'])) and not grep(' ', this['ProcessCommandLine'])
  sigma_id: d4498716-1d52-438f-8084-4a603157d131
- name: New User Created Via Net.EXE
  query: (grep('\\net.exe', this['FolderPath']) or grep('\\net1.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['net.exe', 'net1.exe']) and
    grep('user', this['ProcessCommandLine']) and grep('add', this['ProcessCommandLine'])
  sigma_id: cd219ff3-fa99-45d4-8380-a7d15116c6dc
- name: New User Created Via Net.EXE With Never Expire Option
  query: (grep('\\net.exe', this['FolderPath']) or grep('\\net1.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['net.exe', 'net1.exe']) and
    grep('user', this['ProcessCommandLine']) and grep('add', this['ProcessCommandLine'])
    and grep('expires:never', this['ProcessCommandLine'])
  sigma_id: b9f0e6f5-09b4-4358-bae4-08408705bd5c
- name: Suspicious Manipulation Of Default Accounts Via Net.EXE
  query: "(grep('\\\\net.exe', this['FolderPath']) or grep('\\\\net1.exe', this['FolderPath'])\
    \ or this['ProcessVersionInfoOriginalFileName'] in ['net.exe', 'net1.exe']) and\
    \ grep(' user ', this['ProcessCommandLine']) and (grep(' J\xE4rjestelm\xE4nvalvoja\
    \ ', this['ProcessCommandLine']) or grep(' Rendszergazda ', this['ProcessCommandLine'])\
    \ or grep(' \u0410\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\
    \u043E\u0440 ', this['ProcessCommandLine']) or grep(' Administrateur ', this['ProcessCommandLine'])\
    \ or grep(' Administrador ', this['ProcessCommandLine']) or grep(' Administrat\xF6\
    r ', this['ProcessCommandLine']) or grep(' Administrator ', this['ProcessCommandLine'])\
    \ or grep(' guest ', this['ProcessCommandLine']) or grep(' DefaultAccount ', this['ProcessCommandLine'])\
    \ or grep(' \"J\xE4rjestelm\xE4nvalvoja\" ', this['ProcessCommandLine']) or grep('\
    \ \"Rendszergazda\" ', this['ProcessCommandLine']) or grep(' \"\u0410\u0434\u043C\
    \u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\u0440\" ', this['ProcessCommandLine'])\
    \ or grep(' \"Administrateur\" ', this['ProcessCommandLine']) or grep(' \"Administrador\"\
    \ ', this['ProcessCommandLine']) or grep(' \"Administrat\xF6r\" ', this['ProcessCommandLine'])\
    \ or grep(' \"Administrator\" ', this['ProcessCommandLine']) or grep(' \"guest\"\
    \ ', this['ProcessCommandLine']) or grep(' \"DefaultAccount\" ', this['ProcessCommandLine'])\
    \ or grep(' \\'J\xE4rjestelm\xE4nvalvoja\\' ', this['ProcessCommandLine']) or\
    \ grep(' \\'Rendszergazda\\' ', this['ProcessCommandLine']) or grep(' \\'\u0410\
    \u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\u0440\\' ',\
    \ this['ProcessCommandLine']) or grep(' \\'Administrateur\\' ', this['ProcessCommandLine'])\
    \ or grep(' \\'Administrador\\' ', this['ProcessCommandLine']) or grep(' \\'Administrat\xF6\
    r\\' ', this['ProcessCommandLine']) or grep(' \\'Administrator\\' ', this['ProcessCommandLine'])\
    \ or grep(' \\'guest\\' ', this['ProcessCommandLine']) or grep(' \\'DefaultAccount\\\
    ' ', this['ProcessCommandLine'])) and not (grep('guest', this['ProcessCommandLine'])\
    \ and grep('/active no', this['ProcessCommandLine']))"
  sigma_id: 5b768e71-86f2-4879-b448-81061cbae951
- name: New Firewall Rule Added Via Netsh.EXE
  query: (grep('\\netsh.exe', this['FolderPath']) or grep('netsh.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' firewall ', this['ProcessCommandLine']) and grep(' add ', this['ProcessCommandLine'])
    and not ((grep('advfirewall firewall add rule name=Dropbox dir=in action=allow
    "program=', this['ProcessCommandLine']) or grep(':\\Program Files (x86)\\Dropbox\\Client\\Dropbox.exe"
    enable=yes profile=Any', this['ProcessCommandLine'])) or (grep('advfirewall firewall
    add rule name=Dropbox dir=in action=allow "program=', this['ProcessCommandLine'])
    or grep(':\\Program Files\\Dropbox\\Client\\Dropbox.exe" enable=yes profile=Any',
    this['ProcessCommandLine'])))
  sigma_id: cd5cfd80-aa5f-44c0-9c20-108c4ae12e3c
- name: Suspicious Program Location Whitelisted In Firewall Via Netsh.EXE
  query: (grep('\\netsh.exe', this['FolderPath']) or grep('netsh.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('firewall', this['ProcessCommandLine']) and grep('add', this['ProcessCommandLine'])
    and grep('allowedprogram', this['ProcessCommandLine']) or grep('advfirewall',
    this['ProcessCommandLine']) and grep('firewall', this['ProcessCommandLine']) and
    grep('add', this['ProcessCommandLine']) and grep('rule', this['ProcessCommandLine'])
    and grep('action=allow', this['ProcessCommandLine']) and grep('program=', this['ProcessCommandLine']))
    and (grep(':\\$Recycle.bin\\', this['ProcessCommandLine']) or grep(':\\RECYCLER.BIN\\',
    this['ProcessCommandLine']) or grep(':\\RECYCLERS.BIN\\', this['ProcessCommandLine'])
    or grep(':\\SystemVolumeInformation\\', this['ProcessCommandLine']) or grep(':\\Temp\\',
    this['ProcessCommandLine']) or grep(':\\Users\\Default\\', this['ProcessCommandLine'])
    or grep(':\\Users\\Desktop\\', this['ProcessCommandLine']) or grep(':\\Users\\Public\\',
    this['ProcessCommandLine']) or grep(':\\Windows\\addins\\', this['ProcessCommandLine'])
    or grep(':\\Windows\\cursors\\', this['ProcessCommandLine']) or grep(':\\Windows\\debug\\',
    this['ProcessCommandLine']) or grep(':\\Windows\\drivers\\', this['ProcessCommandLine'])
    or grep(':\\Windows\\fonts\\', this['ProcessCommandLine']) or grep(':\\Windows\\help\\',
    this['ProcessCommandLine']) or grep(':\\Windows\\system32\\tasks\\', this['ProcessCommandLine'])
    or grep(':\\Windows\\Tasks\\', this['ProcessCommandLine']) or grep(':\\Windows\\Temp\\',
    this['ProcessCommandLine']) or grep('\\Downloads\\', this['ProcessCommandLine'])
    or grep('\\Local Settings\\Temporary Internet Files\\', this['ProcessCommandLine'])
    or grep('\\Temporary Internet Files\\Content.Outlook\\', this['ProcessCommandLine'])
    or grep('%Public%\\', this['ProcessCommandLine']) or grep('%TEMP%', this['ProcessCommandLine'])
    or grep('%TMP%', this['ProcessCommandLine']))
  sigma_id: a35f5a72-f347-4e36-8895-9869b0d5fc6d
- name: RDP Connection Allowed Via Netsh.EXE
  query: (grep('\\netsh.exe', this['FolderPath']) or grep('netsh.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('firewall ', this['ProcessCommandLine']) and grep('add ', this['ProcessCommandLine'])
    and grep('tcp ', this['ProcessCommandLine']) and grep('3389', this['ProcessCommandLine'])
    and (grep('portopening', this['ProcessCommandLine']) or grep('allow', this['ProcessCommandLine']))
  sigma_id: 01aeb693-138d-49d2-9403-c4f52d7d3d62
- name: Firewall Rule Deleted Via Netsh.EXE
  query: (grep('\\netsh.exe', this['FolderPath']) or grep('netsh.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('firewall', this['ProcessCommandLine']) and grep('delete ', this['ProcessCommandLine'])
    and not (grep('\\Dropbox.exe', this['InitiatingProcessFolderPath']) and grep('name=Dropbox',
    this['ProcessCommandLine']))
  sigma_id: 1a5fefe6-734f-452e-a07d-fc1c35bce4b2
- name: Firewall Disabled via Netsh.EXE
  query: (grep('\\netsh.exe', this['FolderPath']) or grep('netsh.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('firewall', this['ProcessCommandLine']) and grep('set', this['ProcessCommandLine'])
    and grep('opmode', this['ProcessCommandLine']) and grep('disable', this['ProcessCommandLine'])
    or grep('advfirewall', this['ProcessCommandLine']) and grep('set', this['ProcessCommandLine'])
    and grep('state', this['ProcessCommandLine']) and grep('off', this['ProcessCommandLine']))
  sigma_id: 57c4bf16-227f-4394-8ec7-1b745ee061c3
- name: Netsh Allow Group Policy on Microsoft Defender Firewall
  query: (grep('\\netsh.exe', this['FolderPath']) or grep('netsh.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('advfirewall', this['ProcessCommandLine']) and grep('firewall', this['ProcessCommandLine'])
    and grep('set', this['ProcessCommandLine']) and grep('rule', this['ProcessCommandLine'])
    and grep('group=', this['ProcessCommandLine']) and grep('new', this['ProcessCommandLine'])
    and grep('enable=Yes', this['ProcessCommandLine'])
  sigma_id: 347906f3-e207-4d18-ae5b-a9403d6bcdef
- name: Firewall Rule Update Via Netsh.EXE
  query: (grep('\\netsh.exe', this['FolderPath']) or grep('netsh.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' firewall ', this['ProcessCommandLine']) and grep(' set ', this['ProcessCommandLine'])
  sigma_id: a70dcb37-3bee-453a-99df-d0c683151be6
- name: Potential Persistence Via Netsh Helper DLL
  query: (grep('netsh.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\netsh.exe',
    this['FolderPath'])) and grep('add', this['ProcessCommandLine']) and grep('helper',
    this['ProcessCommandLine'])
  sigma_id: 56321594-9087-49d9-bf10-524fe8479452
- name: New Network Trace Capture Started Via Netsh.EXE
  query: (grep('\\netsh.exe', this['FolderPath']) or grep('netsh.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('trace', this['ProcessCommandLine']) and grep('start', this['ProcessCommandLine'])
  sigma_id: d3c3861d-c504-4c77-ba55-224ba82d0118
- name: New Port Forwarding Rule Added Via Netsh.EXE
  query: (grep('\\netsh.exe', this['FolderPath']) or grep('netsh.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('interface', this['ProcessCommandLine']) and grep('portproxy', this['ProcessCommandLine'])
    and grep('add', this['ProcessCommandLine']) and grep('v4tov4', this['ProcessCommandLine'])
    or grep('i ', this['ProcessCommandLine']) and grep('p ', this['ProcessCommandLine'])
    and grep('a ', this['ProcessCommandLine']) and grep('v ', this['ProcessCommandLine'])
    or grep('connectp', this['ProcessCommandLine']) and grep('listena', this['ProcessCommandLine'])
    and grep('c=', this['ProcessCommandLine']))
  sigma_id: 322ed9ec-fcab-4f67-9a34-e7c6aef43614
- name: RDP Port Forwarding Rule Added Via Netsh.EXE
  query: (grep('\\netsh.exe', this['FolderPath']) or grep('netsh.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' i', this['ProcessCommandLine']) and grep(' p', this['ProcessCommandLine'])
    and grep('=3389', this['ProcessCommandLine']) and grep(' c', this['ProcessCommandLine'])
  sigma_id: 782d6f3e-4c5d-4b8c-92a3-1d05fed72e63
- name: Harvesting Of Wifi Credentials Via Netsh.EXE
  query: (grep('\\netsh.exe', this['FolderPath']) or grep('netsh.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('wlan', this['ProcessCommandLine']) and grep(' s', this['ProcessCommandLine'])
    and grep(' p', this['ProcessCommandLine']) and grep(' k', this['ProcessCommandLine'])
    and grep('=clear', this['ProcessCommandLine'])
  sigma_id: 42b1a5b8-353f-4f10-b256-39de4467faff
- name: Potential Recon Activity Via Nltest.EXE
  query: (grep('\\nltest.exe', this['FolderPath']) or grep('nltestrk.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('server', this['ProcessCommandLine']) and grep('query', this['ProcessCommandLine'])
    or grep('/user', this['ProcessCommandLine']) or grep('all_trusts', this['ProcessCommandLine'])
    or grep('dclist:', this['ProcessCommandLine']) or grep('dnsgetdc:', this['ProcessCommandLine'])
    or grep('domain_trusts', this['ProcessCommandLine']) or grep('dsgetdc:', this['ProcessCommandLine'])
    or grep('parentdomain', this['ProcessCommandLine']) or grep('trusted_domains',
    this['ProcessCommandLine']))
  sigma_id: 5cc90652-4cbd-4241-aa3b-4b462fa5a248
- name: Potential Arbitrary Code Execution Via Node.EXE
  query: grep('\\node.exe', this['FolderPath']) and (grep(' -e ', this['ProcessCommandLine'])
    or grep(' --eval ', this['ProcessCommandLine'])) and grep('.exec(', this['ProcessCommandLine'])
    and grep('net.socket', this['ProcessCommandLine']) and grep('.connect', this['ProcessCommandLine'])
    and grep('child_process', this['ProcessCommandLine'])
  sigma_id: 6640f31c-01ad-49b5-beb5-83498a5cd8bd
- name: Node Process Executions
  query: grep('\\Adobe Creative Cloud Experience\\libs\\node.exe', this['FolderPath'])
    and not grep('Adobe Creative Cloud Experience\\js', this['ProcessCommandLine'])
  sigma_id: df1f26d3-bea7-4700-9ea2-ad3e990cf90e
- name: Network Reconnaissance Activity
  query: grep('nslookup', this['ProcessCommandLine']) and grep('_ldap._tcp.dc._msdcs.',
    this['ProcessCommandLine'])
  sigma_id: e6313acd-208c-44fc-a0ff-db85d572e90e
- name: Nslookup PowerShell Download Cradle - ProcessCreation
  query: (grep('\\nslookup.exe', this['FolderPath']) or grep('\\nslookup.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('\\powershell.exe', this['InitiatingProcessFolderPath']) or grep('\\pwsh.exe',
    this['InitiatingProcessFolderPath'])) and (grep(' -q=txt ', this['ProcessCommandLine'])
    or grep(' -querytype=txt ', this['ProcessCommandLine']))
  sigma_id: 1b3b01c7-84e9-4072-86e5-fc285a41ff23
- name: Suspicious Usage Of Active Directory Diagnostic Tool (ntdsutil.exe)
  query: (grep('\\ntdsutil.exe', this['FolderPath']) or grep('ntdsutil.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('snapshot', this['ProcessCommandLine']) and grep('mount ', this['ProcessCommandLine'])
    or grep('ac', this['ProcessCommandLine']) and grep(' i', this['ProcessCommandLine'])
    and grep(' ntds', this['ProcessCommandLine']))
  sigma_id: a58353df-af43-4753-bad0-cd83ef35eef5
- name: Invocation of Active Directory Diagnostic Tool (ntdsutil.exe)
  query: grep('\\ntdsutil.exe', this['FolderPath'])
  sigma_id: 2afafd61-6aae-4df4-baed-139fa1f4c345
- name: Driver/DLL Installation Via Odbcconf.EXE
  query: (grep('\\odbcconf.exe', this['FolderPath']) or grep('odbcconf.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('INSTALLDRIVER ', this['ProcessCommandLine']) and grep('.dll', this['ProcessCommandLine'])
  sigma_id: 3f5491e2-8db8-496b-9e95-1029fce852d4
- name: Suspicious Driver/DLL Installation Via Odbcconf.EXE
  query: (grep('\\odbcconf.exe', this['FolderPath']) or grep('odbcconf.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('INSTALLDRIVER ', this['ProcessCommandLine']) and not grep('.dll', this['ProcessCommandLine'])
  sigma_id: cb0fe7c5-f3a3-484d-aa25-d350a7912729
- name: Odbcconf.EXE Suspicious DLL Location
  query: (grep('\\odbcconf.exe', this['FolderPath']) or grep('odbcconf.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep(':\\PerfLogs\\', this['ProcessCommandLine']) or grep(':\\ProgramData\\',
    this['ProcessCommandLine']) or grep(':\\Temp\\', this['ProcessCommandLine']) or
    grep(':\\Users\\Public\\', this['ProcessCommandLine']) or grep(':\\Windows\\Registration\\CRMLog',
    this['ProcessCommandLine']) or grep(':\\Windows\\System32\\com\\dmp\\', this['ProcessCommandLine'])
    or grep(':\\Windows\\System32\\FxsTmp\\', this['ProcessCommandLine']) or grep(':\\Windows\\System32\\Microsoft\\Crypto\\RSA\\MachineKeys\\',
    this['ProcessCommandLine']) or grep(':\\Windows\\System32\\spool\\drivers\\color\\',
    this['ProcessCommandLine']) or grep(':\\Windows\\System32\\spool\\PRINTERS\\',
    this['ProcessCommandLine']) or grep(':\\Windows\\System32\\spool\\SERVERS\\',
    this['ProcessCommandLine']) or grep(':\\Windows\\System32\\Tasks_Migrated\\',
    this['ProcessCommandLine']) or grep(':\\Windows\\System32\\Tasks\\Microsoft\\Windows\\SyncCenter\\',
    this['ProcessCommandLine']) or grep(':\\Windows\\SysWOW64\\com\\dmp\\', this['ProcessCommandLine'])
    or grep(':\\Windows\\SysWOW64\\FxsTmp\\', this['ProcessCommandLine']) or grep(':\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\PLA\\System\\',
    this['ProcessCommandLine']) or grep(':\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\SyncCenter\\',
    this['ProcessCommandLine']) or grep(':\\Windows\\Tasks\\', this['ProcessCommandLine'])
    or grep(':\\Windows\\Temp\\', this['ProcessCommandLine']) or grep(':\\Windows\\Tracing\\',
    this['ProcessCommandLine']) or grep('\\AppData\\Local\\Temp\\', this['ProcessCommandLine'])
    or grep('\\AppData\\Roaming\\', this['ProcessCommandLine']))
  sigma_id: 6b65c28e-11f3-46cb-902a-68f2cafaf474
- name: New DLL Registered Via Odbcconf.EXE
  query: (grep('\\odbcconf.exe', this['FolderPath']) or grep('odbcconf.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('REGSVR ', this['ProcessCommandLine']) and grep('.dll', this['ProcessCommandLine'])
  sigma_id: 9f0a8bf3-a65b-440a-8c1e-5cb1547c8e70
- name: Potentially Suspicious DLL Registered Via Odbcconf.EXE
  query: (grep('\\odbcconf.exe', this['FolderPath']) or grep('odbcconf.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('REGSVR ', this['ProcessCommandLine']) and not grep('.dll', this['ProcessCommandLine'])
  sigma_id: ba4cfc11-d0fa-4d94-bf20-7c332c412e76
- name: Response File Execution Via Odbcconf.EXE
  query: "(grep('\\\\odbcconf.exe', this['FolderPath']) or grep('odbcconf.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep(' -f ', this['ProcessCommandLine']) or grep(' /f ', this['ProcessCommandLine'])\
    \ or grep(' \u2013f ', this['ProcessCommandLine']) or grep(' \u2014f ', this['ProcessCommandLine'])\
    \ or grep(' \u2015f ', this['ProcessCommandLine'])) and grep('.rsp', this['ProcessCommandLine'])"
  sigma_id: 5f03babb-12db-4eec-8c82-7b4cb5580868
- name: Suspicious Response File Execution Via Odbcconf.EXE
  query: "(grep('\\\\odbcconf.exe', this['FolderPath']) or grep('odbcconf.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep(' -f ', this['ProcessCommandLine']) or grep(' /f ', this['ProcessCommandLine'])\
    \ or grep(' \u2013f ', this['ProcessCommandLine']) or grep(' \u2014f ', this['ProcessCommandLine'])\
    \ or grep(' \u2015f ', this['ProcessCommandLine'])) and not (grep('.rsp', this['ProcessCommandLine'])\
    \ or grep('C:\\\\Windows\\\\System32\\\\runonce.exe', this['InitiatingProcessFolderPath'])\
    \ and grep('C:\\\\Windows\\\\System32\\\\odbcconf.exe', this['FolderPath']) and\
    \ grep('.exe /E /F \"C:\\\\WINDOWS\\\\system32\\\\odbcconf.tmp\"', this['ProcessCommandLine']))"
  sigma_id: 2d32dd6f-3196-4093-b9eb-1ad8ab088ca5
- name: Uncommon Child Process Spawned By Odbcconf.EXE
  query: grep('\\odbcconf.exe', this['InitiatingProcessFolderPath'])
  sigma_id: 8e3c7994-131e-4ba5-b6ea-804d49113a26
- name: Potential Arbitrary File Download Using Office Application
  query: (grep('\\EXCEL.EXE', this['FolderPath']) or grep('\\POWERPNT.EXE', this['FolderPath'])
    or grep('\\WINWORD.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['Excel.exe', 'POWERPNT.EXE', 'WinWord.exe']) and (grep('http://', this['ProcessCommandLine'])
    or grep('https://', this['ProcessCommandLine']))
  sigma_id: 4ae3e30b-b03f-43aa-87e3-b622f4048eed
- name: Potential Excel.EXE DCOM Lateral Movement Via ActivateMicrosoftApp
  query: grep('\\excel.exe', this['InitiatingProcessFolderPath']) and (this['ProcessVersionInfoOriginalFileName']
    in ['foxprow.exe', 'schdplus.exe', 'winproj.exe'] or grep('\\foxprow.exe', this['FolderPath'])
    or grep('\\schdplus.exe', this['FolderPath']) or grep('\\winproj.exe', this['FolderPath']))
  sigma_id: 551d9c1f-816c-445b-a7a6-7a3864720d60
- name: Potentially Suspicious Office Document Executed From Trusted Location
  query: (grep('\\explorer.exe', this['InitiatingProcessFolderPath']) or grep('\\dopus.exe',
    this['InitiatingProcessFolderPath'])) and (grep('\\EXCEL.EXE', this['FolderPath'])
    or grep('\\POWERPNT.EXE', this['FolderPath']) or grep('\\WINWORD.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['Excel.exe', 'POWERPNT.EXE',
    'WinWord.exe']) and (grep('\\AppData\\Roaming\\Microsoft\\Templates', this['ProcessCommandLine'])
    or grep('\\AppData\\Roaming\\Microsoft\\Word\\Startup\\', this['ProcessCommandLine'])
    or grep('\\Microsoft Office\\root\\Templates\\', this['ProcessCommandLine']) or
    grep('\\Microsoft Office\\Templates\\', this['ProcessCommandLine'])) and not (grep('.dotx',
    this['ProcessCommandLine']) or grep('.xltx', this['ProcessCommandLine']) or grep('.potx',
    this['ProcessCommandLine']))
  sigma_id: f99abdf0-6283-4e71-bd2b-b5c048a94743
- name: OneNote.EXE Execution of Malicious Embedded Scripts
  query: grep('\\onenote.exe', this['InitiatingProcessFolderPath']) and (grep('\\cmd.exe',
    this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']) or grep('\\mshta.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath'])) and (grep('\\exported\\',
    this['ProcessCommandLine']) or grep('\\onenoteofflinecache_files\\', this['ProcessCommandLine']))
  sigma_id: 84b1706c-932a-44c4-ae28-892b28a25b94
- name: Suspicious Microsoft OneNote Child Process
  query: grep('\\onenote.exe', this['InitiatingProcessFolderPath']) and (this['ProcessVersionInfoOriginalFileName']
    in ['bitsadmin.exe', 'CertOC.exe', 'CertUtil.exe', 'Cmd.Exe', 'CMSTP.EXE', 'cscript.exe',
    'curl.exe', 'HH.exe', 'IEExec.exe', 'InstallUtil.exe', 'javaw.exe', 'Microsoft.Workflow.Compiler.exe',
    'msdt.exe', 'MSHTA.EXE', 'msiexec.exe', 'Msxsl.exe', 'odbcconf.exe', 'pcalua.exe',
    'PowerShell.EXE', 'RegAsm.exe', 'RegSvcs.exe', 'REGSVR32.exe', 'RUNDLL32.exe',
    'schtasks.exe', 'ScriptRunner.exe', 'wmic.exe', 'WorkFolders.exe', 'wscript.exe']
    or grep('\\AppVLP.exe', this['FolderPath']) or grep('\\bash.exe', this['FolderPath'])
    or grep('\\bitsadmin.exe', this['FolderPath']) or grep('\\certoc.exe', this['FolderPath'])
    or grep('\\certutil.exe', this['FolderPath']) or grep('\\cmd.exe', this['FolderPath'])
    or grep('\\cmstp.exe', this['FolderPath']) or grep('\\control.exe', this['FolderPath'])
    or grep('\\cscript.exe', this['FolderPath']) or grep('\\curl.exe', this['FolderPath'])
    or grep('\\forfiles.exe', this['FolderPath']) or grep('\\hh.exe', this['FolderPath'])
    or grep('\\ieexec.exe', this['FolderPath']) or grep('\\installutil.exe', this['FolderPath'])
    or grep('\\javaw.exe', this['FolderPath']) or grep('\\mftrace.exe', this['FolderPath'])
    or grep('\\Microsoft.Workflow.Compiler.exe', this['FolderPath']) or grep('\\msbuild.exe',
    this['FolderPath']) or grep('\\msdt.exe', this['FolderPath']) or grep('\\mshta.exe',
    this['FolderPath']) or grep('\\msidb.exe', this['FolderPath']) or grep('\\msiexec.exe',
    this['FolderPath']) or grep('\\msxsl.exe', this['FolderPath']) or grep('\\odbcconf.exe',
    this['FolderPath']) or grep('\\pcalua.exe', this['FolderPath']) or grep('\\powershell.exe',
    this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']) or grep('\\regasm.exe',
    this['FolderPath']) or grep('\\regsvcs.exe', this['FolderPath']) or grep('\\regsvr32.exe',
    this['FolderPath']) or grep('\\rundll32.exe', this['FolderPath']) or grep('\\schtasks.exe',
    this['FolderPath']) or grep('\\scrcons.exe', this['FolderPath']) or grep('\\scriptrunner.exe',
    this['FolderPath']) or grep('\\sh.exe', this['FolderPath']) or grep('\\svchost.exe',
    this['FolderPath']) or grep('\\verclsid.exe', this['FolderPath']) or grep('\\wmic.exe',
    this['FolderPath']) or grep('\\workfolders.exe', this['FolderPath']) or grep('\\wscript.exe',
    this['FolderPath']) or grep('\\explorer.exe', this['FolderPath']) and (grep('.hta',
    this['ProcessCommandLine']) or grep('.vb', this['ProcessCommandLine']) or grep('.wsh',
    this['ProcessCommandLine']) or grep('.js', this['ProcessCommandLine']) or grep('.ps',
    this['ProcessCommandLine']) or grep('.scr', this['ProcessCommandLine']) or grep('.pif',
    this['ProcessCommandLine']) or grep('.bat', this['ProcessCommandLine']) or grep('.cmd',
    this['ProcessCommandLine'])) or grep('\\AppData\\', this['FolderPath']) or grep('\\Users\\Public\\',
    this['FolderPath']) or grep('\\ProgramData\\', this['FolderPath']) or grep('\\Windows\\Tasks\\',
    this['FolderPath']) or grep('\\Windows\\Temp\\', this['FolderPath']) or grep('\\Windows\\System32\\Tasks\\',
    this['FolderPath'])) and not (grep('\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe',
    this['FolderPath']) and grep('-Embedding', this['ProcessCommandLine']) or grep('\\AppData\\Local\\Microsoft\\OneDrive\\',
    this['FolderPath']) and grep('\\FileCoAuth.exe', this['FolderPath']) and grep('-Embedding',
    this['ProcessCommandLine']))
  sigma_id: c27515df-97a9-4162-8a60-dc0eeb51b775
- name: Outlook EnableUnsafeClientMailRules Setting Enabled
  query: grep('\\Outlook\\Security\\EnableUnsafeClientMailRules', this['ProcessCommandLine'])
  sigma_id: 55f0a3a1-846e-40eb-8273-677371b8d912
- name: Suspicious Execution From Outlook Temporary Folder
  query: grep('\\Temporary Internet Files\\Content.Outlook\\', this['FolderPath'])
  sigma_id: a018fdc3-46a3-44e5-9afb-2cd4af1d4b39
- name: Suspicious Outlook Child Process
  query: grep('\\OUTLOOK.EXE', this['InitiatingProcessFolderPath']) and (grep('\\AppVLP.exe',
    this['FolderPath']) or grep('\\bash.exe', this['FolderPath']) or grep('\\cmd.exe',
    this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']) or grep('\\forfiles.exe',
    this['FolderPath']) or grep('\\hh.exe', this['FolderPath']) or grep('\\mftrace.exe',
    this['FolderPath']) or grep('\\msbuild.exe', this['FolderPath']) or grep('\\msdt.exe',
    this['FolderPath']) or grep('\\mshta.exe', this['FolderPath']) or grep('\\msiexec.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\schtasks.exe',
    this['FolderPath']) or grep('\\scrcons.exe', this['FolderPath']) or grep('\\scriptrunner.exe',
    this['FolderPath']) or grep('\\sh.exe', this['FolderPath']) or grep('\\svchost.exe',
    this['FolderPath']) or grep('\\wmic.exe', this['FolderPath']) or grep('\\wscript.exe',
    this['FolderPath']))
  sigma_id: 208748f7-881d-47ac-a29c-07ea84bf691d
- name: Suspicious Remote Child Process From Outlook
  query: grep('\\outlook.exe', this['InitiatingProcessFolderPath']) and grep('\\',
    this['FolderPath'])
  sigma_id: e212d415-0e93-435f-9e1a-f29005bb4723
- name: Suspicious Binary In User Directory Spawned From Office Application
  query: (grep('\\WINWORD.EXE', this['InitiatingProcessFolderPath']) or grep('\\EXCEL.EXE',
    this['InitiatingProcessFolderPath']) or grep('\\POWERPNT.exe', this['InitiatingProcessFolderPath'])
    or grep('\\MSPUB.exe', this['InitiatingProcessFolderPath']) or grep('\\VISIO.exe',
    this['InitiatingProcessFolderPath']) or grep('\\MSACCESS.exe', this['InitiatingProcessFolderPath'])
    or grep('\\EQNEDT32.exe', this['InitiatingProcessFolderPath'])) and grep('C:\\users\\',
    this['FolderPath']) and grep('.exe', this['FolderPath']) and not grep('\\Teams.exe',
    this['FolderPath'])
  sigma_id: aa3a6f94-890e-4e22-b634-ffdfd54792cc
- name: Suspicious Microsoft Office Child Process
  query: (grep('\\EQNEDT32.EXE', this['InitiatingProcessFolderPath']) or grep('\\EXCEL.EXE',
    this['InitiatingProcessFolderPath']) or grep('\\MSACCESS.EXE', this['InitiatingProcessFolderPath'])
    or grep('\\MSPUB.exe', this['InitiatingProcessFolderPath']) or grep('\\ONENOTE.EXE',
    this['InitiatingProcessFolderPath']) or grep('\\POWERPNT.exe', this['InitiatingProcessFolderPath'])
    or grep('\\VISIO.exe', this['InitiatingProcessFolderPath']) or grep('\\WINWORD.EXE',
    this['InitiatingProcessFolderPath']) or grep('\\wordpad.exe', this['InitiatingProcessFolderPath'])
    or grep('\\wordview.exe', this['InitiatingProcessFolderPath'])) and (this['ProcessVersionInfoOriginalFileName']
    in ['bitsadmin.exe', 'CertOC.exe', 'CertUtil.exe', 'Cmd.Exe', 'CMSTP.EXE', 'cscript.exe',
    'curl.exe', 'HH.exe', 'IEExec.exe', 'InstallUtil.exe', 'javaw.exe', 'Microsoft.Workflow.Compiler.exe',
    'msdt.exe', 'MSHTA.EXE', 'msiexec.exe', 'Msxsl.exe', 'odbcconf.exe', 'pcalua.exe',
    'PowerShell.EXE', 'RegAsm.exe', 'RegSvcs.exe', 'REGSVR32.exe', 'RUNDLL32.exe',
    'schtasks.exe', 'ScriptRunner.exe', 'wmic.exe', 'WorkFolders.exe', 'wscript.exe']
    or grep('\\AppVLP.exe', this['FolderPath']) or grep('\\bash.exe', this['FolderPath'])
    or grep('\\bitsadmin.exe', this['FolderPath']) or grep('\\certoc.exe', this['FolderPath'])
    or grep('\\certutil.exe', this['FolderPath']) or grep('\\cmd.exe', this['FolderPath'])
    or grep('\\cmstp.exe', this['FolderPath']) or grep('\\control.exe', this['FolderPath'])
    or grep('\\cscript.exe', this['FolderPath']) or grep('\\curl.exe', this['FolderPath'])
    or grep('\\forfiles.exe', this['FolderPath']) or grep('\\hh.exe', this['FolderPath'])
    or grep('\\ieexec.exe', this['FolderPath']) or grep('\\installutil.exe', this['FolderPath'])
    or grep('\\javaw.exe', this['FolderPath']) or grep('\\mftrace.exe', this['FolderPath'])
    or grep('\\Microsoft.Workflow.Compiler.exe', this['FolderPath']) or grep('\\msbuild.exe',
    this['FolderPath']) or grep('\\msdt.exe', this['FolderPath']) or grep('\\mshta.exe',
    this['FolderPath']) or grep('\\msidb.exe', this['FolderPath']) or grep('\\msiexec.exe',
    this['FolderPath']) or grep('\\msxsl.exe', this['FolderPath']) or grep('\\odbcconf.exe',
    this['FolderPath']) or grep('\\pcalua.exe', this['FolderPath']) or grep('\\powershell.exe',
    this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']) or grep('\\regasm.exe',
    this['FolderPath']) or grep('\\regsvcs.exe', this['FolderPath']) or grep('\\regsvr32.exe',
    this['FolderPath']) or grep('\\rundll32.exe', this['FolderPath']) or grep('\\schtasks.exe',
    this['FolderPath']) or grep('\\scrcons.exe', this['FolderPath']) or grep('\\scriptrunner.exe',
    this['FolderPath']) or grep('\\sh.exe', this['FolderPath']) or grep('\\svchost.exe',
    this['FolderPath']) or grep('\\verclsid.exe', this['FolderPath']) or grep('\\wmic.exe',
    this['FolderPath']) or grep('\\workfolders.exe', this['FolderPath']) or grep('\\wscript.exe',
    this['FolderPath']) or grep('\\AppData\\', this['FolderPath']) or grep('\\Users\\Public\\',
    this['FolderPath']) or grep('\\ProgramData\\', this['FolderPath']) or grep('\\Windows\\Tasks\\',
    this['FolderPath']) or grep('\\Windows\\Temp\\', this['FolderPath']) or grep('\\Windows\\System32\\Tasks\\',
    this['FolderPath']))
  sigma_id: 438025f9-5856-4663-83f7-52f878a70a50
- name: Potential Arbitrary DLL Load Using Winword
  query: (grep('\\WINWORD.exe', this['FolderPath']) or grep('WinWord.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('/l ', this['ProcessCommandLine']) and grep('.dll', this['ProcessCommandLine'])
  sigma_id: f7375e28-5c14-432f-b8d1-1db26c832df3
- name: Potential Mpclient.DLL Sideloading Via OfflineScannerShell.EXE Execution
  query: (grep('\\OfflineScannerShell.exe', this['FolderPath']) or grep('OfflineScannerShell.exe',
    this['ProcessVersionInfoOriginalFileName'])) and not (grep('C:\\Program Files\\Windows
    Defender\\Offline\\', this['CurrentDirectory']) or false or this['CurrentDirectory']==null)
  sigma_id: 02b18447-ea83-4b1b-8805-714a8a34546a
- name: PDQ Deploy Remote Adminstartion Tool Execution
  query: grep('PDQ Deploy Console', this['ProcessVersionInfoFileDescription']) or
    grep('PDQ Deploy', this['ProcessVersionInfoProductName']) or grep('PDQ.com', this['ProcessVersionInfoCompanyName'])
    or grep('PDQDeployConsole.exe', this['ProcessVersionInfoOriginalFileName'])
  sigma_id: d679950c-abb7-43a6-80fb-2a480c4fc450
- name: Potentially Suspicious Execution Of PDQDeployRunner
  query: grep('\\PDQDeployRunner-', this['InitiatingProcessFolderPath']) and (grep('\\bash.exe',
    this['FolderPath']) or grep('\\certutil.exe', this['FolderPath']) or grep('\\cmd.exe',
    this['FolderPath']) or grep('\\csc.exe', this['FolderPath']) or grep('\\cscript.exe',
    this['FolderPath']) or grep('\\dllhost.exe', this['FolderPath']) or grep('\\mshta.exe',
    this['FolderPath']) or grep('\\msiexec.exe', this['FolderPath']) or grep('\\regsvr32.exe',
    this['FolderPath']) or grep('\\rundll32.exe', this['FolderPath']) or grep('\\scriptrunner.exe',
    this['FolderPath']) or grep('\\wmic.exe', this['FolderPath']) or grep('\\wscript.exe',
    this['FolderPath']) or grep('\\wsl.exe', this['FolderPath']) or grep(':\\ProgramData\\',
    this['FolderPath']) or grep(':\\Users\\Public\\', this['FolderPath']) or grep(':\\Windows\\TEMP\\',
    this['FolderPath']) or grep('\\AppData\\Local\\Temp', this['FolderPath']) or grep('
    -decode ', this['ProcessCommandLine']) or grep(' -enc ', this['ProcessCommandLine'])
    or grep(' -encodedcommand ', this['ProcessCommandLine']) or grep(' -w hidden',
    this['ProcessCommandLine']) or grep('DownloadString', this['ProcessCommandLine'])
    or grep('FromBase64String', this['ProcessCommandLine']) or grep('http', this['ProcessCommandLine'])
    or grep('iex ', this['ProcessCommandLine']) or grep('Invoke-', this['ProcessCommandLine']))
  sigma_id: 12b8e9f5-96b2-41e1-9a42-8c6779a5c184
- name: Perl Inline Command Execution
  query: (grep('\\perl.exe', this['FolderPath']) or grep('perl.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' -e', this['ProcessCommandLine'])
  sigma_id: f426547a-e0f7-441a-b63e-854ac5bdf54d
- name: Php Inline Command Execution
  query: (grep('\\php.exe', this['FolderPath']) or grep('php.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' -r', this['ProcessCommandLine'])
  sigma_id: d81871ef-5738-47ab-9797-7a9c90cd4bfb
- name: Ping Hex IP
  query: grep('\\ping.exe', this['FolderPath']) and grep('0x', this['ProcessCommandLine'])
  sigma_id: 1a0d4aba-7668-4365-9ce4-6d79ab088dfd
- name: PktMon.EXE Execution
  query: grep('\\pktmon.exe', this['FolderPath']) or grep('PktMon.exe', this['ProcessVersionInfoOriginalFileName'])
  sigma_id: f956c7c1-0f60-4bc5-b7d7-b39ab3c08908
- name: Suspicious Plink Port Forwarding
  query: grep('Command-line SSH, Telnet, and Rlogin client', this['ProcessVersionInfoFileDescription'])
    and grep(' -R ', this['ProcessCommandLine'])
  sigma_id: 48a61b29-389f-4032-b317-b30de6b95314
- name: Potential RDP Tunneling Via Plink
  query: grep('\\plink.exe', this['FolderPath']) and grep(':127.0.0.1:3389', this['ProcessCommandLine'])
    or grep('\\plink.exe', this['FolderPath']) and grep(':3389', this['ProcessCommandLine'])
    and (grep(' -P 443', this['ProcessCommandLine']) or grep(' -P 22', this['ProcessCommandLine']))
  sigma_id: f38ce0b9-5e97-4b47-a211-7dc8d8b871da
- name: Suspicious Powercfg Execution To Change Lock Screen Timeout
  query: (grep('\\powercfg.exe', this['FolderPath']) or grep('PowerCfg.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('/setacvalueindex ', this['ProcessCommandLine']) and grep('SCHEME_CURRENT',
    this['ProcessCommandLine']) and grep('SUB_VIDEO', this['ProcessCommandLine'])
    and grep('VIDEOCONLOCK', this['ProcessCommandLine']) or grep('-change ', this['ProcessCommandLine'])
    and grep('-standby-timeout-', this['ProcessCommandLine']))
  sigma_id: f8d6a15e-4bc8-4c27-8e5d-2b10f0b73e5b
- name: AADInternals PowerShell Cmdlets Execution - ProccessCreation
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.Exe', 'pwsh.dll'])
    and (grep('Add-AADInt', this['ProcessCommandLine']) or grep('ConvertTo-AADInt',
    this['ProcessCommandLine']) or grep('Disable-AADInt', this['ProcessCommandLine'])
    or grep('Enable-AADInt', this['ProcessCommandLine']) or grep('Export-AADInt',
    this['ProcessCommandLine']) or grep('Get-AADInt', this['ProcessCommandLine'])
    or grep('Grant-AADInt', this['ProcessCommandLine']) or grep('Install-AADInt',
    this['ProcessCommandLine']) or grep('Invoke-AADInt', this['ProcessCommandLine'])
    or grep('Join-AADInt', this['ProcessCommandLine']) or grep('New-AADInt', this['ProcessCommandLine'])
    or grep('Open-AADInt', this['ProcessCommandLine']) or grep('Read-AADInt', this['ProcessCommandLine'])
    or grep('Register-AADInt', this['ProcessCommandLine']) or grep('Remove-AADInt',
    this['ProcessCommandLine']) or grep('Restore-AADInt', this['ProcessCommandLine'])
    or grep('Search-AADInt', this['ProcessCommandLine']) or grep('Send-AADInt', this['ProcessCommandLine'])
    or grep('Set-AADInt', this['ProcessCommandLine']) or grep('Start-AADInt', this['ProcessCommandLine'])
    or grep('Update-AADInt', this['ProcessCommandLine']))
  sigma_id: c86500e9-a645-4680-98d7-f882c70c1ea3
- name: Potential Active Directory Enumeration Using AD Module - ProcCreation
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll'])
    and (grep('Import-Module ', this['ProcessCommandLine']) or grep('ipmo ', this['ProcessCommandLine']))
    and grep('Microsoft.ActiveDirectory.Management.dll', this['ProcessCommandLine'])
  sigma_id: 70bc5215-526f-4477-963c-a47a5c9ebd12
- name: Add Windows Capability Via PowerShell Cmdlet
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll'])
    and grep('Add-WindowsCapability', this['ProcessCommandLine']) and grep('OpenSSH.',
    this['ProcessCommandLine'])
  sigma_id: b36d01a3-ddaf-4804-be18-18a6247adfcd
- name: Potential AMSI Bypass Via .NET Reflection
  query: grep('System.Management.Automation.AmsiUtils', this['ProcessCommandLine'])
    and grep('amsiInitFailed', this['ProcessCommandLine']) or grep('[Ref].Assembly.GetType',
    this['ProcessCommandLine']) and grep('SetValue($null,$true)', this['ProcessCommandLine'])
    and grep('NonPublic,Static', this['ProcessCommandLine'])
  sigma_id: 30edb182-aa75-42c0-b0a9-e998bb29067c
- name: Potential AMSI Bypass Using NULL Bits
  query: grep('if(0){{{0}}}\' -f $(0 -as [char]) +', this['ProcessCommandLine']) or
    grep('#<NULL>', this['ProcessCommandLine'])
  sigma_id: 92a974db-ab84-457f-9ec0-55db83d7a825
- name: Audio Capture via PowerShell
  query: grep('WindowsAudioDevice-Powershell-Cmdlet', this['ProcessCommandLine'])
    or grep('Toggle-AudioDevice', this['ProcessCommandLine']) or grep('Get-AudioDevice
    ', this['ProcessCommandLine']) or grep('Set-AudioDevice ', this['ProcessCommandLine'])
    or grep('Write-AudioDevice ', this['ProcessCommandLine'])
  sigma_id: 932fb0d8-692b-4b0f-a26e-5643a50fe7d6
- name: Suspicious Encoded PowerShell Command Line
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll'])
    and (grep(' -e', this['ProcessCommandLine']) and (grep(' JAB', this['ProcessCommandLine'])
    or grep(' SUVYI', this['ProcessCommandLine']) or grep(' SQBFAFgA', this['ProcessCommandLine'])
    or grep(' aQBlAHgA', this['ProcessCommandLine']) or grep(' aWV4I', this['ProcessCommandLine'])
    or grep(' IAA', this['ProcessCommandLine']) or grep(' IAB', this['ProcessCommandLine'])
    or grep(' UwB', this['ProcessCommandLine']) or grep(' cwB', this['ProcessCommandLine']))
    or grep('.exe -ENCOD ', this['ProcessCommandLine']) or grep(' BA^J e-', this['ProcessCommandLine']))
    and not grep(' -ExecutionPolicy remotesigned ', this['ProcessCommandLine'])
  sigma_id: ca2092a1-c273-4878-9b4b-0d60115bf5ea
- name: Suspicious PowerShell Encoded Command Patterns
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.Exe', 'pwsh.dll'])
    and (grep(' -e ', this['ProcessCommandLine']) or grep(' -en ', this['ProcessCommandLine'])
    or grep(' -enc ', this['ProcessCommandLine']) or grep(' -enco', this['ProcessCommandLine']))
    and (grep(' JAB', this['ProcessCommandLine']) or grep(' SUVYI', this['ProcessCommandLine'])
    or grep(' SQBFAFgA', this['ProcessCommandLine']) or grep(' aWV4I', this['ProcessCommandLine'])
    or grep(' IAB', this['ProcessCommandLine']) or grep(' PAA', this['ProcessCommandLine'])
    or grep(' aQBlAHgA', this['ProcessCommandLine'])) and not (grep('C:\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\',
    this['InitiatingProcessFolderPath']) or grep('\\gc_worker.exe', this['InitiatingProcessFolderPath']))
  sigma_id: b9d9cc83-380b-4ba3-8d8f-60c0e7e2930c
- name: Suspicious Obfuscated PowerShell Code
  query: grep('IAAtAGIAeABvAHIAIAAwAHgA', this['ProcessCommandLine']) or grep('AALQBiAHgAbwByACAAMAB4A',
    this['ProcessCommandLine']) or grep('gAC0AYgB4AG8AcgAgADAAeA', this['ProcessCommandLine'])
    or grep('AC4ASQBuAHYAbwBrAGUAKAApACAAfAAg', this['ProcessCommandLine']) or grep('AuAEkAbgB2AG8AawBlACgAKQAgAHwAI',
    this['ProcessCommandLine']) or grep('ALgBJAG4AdgBvAGsAZQAoACkAIAB8AC', this['ProcessCommandLine'])
    or grep('AHsAMQB9AHsAMAB9ACIAIAAtAGYAI', this['ProcessCommandLine']) or grep('B7ADEAfQB7ADAAfQAiACAALQBmAC',
    this['ProcessCommandLine']) or grep('AewAxAH0AewAwAH0AIgAgAC0AZgAg', this['ProcessCommandLine'])
    or grep('AHsAMAB9AHsAMwB9ACIAIAAtAGYAI', this['ProcessCommandLine']) or grep('B7ADAAfQB7ADMAfQAiACAALQBmAC',
    this['ProcessCommandLine']) or grep('AewAwAH0AewAzAH0AIgAgAC0AZgAg', this['ProcessCommandLine'])
    or grep('AHsAMgB9AHsAMAB9ACIAIAAtAGYAI', this['ProcessCommandLine']) or grep('B7ADIAfQB7ADAAfQAiACAALQBmAC',
    this['ProcessCommandLine']) or grep('AewAyAH0AewAwAH0AIgAgAC0AZgAg', this['ProcessCommandLine'])
    or grep('AHsAMQB9AHsAMAB9ACcAIAAtAGYAI', this['ProcessCommandLine']) or grep('B7ADEAfQB7ADAAfQAnACAALQBmAC',
    this['ProcessCommandLine']) or grep('AewAxAH0AewAwAH0AJwAgAC0AZgAg', this['ProcessCommandLine'])
    or grep('AHsAMAB9AHsAMwB9ACcAIAAtAGYAI', this['ProcessCommandLine']) or grep('B7ADAAfQB7ADMAfQAnACAALQBmAC',
    this['ProcessCommandLine']) or grep('AewAwAH0AewAzAH0AJwAgAC0AZgAg', this['ProcessCommandLine'])
    or grep('AHsAMgB9AHsAMAB9ACcAIAAtAGYAI', this['ProcessCommandLine']) or grep('B7ADIAfQB7ADAAfQAnACAALQBmAC',
    this['ProcessCommandLine']) or grep('AewAyAH0AewAwAH0AJwAgAC0AZgAg', this['ProcessCommandLine'])
  sigma_id: 8d01b53f-456f-48ee-90f6-bc28e67d4e35
- name: PowerShell Base64 Encoded FromBase64String Cmdlet
  query: grep('OjpGcm9tQmFzZTY0U3RyaW5n', this['ProcessCommandLine']) or grep('o6RnJvbUJhc2U2NFN0cmluZ',
    this['ProcessCommandLine']) or grep('6OkZyb21CYXNlNjRTdHJpbm', this['ProcessCommandLine'])
    or grep('OgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcA', this['ProcessCommandLine'])
    or grep('oAOgBGAHIAbwBtAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnA', this['ProcessCommandLine'])
    or grep('6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZw', this['ProcessCommandLine'])
  sigma_id: fdb62a13-9a81-4e5c-a38f-ea93a16f6d7c
- name: Malicious Base64 Encoded PowerShell Keywords in Command Lines
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll'])
    and grep(' hidden ', this['ProcessCommandLine']) and (grep('AGkAdABzAGEAZABtAGkAbgAgAC8AdAByAGEAbgBzAGYAZQByA',
    this['ProcessCommandLine']) or grep('aXRzYWRtaW4gL3RyYW5zZmVy', this['ProcessCommandLine'])
    or grep('IAaQB0AHMAYQBkAG0AaQBuACAALwB0AHIAYQBuAHMAZgBlAHIA', this['ProcessCommandLine'])
    or grep('JpdHNhZG1pbiAvdHJhbnNmZX', this['ProcessCommandLine']) or grep('YgBpAHQAcwBhAGQAbQBpAG4AIAAvAHQAcgBhAG4AcwBmAGUAcg',
    this['ProcessCommandLine']) or grep('Yml0c2FkbWluIC90cmFuc2Zlc', this['ProcessCommandLine'])
    or grep('AGMAaAB1AG4AawBfAHMAaQB6AGUA', this['ProcessCommandLine']) or grep('JABjAGgAdQBuAGsAXwBzAGkAegBlA',
    this['ProcessCommandLine']) or grep('JGNodW5rX3Npem', this['ProcessCommandLine'])
    or grep('QAYwBoAHUAbgBrAF8AcwBpAHoAZQ', this['ProcessCommandLine']) or grep('RjaHVua19zaXpl',
    this['ProcessCommandLine']) or grep('Y2h1bmtfc2l6Z', this['ProcessCommandLine'])
    or grep('AE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4A', this['ProcessCommandLine']) or
    grep('kATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8Abg', this['ProcessCommandLine']) or grep('lPLkNvbXByZXNzaW9u',
    this['ProcessCommandLine']) or grep('SQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuA', this['ProcessCommandLine'])
    or grep('SU8uQ29tcHJlc3Npb2', this['ProcessCommandLine']) or grep('Ty5Db21wcmVzc2lvb',
    this['ProcessCommandLine']) or grep('AE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQ',
    this['ProcessCommandLine']) or grep('kATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtA',
    this['ProcessCommandLine']) or grep('lPLk1lbW9yeVN0cmVhb', this['ProcessCommandLine'])
    or grep('SQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0A', this['ProcessCommandLine'])
    or grep('SU8uTWVtb3J5U3RyZWFt', this['ProcessCommandLine']) or grep('Ty5NZW1vcnlTdHJlYW',
    this['ProcessCommandLine']) or grep('4ARwBlAHQAQwBoAHUAbgBrA', this['ProcessCommandLine'])
    or grep('5HZXRDaHVua', this['ProcessCommandLine']) or grep('AEcAZQB0AEMAaAB1AG4Aaw',
    this['ProcessCommandLine']) or grep('LgBHAGUAdABDAGgAdQBuAGsA', this['ProcessCommandLine'])
    or grep('LkdldENodW5r', this['ProcessCommandLine']) or grep('R2V0Q2h1bm', this['ProcessCommandLine'])
    or grep('AEgAUgBFAEEARABfAEkATgBGAE8ANgA0A', this['ProcessCommandLine']) or grep('QASABSAEUAQQBEAF8ASQBOAEYATwA2ADQA',
    this['ProcessCommandLine']) or grep('RIUkVBRF9JTkZPNj', this['ProcessCommandLine'])
    or grep('SFJFQURfSU5GTzY0', this['ProcessCommandLine']) or grep('VABIAFIARQBBAEQAXwBJAE4ARgBPADYANA',
    this['ProcessCommandLine']) or grep('VEhSRUFEX0lORk82N', this['ProcessCommandLine'])
    or grep('AHIAZQBhAHQAZQBSAGUAbQBvAHQAZQBUAGgAcgBlAGEAZA', this['ProcessCommandLine'])
    or grep('cmVhdGVSZW1vdGVUaHJlYW', this['ProcessCommandLine']) or grep('MAcgBlAGEAdABlAFIAZQBtAG8AdABlAFQAaAByAGUAYQBkA',
    this['ProcessCommandLine']) or grep('NyZWF0ZVJlbW90ZVRocmVhZ', this['ProcessCommandLine'])
    or grep('Q3JlYXRlUmVtb3RlVGhyZWFk', this['ProcessCommandLine']) or grep('QwByAGUAYQB0AGUAUgBlAG0AbwB0AGUAVABoAHIAZQBhAGQA',
    this['ProcessCommandLine']) or grep('0AZQBtAG0AbwB2AGUA', this['ProcessCommandLine'])
    or grep('1lbW1vdm', this['ProcessCommandLine']) or grep('AGUAbQBtAG8AdgBlA', this['ProcessCommandLine'])
    or grep('bQBlAG0AbQBvAHYAZQ', this['ProcessCommandLine']) or grep('bWVtbW92Z',
    this['ProcessCommandLine']) or grep('ZW1tb3Zl', this['ProcessCommandLine']))
  sigma_id: f26c6093-6f14-4b12-800f-0fcb46f5ffd0
- name: PowerShell Base64 Encoded IEX Cmdlet
  query: grep('SUVYIChb', this['ProcessCommandLine']) or grep('lFWCAoW', this['ProcessCommandLine'])
    or grep('JRVggKF', this['ProcessCommandLine']) or grep('aWV4IChb', this['ProcessCommandLine'])
    or grep('lleCAoW', this['ProcessCommandLine']) or grep('pZXggKF', this['ProcessCommandLine'])
    or grep('aWV4IChOZX', this['ProcessCommandLine']) or grep('lleCAoTmV3', this['ProcessCommandLine'])
    or grep('pZXggKE5ld', this['ProcessCommandLine']) or grep('SUVYIChOZX', this['ProcessCommandLine'])
    or grep('lFWCAoTmV3', this['ProcessCommandLine']) or grep('JRVggKE5ld', this['ProcessCommandLine'])
    or grep('SUVYKF', this['ProcessCommandLine']) or grep('lFWChb', this['ProcessCommandLine'])
    or grep('JRVgoW', this['ProcessCommandLine']) or grep('aWV4KF', this['ProcessCommandLine'])
    or grep('lleChb', this['ProcessCommandLine']) or grep('pZXgoW', this['ProcessCommandLine'])
    or grep('aWV4KE5ld', this['ProcessCommandLine']) or grep('lleChOZX', this['ProcessCommandLine'])
    or grep('pZXgoTmV3', this['ProcessCommandLine']) or grep('SUVYKE5ld', this['ProcessCommandLine'])
    or grep('lFWChOZX', this['ProcessCommandLine']) or grep('JRVgoTmV3', this['ProcessCommandLine'])
    or grep('SUVYKCgn', this['ProcessCommandLine']) or grep('lFWCgoJ', this['ProcessCommandLine'])
    or grep('JRVgoKC', this['ProcessCommandLine']) or grep('aWV4KCgn', this['ProcessCommandLine'])
    or grep('lleCgoJ', this['ProcessCommandLine']) or grep('pZXgoKC', this['ProcessCommandLine'])
    or grep('SQBFAFgAIAAoAFsA', this['ProcessCommandLine']) or grep('kARQBYACAAKABbA',
    this['ProcessCommandLine']) or grep('JAEUAWAAgACgAWw', this['ProcessCommandLine'])
    or grep('aQBlAHgAIAAoAFsA', this['ProcessCommandLine']) or grep('kAZQB4ACAAKABbA',
    this['ProcessCommandLine']) or grep('pAGUAeAAgACgAWw', this['ProcessCommandLine'])
    or grep('aQBlAHgAIAAoAE4AZQB3A', this['ProcessCommandLine']) or grep('kAZQB4ACAAKABOAGUAdw',
    this['ProcessCommandLine']) or grep('pAGUAeAAgACgATgBlAHcA', this['ProcessCommandLine'])
    or grep('SQBFAFgAIAAoAE4AZQB3A', this['ProcessCommandLine']) or grep('kARQBYACAAKABOAGUAdw',
    this['ProcessCommandLine']) or grep('JAEUAWAAgACgATgBlAHcA', this['ProcessCommandLine'])
  sigma_id: 88f680b8-070e-402c-ae11-d2914f2257f1
- name: PowerShell Base64 Encoded Invoke Keyword
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll'])
    and grep(' -e', this['ProcessCommandLine']) and (grep('SQBuAHYAbwBrAGUALQ', this['ProcessCommandLine'])
    or grep('kAbgB2AG8AawBlAC0A', this['ProcessCommandLine']) or grep('JAG4AdgBvAGsAZQAtA',
    this['ProcessCommandLine']) or grep('SW52b2tlL', this['ProcessCommandLine']) or
    grep('ludm9rZS', this['ProcessCommandLine']) or grep('JbnZva2Ut', this['ProcessCommandLine']))
  sigma_id: 6385697e-9f1b-40bd-8817-f4a91f40508e
- name: Powershell Base64 Encoded MpPreference Cmdlet
  query: grep('QWRkLU1wUHJlZmVyZW5jZS', this['ProcessCommandLine']) or grep('FkZC1NcFByZWZlcmVuY2Ug',
    this['ProcessCommandLine']) or grep('BZGQtTXBQcmVmZXJlbmNlI', this['ProcessCommandLine'])
    or grep('U2V0LU1wUHJlZmVyZW5jZS', this['ProcessCommandLine']) or grep('NldC1NcFByZWZlcmVuY2Ug',
    this['ProcessCommandLine']) or grep('TZXQtTXBQcmVmZXJlbmNlI', this['ProcessCommandLine'])
    or grep('YWRkLW1wcHJlZmVyZW5jZS', this['ProcessCommandLine']) or grep('FkZC1tcHByZWZlcmVuY2Ug',
    this['ProcessCommandLine']) or grep('hZGQtbXBwcmVmZXJlbmNlI', this['ProcessCommandLine'])
    or grep('c2V0LW1wcHJlZmVyZW5jZS', this['ProcessCommandLine']) or grep('NldC1tcHByZWZlcmVuY2Ug',
    this['ProcessCommandLine']) or grep('zZXQtbXBwcmVmZXJlbmNlI', this['ProcessCommandLine'])
    or grep('QQBkAGQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA', this['ProcessCommandLine'])
    or grep('EAZABkAC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA', this['ProcessCommandLine'])
    or grep('BAGQAZAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA', this['ProcessCommandLine'])
    or grep('UwBlAHQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA', this['ProcessCommandLine'])
    or grep('MAZQB0AC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA', this['ProcessCommandLine'])
    or grep('TAGUAdAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA', this['ProcessCommandLine'])
    or grep('YQBkAGQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA', this['ProcessCommandLine'])
    or grep('EAZABkAC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA', this['ProcessCommandLine'])
    or grep('hAGQAZAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA', this['ProcessCommandLine'])
    or grep('cwBlAHQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA', this['ProcessCommandLine'])
    or grep('MAZQB0AC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA', this['ProcessCommandLine'])
    or grep('zAGUAdAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA', this['ProcessCommandLine'])
  sigma_id: c6fb44c6-71f5-49e6-9462-1425d328aee3
- name: PowerShell Base64 Encoded Reflective Assembly Load
  query: grep('WwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKA',
    this['ProcessCommandLine']) or grep('sAUgBlAGYAbABlAGMAdABpAG8AbgAuAEEAcwBzAGUAbQBiAGwAeQBdADoAOgBMAG8AYQBkACgA',
    this['ProcessCommandLine']) or grep('bAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZAAoA',
    this['ProcessCommandLine']) or grep('AFsAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvAGEAZAAiAC',
    this['ProcessCommandLine']) or grep('BbAHIAZQBmAGwAZQBjAHQAaQBvAG4ALgBhAHMAcwBlAG0AYgBsAHkAXQA6ADoAKAAiAEwAbwBhAGQAIgAp',
    this['ProcessCommandLine']) or grep('AWwByAGUAZgBsAGUAYwB0AGkAbwBuAC4AYQBzAHMAZQBtAGIAbAB5AF0AOgA6ACgAIgBMAG8AYQBkACIAK',
    this['ProcessCommandLine']) or grep('WwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6ACgAIgBMAG8AYQBkACIAKQ',
    this['ProcessCommandLine']) or grep('sAUgBlAGYAbABlAGMAdABpAG8AbgAuAEEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvAGEAZAAiACkA',
    this['ProcessCommandLine']) or grep('bAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoAKAAiAEwAbwBhAGQAIgApA',
    this['ProcessCommandLine']) or grep('WwByAGUAZgBsAGUAYwB0AGkAbwBuAC4AYQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKA',
    this['ProcessCommandLine']) or grep('sAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgBMAG8AYQBkACgA',
    this['ProcessCommandLine']) or grep('bAHIAZQBmAGwAZQBjAHQAaQBvAG4ALgBhAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZAAoA',
    this['ProcessCommandLine'])
  sigma_id: 62b7ccc9-23b4-471e-aa15-6da3663c4d59
- name: Suspicious Encoded And Obfuscated Reflection Assembly Load Function Call
  query: grep('OgA6ACgAIgBMACIAKwAiAG8AYQBkACIAKQ', this['ProcessCommandLine']) or
    grep('oAOgAoACIATAAiACsAIgBvAGEAZAAiACkA', this['ProcessCommandLine']) or grep('6ADoAKAAiAEwAIgArACIAbwBhAGQAIgApA',
    this['ProcessCommandLine']) or grep('OgA6ACgAIgBMAG8AIgArACIAYQBkACIAKQ', this['ProcessCommandLine'])
    or grep('oAOgAoACIATABvACIAKwAiAGEAZAAiACkA', this['ProcessCommandLine']) or grep('6ADoAKAAiAEwAbwAiACsAIgBhAGQAIgApA',
    this['ProcessCommandLine']) or grep('OgA6ACgAIgBMAG8AYQAiACsAIgBkACIAKQ', this['ProcessCommandLine'])
    or grep('oAOgAoACIATABvAGEAIgArACIAZAAiACkA', this['ProcessCommandLine']) or grep('6ADoAKAAiAEwAbwBhACIAKwAiAGQAIgApA',
    this['ProcessCommandLine']) or grep('OgA6ACgAJwBMACcAKwAnAG8AYQBkACcAKQ', this['ProcessCommandLine'])
    or grep('oAOgAoACcATAAnACsAJwBvAGEAZAAnACkA', this['ProcessCommandLine']) or grep('6ADoAKAAnAEwAJwArACcAbwBhAGQAJwApA',
    this['ProcessCommandLine']) or grep('OgA6ACgAJwBMAG8AJwArACcAYQBkACcAKQ', this['ProcessCommandLine'])
    or grep('oAOgAoACcATABvACcAKwAnAGEAZAAnACkA', this['ProcessCommandLine']) or grep('6ADoAKAAnAEwAbwAnACsAJwBhAGQAJwApA',
    this['ProcessCommandLine']) or grep('OgA6ACgAJwBMAG8AYQAnACsAJwBkACcAKQ', this['ProcessCommandLine'])
    or grep('oAOgAoACcATABvAGEAJwArACcAZAAnACkA', this['ProcessCommandLine']) or grep('6ADoAKAAnAEwAbwBhACcAKwAnAGQAJwApA',
    this['ProcessCommandLine'])
  sigma_id: 9c0295ce-d60d-40bd-bd74-84673b7592b1
- name: PowerShell Base64 Encoded WMI Classes
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll'])
    and (grep('VwBpAG4AMwAyAF8AUwBoAGEAZABvAHcAYwBvAHAAeQ', this['ProcessCommandLine'])
    or grep('cAaQBuADMAMgBfAFMAaABhAGQAbwB3AGMAbwBwAHkA', this['ProcessCommandLine'])
    or grep('XAGkAbgAzADIAXwBTAGgAYQBkAG8AdwBjAG8AcAB5A', this['ProcessCommandLine'])
    or grep('V2luMzJfU2hhZG93Y29we', this['ProcessCommandLine']) or grep('dpbjMyX1NoYWRvd2NvcH',
    this['ProcessCommandLine']) or grep('XaW4zMl9TaGFkb3djb3B5', this['ProcessCommandLine'])
    or grep('VwBpAG4AMwAyAF8AUwBjAGgAZQBkAHUAbABlAGQASgBvAGIA', this['ProcessCommandLine'])
    or grep('cAaQBuADMAMgBfAFMAYwBoAGUAZAB1AGwAZQBkAEoAbwBiA', this['ProcessCommandLine'])
    or grep('XAGkAbgAzADIAXwBTAGMAaABlAGQAdQBsAGUAZABKAG8AYg', this['ProcessCommandLine'])
    or grep('V2luMzJfU2NoZWR1bGVkSm9i', this['ProcessCommandLine']) or grep('dpbjMyX1NjaGVkdWxlZEpvY',
    this['ProcessCommandLine']) or grep('XaW4zMl9TY2hlZHVsZWRKb2', this['ProcessCommandLine'])
    or grep('VwBpAG4AMwAyAF8AUAByAG8AYwBlAHMAcw', this['ProcessCommandLine']) or grep('cAaQBuADMAMgBfAFAAcgBvAGMAZQBzAHMA',
    this['ProcessCommandLine']) or grep('XAGkAbgAzADIAXwBQAHIAbwBjAGUAcwBzA', this['ProcessCommandLine'])
    or grep('V2luMzJfUHJvY2Vzc', this['ProcessCommandLine']) or grep('dpbjMyX1Byb2Nlc3',
    this['ProcessCommandLine']) or grep('XaW4zMl9Qcm9jZXNz', this['ProcessCommandLine'])
    or grep('VwBpAG4AMwAyAF8AVQBzAGUAcgBBAGMAYwBvAHUAbgB0A', this['ProcessCommandLine'])
    or grep('cAaQBuADMAMgBfAFUAcwBlAHIAQQBjAGMAbwB1AG4AdA', this['ProcessCommandLine'])
    or grep('XAGkAbgAzADIAXwBVAHMAZQByAEEAYwBjAG8AdQBuAHQA', this['ProcessCommandLine'])
    or grep('V2luMzJfVXNlckFjY291bn', this['ProcessCommandLine']) or grep('dpbjMyX1VzZXJBY2NvdW50',
    this['ProcessCommandLine']) or grep('XaW4zMl9Vc2VyQWNjb3Vud', this['ProcessCommandLine'])
    or grep('VwBpAG4AMwAyAF8ATABvAGcAZwBlAGQATwBuAFUAcwBlAHIA', this['ProcessCommandLine'])
    or grep('cAaQBuADMAMgBfAEwAbwBnAGcAZQBkAE8AbgBVAHMAZQByA', this['ProcessCommandLine'])
    or grep('XAGkAbgAzADIAXwBMAG8AZwBnAGUAZABPAG4AVQBzAGUAcg', this['ProcessCommandLine'])
    or grep('V2luMzJfTG9nZ2VkT25Vc2Vy', this['ProcessCommandLine']) or grep('dpbjMyX0xvZ2dlZE9uVXNlc',
    this['ProcessCommandLine']) or grep('XaW4zMl9Mb2dnZWRPblVzZX', this['ProcessCommandLine']))
  sigma_id: 1816994b-42e1-4fb1-afd2-134d88184f71
- name: Potential Process Execution Proxy Via CL_Invocation.ps1
  query: grep('SyncInvoke ', this['ProcessCommandLine'])
  sigma_id: a0459f02-ac51-4c09-b511-b8c9203fc429
- name: Assembly Loading Via CL_LoadAssembly.ps1
  query: grep('LoadAssemblyFromPath ', this['ProcessCommandLine']) or grep('LoadAssemblyFromNS
    ', this['ProcessCommandLine'])
  sigma_id: c57872c7-614f-4d7f-a40d-b78c8df2d30d
- name: Potential Script Proxy Execution Via CL_Mutexverifiers.ps1
  query: (grep('\\powershell.exe', this['InitiatingProcessFolderPath']) or grep('\\pwsh.exe',
    this['InitiatingProcessFolderPath'])) and grep('\\powershell.exe', this['FolderPath'])
    and grep(' -nologo -windowstyle minimized -file ', this['ProcessCommandLine'])
    and (grep('\\AppData\\Local\\Temp\\', this['ProcessCommandLine']) or grep('\\Windows\\Temp\\',
    this['ProcessCommandLine']))
  sigma_id: 1e0e1a81-e79b-44bc-935b-ddb9c8006b3d
- name: ConvertTo-SecureString Cmdlet Usage Via CommandLine
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll'])
    and grep('ConvertTo-SecureString', this['ProcessCommandLine'])
  sigma_id: 74403157-20f5-415d-89a7-c505779585cf
- name: Potential PowerShell Obfuscation Via Reversed Commands
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll'])
    and (grep('hctac', this['ProcessCommandLine']) or grep('kaerb', this['ProcessCommandLine'])
    or grep('dnammoc', this['ProcessCommandLine']) or grep('ekovn', this['ProcessCommandLine'])
    or grep('eliFd', this['ProcessCommandLine']) or grep('rahc', this['ProcessCommandLine'])
    or grep('etirw', this['ProcessCommandLine']) or grep('golon', this['ProcessCommandLine'])
    or grep('tninon', this['ProcessCommandLine']) or grep('eddih', this['ProcessCommandLine'])
    or grep('tpircS', this['ProcessCommandLine']) or grep('ssecorp', this['ProcessCommandLine'])
    or grep('llehsrewop', this['ProcessCommandLine']) or grep('esnopser', this['ProcessCommandLine'])
    or grep('daolnwod', this['ProcessCommandLine']) or grep('tneilCbeW', this['ProcessCommandLine'])
    or grep('tneilc', this['ProcessCommandLine']) or grep('ptth', this['ProcessCommandLine'])
    or grep('elifotevas', this['ProcessCommandLine']) or grep('46esab', this['ProcessCommandLine'])
    or grep('htaPpmeTteG', this['ProcessCommandLine']) or grep('tcejbO', this['ProcessCommandLine'])
    or grep('maerts', this['ProcessCommandLine']) or grep('hcaerof', this['ProcessCommandLine'])
    or grep('retupmoc', this['ProcessCommandLine'])) and not (grep(' -EncodedCommand
    ', this['ProcessCommandLine']) or grep(' -enc ', this['ProcessCommandLine']))
  sigma_id: b6b49cd1-34d6-4ead-b1bf-176e9edba9a4
- name: Computer Discovery And Export Via Get-ADComputer Cmdlet
  query: '(grep(''\\powershell.exe'', this[''FolderPath'']) or grep(''\\pwsh.exe'',
    this[''FolderPath'']) or this[''ProcessVersionInfoOriginalFileName''] in [''PowerShell.EXE'',
    ''pwsh.dll'']) and grep(''Get-ADComputer '', this[''ProcessCommandLine'']) and
    grep(''(\'' -Filter \'', <SpecialChars.WILDCARD_MULTI: 1>)'', this[''ProcessCommandLine''])
    and (grep('' > '', this[''ProcessCommandLine'']) or grep('' | Select '', this[''ProcessCommandLine''])
    or grep(''Out-File'', this[''ProcessCommandLine'']) or grep(''Set-Content'', this[''ProcessCommandLine''])
    or grep(''Add-Content'', this[''ProcessCommandLine'']))'
  sigma_id: 435e10e4-992a-4281-96f3-38b11106adde
- name: Gzip Archive Decode Via PowerShell
  query: grep('GZipStream', this['ProcessCommandLine']) and grep('::Decompress', this['ProcessCommandLine'])
  sigma_id: 98767d61-b2e8-4d71-b661-e36783ee24c1
- name: PowerShell Execution With Potential Decryption Capabilities
  query: '(grep(''\\powershell.exe'', this[''FolderPath'']) or grep(''\\pwsh.exe'',
    this[''FolderPath''])) and (this[''ProcessVersionInfoOriginalFileName''] in [''PowerShell.EXE'',
    ''pwsh.dll'']) and (grep(''Get-ChildItem '', this[''ProcessCommandLine'']) or
    grep(''dir '', this[''ProcessCommandLine'']) or grep(''gci '', this[''ProcessCommandLine''])
    or grep(''ls '', this[''ProcessCommandLine''])) and (grep(''Get-Content '', this[''ProcessCommandLine''])
    or grep(''gc '', this[''ProcessCommandLine'']) or grep(''cat '', this[''ProcessCommandLine''])
    or grep(''type '', this[''ProcessCommandLine'']) or grep(''ReadAllBytes'', this[''ProcessCommandLine'']))
    and (grep('' ^| '', this[''ProcessCommandLine'']) and grep(''(<SpecialChars.WILDCARD_MULTI:
    1>, \''.lnk\'')'', this[''ProcessCommandLine'']) and grep(''-Recurse'', this[''ProcessCommandLine''])
    and grep(''-Skip '', this[''ProcessCommandLine'']) or grep('' -ExpandProperty
    '', this[''ProcessCommandLine'']) and grep(''(<SpecialChars.WILDCARD_MULTI: 1>,
    \''.lnk\'')'', this[''ProcessCommandLine'']) and grep(''WriteAllBytes'', this[''ProcessCommandLine''])
    and grep('' .length '', this[''ProcessCommandLine'']))'
  sigma_id: 434c08ba-8406-4d15-8b24-782cb071a691
- name: Powershell Defender Disable Scan Feature
  query: (grep('Add-MpPreference ', this['ProcessCommandLine']) or grep('Set-MpPreference
    ', this['ProcessCommandLine'])) and (grep('DisableArchiveScanning ', this['ProcessCommandLine'])
    or grep('DisableRealtimeMonitoring ', this['ProcessCommandLine']) or grep('DisableIOAVProtection
    ', this['ProcessCommandLine']) or grep('DisableBehaviorMonitoring ', this['ProcessCommandLine'])
    or grep('DisableBlockAtFirstSeen ', this['ProcessCommandLine']) or grep('DisableCatchupFullScan
    ', this['ProcessCommandLine']) or grep('DisableCatchupQuickScan ', this['ProcessCommandLine']))
    and (grep('$true', this['ProcessCommandLine']) or grep(' 1 ', this['ProcessCommandLine']))
    or grep('ZGlzYWJsZWFyY2hpdmVzY2FubmluZy', this['ProcessCommandLine']) or grep('Rpc2FibGVhcmNoaXZlc2Nhbm5pbmcg',
    this['ProcessCommandLine']) or grep('kaXNhYmxlYXJjaGl2ZXNjYW5uaW5nI', this['ProcessCommandLine'])
    or grep('RGlzYWJsZUFyY2hpdmVTY2FubmluZy', this['ProcessCommandLine']) or grep('Rpc2FibGVBcmNoaXZlU2Nhbm5pbmcg',
    this['ProcessCommandLine']) or grep('EaXNhYmxlQXJjaGl2ZVNjYW5uaW5nI', this['ProcessCommandLine'])
    or grep('ZGlzYWJsZWJlaGF2aW9ybW9uaXRvcmluZy', this['ProcessCommandLine']) or grep('Rpc2FibGViZWhhdmlvcm1vbml0b3Jpbmcg',
    this['ProcessCommandLine']) or grep('kaXNhYmxlYmVoYXZpb3Jtb25pdG9yaW5nI', this['ProcessCommandLine'])
    or grep('RGlzYWJsZUJlaGF2aW9yTW9uaXRvcmluZy', this['ProcessCommandLine']) or grep('Rpc2FibGVCZWhhdmlvck1vbml0b3Jpbmcg',
    this['ProcessCommandLine']) or grep('EaXNhYmxlQmVoYXZpb3JNb25pdG9yaW5nI', this['ProcessCommandLine'])
    or grep('ZGlzYWJsZWJsb2NrYXRmaXJzdHNlZW4g', this['ProcessCommandLine']) or grep('Rpc2FibGVibG9ja2F0Zmlyc3RzZWVuI',
    this['ProcessCommandLine']) or grep('kaXNhYmxlYmxvY2thdGZpcnN0c2Vlbi', this['ProcessCommandLine'])
    or grep('RGlzYWJsZUJsb2NrQXRGaXJzdFNlZW4g', this['ProcessCommandLine']) or grep('Rpc2FibGVCbG9ja0F0Rmlyc3RTZWVuI',
    this['ProcessCommandLine']) or grep('EaXNhYmxlQmxvY2tBdEZpcnN0U2Vlbi', this['ProcessCommandLine'])
    or grep('ZGlzYWJsZWNhdGNodXBmdWxsc2Nhbi', this['ProcessCommandLine']) or grep('Rpc2FibGVjYXRjaHVwZnVsbHNjYW4g',
    this['ProcessCommandLine']) or grep('kaXNhYmxlY2F0Y2h1cGZ1bGxzY2FuI', this['ProcessCommandLine'])
    or grep('RGlzYWJsZUNhdGNodXBGdWxsU2Nhbi', this['ProcessCommandLine']) or grep('Rpc2FibGVDYXRjaHVwRnVsbFNjYW4g',
    this['ProcessCommandLine']) or grep('EaXNhYmxlQ2F0Y2h1cEZ1bGxTY2FuI', this['ProcessCommandLine'])
    or grep('ZGlzYWJsZWNhdGNodXBxdWlja3NjYW4g', this['ProcessCommandLine']) or grep('Rpc2FibGVjYXRjaHVwcXVpY2tzY2FuI',
    this['ProcessCommandLine']) or grep('kaXNhYmxlY2F0Y2h1cHF1aWNrc2Nhbi', this['ProcessCommandLine'])
    or grep('RGlzYWJsZUNhdGNodXBRdWlja1NjYW4g', this['ProcessCommandLine']) or grep('Rpc2FibGVDYXRjaHVwUXVpY2tTY2FuI',
    this['ProcessCommandLine']) or grep('EaXNhYmxlQ2F0Y2h1cFF1aWNrU2Nhbi', this['ProcessCommandLine'])
    or grep('ZGlzYWJsZWlvYXZwcm90ZWN0aW9uI', this['ProcessCommandLine']) or grep('Rpc2FibGVpb2F2cHJvdGVjdGlvbi',
    this['ProcessCommandLine']) or grep('kaXNhYmxlaW9hdnByb3RlY3Rpb24g', this['ProcessCommandLine'])
    or grep('RGlzYWJsZUlPQVZQcm90ZWN0aW9uI', this['ProcessCommandLine']) or grep('Rpc2FibGVJT0FWUHJvdGVjdGlvbi',
    this['ProcessCommandLine']) or grep('EaXNhYmxlSU9BVlByb3RlY3Rpb24g', this['ProcessCommandLine'])
    or grep('ZGlzYWJsZXJlYWx0aW1lbW9uaXRvcmluZy', this['ProcessCommandLine']) or grep('Rpc2FibGVyZWFsdGltZW1vbml0b3Jpbmcg',
    this['ProcessCommandLine']) or grep('kaXNhYmxlcmVhbHRpbWVtb25pdG9yaW5nI', this['ProcessCommandLine'])
    or grep('RGlzYWJsZVJlYWx0aW1lTW9uaXRvcmluZy', this['ProcessCommandLine']) or grep('Rpc2FibGVSZWFsdGltZU1vbml0b3Jpbmcg',
    this['ProcessCommandLine']) or grep('EaXNhYmxlUmVhbHRpbWVNb25pdG9yaW5nI', this['ProcessCommandLine'])
    or grep('RABpAHMAYQBiAGwAZQBSAGUAYQBsAHQAaQBtAGUATQBvAG4AaQB0AG8AcgBpAG4AZwAgA',
    this['ProcessCommandLine']) or grep('QAaQBzAGEAYgBsAGUAUgBlAGEAbAB0AGkAbQBlAE0AbwBuAGkAdABvAHIAaQBuAGcAIA',
    this['ProcessCommandLine']) or grep('EAGkAcwBhAGIAbABlAFIAZQBhAGwAdABpAG0AZQBNAG8AbgBpAHQAbwByAGkAbgBnACAA',
    this['ProcessCommandLine']) or grep('RABpAHMAYQBiAGwAZQBJAE8AQQBWAFAAcgBvAHQAZQBjAHQAaQBvAG4AIA',
    this['ProcessCommandLine']) or grep('QAaQBzAGEAYgBsAGUASQBPAEEAVgBQAHIAbwB0AGUAYwB0AGkAbwBuACAA',
    this['ProcessCommandLine']) or grep('EAGkAcwBhAGIAbABlAEkATwBBAFYAUAByAG8AdABlAGMAdABpAG8AbgAgA',
    this['ProcessCommandLine']) or grep('RABpAHMAYQBiAGwAZQBCAGUAaABhAHYAaQBvAHIATQBvAG4AaQB0AG8AcgBpAG4AZwAgA',
    this['ProcessCommandLine']) or grep('QAaQBzAGEAYgBsAGUAQgBlAGgAYQB2AGkAbwByAE0AbwBuAGkAdABvAHIAaQBuAGcAIA',
    this['ProcessCommandLine']) or grep('EAGkAcwBhAGIAbABlAEIAZQBoAGEAdgBpAG8AcgBNAG8AbgBpAHQAbwByAGkAbgBnACAA',
    this['ProcessCommandLine']) or grep('RABpAHMAYQBiAGwAZQBCAGwAbwBjAGsAQQB0AEYAaQByAHMAdABTAGUAZQBuACAA',
    this['ProcessCommandLine']) or grep('QAaQBzAGEAYgBsAGUAQgBsAG8AYwBrAEEAdABGAGkAcgBzAHQAUwBlAGUAbgAgA',
    this['ProcessCommandLine']) or grep('EAGkAcwBhAGIAbABlAEIAbABvAGMAawBBAHQARgBpAHIAcwB0AFMAZQBlAG4AIA',
    this['ProcessCommandLine']) or grep('ZABpAHMAYQBiAGwAZQByAGUAYQBsAHQAaQBtAGUAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA',
    this['ProcessCommandLine']) or grep('QAaQBzAGEAYgBsAGUAcgBlAGEAbAB0AGkAbQBlAG0AbwBuAGkAdABvAHIAaQBuAGcAIA',
    this['ProcessCommandLine']) or grep('kAGkAcwBhAGIAbABlAHIAZQBhAGwAdABpAG0AZQBtAG8AbgBpAHQAbwByAGkAbgBnACAA',
    this['ProcessCommandLine']) or grep('ZABpAHMAYQBiAGwAZQBpAG8AYQB2AHAAcgBvAHQAZQBjAHQAaQBvAG4AIA',
    this['ProcessCommandLine']) or grep('QAaQBzAGEAYgBsAGUAaQBvAGEAdgBwAHIAbwB0AGUAYwB0AGkAbwBuACAA',
    this['ProcessCommandLine']) or grep('kAGkAcwBhAGIAbABlAGkAbwBhAHYAcAByAG8AdABlAGMAdABpAG8AbgAgA',
    this['ProcessCommandLine']) or grep('ZABpAHMAYQBiAGwAZQBiAGUAaABhAHYAaQBvAHIAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA',
    this['ProcessCommandLine']) or grep('QAaQBzAGEAYgBsAGUAYgBlAGgAYQB2AGkAbwByAG0AbwBuAGkAdABvAHIAaQBuAGcAIA',
    this['ProcessCommandLine']) or grep('kAGkAcwBhAGIAbABlAGIAZQBoAGEAdgBpAG8AcgBtAG8AbgBpAHQAbwByAGkAbgBnACAA',
    this['ProcessCommandLine']) or grep('ZABpAHMAYQBiAGwAZQBiAGwAbwBjAGsAYQB0AGYAaQByAHMAdABzAGUAZQBuACAA',
    this['ProcessCommandLine']) or grep('QAaQBzAGEAYgBsAGUAYgBsAG8AYwBrAGEAdABmAGkAcgBzAHQAcwBlAGUAbgAgA',
    this['ProcessCommandLine']) or grep('kAGkAcwBhAGIAbABlAGIAbABvAGMAawBhAHQAZgBpAHIAcwB0AHMAZQBlAG4AIA',
    this['ProcessCommandLine']) or grep('RABpAHMAYQBiAGwAZQBDAGEAdABjAGgAdQBwAEYAdQBsAGwAUwBjAGEAbgA',
    this['ProcessCommandLine']) or grep('RABpAHMAYQBiAGwAZQBDAGEAdABjAGgAdQBwAFEAdQBpAGMAawBTAGMAYQBuAA',
    this['ProcessCommandLine']) or grep('RABpAHMAYQBiAGwAZQBBAHIAYwBoAGkAdgBlAFMAYwBhAG4AbgBpAG4AZwA',
    this['ProcessCommandLine'])
  sigma_id: 1ec65a5f-9473-4f12-97da-622044d6df21
- name: Powershell Defender Exclusion
  query: (grep('Add-MpPreference ', this['ProcessCommandLine']) or grep('Set-MpPreference
    ', this['ProcessCommandLine'])) and (grep(' -ExclusionPath ', this['ProcessCommandLine'])
    or grep(' -ExclusionExtension ', this['ProcessCommandLine']) or grep(' -ExclusionProcess
    ', this['ProcessCommandLine']) or grep(' -ExclusionIpAddress ', this['ProcessCommandLine']))
  sigma_id: 17769c90-230e-488b-a463-e05c08e9d48f
- name: Disable Windows Defender AV Security Monitoring
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll'])
    and (grep('-DisableBehaviorMonitoring $true', this['ProcessCommandLine']) or grep('-DisableRuntimeMonitoring
    $true', this['ProcessCommandLine'])) or (grep('\\sc.exe', this['FolderPath'])
    or grep('sc.exe', this['ProcessVersionInfoOriginalFileName'])) and (grep('stop',
    this['ProcessCommandLine']) and grep('WinDefend', this['ProcessCommandLine'])
    or grep('delete', this['ProcessCommandLine']) and grep('WinDefend', this['ProcessCommandLine'])
    or grep('config', this['ProcessCommandLine']) and grep('WinDefend', this['ProcessCommandLine'])
    and grep('start=disabled', this['ProcessCommandLine']))
  sigma_id: a7ee1722-c3c5-aeff-3212-c777e4733217
- name: Windows Firewall Disabled via PowerShell
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or grep('\\powershell_ise.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['PowerShell.EXE', 'pwsh.dll']) and grep('Set-NetFirewallProfile ', this['ProcessCommandLine'])
    and grep(' -Enabled ', this['ProcessCommandLine']) and grep(' False', this['ProcessCommandLine'])
    and (grep(' -All ', this['ProcessCommandLine']) or grep('Public', this['ProcessCommandLine'])
    or grep('Domain', this['ProcessCommandLine']) or grep('Private', this['ProcessCommandLine']))
  sigma_id: 12f6b752-042d-483e-bf9c-915a6d06ad75
- name: Disabled IE Security Features
  query: grep(' -name IEHarden ', this['ProcessCommandLine']) and grep(' -value 0
    ', this['ProcessCommandLine']) or grep(' -name DEPOff ', this['ProcessCommandLine'])
    and grep(' -value 1 ', this['ProcessCommandLine']) or grep(' -name DisableFirstRunCustomize
    ', this['ProcessCommandLine']) and grep(' -value 2 ', this['ProcessCommandLine'])
  sigma_id: fb50eb7a-5ab1-43ae-bcc9-091818cb8424
- name: Potential PowerShell Downgrade Attack
  query: grep('\\powershell.exe', this['FolderPath']) and (grep(' -version 2 ', this['ProcessCommandLine'])
    or grep(' -versio 2 ', this['ProcessCommandLine']) or grep(' -versi 2 ', this['ProcessCommandLine'])
    or grep(' -vers 2 ', this['ProcessCommandLine']) or grep(' -ver 2 ', this['ProcessCommandLine'])
    or grep(' -ve 2 ', this['ProcessCommandLine']) or grep(' -v 2 ', this['ProcessCommandLine']))
  sigma_id: b3512211-c67e-4707-bedc-66efc7848863
- name: Potential COM Objects Download Cradles Usage - Process Creation
  query: grep('[Type]::GetTypeFromCLSID(', this['ProcessCommandLine']) and (grep('0002DF01-0000-0000-C000-000000000046',
    this['ProcessCommandLine']) or grep('F6D90F16-9C73-11D3-B32E-00C04F990BB4', this['ProcessCommandLine'])
    or grep('F5078F35-C551-11D3-89B9-0000F81FE221', this['ProcessCommandLine']) or
    grep('88d96a0a-f192-11d4-a65f-0040963251e5', this['ProcessCommandLine']) or grep('AFBA6B42-5692-48EA-8141-DC517DCF0EF1',
    this['ProcessCommandLine']) or grep('AFB40FFD-B609-40A3-9828-F88BBE11E4E3', this['ProcessCommandLine'])
    or grep('88d96a0b-f192-11d4-a65f-0040963251e5', this['ProcessCommandLine']) or
    grep('2087c2f4-2cef-4953-a8ab-66779b670495', this['ProcessCommandLine']) or grep('000209FF-0000-0000-C000-000000000046',
    this['ProcessCommandLine']) or grep('00024500-0000-0000-C000-000000000046', this['ProcessCommandLine']))
  sigma_id: 02b64f1b-3f33-4e67-aede-ef3b0a5a8fcf
- name: Obfuscated PowerShell OneLiner Execution
  query: grep('\\powershell.exe', this['FolderPath']) and grep('http://127.0.0.1',
    this['ProcessCommandLine']) and grep('%{(IRM $_)}', this['ProcessCommandLine'])
    and grep('.SubString.ToString()[67,72,64]-Join', this['ProcessCommandLine']) and
    grep('Import-Module', this['ProcessCommandLine'])
  sigma_id: 44e24481-6202-4c62-9127-5a0ae8e3fe3d
- name: PowerShell Web Download
  query: grep('.DownloadString(', this['ProcessCommandLine']) or grep('.DownloadFile(',
    this['ProcessCommandLine']) or grep('Invoke-WebRequest ', this['ProcessCommandLine'])
    or grep('iwr ', this['ProcessCommandLine'])
  sigma_id: 6e897651-f157-4d8f-aaeb-df8151488385
- name: Potential DLL File Download Via PowerShell Invoke-WebRequest
  query: (grep('Invoke-WebRequest ', this['ProcessCommandLine']) or grep('IWR ', this['ProcessCommandLine']))
    and grep('http', this['ProcessCommandLine']) and grep('OutFile', this['ProcessCommandLine'])
    and grep('.dll', this['ProcessCommandLine'])
  sigma_id: 0f0450f3-8b47-441e-a31b-15a91dc243e2
- name: PowerShell Download and Execution Cradles
  query: (grep('.DownloadString(', this['ProcessCommandLine']) or grep('.DownloadFile(',
    this['ProcessCommandLine']) or grep('Invoke-WebRequest ', this['ProcessCommandLine'])
    or grep('iwr ', this['ProcessCommandLine'])) and (grep(';iex $', this['ProcessCommandLine'])
    or grep('| IEX', this['ProcessCommandLine']) or grep('|IEX ', this['ProcessCommandLine'])
    or grep('I`E`X', this['ProcessCommandLine']) or grep('I`EX', this['ProcessCommandLine'])
    or grep('IE`X', this['ProcessCommandLine']) or grep('iex ', this['ProcessCommandLine'])
    or grep('IEX (', this['ProcessCommandLine']) or grep('IEX(', this['ProcessCommandLine'])
    or grep('Invoke-Expression', this['ProcessCommandLine']))
  sigma_id: 85b0b087-eddf-4a2b-b033-d771fa2b9775
- name: PowerShell Download Pattern
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll'])
    and grep('new-object', this['ProcessCommandLine']) and grep('net.webclient).',
    this['ProcessCommandLine']) and grep('download', this['ProcessCommandLine']) and
    (grep('string(', this['ProcessCommandLine']) or grep('file(', this['ProcessCommandLine']))
  sigma_id: 3b6ab547-8ec2-4991-b9d2-2b06702a48d7
- name: Potentially Suspicious File Download From File Sharing Domain Via PowerShell.EXE
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll'])
    and (grep('anonfiles.com', this['ProcessCommandLine']) or grep('cdn.discordapp.com',
    this['ProcessCommandLine']) or grep('ddns.net', this['ProcessCommandLine']) or
    grep('dl.dropboxusercontent.com', this['ProcessCommandLine']) or grep('ghostbin.co',
    this['ProcessCommandLine']) or grep('glitch.me', this['ProcessCommandLine']) or
    grep('gofile.io', this['ProcessCommandLine']) or grep('hastebin.com', this['ProcessCommandLine'])
    or grep('mediafire.com', this['ProcessCommandLine']) or grep('mega.nz', this['ProcessCommandLine'])
    or grep('onrender.com', this['ProcessCommandLine']) or grep('pages.dev', this['ProcessCommandLine'])
    or grep('paste.ee', this['ProcessCommandLine']) or grep('pastebin.com', this['ProcessCommandLine'])
    or grep('pastebin.pl', this['ProcessCommandLine']) or grep('pastetext.net', this['ProcessCommandLine'])
    or grep('pixeldrain.com', this['ProcessCommandLine']) or grep('privatlab.com',
    this['ProcessCommandLine']) or grep('privatlab.net', this['ProcessCommandLine'])
    or grep('send.exploit.in', this['ProcessCommandLine']) or grep('sendspace.com',
    this['ProcessCommandLine']) or grep('storage.googleapis.com', this['ProcessCommandLine'])
    or grep('storjshare.io', this['ProcessCommandLine']) or grep('supabase.co', this['ProcessCommandLine'])
    or grep('temp.sh', this['ProcessCommandLine']) or grep('transfer.sh', this['ProcessCommandLine'])
    or grep('trycloudflare.com', this['ProcessCommandLine']) or grep('ufile.io', this['ProcessCommandLine'])
    or grep('w3spaces.com', this['ProcessCommandLine']) or grep('workers.dev', this['ProcessCommandLine']))
    and (grep('.DownloadString(', this['ProcessCommandLine']) or grep('.DownloadFile(',
    this['ProcessCommandLine']) or grep('Invoke-WebRequest ', this['ProcessCommandLine'])
    or grep('iwr ', this['ProcessCommandLine']) or grep('wget ', this['ProcessCommandLine']))
  sigma_id: b6e04788-29e1-4557-bb14-77f761848ab8
- name: DSInternals Suspicious PowerShell Cmdlets
  query: grep('Add-ADDBSidHistory', this['ProcessCommandLine']) or grep('Add-ADNgcKey',
    this['ProcessCommandLine']) or grep('Add-ADReplNgcKey', this['ProcessCommandLine'])
    or grep('ConvertFrom-ADManagedPasswordBlob', this['ProcessCommandLine']) or grep('ConvertFrom-GPPrefPassword',
    this['ProcessCommandLine']) or grep('ConvertFrom-ManagedPasswordBlob', this['ProcessCommandLine'])
    or grep('ConvertFrom-UnattendXmlPassword', this['ProcessCommandLine']) or grep('ConvertFrom-UnicodePassword',
    this['ProcessCommandLine']) or grep('ConvertTo-AADHash', this['ProcessCommandLine'])
    or grep('ConvertTo-GPPrefPassword', this['ProcessCommandLine']) or grep('ConvertTo-KerberosKey',
    this['ProcessCommandLine']) or grep('ConvertTo-LMHash', this['ProcessCommandLine'])
    or grep('ConvertTo-MsoPasswordHash', this['ProcessCommandLine']) or grep('ConvertTo-NTHash',
    this['ProcessCommandLine']) or grep('ConvertTo-OrgIdHash', this['ProcessCommandLine'])
    or grep('ConvertTo-UnicodePassword', this['ProcessCommandLine']) or grep('Disable-ADDBAccount',
    this['ProcessCommandLine']) or grep('Enable-ADDBAccount', this['ProcessCommandLine'])
    or grep('Get-ADDBAccount', this['ProcessCommandLine']) or grep('Get-ADDBBackupKey',
    this['ProcessCommandLine']) or grep('Get-ADDBDomainController', this['ProcessCommandLine'])
    or grep('Get-ADDBGroupManagedServiceAccount', this['ProcessCommandLine']) or grep('Get-ADDBKdsRootKey',
    this['ProcessCommandLine']) or grep('Get-ADDBSchemaAttribute', this['ProcessCommandLine'])
    or grep('Get-ADDBServiceAccount', this['ProcessCommandLine']) or grep('Get-ADDefaultPasswordPolicy',
    this['ProcessCommandLine']) or grep('Get-ADKeyCredential', this['ProcessCommandLine'])
    or grep('Get-ADPasswordPolicy', this['ProcessCommandLine']) or grep('Get-ADReplAccount',
    this['ProcessCommandLine']) or grep('Get-ADReplBackupKey', this['ProcessCommandLine'])
    or grep('Get-ADReplicationAccount', this['ProcessCommandLine']) or grep('Get-ADSIAccount',
    this['ProcessCommandLine']) or grep('Get-AzureADUserEx', this['ProcessCommandLine'])
    or grep('Get-BootKey', this['ProcessCommandLine']) or grep('Get-KeyCredential',
    this['ProcessCommandLine']) or grep('Get-LsaBackupKey', this['ProcessCommandLine'])
    or grep('Get-LsaPolicy', this['ProcessCommandLine']) or grep('Get-SamPasswordPolicy',
    this['ProcessCommandLine']) or grep('Get-SysKey', this['ProcessCommandLine'])
    or grep('Get-SystemKey', this['ProcessCommandLine']) or grep('New-ADDBRestoreFromMediaScript',
    this['ProcessCommandLine']) or grep('New-ADKeyCredential', this['ProcessCommandLine'])
    or grep('New-ADNgcKey', this['ProcessCommandLine']) or grep('New-NTHashSet', this['ProcessCommandLine'])
    or grep('Remove-ADDBObject', this['ProcessCommandLine']) or grep('Save-DPAPIBlob',
    this['ProcessCommandLine']) or grep('Set-ADAccountPasswordHash', this['ProcessCommandLine'])
    or grep('Set-ADDBAccountPassword', this['ProcessCommandLine']) or grep('Set-ADDBBootKey',
    this['ProcessCommandLine']) or grep('Set-ADDBDomainController', this['ProcessCommandLine'])
    or grep('Set-ADDBPrimaryGroup', this['ProcessCommandLine']) or grep('Set-ADDBSysKey',
    this['ProcessCommandLine']) or grep('Set-AzureADUserEx', this['ProcessCommandLine'])
    or grep('Set-LsaPolicy', this['ProcessCommandLine']) or grep('Set-SamAccountPasswordHash',
    this['ProcessCommandLine']) or grep('Set-WinUserPasswordHash', this['ProcessCommandLine'])
    or grep('Test-ADDBPasswordQuality', this['ProcessCommandLine']) or grep('Test-ADPasswordQuality',
    this['ProcessCommandLine']) or grep('Test-ADReplPasswordQuality', this['ProcessCommandLine'])
    or grep('Test-PasswordQuality', this['ProcessCommandLine']) or grep('Unlock-ADDBAccount',
    this['ProcessCommandLine']) or grep('Write-ADNgcKey', this['ProcessCommandLine'])
    or grep('Write-ADReplNgcKey', this['ProcessCommandLine'])
  sigma_id: 43d91656-a9b2-4541-b7e2-6a9bd3a13f4e
- name: Email Exifiltration Via Powershell
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']))
    and grep('Add-PSSnapin', this['ProcessCommandLine']) and grep('Get-Recipient',
    this['ProcessCommandLine']) and grep('-ExpandProperty', this['ProcessCommandLine'])
    and grep('EmailAddresses', this['ProcessCommandLine']) and grep('SmtpAddress',
    this['ProcessCommandLine']) and grep('-hidetableheaders', this['ProcessCommandLine'])
  sigma_id: 312d0384-401c-4b8b-abdf-685ffba9a332
- name: Potential Suspicious Windows Feature Enabled - ProcCreation
  query: grep('Enable-WindowsOptionalFeature', this['ProcessCommandLine']) and grep('-Online',
    this['ProcessCommandLine']) and grep('-FeatureName', this['ProcessCommandLine'])
    and (grep('TelnetServer', this['ProcessCommandLine']) or grep('Internet-Explorer-Optional-amd64',
    this['ProcessCommandLine']) or grep('TFTP', this['ProcessCommandLine']) or grep('SMB1Protocol',
    this['ProcessCommandLine']) or grep('Client-ProjFS', this['ProcessCommandLine'])
    or grep('Microsoft-Windows-Subsystem-Linux', this['ProcessCommandLine']))
  sigma_id: c740d4cf-a1e9-41de-bb16-8a46a4f57918
- name: Suspicious Execution of Powershell with Base64
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']))
    and (grep(' -e ', this['ProcessCommandLine']) or grep(' -en ', this['ProcessCommandLine'])
    or grep(' -enc ', this['ProcessCommandLine']) or grep(' -enco', this['ProcessCommandLine'])
    or grep(' -ec ', this['ProcessCommandLine'])) and not (grep(' -Encoding ', this['ProcessCommandLine'])
    or grep('C:\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\',
    this['InitiatingProcessFolderPath']) or grep('\\gc_worker.exe', this['InitiatingProcessFolderPath']))
  sigma_id: fb843269-508c-4b76-8b8d-88679db22ce7
- name: Powershell Inline Execution From A File
  query: (grep('iex ', this['ProcessCommandLine']) or grep('Invoke-Expression ', this['ProcessCommandLine'])
    or grep('Invoke-Command ', this['ProcessCommandLine']) or grep('icm ', this['ProcessCommandLine']))
    and (grep('cat ', this['ProcessCommandLine']) or grep('get-content ', this['ProcessCommandLine'])
    or grep('type ', this['ProcessCommandLine'])) and grep(' -raw', this['ProcessCommandLine'])
  sigma_id: ee218c12-627a-4d27-9e30-d6fb2fe22ed2
- name: Certificate Exported Via PowerShell
  query: grep('Export-PfxCertificate ', this['ProcessCommandLine']) or grep('Export-Certificate
    ', this['ProcessCommandLine'])
  sigma_id: 9e716b33-63b2-46da-86a4-bd3c3b9b5dfb
- name: Base64 Encoded PowerShell Command Detected
  query: grep('::FromBase64String(', this['ProcessCommandLine'])
  sigma_id: e32d4572-9826-4738-b651-95fa63747e8a
- name: Suspicious FromBase64String Usage On Gzip Archive - Process Creation
  query: grep('FromBase64String', this['ProcessCommandLine']) and grep('MemoryStream',
    this['ProcessCommandLine']) and grep('H4sI', this['ProcessCommandLine'])
  sigma_id: d75d6b6b-adb9-48f7-824b-ac2e786efe1f
- name: PowerShell Get-Clipboard Cmdlet Via CLI
  query: grep('Get-Clipboard', this['ProcessCommandLine'])
  sigma_id: b9aeac14-2ffd-4ad3-b967-1354a4e628c3
- name: Suspicious Reconnaissance Activity Using Get-LocalGroupMember Cmdlet
  query: "grep('Get-LocalGroupMember ', this['ProcessCommandLine']) and (grep('domain\
    \ admins', this['ProcessCommandLine']) or grep(' administrator', this['ProcessCommandLine'])\
    \ or grep(' administrateur', this['ProcessCommandLine']) or grep('enterprise admins',\
    \ this['ProcessCommandLine']) or grep('Exchange Trusted Subsystem', this['ProcessCommandLine'])\
    \ or grep('Remote Desktop Users', this['ProcessCommandLine']) or grep('Utilisateurs\
    \ du Bureau \xE0 distance', this['ProcessCommandLine']) or grep('Usuarios de escritorio\
    \ remoto', this['ProcessCommandLine']))"
  sigma_id: c8a180d6-47a3-4345-a609-53f9c3d834fc
- name: PowerShell Get-Process LSASS
  query: grep('Get-Process lsas', this['ProcessCommandLine']) or grep('ps lsas', this['ProcessCommandLine'])
    or grep('gps lsas', this['ProcessCommandLine'])
  sigma_id: b2815d0d-7481-4bf0-9b6c-a4c48a94b349
- name: Abuse of Service Permissions to Hide Services Via Set-Service
  query: (grep('\\pwsh.exe', this['FolderPath']) or grep('pwsh.dll', this['ProcessVersionInfoOriginalFileName']))
    and grep('Set-Service ', this['ProcessCommandLine']) and grep('DCLCWPDTSD', this['ProcessCommandLine'])
    and (grep('-SecurityDescriptorSddl ', this['ProcessCommandLine']) or grep('-sd
    ', this['ProcessCommandLine']))
  sigma_id: 514e4c3a-c77d-4cde-a00f-046425e2301e
- name: Suspicious PowerShell IEX Execution Patterns
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']))
    and (grep(' | iex;', this['ProcessCommandLine']) or grep(' | iex ', this['ProcessCommandLine'])
    or grep(' | iex}', this['ProcessCommandLine']) or grep(' | IEX ;', this['ProcessCommandLine'])
    or grep(' | IEX -Error', this['ProcessCommandLine']) or grep(' | IEX (new', this['ProcessCommandLine'])
    or grep(');IEX ', this['ProcessCommandLine'])) and (grep('::FromBase64String',
    this['ProcessCommandLine']) or grep('.GetString([System.Convert]::', this['ProcessCommandLine']))
    or grep(')|iex;$', this['ProcessCommandLine']) or grep(');iex($', this['ProcessCommandLine'])
    or grep(');iex $', this['ProcessCommandLine']) or grep(' | IEX | ', this['ProcessCommandLine'])
    or grep(' | iex\\"', this['ProcessCommandLine'])
  sigma_id: 09576804-7a05-458e-a817-eb718ca91f54
- name: Root Certificate Installed From Susp Locations
  query: grep('Import-Certificate', this['ProcessCommandLine']) and grep(' -FilePath
    ', this['ProcessCommandLine']) and grep('Cert:\\LocalMachine\\Root', this['ProcessCommandLine'])
    and (grep('\\AppData\\Local\\Temp\\', this['ProcessCommandLine']) or grep(':\\Windows\\TEMP\\',
    this['ProcessCommandLine']) or grep('\\Desktop\\', this['ProcessCommandLine'])
    or grep('\\Downloads\\', this['ProcessCommandLine']) or grep('\\Perflogs\\', this['ProcessCommandLine'])
    or grep(':\\Users\\Public\\', this['ProcessCommandLine']))
  sigma_id: 5f6a601c-2ecb-498b-9c33-660362323afa
- name: Import PowerShell Modules From Suspicious Directories - ProcCreation
  query: grep('Import-Module "$Env:Temp\\', this['ProcessCommandLine']) or grep('Import-Module
    \'$Env:Temp\\', this['ProcessCommandLine']) or grep('Import-Module $Env:Temp\\',
    this['ProcessCommandLine']) or grep('Import-Module "$Env:Appdata\\', this['ProcessCommandLine'])
    or grep('Import-Module \'$Env:Appdata\\', this['ProcessCommandLine']) or grep('Import-Module
    $Env:Appdata\\', this['ProcessCommandLine']) or grep('Import-Module C:\\Users\\Public\\',
    this['ProcessCommandLine']) or grep('ipmo "$Env:Temp\\', this['ProcessCommandLine'])
    or grep('ipmo \'$Env:Temp\\', this['ProcessCommandLine']) or grep('ipmo $Env:Temp\\',
    this['ProcessCommandLine']) or grep('ipmo "$Env:Appdata\\', this['ProcessCommandLine'])
    or grep('ipmo \'$Env:Appdata\\', this['ProcessCommandLine']) or grep('ipmo $Env:Appdata\\',
    this['ProcessCommandLine']) or grep('ipmo C:\\Users\\Public\\', this['ProcessCommandLine'])
  sigma_id: c31364f7-8be6-4b77-8483-dd2b5a7b69a3
- name: Unsigned AppX Installation Attempt Using Add-AppxPackage
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll'])
    and (grep('Add-AppPackage ', this['ProcessCommandLine']) or grep('Add-AppxPackage
    ', this['ProcessCommandLine'])) and grep(' -AllowUnsigned', this['ProcessCommandLine'])
  sigma_id: 37651c2a-42cd-4a69-ae0d-22a4349aa04a
- name: Suspicious PowerShell Invocations - Specific - ProcessCreation
  query: (grep('-nop', this['ProcessCommandLine']) and grep(' -w ', this['ProcessCommandLine'])
    and grep('hidden', this['ProcessCommandLine']) and grep(' -c ', this['ProcessCommandLine'])
    and grep('[Convert]::FromBase64String', this['ProcessCommandLine']) or grep('
    -w ', this['ProcessCommandLine']) and grep('hidden', this['ProcessCommandLine'])
    and grep('-noni', this['ProcessCommandLine']) and grep('-nop', this['ProcessCommandLine'])
    and grep(' -c ', this['ProcessCommandLine']) and grep('iex', this['ProcessCommandLine'])
    and grep('New-Object', this['ProcessCommandLine']) or grep(' -w ', this['ProcessCommandLine'])
    and grep('hidden', this['ProcessCommandLine']) and grep('-ep', this['ProcessCommandLine'])
    and grep('bypass', this['ProcessCommandLine']) and grep('-Enc', this['ProcessCommandLine'])
    or grep('powershell', this['ProcessCommandLine']) and grep('reg', this['ProcessCommandLine'])
    and grep('add', this['ProcessCommandLine']) and grep('\\software\\', this['ProcessCommandLine'])
    or grep('bypass', this['ProcessCommandLine']) and grep('-noprofile', this['ProcessCommandLine'])
    and grep('-windowstyle', this['ProcessCommandLine']) and grep('hidden', this['ProcessCommandLine'])
    and grep('new-object', this['ProcessCommandLine']) and grep('system.net.webclient',
    this['ProcessCommandLine']) and grep('.download', this['ProcessCommandLine'])
    or grep('iex', this['ProcessCommandLine']) and grep('New-Object', this['ProcessCommandLine'])
    and grep('Net.WebClient', this['ProcessCommandLine']) and grep('.Download', this['ProcessCommandLine']))
    and not (grep('(New-Object System.Net.WebClient).DownloadString(\'https://community.chocolatey.org/install.ps1',
    this['ProcessCommandLine']) or grep('Write-ChocolateyWarning', this['ProcessCommandLine']))
  sigma_id: 536e2947-3729-478c-9903-745aaffe60d2
- name: Suspicious Invoke-WebRequest Execution With DirectIP
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll'])
    and (grep('curl ', this['ProcessCommandLine']) or grep('Invoke-WebRequest', this['ProcessCommandLine'])
    or grep('iwr ', this['ProcessCommandLine']) or grep('wget ', this['ProcessCommandLine']))
    and (grep('://1', this['ProcessCommandLine']) or grep('://2', this['ProcessCommandLine'])
    or grep('://3', this['ProcessCommandLine']) or grep('://4', this['ProcessCommandLine'])
    or grep('://5', this['ProcessCommandLine']) or grep('://6', this['ProcessCommandLine'])
    or grep('://7', this['ProcessCommandLine']) or grep('://8', this['ProcessCommandLine'])
    or grep('://9', this['ProcessCommandLine']))
  sigma_id: 1edff897-9146-48d2-9066-52e8d8f80a2f
- name: Suspicious Invoke-WebRequest Execution
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll'])
    and (grep('curl ', this['ProcessCommandLine']) or grep('Invoke-WebRequest', this['ProcessCommandLine'])
    or grep('iwr ', this['ProcessCommandLine']) or grep('wget ', this['ProcessCommandLine']))
    and (grep(' -ur', this['ProcessCommandLine']) or grep(' -o', this['ProcessCommandLine']))
    and (grep('\\AppData\\', this['ProcessCommandLine']) or grep('\\Desktop\\', this['ProcessCommandLine'])
    or grep('\\Temp\\', this['ProcessCommandLine']) or grep('\\Users\\Public\\', this['ProcessCommandLine'])
    or grep('%AppData%', this['ProcessCommandLine']) or grep('%Public%', this['ProcessCommandLine'])
    or grep('%Temp%', this['ProcessCommandLine']) or grep('%tmp%', this['ProcessCommandLine'])
    or grep(':\\Windows\\', this['ProcessCommandLine']))
  sigma_id: 5e3cc4d8-3e68-43db-8656-eaaeefdec9cc
- name: Suspicious PowerShell Mailbox Export to Share
  query: grep('New-MailboxExportRequest', this['ProcessCommandLine']) and grep(' -Mailbox
    ', this['ProcessCommandLine']) and grep(' -FilePath \\', this['ProcessCommandLine'])
  sigma_id: 889719ef-dd62-43df-86c3-768fb08dc7c0
- name: Malicious PowerShell Commandlets - ProcessCreation
  query: grep('Add-Exfiltration', this['ProcessCommandLine']) or grep('Add-Persistence',
    this['ProcessCommandLine']) or grep('Add-RegBackdoor', this['ProcessCommandLine'])
    or grep('Add-RemoteRegBackdoor', this['ProcessCommandLine']) or grep('Add-ScrnSaveBackdoor',
    this['ProcessCommandLine']) or grep('Check-VM', this['ProcessCommandLine']) or
    grep('ConvertTo-Rc4ByteStream', this['ProcessCommandLine']) or grep('Decrypt-Hash',
    this['ProcessCommandLine']) or grep('Disable-ADIDNSNode', this['ProcessCommandLine'])
    or grep('Disable-MachineAccount', this['ProcessCommandLine']) or grep('Do-Exfiltration',
    this['ProcessCommandLine']) or grep('Enable-ADIDNSNode', this['ProcessCommandLine'])
    or grep('Enable-MachineAccount', this['ProcessCommandLine']) or grep('Enabled-DuplicateToken',
    this['ProcessCommandLine']) or grep('Exploit-Jboss', this['ProcessCommandLine'])
    or grep('Export-ADR', this['ProcessCommandLine']) or grep('Export-ADRCSV', this['ProcessCommandLine'])
    or grep('Export-ADRExcel', this['ProcessCommandLine']) or grep('Export-ADRHTML',
    this['ProcessCommandLine']) or grep('Export-ADRJSON', this['ProcessCommandLine'])
    or grep('Export-ADRXML', this['ProcessCommandLine']) or grep('Find-Fruit', this['ProcessCommandLine'])
    or grep('Find-GPOLocation', this['ProcessCommandLine']) or grep('Find-TrustedDocuments',
    this['ProcessCommandLine']) or grep('Get-ADIDNS', this['ProcessCommandLine'])
    or grep('Get-ApplicationHost', this['ProcessCommandLine']) or grep('Get-ChromeDump',
    this['ProcessCommandLine']) or grep('Get-ClipboardContents', this['ProcessCommandLine'])
    or grep('Get-FoxDump', this['ProcessCommandLine']) or grep('Get-GPPPassword',
    this['ProcessCommandLine']) or grep('Get-IndexedItem', this['ProcessCommandLine'])
    or grep('Get-KerberosAESKey', this['ProcessCommandLine']) or grep('Get-Keystrokes',
    this['ProcessCommandLine']) or grep('Get-LSASecret', this['ProcessCommandLine'])
    or grep('Get-MachineAccountAttribute', this['ProcessCommandLine']) or grep('Get-MachineAccountCreator',
    this['ProcessCommandLine']) or grep('Get-PassHashes', this['ProcessCommandLine'])
    or grep('Get-RegAlwaysInstallElevated', this['ProcessCommandLine']) or grep('Get-RegAutoLogon',
    this['ProcessCommandLine']) or grep('Get-RemoteBootKey', this['ProcessCommandLine'])
    or grep('Get-RemoteCachedCredential', this['ProcessCommandLine']) or grep('Get-RemoteLocalAccountHash',
    this['ProcessCommandLine']) or grep('Get-RemoteLSAKey', this['ProcessCommandLine'])
    or grep('Get-RemoteMachineAccountHash', this['ProcessCommandLine']) or grep('Get-RemoteNLKMKey',
    this['ProcessCommandLine']) or grep('Get-RickAstley', this['ProcessCommandLine'])
    or grep('Get-Screenshot', this['ProcessCommandLine']) or grep('Get-SecurityPackages',
    this['ProcessCommandLine']) or grep('Get-ServiceFilePermission', this['ProcessCommandLine'])
    or grep('Get-ServicePermission', this['ProcessCommandLine']) or grep('Get-ServiceUnquoted',
    this['ProcessCommandLine']) or grep('Get-SiteListPassword', this['ProcessCommandLine'])
    or grep('Get-System', this['ProcessCommandLine']) or grep('Get-TimedScreenshot',
    this['ProcessCommandLine']) or grep('Get-UnattendedInstallFile', this['ProcessCommandLine'])
    or grep('Get-Unconstrained', this['ProcessCommandLine']) or grep('Get-USBKeystrokes',
    this['ProcessCommandLine']) or grep('Get-VaultCredential', this['ProcessCommandLine'])
    or grep('Get-VulnAutoRun', this['ProcessCommandLine']) or grep('Get-VulnSchTask',
    this['ProcessCommandLine']) or grep('Grant-ADIDNSPermission', this['ProcessCommandLine'])
    or grep('Gupt-Backdoor', this['ProcessCommandLine']) or grep('HTTP-Login', this['ProcessCommandLine'])
    or grep('Install-ServiceBinary', this['ProcessCommandLine']) or grep('Install-SSP',
    this['ProcessCommandLine']) or grep('Invoke-ACLScanner', this['ProcessCommandLine'])
    or grep('Invoke-ADRecon', this['ProcessCommandLine']) or grep('Invoke-ADSBackdoor',
    this['ProcessCommandLine']) or grep('Invoke-AgentSmith', this['ProcessCommandLine'])
    or grep('Invoke-AllChecks', this['ProcessCommandLine']) or grep('Invoke-ARPScan',
    this['ProcessCommandLine']) or grep('Invoke-AzureHound', this['ProcessCommandLine'])
    or grep('Invoke-BackdoorLNK', this['ProcessCommandLine']) or grep('Invoke-BadPotato',
    this['ProcessCommandLine']) or grep('Invoke-BetterSafetyKatz', this['ProcessCommandLine'])
    or grep('Invoke-BypassUAC', this['ProcessCommandLine']) or grep('Invoke-Carbuncle',
    this['ProcessCommandLine']) or grep('Invoke-Certify', this['ProcessCommandLine'])
    or grep('Invoke-ConPtyShell', this['ProcessCommandLine']) or grep('Invoke-CredentialInjection',
    this['ProcessCommandLine']) or grep('Invoke-DAFT', this['ProcessCommandLine'])
    or grep('Invoke-DCSync', this['ProcessCommandLine']) or grep('Invoke-DinvokeKatz',
    this['ProcessCommandLine']) or grep('Invoke-DllInjection', this['ProcessCommandLine'])
    or grep('Invoke-DNSUpdate', this['ProcessCommandLine']) or grep('Invoke-DomainPasswordSpray',
    this['ProcessCommandLine']) or grep('Invoke-DowngradeAccount', this['ProcessCommandLine'])
    or grep('Invoke-EgressCheck', this['ProcessCommandLine']) or grep('Invoke-Eyewitness',
    this['ProcessCommandLine']) or grep('Invoke-FakeLogonScreen', this['ProcessCommandLine'])
    or grep('Invoke-Farmer', this['ProcessCommandLine']) or grep('Invoke-Get-RBCD-Threaded',
    this['ProcessCommandLine']) or grep('Invoke-Gopher', this['ProcessCommandLine'])
    or grep('Invoke-Grouper', this['ProcessCommandLine']) or grep('Invoke-HandleKatz',
    this['ProcessCommandLine']) or grep('Invoke-ImpersonatedProcess', this['ProcessCommandLine'])
    or grep('Invoke-ImpersonateSystem', this['ProcessCommandLine']) or grep('Invoke-InteractiveSystemPowerShell',
    this['ProcessCommandLine']) or grep('Invoke-Internalmonologue', this['ProcessCommandLine'])
    or grep('Invoke-Inveigh', this['ProcessCommandLine']) or grep('Invoke-InveighRelay',
    this['ProcessCommandLine']) or grep('Invoke-KrbRelay', this['ProcessCommandLine'])
    or grep('Invoke-LdapSignCheck', this['ProcessCommandLine']) or grep('Invoke-Lockless',
    this['ProcessCommandLine']) or grep('Invoke-MalSCCM', this['ProcessCommandLine'])
    or grep('Invoke-Mimikatz', this['ProcessCommandLine']) or grep('Invoke-Mimikittenz',
    this['ProcessCommandLine']) or grep('Invoke-MITM6', this['ProcessCommandLine'])
    or grep('Invoke-NanoDump', this['ProcessCommandLine']) or grep('Invoke-NetRipper',
    this['ProcessCommandLine']) or grep('Invoke-Nightmare', this['ProcessCommandLine'])
    or grep('Invoke-NinjaCopy', this['ProcessCommandLine']) or grep('Invoke-OfficeScrape',
    this['ProcessCommandLine']) or grep('Invoke-OxidResolver', this['ProcessCommandLine'])
    or grep('Invoke-P0wnedshell', this['ProcessCommandLine']) or grep('Invoke-Paranoia',
    this['ProcessCommandLine']) or grep('Invoke-PortScan', this['ProcessCommandLine'])
    or grep('Invoke-PoshRatHttp', this['ProcessCommandLine']) or grep('Invoke-PostExfil',
    this['ProcessCommandLine']) or grep('Invoke-PowerDump', this['ProcessCommandLine'])
    or grep('Invoke-PowerShellTCP', this['ProcessCommandLine']) or grep('Invoke-PowerShellWMI',
    this['ProcessCommandLine']) or grep('Invoke-PPLDump', this['ProcessCommandLine'])
    or grep('Invoke-PsExec', this['ProcessCommandLine']) or grep('Invoke-PSInject',
    this['ProcessCommandLine']) or grep('Invoke-PsUaCme', this['ProcessCommandLine'])
    or grep('Invoke-ReflectivePEInjection', this['ProcessCommandLine']) or grep('Invoke-ReverseDNSLookup',
    this['ProcessCommandLine']) or grep('Invoke-Rubeus', this['ProcessCommandLine'])
    or grep('Invoke-RunAs', this['ProcessCommandLine']) or grep('Invoke-SafetyKatz',
    this['ProcessCommandLine']) or grep('Invoke-SauronEye', this['ProcessCommandLine'])
    or grep('Invoke-SCShell', this['ProcessCommandLine']) or grep('Invoke-Seatbelt',
    this['ProcessCommandLine']) or grep('Invoke-ServiceAbuse', this['ProcessCommandLine'])
    or grep('Invoke-ShadowSpray', this['ProcessCommandLine']) or grep('Invoke-Sharp',
    this['ProcessCommandLine']) or grep('Invoke-Shellcode', this['ProcessCommandLine'])
    or grep('Invoke-SMBScanner', this['ProcessCommandLine']) or grep('Invoke-Snaffler',
    this['ProcessCommandLine']) or grep('Invoke-Spoolsample', this['ProcessCommandLine'])
    or grep('Invoke-SpraySinglePassword', this['ProcessCommandLine']) or grep('Invoke-SSHCommand',
    this['ProcessCommandLine']) or grep('Invoke-StandIn', this['ProcessCommandLine'])
    or grep('Invoke-StickyNotesExtract', this['ProcessCommandLine']) or grep('Invoke-SystemCommand',
    this['ProcessCommandLine']) or grep('Invoke-Tasksbackdoor', this['ProcessCommandLine'])
    or grep('Invoke-Tater', this['ProcessCommandLine']) or grep('Invoke-Thunderfox',
    this['ProcessCommandLine']) or grep('Invoke-ThunderStruck', this['ProcessCommandLine'])
    or grep('Invoke-TokenManipulation', this['ProcessCommandLine']) or grep('Invoke-Tokenvator',
    this['ProcessCommandLine']) or grep('Invoke-TotalExec', this['ProcessCommandLine'])
    or grep('Invoke-UrbanBishop', this['ProcessCommandLine']) or grep('Invoke-UserHunter',
    this['ProcessCommandLine']) or grep('Invoke-VoiceTroll', this['ProcessCommandLine'])
    or grep('Invoke-Whisker', this['ProcessCommandLine']) or grep('Invoke-WinEnum',
    this['ProcessCommandLine']) or grep('Invoke-winPEAS', this['ProcessCommandLine'])
    or grep('Invoke-WireTap', this['ProcessCommandLine']) or grep('Invoke-WmiCommand',
    this['ProcessCommandLine']) or grep('Invoke-WMIExec', this['ProcessCommandLine'])
    or grep('Invoke-WScriptBypassUAC', this['ProcessCommandLine']) or grep('Invoke-Zerologon',
    this['ProcessCommandLine']) or grep('MailRaider', this['ProcessCommandLine'])
    or grep('New-ADIDNSNode', this['ProcessCommandLine']) or grep('New-DNSRecordArray',
    this['ProcessCommandLine']) or grep('New-HoneyHash', this['ProcessCommandLine'])
    or grep('New-InMemoryModule', this['ProcessCommandLine']) or grep('New-MachineAccount',
    this['ProcessCommandLine']) or grep('New-SOASerialNumberArray', this['ProcessCommandLine'])
    or grep('Out-Minidump', this['ProcessCommandLine']) or grep('Port-Scan', this['ProcessCommandLine'])
    or grep('PowerBreach', this['ProcessCommandLine']) or grep('powercat ', this['ProcessCommandLine'])
    or grep('PowerUp', this['ProcessCommandLine']) or grep('PowerView', this['ProcessCommandLine'])
    or grep('Remove-ADIDNSNode', this['ProcessCommandLine']) or grep('Remove-MachineAccount',
    this['ProcessCommandLine']) or grep('Remove-Update', this['ProcessCommandLine'])
    or grep('Rename-ADIDNSNode', this['ProcessCommandLine']) or grep('Revoke-ADIDNSPermission',
    this['ProcessCommandLine']) or grep('Set-ADIDNSNode', this['ProcessCommandLine'])
    or grep('Set-MacAttribute', this['ProcessCommandLine']) or grep('Set-MachineAccountAttribute',
    this['ProcessCommandLine']) or grep('Set-Wallpaper', this['ProcessCommandLine'])
    or grep('Show-TargetScreen', this['ProcessCommandLine']) or grep('Start-CaptureServer',
    this['ProcessCommandLine']) or grep('Start-Dnscat2', this['ProcessCommandLine'])
    or grep('Start-WebcamRecorder', this['ProcessCommandLine']) or grep('VolumeShadowCopyTools',
    this['ProcessCommandLine'])
  sigma_id: 02030f2f-6199-49ec-b258-ea71b07e03dc
- name: MSExchange Transport Agent Installation
  query: grep('Install-TransportAgent', this['ProcessCommandLine'])
  sigma_id: 83809e84-4475-4b69-bc3e-4aad8568612f
- name: Potential PowerShell Obfuscation Via WCHAR
  query: grep('(WCHAR)0x', this['ProcessCommandLine'])
  sigma_id: e312efd0-35a1-407f-8439-b8d434b438a6
- name: Execution of Powershell Script in Public Folder
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']))
    and (grep('-f C:\\Users\\Public', this['ProcessCommandLine']) or grep('-f "C:\\Users\\Public',
    this['ProcessCommandLine']) or grep('-f %Public%', this['ProcessCommandLine'])
    or grep('-fi C:\\Users\\Public', this['ProcessCommandLine']) or grep('-fi "C:\\Users\\Public',
    this['ProcessCommandLine']) or grep('-fi %Public%', this['ProcessCommandLine'])
    or grep('-fil C:\\Users\\Public', this['ProcessCommandLine']) or grep('-fil "C:\\Users\\Public',
    this['ProcessCommandLine']) or grep('-fil %Public%', this['ProcessCommandLine'])
    or grep('-file C:\\Users\\Public', this['ProcessCommandLine']) or grep('-file
    "C:\\Users\\Public', this['ProcessCommandLine']) or grep('-file %Public%', this['ProcessCommandLine']))
  sigma_id: fb9d3ff7-7348-46ab-af8c-b55f5fbf39b4
- name: RemoteFXvGPUDisablement Abuse Via AtomicTestHarnesses
  query: grep('Invoke-ATHRemoteFXvGPUDisablementCommand', this['ProcessCommandLine'])
    or grep('Invoke-ATHRemoteFXvGPUDisableme', this['ProcessCommandLine'])
  sigma_id: a6fc3c46-23b8-4996-9ea2-573f4c4d88c5
- name: Tamper Windows Defender Remove-MpPreference
  query: grep('Remove-MpPreference', this['ProcessCommandLine']) and (grep('-ControlledFolderAccessProtectedFolders
    ', this['ProcessCommandLine']) or grep('-AttackSurfaceReductionRules_Ids ', this['ProcessCommandLine'])
    or grep('-AttackSurfaceReductionRules_Actions ', this['ProcessCommandLine']) or
    grep('-CheckForSignaturesBeforeRunningScan ', this['ProcessCommandLine']))
  sigma_id: 07e3cb2c-0608-410d-be4b-1511cb1a0448
- name: Potential Powershell ReverseShell Connection
  query: (this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll']
    or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']))
    and grep(' Net.Sockets.TCPClient', this['ProcessCommandLine']) and grep('.GetStream(',
    this['ProcessCommandLine']) and grep('.Write(', this['ProcessCommandLine'])
  sigma_id: edc2f8ae-2412-4dfd-b9d5-0c57727e70be
- name: Run PowerShell Script from ADS
  query: (grep('\\powershell.exe', this['InitiatingProcessFolderPath']) or grep('\\pwsh.exe',
    this['InitiatingProcessFolderPath'])) and (grep('\\powershell.exe', this['FolderPath'])
    or grep('\\pwsh.exe', this['FolderPath'])) and grep('Get-Content', this['ProcessCommandLine'])
    and grep('-Stream', this['ProcessCommandLine'])
  sigma_id: 45a594aa-1fbd-4972-a809-ff5a99dd81b8
- name: PowerShell SAM Copy
  query: grep('\\HarddiskVolumeShadowCopy', this['ProcessCommandLine']) and grep('System32\\config\\sam',
    this['ProcessCommandLine']) and (grep('Copy-Item', this['ProcessCommandLine'])
    or grep('cp $_.', this['ProcessCommandLine']) or grep('cpi $_.', this['ProcessCommandLine'])
    or grep('copy $_.', this['ProcessCommandLine']) or grep('.File]::Copy(', this['ProcessCommandLine']))
  sigma_id: 1af57a4b-460a-4738-9034-db68b880c665
- name: Suspicious PowerShell Invocation From Script Engines
  query: (grep('\\wscript.exe', this['InitiatingProcessFolderPath']) or grep('\\cscript.exe',
    this['InitiatingProcessFolderPath'])) and (grep('\\powershell.exe', this['FolderPath'])
    or grep('\\pwsh.exe', this['FolderPath'])) and not grep('\\Health Service State\\',
    this['CurrentDirectory'])
  sigma_id: 95eadcb2-92e4-4ed1-9031-92547773a6db
- name: Suspicious Service DACL Modification Via Set-Service Cmdlet
  query: (grep('\\pwsh.exe', this['FolderPath']) or grep('pwsh.dll', this['ProcessVersionInfoOriginalFileName']))
    and (grep('-SecurityDescriptorSddl ', this['ProcessCommandLine']) or grep('-sd
    ', this['ProcessCommandLine'])) and grep('Set-Service ', this['ProcessCommandLine'])
    and grep('D;;', this['ProcessCommandLine']) and (grep(';;;IU', this['ProcessCommandLine'])
    or grep(';;;SU', this['ProcessCommandLine']) or grep(';;;BA', this['ProcessCommandLine'])
    or grep(';;;SY', this['ProcessCommandLine']) or grep(';;;WD', this['ProcessCommandLine']))
  sigma_id: a95b9b42-1308-4735-a1af-abb1c5e6f5ac
- name: PowerShell Script Change Permission Via Set-Acl
  query: (this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll']
    or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']))
    and grep('Set-Acl ', this['ProcessCommandLine']) and grep('-AclObject ', this['ProcessCommandLine'])
    and grep('-Path ', this['ProcessCommandLine'])
  sigma_id: bdeb2cff-af74-4094-8426-724dc937f20a
- name: PowerShell Set-Acl On Windows Folder
  query: (this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll']
    or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']))
    and grep('Set-Acl ', this['ProcessCommandLine']) and grep('-AclObject ', this['ProcessCommandLine'])
    and (grep('-Path "C:\\Windows', this['ProcessCommandLine']) or grep('-Path \'C:\\Windows',
    this['ProcessCommandLine']) or grep('-Path %windir%', this['ProcessCommandLine'])
    or grep('-Path $env:windir', this['ProcessCommandLine'])) and (grep('FullControl',
    this['ProcessCommandLine']) or grep('Allow', this['ProcessCommandLine']))
  sigma_id: 0944e002-e3f6-4eb5-bf69-3a3067b53d73
- name: Change PowerShell Policies to an Insecure Level
  query: (this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll']
    or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']))
    and (grep('-executionpolicy ', this['ProcessCommandLine']) or grep(' -ep ', this['ProcessCommandLine'])
    or grep(' -exec ', this['ProcessCommandLine'])) and (grep('Bypass', this['ProcessCommandLine'])
    or grep('Unrestricted', this['ProcessCommandLine']))
  sigma_id: 87e3c4e8-a6a8-4ad9-bb4f-46e7ff99a180
- name: Service StartupType Change Via PowerShell Set-Service
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('PowerShell.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('Set-Service', this['ProcessCommandLine']) and grep('-StartupType', this['ProcessCommandLine'])
    and (grep('Disabled', this['ProcessCommandLine']) or grep('Manual', this['ProcessCommandLine']))
  sigma_id: 62b20d44-1546-4e61-afce-8e175eb9473c
- name: Deletion of Volume Shadow Copies via WMI with PowerShell
  query: (grep('Get-WmiObject', this['ProcessCommandLine']) or grep('gwmi', this['ProcessCommandLine'])
    or grep('Get-CimInstance', this['ProcessCommandLine']) or grep('gcim', this['ProcessCommandLine']))
    and grep('Win32_ShadowCopy', this['ProcessCommandLine']) and (grep('.Delete()',
    this['ProcessCommandLine']) or grep('Remove-WmiObject', this['ProcessCommandLine'])
    or grep('rwmi', this['ProcessCommandLine']) or grep('Remove-CimInstance', this['ProcessCommandLine'])
    or grep('rcim', this['ProcessCommandLine']))
  sigma_id: 21ff4ca9-f13a-41ad-b828-0077b2af2e40
- name: Exchange PowerShell Snap-Ins Usage
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll'])
    and grep('Add-PSSnapin', this['ProcessCommandLine']) and (grep('Microsoft.Exchange.Powershell.Snapin',
    this['ProcessCommandLine']) or grep('Microsoft.Exchange.Management.PowerShell.SnapIn',
    this['ProcessCommandLine'])) and not (grep('C:\\Windows\\System32\\msiexec.exe',
    this['InitiatingProcessFolderPath']) and grep('$exserver=Get-ExchangeServer ([Environment]::MachineName)
    -ErrorVariable exerr 2> $null', this['ProcessCommandLine']))
  sigma_id: 25676e10-2121-446e-80a4-71ff8506af47
- name: Suspicious PowerShell Download and Execute Pattern
  query: grep('IEX ((New-Object Net.WebClient).DownloadString', this['ProcessCommandLine'])
    or grep('IEX (New-Object Net.WebClient).DownloadString', this['ProcessCommandLine'])
    or grep('IEX((New-Object Net.WebClient).DownloadString', this['ProcessCommandLine'])
    or grep('IEX(New-Object Net.WebClient).DownloadString', this['ProcessCommandLine'])
    or grep(' -command (New-Object System.Net.WebClient).DownloadFile(', this['ProcessCommandLine'])
    or grep(' -c (New-Object System.Net.WebClient).DownloadFile(', this['ProcessCommandLine'])
  sigma_id: e6c54d94-498c-4562-a37c-b469d8e9a275
- name: Suspicious PowerShell Parameter Substring
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']))
    and (grep(' -windowstyle h ', this['ProcessCommandLine']) or grep(' -windowstyl
    h', this['ProcessCommandLine']) or grep(' -windowsty h', this['ProcessCommandLine'])
    or grep(' -windowst h', this['ProcessCommandLine']) or grep(' -windows h', this['ProcessCommandLine'])
    or grep(' -windo h', this['ProcessCommandLine']) or grep(' -wind h', this['ProcessCommandLine'])
    or grep(' -win h', this['ProcessCommandLine']) or grep(' -wi h', this['ProcessCommandLine'])
    or grep(' -win h ', this['ProcessCommandLine']) or grep(' -win hi ', this['ProcessCommandLine'])
    or grep(' -win hid ', this['ProcessCommandLine']) or grep(' -win hidd ', this['ProcessCommandLine'])
    or grep(' -win hidde ', this['ProcessCommandLine']) or grep(' -NoPr ', this['ProcessCommandLine'])
    or grep(' -NoPro ', this['ProcessCommandLine']) or grep(' -NoProf ', this['ProcessCommandLine'])
    or grep(' -NoProfi ', this['ProcessCommandLine']) or grep(' -NoProfil ', this['ProcessCommandLine'])
    or grep(' -nonin ', this['ProcessCommandLine']) or grep(' -nonint ', this['ProcessCommandLine'])
    or grep(' -noninte ', this['ProcessCommandLine']) or grep(' -noninter ', this['ProcessCommandLine'])
    or grep(' -nonintera ', this['ProcessCommandLine']) or grep(' -noninterac ', this['ProcessCommandLine'])
    or grep(' -noninteract ', this['ProcessCommandLine']) or grep(' -noninteracti
    ', this['ProcessCommandLine']) or grep(' -noninteractiv ', this['ProcessCommandLine'])
    or grep(' -ec ', this['ProcessCommandLine']) or grep(' -encodedComman ', this['ProcessCommandLine'])
    or grep(' -encodedComma ', this['ProcessCommandLine']) or grep(' -encodedComm
    ', this['ProcessCommandLine']) or grep(' -encodedCom ', this['ProcessCommandLine'])
    or grep(' -encodedCo ', this['ProcessCommandLine']) or grep(' -encodedC ', this['ProcessCommandLine'])
    or grep(' -encoded ', this['ProcessCommandLine']) or grep(' -encode ', this['ProcessCommandLine'])
    or grep(' -encod ', this['ProcessCommandLine']) or grep(' -enco ', this['ProcessCommandLine'])
    or grep(' -en ', this['ProcessCommandLine']) or grep(' -executionpolic ', this['ProcessCommandLine'])
    or grep(' -executionpoli ', this['ProcessCommandLine']) or grep(' -executionpol
    ', this['ProcessCommandLine']) or grep(' -executionpo ', this['ProcessCommandLine'])
    or grep(' -executionp ', this['ProcessCommandLine']) or grep(' -execution bypass',
    this['ProcessCommandLine']) or grep(' -executio bypass', this['ProcessCommandLine'])
    or grep(' -executi bypass', this['ProcessCommandLine']) or grep(' -execut bypass',
    this['ProcessCommandLine']) or grep(' -execu bypass', this['ProcessCommandLine'])
    or grep(' -exec bypass', this['ProcessCommandLine']) or grep(' -exe bypass', this['ProcessCommandLine'])
    or grep(' -ex bypass', this['ProcessCommandLine']) or grep(' -ep bypass', this['ProcessCommandLine'])
    or grep(' /windowstyle h ', this['ProcessCommandLine']) or grep(' /windowstyl
    h', this['ProcessCommandLine']) or grep(' /windowsty h', this['ProcessCommandLine'])
    or grep(' /windowst h', this['ProcessCommandLine']) or grep(' /windows h', this['ProcessCommandLine'])
    or grep(' /windo h', this['ProcessCommandLine']) or grep(' /wind h', this['ProcessCommandLine'])
    or grep(' /win h', this['ProcessCommandLine']) or grep(' /wi h', this['ProcessCommandLine'])
    or grep(' /win h ', this['ProcessCommandLine']) or grep(' /win hi ', this['ProcessCommandLine'])
    or grep(' /win hid ', this['ProcessCommandLine']) or grep(' /win hidd ', this['ProcessCommandLine'])
    or grep(' /win hidde ', this['ProcessCommandLine']) or grep(' /NoPr ', this['ProcessCommandLine'])
    or grep(' /NoPro ', this['ProcessCommandLine']) or grep(' /NoProf ', this['ProcessCommandLine'])
    or grep(' /NoProfi ', this['ProcessCommandLine']) or grep(' /NoProfil ', this['ProcessCommandLine'])
    or grep(' /nonin ', this['ProcessCommandLine']) or grep(' /nonint ', this['ProcessCommandLine'])
    or grep(' /noninte ', this['ProcessCommandLine']) or grep(' /noninter ', this['ProcessCommandLine'])
    or grep(' /nonintera ', this['ProcessCommandLine']) or grep(' /noninterac ', this['ProcessCommandLine'])
    or grep(' /noninteract ', this['ProcessCommandLine']) or grep(' /noninteracti
    ', this['ProcessCommandLine']) or grep(' /noninteractiv ', this['ProcessCommandLine'])
    or grep(' /ec ', this['ProcessCommandLine']) or grep(' /encodedComman ', this['ProcessCommandLine'])
    or grep(' /encodedComma ', this['ProcessCommandLine']) or grep(' /encodedComm
    ', this['ProcessCommandLine']) or grep(' /encodedCom ', this['ProcessCommandLine'])
    or grep(' /encodedCo ', this['ProcessCommandLine']) or grep(' /encodedC ', this['ProcessCommandLine'])
    or grep(' /encoded ', this['ProcessCommandLine']) or grep(' /encode ', this['ProcessCommandLine'])
    or grep(' /encod ', this['ProcessCommandLine']) or grep(' /enco ', this['ProcessCommandLine'])
    or grep(' /en ', this['ProcessCommandLine']) or grep(' /executionpolic ', this['ProcessCommandLine'])
    or grep(' /executionpoli ', this['ProcessCommandLine']) or grep(' /executionpol
    ', this['ProcessCommandLine']) or grep(' /executionpo ', this['ProcessCommandLine'])
    or grep(' /executionp ', this['ProcessCommandLine']) or grep(' /execution bypass',
    this['ProcessCommandLine']) or grep(' /executio bypass', this['ProcessCommandLine'])
    or grep(' /executi bypass', this['ProcessCommandLine']) or grep(' /execut bypass',
    this['ProcessCommandLine']) or grep(' /execu bypass', this['ProcessCommandLine'])
    or grep(' /exec bypass', this['ProcessCommandLine']) or grep(' /exe bypass', this['ProcessCommandLine'])
    or grep(' /ex bypass', this['ProcessCommandLine']) or grep(' /ep bypass', this['ProcessCommandLine']))
  sigma_id: 36210e0d-5b19-485d-a087-c096088885f0
- name: Suspicious PowerShell Parent Process
  query: (grep('tomcat', this['InitiatingProcessFolderPath']) or grep('\\amigo.exe',
    this['InitiatingProcessFolderPath']) or grep('\\browser.exe', this['InitiatingProcessFolderPath'])
    or grep('\\chrome.exe', this['InitiatingProcessFolderPath']) or grep('\\firefox.exe',
    this['InitiatingProcessFolderPath']) or grep('\\httpd.exe', this['InitiatingProcessFolderPath'])
    or grep('\\iexplore.exe', this['InitiatingProcessFolderPath']) or grep('\\jbosssvc.exe',
    this['InitiatingProcessFolderPath']) or grep('\\microsoftedge.exe', this['InitiatingProcessFolderPath'])
    or grep('\\microsoftedgecp.exe', this['InitiatingProcessFolderPath']) or grep('\\MicrosoftEdgeSH.exe',
    this['InitiatingProcessFolderPath']) or grep('\\mshta.exe', this['InitiatingProcessFolderPath'])
    or grep('\\nginx.exe', this['InitiatingProcessFolderPath']) or grep('\\outlook.exe',
    this['InitiatingProcessFolderPath']) or grep('\\php-cgi.exe', this['InitiatingProcessFolderPath'])
    or grep('\\regsvr32.exe', this['InitiatingProcessFolderPath']) or grep('\\rundll32.exe',
    this['InitiatingProcessFolderPath']) or grep('\\safari.exe', this['InitiatingProcessFolderPath'])
    or grep('\\services.exe', this['InitiatingProcessFolderPath']) or grep('\\sqlagent.exe',
    this['InitiatingProcessFolderPath']) or grep('\\sqlserver.exe', this['InitiatingProcessFolderPath'])
    or grep('\\sqlservr.exe', this['InitiatingProcessFolderPath']) or grep('\\vivaldi.exe',
    this['InitiatingProcessFolderPath']) or grep('\\w3wp.exe', this['InitiatingProcessFolderPath']))
    and (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or grep('/c powershell', this['ProcessCommandLine']) or grep('/c pwsh', this['ProcessCommandLine'])
    or grep('Windows PowerShell', this['ProcessVersionInfoFileDescription']) or grep('PowerShell
    Core 6', this['ProcessVersionInfoProductName']) or this['ProcessVersionInfoOriginalFileName']
    in ['PowerShell.EXE', 'pwsh.dll'])
  sigma_id: 754ed792-634f-40ae-b3bc-e0448d33f695
- name: PowerShell Script Run in AppData
  query: (grep('powershell.exe', this['ProcessCommandLine']) or grep('\\powershell',
    this['ProcessCommandLine']) or grep('\\pwsh', this['ProcessCommandLine']) or grep('pwsh.exe',
    this['ProcessCommandLine'])) and grep('/c ', this['ProcessCommandLine']) and grep('\\AppData\\',
    this['ProcessCommandLine']) and (grep('Local\\', this['ProcessCommandLine']) or
    grep('Roaming\\', this['ProcessCommandLine']))
  sigma_id: ac175779-025a-4f12-98b0-acdaeb77ea85
- name: PowerShell DownloadFile
  query: grep('powershell', this['ProcessCommandLine']) and grep('.DownloadFile',
    this['ProcessCommandLine']) and grep('System.Net.WebClient', this['ProcessCommandLine'])
  sigma_id: 8f70ac5f-1f6f-4f8e-b454-db19561216c5
- name: User Discovery And Export Via Get-ADUser Cmdlet
  query: '(grep(''\\powershell.exe'', this[''FolderPath'']) or grep(''\\pwsh.exe'',
    this[''FolderPath'']) or this[''ProcessVersionInfoOriginalFileName''] in [''PowerShell.EXE'',
    ''pwsh.dll'']) and grep(''Get-ADUser '', this[''ProcessCommandLine'']) and grep(''(\''
    -Filter \'', <SpecialChars.WILDCARD_MULTI: 1>)'', this[''ProcessCommandLine''])
    and (grep('' > '', this[''ProcessCommandLine'']) or grep('' | Select '', this[''ProcessCommandLine''])
    or grep(''Out-File'', this[''ProcessCommandLine'']) or grep(''Set-Content'', this[''ProcessCommandLine''])
    or grep(''Add-Content'', this[''ProcessCommandLine'']))'
  sigma_id: 1114e048-b69c-4f41-bc20-657245ae6e3f
- name: Net WebClient Casing Anomalies
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll'])
    and (grep('TgBlAFQALgB3AEUAQg', this['ProcessCommandLine']) or grep('4AZQBUAC4AdwBFAEIA',
    this['ProcessCommandLine']) or grep('OAGUAVAAuAHcARQBCA', this['ProcessCommandLine'])
    or grep('bgBFAHQALgB3AGUAYg', this['ProcessCommandLine']) or grep('4ARQB0AC4AdwBlAGIA',
    this['ProcessCommandLine']) or grep('uAEUAdAAuAHcAZQBiA', this['ProcessCommandLine'])
    or grep('TgBFAHQALgB3AGUAYg', this['ProcessCommandLine']) or grep('OAEUAdAAuAHcAZQBiA',
    this['ProcessCommandLine']) or grep('bgBlAFQALgB3AGUAYg', this['ProcessCommandLine'])
    or grep('4AZQBUAC4AdwBlAGIA', this['ProcessCommandLine']) or grep('uAGUAVAAuAHcAZQBiA',
    this['ProcessCommandLine']) or grep('TgBlAFQALgB3AGUAYg', this['ProcessCommandLine'])
    or grep('OAGUAVAAuAHcAZQBiA', this['ProcessCommandLine']) or grep('bgBFAFQALgB3AGUAYg',
    this['ProcessCommandLine']) or grep('4ARQBUAC4AdwBlAGIA', this['ProcessCommandLine'])
    or grep('uAEUAVAAuAHcAZQBiA', this['ProcessCommandLine']) or grep('bgBlAHQALgBXAGUAYg',
    this['ProcessCommandLine']) or grep('4AZQB0AC4AVwBlAGIA', this['ProcessCommandLine'])
    or grep('uAGUAdAAuAFcAZQBiA', this['ProcessCommandLine']) or grep('bgBFAHQALgBXAGUAYg',
    this['ProcessCommandLine']) or grep('4ARQB0AC4AVwBlAGIA', this['ProcessCommandLine'])
    or grep('uAEUAdAAuAFcAZQBiA', this['ProcessCommandLine']) or grep('TgBFAHQALgBXAGUAYg',
    this['ProcessCommandLine']) or grep('OAEUAdAAuAFcAZQBiA', this['ProcessCommandLine'])
    or grep('bgBlAFQALgBXAGUAYg', this['ProcessCommandLine']) or grep('4AZQBUAC4AVwBlAGIA',
    this['ProcessCommandLine']) or grep('uAGUAVAAuAFcAZQBiA', this['ProcessCommandLine'])
    or grep('TgBlAFQALgBXAGUAYg', this['ProcessCommandLine']) or grep('OAGUAVAAuAFcAZQBiA',
    this['ProcessCommandLine']) or grep('bgBFAFQALgBXAGUAYg', this['ProcessCommandLine'])
    or grep('4ARQBUAC4AVwBlAGIA', this['ProcessCommandLine']) or grep('uAEUAVAAuAFcAZQBiA',
    this['ProcessCommandLine']) or grep('bgBlAHQALgB3AEUAYg', this['ProcessCommandLine'])
    or grep('4AZQB0AC4AdwBFAGIA', this['ProcessCommandLine']) or grep('uAGUAdAAuAHcARQBiA',
    this['ProcessCommandLine']) or grep('TgBlAHQALgB3AEUAYg', this['ProcessCommandLine'])
    or grep('OAGUAdAAuAHcARQBiA', this['ProcessCommandLine']) or grep('bgBFAHQALgB3AEUAYg',
    this['ProcessCommandLine']) or grep('4ARQB0AC4AdwBFAGIA', this['ProcessCommandLine'])
    or grep('uAEUAdAAuAHcARQBiA', this['ProcessCommandLine']) or grep('TgBFAHQALgB3AEUAYg',
    this['ProcessCommandLine']) or grep('OAEUAdAAuAHcARQBiA', this['ProcessCommandLine'])
    or grep('bgBlAFQALgB3AEUAYg', this['ProcessCommandLine']) or grep('4AZQBUAC4AdwBFAGIA',
    this['ProcessCommandLine']) or grep('uAGUAVAAuAHcARQBiA', this['ProcessCommandLine'])
    or grep('TgBlAFQALgB3AEUAYg', this['ProcessCommandLine']) or grep('OAGUAVAAuAHcARQBiA',
    this['ProcessCommandLine']) or grep('bgBFAFQALgB3AEUAYg', this['ProcessCommandLine'])
    or grep('4ARQBUAC4AdwBFAGIA', this['ProcessCommandLine']) or grep('uAEUAVAAuAHcARQBiA',
    this['ProcessCommandLine']) or grep('TgBFAFQALgB3AEUAYg', this['ProcessCommandLine'])
    or grep('OAEUAVAAuAHcARQBiA', this['ProcessCommandLine']) or grep('bgBlAHQALgBXAEUAYg',
    this['ProcessCommandLine']) or grep('4AZQB0AC4AVwBFAGIA', this['ProcessCommandLine'])
    or grep('uAGUAdAAuAFcARQBiA', this['ProcessCommandLine']) or grep('TgBlAHQALgBXAEUAYg',
    this['ProcessCommandLine']) or grep('OAGUAdAAuAFcARQBiA', this['ProcessCommandLine'])
    or grep('bgBFAHQALgBXAEUAYg', this['ProcessCommandLine']) or grep('4ARQB0AC4AVwBFAGIA',
    this['ProcessCommandLine']) or grep('uAEUAdAAuAFcARQBiA', this['ProcessCommandLine'])
    or grep('TgBFAHQALgBXAEUAYg', this['ProcessCommandLine']) or grep('OAEUAdAAuAFcARQBiA',
    this['ProcessCommandLine']) or grep('bgBlAFQALgBXAEUAYg', this['ProcessCommandLine'])
    or grep('4AZQBUAC4AVwBFAGIA', this['ProcessCommandLine']) or grep('uAGUAVAAuAFcARQBiA',
    this['ProcessCommandLine']) or grep('TgBlAFQALgBXAEUAYg', this['ProcessCommandLine'])
    or grep('OAGUAVAAuAFcARQBiA', this['ProcessCommandLine']) or grep('bgBFAFQALgBXAEUAYg',
    this['ProcessCommandLine']) or grep('4ARQBUAC4AVwBFAGIA', this['ProcessCommandLine'])
    or grep('uAEUAVAAuAFcARQBiA', this['ProcessCommandLine']) or grep('TgBFAFQALgBXAEUAYg',
    this['ProcessCommandLine']) or grep('OAEUAVAAuAFcARQBiA', this['ProcessCommandLine'])
    or grep('bgBlAHQALgB3AGUAQg', this['ProcessCommandLine']) or grep('4AZQB0AC4AdwBlAEIA',
    this['ProcessCommandLine']) or grep('uAGUAdAAuAHcAZQBCA', this['ProcessCommandLine'])
    or grep('TgBlAHQALgB3AGUAQg', this['ProcessCommandLine']) or grep('OAGUAdAAuAHcAZQBCA',
    this['ProcessCommandLine']) or grep('bgBFAHQALgB3AGUAQg', this['ProcessCommandLine'])
    or grep('4ARQB0AC4AdwBlAEIA', this['ProcessCommandLine']) or grep('uAEUAdAAuAHcAZQBCA',
    this['ProcessCommandLine']) or grep('TgBFAHQALgB3AGUAQg', this['ProcessCommandLine'])
    or grep('OAEUAdAAuAHcAZQBCA', this['ProcessCommandLine']) or grep('bgBlAFQALgB3AGUAQg',
    this['ProcessCommandLine']) or grep('4AZQBUAC4AdwBlAEIA', this['ProcessCommandLine'])
    or grep('uAGUAVAAuAHcAZQBCA', this['ProcessCommandLine']) or grep('TgBlAFQALgB3AGUAQg',
    this['ProcessCommandLine']) or grep('OAGUAVAAuAHcAZQBCA', this['ProcessCommandLine'])
    or grep('bgBFAFQALgB3AGUAQg', this['ProcessCommandLine']) or grep('4ARQBUAC4AdwBlAEIA',
    this['ProcessCommandLine']) or grep('uAEUAVAAuAHcAZQBCA', this['ProcessCommandLine'])
    or grep('TgBFAFQALgB3AGUAQg', this['ProcessCommandLine']) or grep('OAEUAVAAuAHcAZQBCA',
    this['ProcessCommandLine']) or grep('bgBlAHQALgBXAGUAQg', this['ProcessCommandLine'])
    or grep('4AZQB0AC4AVwBlAEIA', this['ProcessCommandLine']) or grep('uAGUAdAAuAFcAZQBCA',
    this['ProcessCommandLine']) or grep('TgBlAHQALgBXAGUAQg', this['ProcessCommandLine'])
    or grep('OAGUAdAAuAFcAZQBCA', this['ProcessCommandLine']) or grep('bgBFAHQALgBXAGUAQg',
    this['ProcessCommandLine']) or grep('4ARQB0AC4AVwBlAEIA', this['ProcessCommandLine'])
    or grep('uAEUAdAAuAFcAZQBCA', this['ProcessCommandLine']) or grep('TgBFAHQALgBXAGUAQg',
    this['ProcessCommandLine']) or grep('OAEUAdAAuAFcAZQBCA', this['ProcessCommandLine'])
    or grep('bgBlAFQALgBXAGUAQg', this['ProcessCommandLine']) or grep('4AZQBUAC4AVwBlAEIA',
    this['ProcessCommandLine']) or grep('uAGUAVAAuAFcAZQBCA', this['ProcessCommandLine'])
    or grep('TgBlAFQALgBXAGUAQg', this['ProcessCommandLine']) or grep('OAGUAVAAuAFcAZQBCA',
    this['ProcessCommandLine']) or grep('bgBFAFQALgBXAGUAQg', this['ProcessCommandLine'])
    or grep('4ARQBUAC4AVwBlAEIA', this['ProcessCommandLine']) or grep('uAEUAVAAuAFcAZQBCA',
    this['ProcessCommandLine']) or grep('TgBFAFQALgBXAGUAQg', this['ProcessCommandLine'])
    or grep('OAEUAVAAuAFcAZQBCA', this['ProcessCommandLine']) or grep('bgBlAHQALgB3AEUAQg',
    this['ProcessCommandLine']) or grep('4AZQB0AC4AdwBFAEIA', this['ProcessCommandLine'])
    or grep('uAGUAdAAuAHcARQBCA', this['ProcessCommandLine']) or grep('TgBlAHQALgB3AEUAQg',
    this['ProcessCommandLine']) or grep('OAGUAdAAuAHcARQBCA', this['ProcessCommandLine'])
    or grep('bgBFAHQALgB3AEUAQg', this['ProcessCommandLine']) or grep('4ARQB0AC4AdwBFAEIA',
    this['ProcessCommandLine']) or grep('uAEUAdAAuAHcARQBCA', this['ProcessCommandLine'])
    or grep('TgBFAHQALgB3AEUAQg', this['ProcessCommandLine']) or grep('OAEUAdAAuAHcARQBCA',
    this['ProcessCommandLine']) or grep('bgBlAFQALgB3AEUAQg', this['ProcessCommandLine'])
    or grep('uAGUAVAAuAHcARQBCA', this['ProcessCommandLine']) or grep('bgBFAFQALgB3AEUAQg',
    this['ProcessCommandLine']) or grep('4ARQBUAC4AdwBFAEIA', this['ProcessCommandLine'])
    or grep('uAEUAVAAuAHcARQBCA', this['ProcessCommandLine']) or grep('TgBFAFQALgB3AEUAQg',
    this['ProcessCommandLine']) or grep('OAEUAVAAuAHcARQBCA', this['ProcessCommandLine'])
    or grep('TgBlAHQALgBXAEUAQg', this['ProcessCommandLine']) or grep('4AZQB0AC4AVwBFAEIA',
    this['ProcessCommandLine']) or grep('OAGUAdAAuAFcARQBCA', this['ProcessCommandLine'])
    or grep('bgBFAHQALgBXAEUAQg', this['ProcessCommandLine']) or grep('4ARQB0AC4AVwBFAEIA',
    this['ProcessCommandLine']) or grep('uAEUAdAAuAFcARQBCA', this['ProcessCommandLine'])
    or grep('TgBFAHQALgBXAEUAQg', this['ProcessCommandLine']) or grep('OAEUAdAAuAFcARQBCA',
    this['ProcessCommandLine']) or grep('bgBlAFQALgBXAEUAQg', this['ProcessCommandLine'])
    or grep('4AZQBUAC4AVwBFAEIA', this['ProcessCommandLine']) or grep('uAGUAVAAuAFcARQBCA',
    this['ProcessCommandLine']) or grep('TgBlAFQALgBXAEUAQg', this['ProcessCommandLine'])
    or grep('OAGUAVAAuAFcARQBCA', this['ProcessCommandLine']) or grep('bgBFAFQALgBXAEUAQg',
    this['ProcessCommandLine']) or grep('4ARQBUAC4AVwBFAEIA', this['ProcessCommandLine'])
    or grep('uAEUAVAAuAFcARQBCA', this['ProcessCommandLine']))
  sigma_id: c86133ad-4725-4bd0-8170-210788e0a7ba
- name: Suspicious X509Enrollment - Process Creation
  query: grep('X509Enrollment.CBinaryConverter', this['ProcessCommandLine']) or grep('884e2002-217d-11da-b2a4-000e7bbb2b09',
    this['ProcessCommandLine'])
  sigma_id: 114de787-4eb2-48cc-abdb-c0b449f93ea4
- name: Suspicious XOR Encoded PowerShell Command
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll']
    or grep('Windows PowerShell', this['ProcessVersionInfoFileDescription']) or grep('PowerShell
    Core 6', this['ProcessVersionInfoProductName'])) and grep('bxor', this['ProcessCommandLine'])
    and (grep('ForEach', this['ProcessCommandLine']) or grep('for(', this['ProcessCommandLine'])
    or grep('for ', this['ProcessCommandLine']) or grep('-join ', this['ProcessCommandLine'])
    or grep('-join\'', this['ProcessCommandLine']) or grep('-join"', this['ProcessCommandLine'])
    or grep('-join`', this['ProcessCommandLine']) or grep('::Join', this['ProcessCommandLine'])
    or grep('[char]', this['ProcessCommandLine']))
  sigma_id: bb780e0c-16cf-4383-8383-1e5471db6cf9
- name: Folder Compress To Potentially Suspicious Output Via Compress-Archive Cmdlet
  query: (grep('Compress-Archive -Path', this['ProcessCommandLine']) or grep('-DestinationPath
    $env:TEMP', this['ProcessCommandLine'])) or (grep('Compress-Archive -Path', this['ProcessCommandLine'])
    or grep('-DestinationPath', this['ProcessCommandLine']) or grep('\\AppData\\Local\\Temp\\',
    this['ProcessCommandLine'])) or (grep('Compress-Archive -Path', this['ProcessCommandLine'])
    or grep('-DestinationPath', this['ProcessCommandLine']) or grep(':\\Windows\\Temp\\',
    this['ProcessCommandLine']))
  sigma_id: 85a8e5ba-bd03-4bfb-bbfa-a4409a8f8b98
- name: Arbitrary File Download Via PresentationHost.EXE
  query: (grep('\\presentationhost.exe', this['FolderPath']) or grep('PresentationHost.exe',
    this['ProcessVersionInfoOriginalFileName'])) and (grep('http://', this['ProcessCommandLine'])
    or grep('https://', this['ProcessCommandLine']) or grep('ftp://', this['ProcessCommandLine']))
  sigma_id: b124ddf4-778d-418e-907f-6dd3fc0d31cd
- name: XBAP Execution From Uncommon Locations Via PresentationHost.EXE
  query: (grep('\\presentationhost.exe', this['FolderPath']) or grep('PresentationHost.exe',
    this['ProcessVersionInfoOriginalFileName'])) and grep('.xbap', this['ProcessCommandLine'])
    and not (grep(' C:\\Windows\\', this['ProcessCommandLine']) or grep(' C:\\Program
    Files', this['ProcessCommandLine']))
  sigma_id: d22e2925-cfd8-463f-96f6-89cec9d9bc5f
- name: Visual Studio NodejsTools PressAnyKey Arbitrary Binary Execution
  query: grep('\\Microsoft.NodejsTools.PressAnyKey.exe', this['InitiatingProcessFolderPath'])
  sigma_id: a20391f8-76fb-437b-abc0-dba2df1952c6
- name: Abusing Print Executable
  query: grep('\\print.exe', this['FolderPath']) and grep('print', this['ProcessCommandLine'])
    and grep('/D', this['ProcessCommandLine']) and grep('.exe', this['ProcessCommandLine'])
    and not grep('print.exe', this['ProcessCommandLine'])
  sigma_id: bafac3d6-7de9-4dd9-8874-4a1194b493ed
- name: File Download Using ProtocolHandler.exe
  query: (grep('\\protocolhandler.exe', this['FolderPath']) or grep('ProtocolHandler.exe',
    this['ProcessVersionInfoOriginalFileName'])) and (grep('ftp://', this['ProcessCommandLine'])
    or grep('http://', this['ProcessCommandLine']) or grep('https://', this['ProcessCommandLine']))
  sigma_id: 104cdb48-a7a8-4ca7-a453-32942c6e5dcb
- name: Potential Provlaunch.EXE Binary Proxy Execution Abuse
  query: grep('\\provlaunch.exe', this['InitiatingProcessFolderPath']) and not (grep('\\calc.exe',
    this['FolderPath']) or grep('\\cmd.exe', this['FolderPath']) or grep('\\cscript.exe',
    this['FolderPath']) or grep('\\mshta.exe', this['FolderPath']) or grep('\\notepad.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\rundll32.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath']) or grep(':\\PerfLogs\\',
    this['FolderPath']) or grep(':\\Temp\\', this['FolderPath']) or grep(':\\Users\\Public\\',
    this['FolderPath']) or grep('\\AppData\\Temp\\', this['FolderPath']) or grep('\\Windows\\System32\\Tasks\\',
    this['FolderPath']) or grep('\\Windows\\Tasks\\', this['FolderPath']) or grep('\\Windows\\Temp\\',
    this['FolderPath']))
  sigma_id: 7f5d1c9a-3e83-48df-95a7-2b98aae6c13c
- name: Suspicious Provlaunch.EXE Child Process
  query: grep('\\provlaunch.exe', this['InitiatingProcessFolderPath']) and (grep('\\calc.exe',
    this['FolderPath']) or grep('\\cmd.exe', this['FolderPath']) or grep('\\cscript.exe',
    this['FolderPath']) or grep('\\mshta.exe', this['FolderPath']) or grep('\\notepad.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\rundll32.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath']) or grep(':\\PerfLogs\\',
    this['FolderPath']) or grep(':\\Temp\\', this['FolderPath']) or grep(':\\Users\\Public\\',
    this['FolderPath']) or grep('\\AppData\\Temp\\', this['FolderPath']) or grep('\\Windows\\System32\\Tasks\\',
    this['FolderPath']) or grep('\\Windows\\Tasks\\', this['FolderPath']) or grep('\\Windows\\Temp\\',
    this['FolderPath']))
  sigma_id: f9999590-1f94-4a34-a91e-951e47bedefd
- name: Screen Capture Activity Via Psr.EXE
  query: grep('\\Psr.exe', this['FolderPath']) and (grep('/start', this['ProcessCommandLine'])
    or grep('-start', this['ProcessCommandLine']))
  sigma_id: 2158f96f-43c2-43cb-952a-ab4580f32382
- name: PUA - 3Proxy Execution
  query: grep('\\3proxy.exe', this['FolderPath']) or grep('3proxy - tiny proxy server',
    this['ProcessVersionInfoFileDescription']) or grep('.exe -i127.0.0.1 -p', this['ProcessCommandLine'])
  sigma_id: f38a82d2-fba3-4781-b549-525efbec8506
- name: PUA - Suspicious ActiveDirectory Enumeration Via AdFind.EXE
  query: grep('lockoutduration', this['ProcessCommandLine']) or grep('lockoutthreshold',
    this['ProcessCommandLine']) or grep('lockoutobservationwindow', this['ProcessCommandLine'])
    or grep('maxpwdage', this['ProcessCommandLine']) or grep('minpwdage', this['ProcessCommandLine'])
    or grep('minpwdlength', this['ProcessCommandLine']) or grep('pwdhistorylength',
    this['ProcessCommandLine']) or grep('pwdproperties', this['ProcessCommandLine'])
    or grep('-sc admincountdmp', this['ProcessCommandLine']) or grep('-sc exchaddresses',
    this['ProcessCommandLine'])
  sigma_id: 455b9d50-15a1-4b99-853f-8d37655a4c1b
- name: PUA - AdFind Suspicious Execution
  query: grep('domainlist', this['ProcessCommandLine']) or grep('trustdmp', this['ProcessCommandLine'])
    or grep('dcmodes', this['ProcessCommandLine']) or grep('adinfo', this['ProcessCommandLine'])
    or grep(' dclist ', this['ProcessCommandLine']) or grep('computer_pwdnotreqd',
    this['ProcessCommandLine']) or grep('objectcategory=', this['ProcessCommandLine'])
    or grep('-subnets -f', this['ProcessCommandLine']) or grep('name="Domain Admins"',
    this['ProcessCommandLine']) or grep('-sc u:', this['ProcessCommandLine']) or grep('domainncs',
    this['ProcessCommandLine']) or grep('dompol', this['ProcessCommandLine']) or grep('
    oudmp ', this['ProcessCommandLine']) or grep('subnetdmp', this['ProcessCommandLine'])
    or grep('gpodmp', this['ProcessCommandLine']) or grep('fspdmp', this['ProcessCommandLine'])
    or grep('users_noexpire', this['ProcessCommandLine']) or grep('computers_active',
    this['ProcessCommandLine']) or grep('computers_pwdnotreqd', this['ProcessCommandLine'])
  sigma_id: 9a132afa-654e-11eb-ae93-0242ac130002
- name: PUA - Advanced IP Scanner Execution
  query: grep('\\advanced_ip_scanner', this['FolderPath']) or grep('advanced_ip_scanner',
    this['ProcessVersionInfoOriginalFileName']) or grep('Advanced IP Scanner', this['ProcessVersionInfoFileDescription'])
    or grep('/portable', this['ProcessCommandLine']) and grep('/lng', this['ProcessCommandLine'])
  sigma_id: bef37fa2-f205-4a7b-b484-0759bfd5f86f
- name: PUA - Advanced Port Scanner Execution
  query: grep('\\advanced_port_scanner', this['FolderPath']) or grep('advanced_port_scanner',
    this['ProcessVersionInfoOriginalFileName']) or grep('Advanced Port Scanner', this['ProcessVersionInfoFileDescription'])
    or grep('/portable', this['ProcessCommandLine']) and grep('/lng', this['ProcessCommandLine'])
  sigma_id: 54773c5f-f1cc-4703-9126-2f797d96a69d
- name: PUA - AdvancedRun Execution
  query: grep('AdvancedRun.exe', this['ProcessVersionInfoOriginalFileName']) or grep('
    /EXEFilename ', this['ProcessCommandLine']) and grep(' /Run', this['ProcessCommandLine'])
    or grep(' /WindowState 0', this['ProcessCommandLine']) and grep(' /RunAs ', this['ProcessCommandLine'])
    and grep(' /CommandLine ', this['ProcessCommandLine'])
  sigma_id: d2b749ee-4225-417e-b20e-a8d2193cbb84
- name: PUA - AdvancedRun Suspicious Execution
  query: (grep('/EXEFilename', this['ProcessCommandLine']) or grep('/CommandLine',
    this['ProcessCommandLine'])) and (grep(' /RunAs 8 ', this['ProcessCommandLine'])
    or grep(' /RunAs 4 ', this['ProcessCommandLine']) or grep(' /RunAs 10 ', this['ProcessCommandLine'])
    or grep(' /RunAs 11 ', this['ProcessCommandLine']) or grep('/RunAs 8', this['ProcessCommandLine'])
    or grep('/RunAs 4', this['ProcessCommandLine']) or grep('/RunAs 10', this['ProcessCommandLine'])
    or grep('/RunAs 11', this['ProcessCommandLine']))
  sigma_id: fa00b701-44c6-4679-994d-5a18afa8a707
- name: PUA - Chisel Tunneling Tool Execution
  query: grep('\\chisel.exe', this['FolderPath']) or (grep('exe client ', this['ProcessCommandLine'])
    or grep('exe server ', this['ProcessCommandLine'])) and (grep('-socks5', this['ProcessCommandLine'])
    or grep('-reverse', this['ProcessCommandLine']) or grep(' r:', this['ProcessCommandLine'])
    or grep(':127.0.0.1:', this['ProcessCommandLine']) or grep('-tls-skip-verify ',
    this['ProcessCommandLine']) or grep(':socks', this['ProcessCommandLine']))
  sigma_id: 8b0e12da-d3c3-49db-bb4f-256703f380e5
- name: PUA - CleanWipe Execution
  query: grep('\\SepRemovalToolNative_x64.exe', this['FolderPath']) or grep('\\CATClean.exe',
    this['FolderPath']) and grep('--uninstall', this['ProcessCommandLine']) or grep('\\NetInstaller.exe',
    this['FolderPath']) and grep('-r', this['ProcessCommandLine']) or grep('\\WFPUnins.exe',
    this['FolderPath']) and grep('/uninstall', this['ProcessCommandLine']) and grep('/enterprise',
    this['ProcessCommandLine'])
  sigma_id: f44800ac-38ec-471f-936e-3fa7d9c53100
- name: PUA - Crassus Execution
  query: grep('\\Crassus.exe', this['FolderPath']) or grep('Crassus.exe', this['ProcessVersionInfoOriginalFileName'])
    or grep('Crassus', this['ProcessVersionInfoFileDescription'])
  sigma_id: 2c32b543-1058-4808-91c6-5b31b8bed6c5
- name: PUA - CsExec Execution
  query: grep('\\csexec.exe', this['FolderPath']) or grep('csexec', this['ProcessVersionInfoFileDescription'])
  sigma_id: d08a2711-ee8b-4323-bdec-b7d85e892b31
- name: PUA - DefenderCheck Execution
  query: grep('\\DefenderCheck.exe', this['FolderPath']) or grep('DefenderCheck',
    this['ProcessVersionInfoFileDescription'])
  sigma_id: f0ca6c24-3225-47d5-b1f5-352bf07ecfa7
- name: PUA - DIT Snapshot Viewer
  query: grep('\\ditsnap.exe', this['FolderPath']) or grep('ditsnap.exe', this['ProcessCommandLine'])
  sigma_id: d3b70aad-097e-409c-9df2-450f80dc476b
- name: PUA - Fast Reverse Proxy (FRP) Execution
  query: grep('\\frpc.exe', this['FolderPath']) or grep('\\frps.exe', this['FolderPath'])
    or grep('\\frpc.ini', this['ProcessCommandLine']) or grep('7D9C233B8C9E3F0EA290D2B84593C842',
    this['MD5']) or grep('06DDC9280E1F1810677935A2477012960905942F', this['SHA1'])
    or grep('57B0936B8D336D8E981C169466A15A5FD21A7D5A2C7DAF62D5E142EE860E387C', this['SHA256'])
  sigma_id: 32410e29-5f94-4568-b6a3-d91a8adad863
- name: PUA- IOX Tunneling Tool Execution
  query: grep('\\iox.exe', this['FolderPath']) or grep('.exe fwd -l ', this['ProcessCommandLine'])
    or grep('.exe fwd -r ', this['ProcessCommandLine']) or grep('.exe proxy -l ',
    this['ProcessCommandLine']) or grep('.exe proxy -r ', this['ProcessCommandLine'])
    or grep('9DB2D314DD3F704A02051EF5EA210993', this['MD5']) or grep('039130337E28A6623ECF9A0A3DA7D92C5964D8DD',
    this['SHA1']) or grep('C6CF82919B809967D9D90EA73772A8AA1C1EB3BC59252D977500F64F1A0D6731',
    this['SHA256'])
  sigma_id: d7654f02-e04b-4934-9838-65c46f187ebc
- name: PUA - Mouse Lock Execution
  query: grep('Mouse Lock', this['ProcessVersionInfoProductName']) or grep('Misc314',
    this['ProcessVersionInfoCompanyName']) or grep('Mouse Lock_', this['ProcessCommandLine'])
  sigma_id: c9192ad9-75e5-43eb-8647-82a0a5b493e3
- name: PUA - Netcat Suspicious Execution
  query: grep('\\nc.exe', this['FolderPath']) or grep('\\ncat.exe', this['FolderPath'])
    or grep('\\netcat.exe', this['FolderPath']) or grep(' -lvp ', this['ProcessCommandLine'])
    or grep(' -lvnp', this['ProcessCommandLine']) or grep(' -l -v -p ', this['ProcessCommandLine'])
    or grep(' -lv -p ', this['ProcessCommandLine']) or grep(' -l --proxy-type http
    ', this['ProcessCommandLine']) or grep(' -vnl --exec ', this['ProcessCommandLine'])
    or grep(' -vnl -e ', this['ProcessCommandLine']) or grep(' --lua-exec ', this['ProcessCommandLine'])
    or grep(' --sh-exec ', this['ProcessCommandLine'])
  sigma_id: e31033fc-33f0-4020-9a16-faf9b31cbf08
- name: PUA - SoftPerfect Netscan Execution
  query: grep('\\netscan.exe', this['FolderPath']) or grep('Network Scanner', this['ProcessVersionInfoProductName'])
    or grep('Application for scanning networks', this['ProcessVersionInfoFileDescription'])
  sigma_id: ca387a8e-1c84-4da3-9993-028b45342d30
- name: PUA - Ngrok Execution
  query: grep(' tcp 139', this['ProcessCommandLine']) or grep(' tcp 445', this['ProcessCommandLine'])
    or grep(' tcp 3389', this['ProcessCommandLine']) or grep(' tcp 5985', this['ProcessCommandLine'])
    or grep(' tcp 5986', this['ProcessCommandLine']) or grep(' start ', this['ProcessCommandLine'])
    and grep('--all', this['ProcessCommandLine']) and grep('--config', this['ProcessCommandLine'])
    and grep('.yml', this['ProcessCommandLine']) or grep('ngrok.exe', this['FolderPath'])
    and (grep(' tcp ', this['ProcessCommandLine']) or grep(' http ', this['ProcessCommandLine'])
    or grep(' authtoken ', this['ProcessCommandLine'])) or grep('.exe authtoken ',
    this['ProcessCommandLine']) or grep('.exe start --all', this['ProcessCommandLine'])
  sigma_id: ee37eb7c-a4e7-4cd5-8fa4-efa27f1c3f31
- name: PUA - Nimgrab Execution
  query: grep('\\nimgrab.exe', this['FolderPath']) or grep('2DD44C3C29D667F5C0EF5F9D7C7FFB8B',
    this['MD5']) or grep('F266609E91985F0FE3E31C5E8FAEEEC4FFA5E0322D8B6F15FE69F4C5165B9559',
    this['SHA256'])
  sigma_id: 74a12f18-505c-4114-8d0b-8448dd5485c6
- name: PUA - NirCmd Execution
  query: grep('\\NirCmd.exe', this['FolderPath']) or grep('NirCmd.exe', this['ProcessVersionInfoOriginalFileName'])
    or grep(' execmd ', this['ProcessCommandLine']) or grep('.exe script ', this['ProcessCommandLine'])
    or grep('.exe shexec ', this['ProcessCommandLine']) or grep(' runinteractive ',
    this['ProcessCommandLine']) or (grep(' exec ', this['ProcessCommandLine']) or
    grep(' exec2 ', this['ProcessCommandLine'])) and (grep(' show ', this['ProcessCommandLine'])
    or grep(' hide ', this['ProcessCommandLine']))
  sigma_id: 4e2ed651-1906-4a59-a78a-18220fca1b22
- name: PUA - NirCmd Execution As LOCAL SYSTEM
  query: grep(' runassystem ', this['ProcessCommandLine'])
  sigma_id: d9047477-0359-48c9-b8c7-792cedcdc9c4
- name: PUA - Nmap/Zenmap Execution
  query: grep('\\nmap.exe', this['FolderPath']) or grep('\\zennmap.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['nmap.exe', 'zennmap.exe']
  sigma_id: f6ecd1cf-19b8-4488-97f6-00f0924991a3
- name: PUA - NPS Tunneling Tool Execution
  query: grep('\\npc.exe', this['FolderPath']) or grep(' -server=', this['ProcessCommandLine'])
    and grep(' -vkey=', this['ProcessCommandLine']) and grep(' -password=', this['ProcessCommandLine'])
    or grep(' -config=npc', this['ProcessCommandLine']) or grep('AE8ACF66BFE3A44148964048B826D005',
    this['MD5']) or grep('CEA49E9B9B67F3A13AD0BE1C2655293EA3C18181', this['SHA1'])
    or grep('5A456283392FFCEEEACA3D3426C306EB470304637520D72FED1CC1FEBBBD6856', this['SHA256'])
  sigma_id: 68d37776-61db-42f5-bf54-27e87072d17e
- name: PUA - NSudo Execution
  query: (grep('\\NSudo.exe', this['FolderPath']) or grep('\\NSudoLC.exe', this['FolderPath'])
    or grep('\\NSudoLG.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['NSudo.exe', 'NSudoLC.exe', 'NSudoLG.exe']) and (grep('-U:S ', this['ProcessCommandLine'])
    or grep('-U:T ', this['ProcessCommandLine']) or grep('-U:E ', this['ProcessCommandLine'])
    or grep('-P:E ', this['ProcessCommandLine']) or grep('-M:S ', this['ProcessCommandLine'])
    or grep('-M:H ', this['ProcessCommandLine']) or grep('-U=S ', this['ProcessCommandLine'])
    or grep('-U=T ', this['ProcessCommandLine']) or grep('-U=E ', this['ProcessCommandLine'])
    or grep('-P=E ', this['ProcessCommandLine']) or grep('-M=S ', this['ProcessCommandLine'])
    or grep('-M=H ', this['ProcessCommandLine']) or grep('-ShowWindowMode:Hide', this['ProcessCommandLine']))
  sigma_id: 771d1eb5-9587-4568-95fb-9ec44153a012
- name: PUA - PingCastle Execution
  query: grep('f741f25ac909ee434e50812d436c73ff', this['MD5']) or grep('d40acbfc29ee24388262e3d8be16f622',
    this['MD5']) or grep('01bb2c16fadb992fa66228cd02d45c60', this['MD5']) or grep('9e1b18e62e42b5444fc55b51e640355b',
    this['MD5']) or grep('b7f8fe33ac471b074ca9e630ba0c7e79', this['MD5']) or grep('324579d717c9b9b8e71d0269d13f811f',
    this['MD5']) or grep('63257a1ddaf83cfa43fe24a3bc06c207', this['MD5']) or grep('049e85963826b059c9bac273bb9c82ab',
    this['MD5']) or grep('ecb98b7b4d4427eb8221381154ff4cb2', this['MD5']) or grep('faf87749ac790ec3a10dd069d10f9d63',
    this['MD5']) or grep('f296dba5d21ad18e6990b1992aea8f83', this['MD5']) or grep('93ba94355e794b6c6f98204cf39f7a11',
    this['MD5']) or grep('a258ef593ac63155523a461ecc73bdba', this['MD5']) or grep('97000eb5d1653f1140ee3f47186463c4',
    this['MD5']) or grep('95eb317fbbe14a82bd9fdf31c48b8d93', this['MD5']) or grep('32fe9f0d2630ac40ea29023920f20f49',
    this['MD5']) or grep('a05930dde939cfd02677fc18bb2b7df5', this['MD5']) or grep('124283924e86933ff9054a549d3a268b',
    this['MD5']) or grep('ceda6909b8573fdeb0351c6920225686', this['MD5']) or grep('60ce120040f2cd311c810ae6f6bbc182',
    this['MD5']) or grep('2f10cdc5b09100a260703a28eadd0ceb', this['MD5']) or grep('011d967028e797a4c16d547f7ba1463f',
    this['MD5']) or grep('2da9152c0970500c697c1c9b4a9e0360', this['MD5']) or grep('b5ba72034b8f44d431f55275bace9f8b',
    this['MD5']) or grep('d6ed9101df0f24e27ff92ddab42dacca', this['MD5']) or grep('3ed3cdb6d12aa1ac562ad185cdbf2d1d',
    this['MD5']) or grep('5e083cd0143ae95a6cb79b68c07ca573', this['MD5']) or grep('28caff93748cb84be70486e79f04c2df',
    this['MD5']) or grep('9d4f12c30f9b500f896efd1800e4dd11', this['MD5']) or grep('4586f7dd14271ad65a5fb696b393f4c0',
    this['MD5']) or grep('86ba9dddbdf49215145b5bcd081d4011', this['MD5']) or grep('9dce0a481343874ef9a36c9a825ef991',
    this['MD5']) or grep('85890f62e231ad964b1fda7a674747ec', this['MD5']) or grep('599be548da6441d7fe3e9a1bb8cb0833',
    this['MD5']) or grep('9b0c7fd5763f66e9b8c7b457fce53f96', this['MD5']) or grep('32d45718164205aec3e98e0223717d1d',
    this['MD5']) or grep('6ff5f373ee7f794cd17db50704d00ddb', this['MD5']) or grep('88efbdf41f0650f8f58a3053b0ca0459',
    this['MD5']) or grep('ef915f61f861d1fb7cbde9afd2e7bd93', this['MD5']) or grep('781fa16511a595757154b4304d2dd350',
    this['MD5']) or grep('5018ec39be0e296f4fc8c8575bfa8486', this['MD5']) or grep('f4a84d6f1caf0875b50135423d04139f',
    this['MD5']) or grep('9c1431801fa6342ed68f047842b9a11778fc669b', this['SHA1'])
    or grep('c36c862f40dad78cb065197aad15fef690c262f2', this['SHA1']) or grep('bc8e23faea8b3c537f268b3e81d05b937012272d',
    this['SHA1']) or grep('12e0357658614ff60d480d1a6709be68a2e40c5f', this['SHA1'])
    or grep('18b33ab5719966393d424a3edbfa8dec225d98fa', this['SHA1']) or grep('f14c9633040897d375e3069fddc71e859f283778',
    this['SHA1']) or grep('08041b426c9f112ad2061bf3c8c718e34739d4fc', this['SHA1'])
    or grep('7be77c885d0c9a4af4cecc64d512987cf93ba937', this['SHA1']) or grep('72dbb719b05f89d9d2dbdf186714caf7639daa36',
    this['SHA1']) or grep('5b1498beb2cfb4d971e377801e7abce62c0e315b', this['SHA1'])
    or grep('292629c6ab33bddf123d26328025e2d157d9e8fc', this['SHA1']) or grep('be59e621e83a2d4c87b0e6c69a2d22f175408b11',
    this['SHA1']) or grep('0250ce9a716ab8cca1c70a9de4cbc49a51934995', this['SHA1'])
    or grep('607e1fa810c799735221a609af3bfc405728c02d', this['SHA1']) or grep('ab1c547f6d1c07a9e0a01e46adea3aae1cac12e3',
    this['SHA1']) or grep('044cf5698a8e6b0aeba5acb56567f06366a9a70a', this['SHA1'])
    or grep('ef2dea8c736d49607832986c6c2d6fdd68ba6491', this['SHA1']) or grep('efffc2bfb8af2e3242233db9a7109b903fc3f178',
    this['SHA1']) or grep('5a05d4320de9afbc84de8469dd02b3a109efb2d4', this['SHA1'])
    or grep('a785d88cf8b862a420b9be793ee6a9616aa94c84', this['SHA1']) or grep('5688d56cbaf0d934c4e37b112ba257e8fb63f4ea',
    this['SHA1']) or grep('5cd2ada1c26815fbfd6a0cd746d5d429c0d83a17', this['SHA1'])
    or grep('81d67b3d70c4e855cb11a453cc32997517708362', this['SHA1']) or grep('9cffce9de95e0109f4dfecce0ab2cb0a59cc58ad',
    this['SHA1']) or grep('09c6930d057f49c1c1e11cf9241fffc8c12df3a2', this['SHA1'])
    or grep('e27bf7db8d96db9d4c8a06ee5e9b8e9fcb86ac92', this['SHA1']) or grep('9e3c992415e390f9ada4d15c693b687f38a492d1',
    this['SHA1']) or grep('3f34a5ee303d37916584c888c4928e1c1164f92a', this['SHA1'])
    or grep('ea4c8c56a8f5c90a4c08366933e5fb2de611d0db', this['SHA1']) or grep('3150f14508ee4cae19cf09083499d1cda8426540',
    this['SHA1']) or grep('036ad9876fa552b1298c040e233d620ea44689c6', this['SHA1'])
    or grep('3a3c1dcb146bb4616904157344ce1a82cd173bf5', this['SHA1']) or grep('6230d6fca973fa26188dfbadede57afb4c15f75c',
    this['SHA1']) or grep('8f7b2a9b8842f339b1e33602b7f926ab65de1a4d', this['SHA1'])
    or grep('a586bb06b59a4736a47abff8423a54fe8e2c05c4', this['SHA1']) or grep('c82152cddf9e5df49094686531872ecd545976db',
    this['SHA1']) or grep('04c39ffc18533100aaa4f9c06baf2c719ac94a61', this['SHA1'])
    or grep('e082affa5cdb2d46452c6601a9e85acb8446b836', this['SHA1']) or grep('a075bfb6cf5c6451ce682197a87277c8bc188719',
    this['SHA1']) or grep('34c0c5839af1c92bce7562b91418443a2044c90d', this['SHA1'])
    or grep('74e10a9989e0ec8fe075537ac802bd3031ae7e08', this['SHA1']) or grep('3a515551814775df0ccbe09f219bc972eae45a10',
    this['SHA1']) or grep('90fd5b855b5107e7abaaefb6e658f50d5d6e08ac28e35f31d8b03dcabf77872b',
    this['SHA256']) or grep('5836c24f233f77342fee825f3cad73caab7ab4fb65ec2aec309fd12bc1317e85',
    this['SHA256']) or grep('e850e54b12331249c357a20604281b9abf8a91e6f3d957463fc625e6b126ef03',
    this['SHA256']) or grep('9e752f29edcd0db9931c20b173eee8d4d8196f87382c68a6e7eb4c8a44d58795',
    this['SHA256']) or grep('7a8c127d6c41f80d178d2315ed2f751ac91b1cd54d008af13680e04f068f426f',
    this['SHA256']) or grep('9f65e1c142c4f814e056a197a2241fd09e09acf245c62897109871137321a72a',
    this['SHA256']) or grep('c9b52d03c66d54d6391c643b3559184b1425c84a372081ec2bfed07ebf6af275',
    this['SHA256']) or grep('1b96f6218498aa6baf6f6c15b8f99e542077e33feb1ab5472bbbf7d4de43eb6b',
    this['SHA256']) or grep('768021fc242054decc280675750dec0a9e74e764b8646864c58756fa2386d2a2',
    this['SHA256']) or grep('1e1b32bef31be040f0f038fcb5a2d68fb192daaef23c6167f91793d21e06ebae',
    this['SHA256']) or grep('606bd75ed9d2d6107ea7ee67063d1761a99f2fb5e932c8344d11395d24587dd6',
    this['SHA256']) or grep('b489d3cdd158f040322ae5c8d0139ad28eff743c738a10f2d0255c7e149bd92a',
    this['SHA256']) or grep('ca7ecf04a8ad63aff330492c15270d56760cb223a607cdb1431fb00e1b9985d1',
    this['SHA256']) or grep('9dc4fca72463078b70f6516559a179c78400b06534e63ee12fb38adbe2632559',
    this['SHA256']) or grep('c00d2aee59bac087d769e09b5b7f832176f7714fefdc6af2502e6031e3eb37c2',
    this['SHA256']) or grep('a8e96d564687064190eaf865774f773def05fdbf651aa5bbf66216c077b863ef',
    this['SHA256']) or grep('84ed328cee2a0505e87662faf6fc57915e3a831c97ee88ad691f5c63522e139d',
    this['SHA256']) or grep('c143de99c57965d3a44c1fce6a97c2773b050609c1ea7f45688a4ca2422a5524',
    this['SHA256']) or grep('01d1efd5e552c59baa70c0778902233c05fde7de6e5cc156c62607df0804d36b',
    this['SHA256']) or grep('9a8dfeb7e3174f3510691e2b32d0f9088e0ed67d9ed1b2afbe450d70dec2016b',
    this['SHA256']) or grep('63b92a114075d855f706979d50ed3460fe39f8a2f5498b7657f0d14865117629',
    this['SHA256']) or grep('2eb014130ff837b6481c26f0d0152f84de22ca7370b15a4f51921e0054a2a358',
    this['SHA256']) or grep('7d5bb4271bf8ca2b63a59e731f3ec831dbda53adb8e28665e956afb4941f32ca',
    this['SHA256']) or grep('e57098a75bf32e127c214b61bfba492d6b209e211f065fcc84ff10637a2143ea',
    this['SHA256']) or grep('dd14dbcdbcfcf4bc108a926b9667af4944a3b6faf808cf1bb9a3a2554722e172',
    this['SHA256']) or grep('dca2b1b824cb28bd15577eace45bde7ff8f8f44705b17085524659de31761de4',
    this['SHA256']) or grep('8b95f339a07d59a8c8d8580283dffb9e8dfabdeb9171e42c948ab68c71afe7f2',
    this['SHA256']) or grep('5428a840fab6ac4a0ecb2fc20dbc5f928432b00b9297dd1cb6e69336f44eba66',
    this['SHA256']) or grep('e2517ae0fccaa4aefe039026a4fc855964f0c2a5f84177140200b0e58ddbfd27',
    this['SHA256']) or grep('75d05880de2593480254181215dd9a0075373876f2f4a2a4a9a654b2e0729a41',
    this['SHA256']) or grep('56490e14ce3817c3a1ddc0d97b96e90d6351bcd29914e7c9282f6a998cca84b1',
    this['SHA256']) or grep('f25d0a5e77e4ed9e7c4204a33cfc8e46281b43adbee550b15701dd00f41bdbe0',
    this['SHA256']) or grep('845a5fdcbb08e7efa7e0eabfcd881c9eebc0eec0a3a2f8689194e6b91b6eeaf8',
    this['SHA256']) or grep('9a89e6652e563d26a3f328ba23d91f464c9549da734557c5a02559df24b2700d',
    this['SHA256']) or grep('5614f2bc9b2ed414aab2c5c7997bdcbe8236e67ced8f91a63d1b6cfbe6e08726',
    this['SHA256']) or grep('37bf92dcedb47a90d8d38ebda8d8dd168ef5803dcb01161f8cf6d68b70d49d90',
    this['SHA256']) or grep('ec8590f91f5cc21e931c57345425f0625a6e37dfba026b222260450de40459f5',
    this['SHA256']) or grep('3994eb72b1c227c593e14b8cad7001de11d1c247d4fbf84d0714bb8a17853140',
    this['SHA256']) or grep('d654f870436d63c9d8e4390d9d4d898abdf0456736c7654d71cdf81a299c3f87',
    this['SHA256']) or grep('63fbfabd4d8afb497dee47d112eb9d683671b75a8bf6407c4bd5027fd211b892',
    this['SHA256']) or grep('47028053f05188e6a366fff19bedbcad2bc4daba8ff9e4df724b77d0181b7054',
    this['SHA256']) or grep('7c1b1e8c880a30c43b3a52ee245f963a977e1f40284f4b83f4b9afe3821753dd',
    this['SHA256']) or grep('\\PingCastle.exe', this['FolderPath']) or grep('PingCastle.exe',
    this['ProcessVersionInfoOriginalFileName']) or grep('Ping Castle', this['ProcessVersionInfoProductName'])
    or grep('--scanner aclcheck', this['ProcessCommandLine']) or grep('--scanner antivirus',
    this['ProcessCommandLine']) or grep('--scanner computerversion', this['ProcessCommandLine'])
    or grep('--scanner foreignusers', this['ProcessCommandLine']) or grep('--scanner
    laps_bitlocker', this['ProcessCommandLine']) or grep('--scanner localadmin', this['ProcessCommandLine'])
    or grep('--scanner nullsession', this['ProcessCommandLine']) or grep('--scanner
    nullsession-trust', this['ProcessCommandLine']) or grep('--scanner oxidbindings',
    this['ProcessCommandLine']) or grep('--scanner remote', this['ProcessCommandLine'])
    or grep('--scanner share', this['ProcessCommandLine']) or grep('--scanner smb',
    this['ProcessCommandLine']) or grep('--scanner smb3querynetwork', this['ProcessCommandLine'])
    or grep('--scanner spooler', this['ProcessCommandLine']) or grep('--scanner startup',
    this['ProcessCommandLine']) or grep('--scanner zerologon', this['ProcessCommandLine'])
    or grep('--no-enum-limit', this['ProcessCommandLine']) or grep('--healthcheck',
    this['ProcessCommandLine']) and grep('--level Full', this['ProcessCommandLine'])
    or grep('--healthcheck', this['ProcessCommandLine']) and grep('--server ', this['ProcessCommandLine'])
  sigma_id: b1cb4ab6-ac31-43f4-adf1-d9d08957419c
- name: PUA - PingCastle Execution From Potentially Suspicious Parent
  query: (grep('.bat', this['InitiatingProcessCommandLine']) or grep('.chm', this['InitiatingProcessCommandLine'])
    or grep('.cmd', this['InitiatingProcessCommandLine']) or grep('.hta', this['InitiatingProcessCommandLine'])
    or grep('.htm', this['InitiatingProcessCommandLine']) or grep('.html', this['InitiatingProcessCommandLine'])
    or grep('.js', this['InitiatingProcessCommandLine']) or grep('.lnk', this['InitiatingProcessCommandLine'])
    or grep('.ps1', this['InitiatingProcessCommandLine']) or grep('.vbe', this['InitiatingProcessCommandLine'])
    or grep('.vbs', this['InitiatingProcessCommandLine']) or grep('.wsf', this['InitiatingProcessCommandLine'])
    or grep(':\\Perflogs\\', this['InitiatingProcessCommandLine']) or grep(':\\Temp\\',
    this['InitiatingProcessCommandLine']) or grep(':\\Users\\Public\\', this['InitiatingProcessCommandLine'])
    or grep(':\\Windows\\Temp\\', this['InitiatingProcessCommandLine']) or grep('\\AppData\\Local\\Temp',
    this['InitiatingProcessCommandLine']) or grep('\\AppData\\Roaming\\', this['InitiatingProcessCommandLine'])
    or grep('\\Temporary Internet', this['InitiatingProcessCommandLine']) or grep(':\\Users\\',
    this['InitiatingProcessCommandLine']) and grep('\\Favorites\\', this['InitiatingProcessCommandLine'])
    or grep(':\\Users\\', this['InitiatingProcessCommandLine']) and grep('\\Favourites\\',
    this['InitiatingProcessCommandLine']) or grep(':\\Users\\', this['InitiatingProcessCommandLine'])
    and grep('\\Contacts\\', this['InitiatingProcessCommandLine'])) and (grep('.bat',
    this['InitiatingProcessCommandLine']) or grep('.chm', this['InitiatingProcessCommandLine'])
    or grep('.cmd', this['InitiatingProcessCommandLine']) or grep('.hta', this['InitiatingProcessCommandLine'])
    or grep('.htm', this['InitiatingProcessCommandLine']) or grep('.html', this['InitiatingProcessCommandLine'])
    or grep('.js', this['InitiatingProcessCommandLine']) or grep('.lnk', this['InitiatingProcessCommandLine'])
    or grep('.ps1', this['InitiatingProcessCommandLine']) or grep('.vbe', this['InitiatingProcessCommandLine'])
    or grep('.vbs', this['InitiatingProcessCommandLine']) or grep('.wsf', this['InitiatingProcessCommandLine']))
    and (grep('\\PingCastle.exe', this['FolderPath']) or grep('PingCastle.exe', this['ProcessVersionInfoOriginalFileName'])
    or grep('Ping Castle', this['ProcessVersionInfoProductName']) or grep('--scanner
    aclcheck', this['ProcessCommandLine']) or grep('--scanner antivirus', this['ProcessCommandLine'])
    or grep('--scanner computerversion', this['ProcessCommandLine']) or grep('--scanner
    foreignusers', this['ProcessCommandLine']) or grep('--scanner laps_bitlocker',
    this['ProcessCommandLine']) or grep('--scanner localadmin', this['ProcessCommandLine'])
    or grep('--scanner nullsession', this['ProcessCommandLine']) or grep('--scanner
    nullsession-trust', this['ProcessCommandLine']) or grep('--scanner oxidbindings',
    this['ProcessCommandLine']) or grep('--scanner remote', this['ProcessCommandLine'])
    or grep('--scanner share', this['ProcessCommandLine']) or grep('--scanner smb',
    this['ProcessCommandLine']) or grep('--scanner smb3querynetwork', this['ProcessCommandLine'])
    or grep('--scanner spooler', this['ProcessCommandLine']) or grep('--scanner startup',
    this['ProcessCommandLine']) or grep('--scanner zerologon', this['ProcessCommandLine'])
    or grep('--no-enum-limit', this['ProcessCommandLine']) or grep('--healthcheck',
    this['ProcessCommandLine']) and grep('--level Full', this['ProcessCommandLine'])
    or grep('--healthcheck', this['ProcessCommandLine']) and grep('--server ', this['ProcessCommandLine']))
  sigma_id: b37998de-a70b-4f33-b219-ec36bf433dc0
- name: PUA - Process Hacker Execution
  query: grep('\\ProcessHacker_', this['FolderPath']) or grep('\\ProcessHacker.exe',
    this['FolderPath']) or this['ProcessVersionInfoOriginalFileName'] in ['ProcessHacker.exe',
    'Process Hacker'] or grep('Process Hacker', this['ProcessVersionInfoFileDescription'])
    or grep('Process Hacker', this['ProcessVersionInfoProductName']) or grep('68F9B52895F4D34E74112F3129B3B00D',
    this['MD5']) or grep('B365AF317AE730A67C936F21432B9C71', this['MD5']) or grep('A0BDFAC3CE1880B32FF9B696458327CE352E3B1D',
    this['SHA1']) or grep('C5E2018BF7C0F314FED4FD7FE7E69FA2E648359E', this['SHA1'])
    or grep('D4A0FE56316A2C45B9BA9AC1005363309A3EDC7ACF9E4DF64D326A0FF273E80F', this['SHA256'])
    or grep('BD2C2CF0631D881ED382817AFCCE2B093F4E412FFB170A719E2762F250ABFEA4', this['SHA256'])
  sigma_id: 811e0002-b13b-4a15-9d00-a613fce66e42
- name: PUA - Radmin Viewer Utility Execution
  query: grep('Radmin Viewer', this['ProcessVersionInfoFileDescription']) or grep('Radmin
    Viewer', this['ProcessVersionInfoProductName']) or grep('Radmin.exe', this['ProcessVersionInfoOriginalFileName'])
  sigma_id: 5817e76f-4804-41e6-8f1d-5fa0b3ecae2d
- name: PUA - Potential PE Metadata Tamper Using Rcedit
  query: (grep('\\rcedit-x64.exe', this['FolderPath']) or grep('\\rcedit-x86.exe',
    this['FolderPath']) or grep('Edit resources of exe', this['ProcessVersionInfoFileDescription'])
    or grep('rcedit', this['ProcessVersionInfoProductName'])) and grep('--set-', this['ProcessCommandLine'])
    and (grep('OriginalFileName', this['ProcessCommandLine']) or grep('CompanyName',
    this['ProcessCommandLine']) or grep('FileDescription', this['ProcessCommandLine'])
    or grep('ProductName', this['ProcessCommandLine']) or grep('ProductVersion', this['ProcessCommandLine'])
    or grep('LegalCopyright', this['ProcessCommandLine']))
  sigma_id: 0c92f2e6-f08f-4b73-9216-ecb0ca634689
- name: PUA - Rclone Execution
  query: grep('--config ', this['ProcessCommandLine']) and grep('--no-check-certificate
    ', this['ProcessCommandLine']) and grep(' copy ', this['ProcessCommandLine'])
    or (grep('\\rclone.exe', this['FolderPath']) or grep('Rsync for cloud storage',
    this['ProcessVersionInfoFileDescription'])) and (grep('pass', this['ProcessCommandLine'])
    or grep('user', this['ProcessCommandLine']) or grep('copy', this['ProcessCommandLine'])
    or grep('sync', this['ProcessCommandLine']) or grep('config', this['ProcessCommandLine'])
    or grep('lsd', this['ProcessCommandLine']) or grep('remote', this['ProcessCommandLine'])
    or grep('ls', this['ProcessCommandLine']) or grep('mega', this['ProcessCommandLine'])
    or grep('pcloud', this['ProcessCommandLine']) or grep('ftp', this['ProcessCommandLine'])
    or grep('ignore-existing', this['ProcessCommandLine']) or grep('auto-confirm',
    this['ProcessCommandLine']) or grep('transfers', this['ProcessCommandLine']) or
    grep('multi-thread-streams', this['ProcessCommandLine']) or grep('no-check-certificate
    ', this['ProcessCommandLine']))
  sigma_id: e37db05d-d1f9-49c8-b464-cee1a4b11638
- name: PUA - RunXCmd Execution
  query: (grep(' /account=system ', this['ProcessCommandLine']) or grep(' /account=ti
    ', this['ProcessCommandLine'])) and grep('/exec=', this['ProcessCommandLine'])
  sigma_id: 93199800-b52a-4dec-b762-75212c196542
- name: PUA - Seatbelt Execution
  query: grep('\\Seatbelt.exe', this['FolderPath']) or grep('Seatbelt.exe', this['ProcessVersionInfoOriginalFileName'])
    or grep('Seatbelt', this['ProcessVersionInfoFileDescription']) or grep(' DpapiMasterKeys',
    this['ProcessCommandLine']) or grep(' InterestingProcesses', this['ProcessCommandLine'])
    or grep(' InterestingFiles', this['ProcessCommandLine']) or grep(' CertificateThumbprints',
    this['ProcessCommandLine']) or grep(' ChromiumBookmarks', this['ProcessCommandLine'])
    or grep(' ChromiumHistory', this['ProcessCommandLine']) or grep(' ChromiumPresence',
    this['ProcessCommandLine']) or grep(' CloudCredentials', this['ProcessCommandLine'])
    or grep(' CredEnum', this['ProcessCommandLine']) or grep(' CredGuard', this['ProcessCommandLine'])
    or grep(' FirefoxHistory', this['ProcessCommandLine']) or grep(' ProcessCreationEvents',
    this['ProcessCommandLine']) or (grep(' -group=misc', this['ProcessCommandLine'])
    or grep(' -group=remote', this['ProcessCommandLine']) or grep(' -group=chromium',
    this['ProcessCommandLine']) or grep(' -group=slack', this['ProcessCommandLine'])
    or grep(' -group=system', this['ProcessCommandLine']) or grep(' -group=user',
    this['ProcessCommandLine']) or grep(' -group=all', this['ProcessCommandLine']))
    and grep(' -outputfile=', this['ProcessCommandLine'])
  sigma_id: 38646daa-e78f-4ace-9de0-55547b2d30da
- name: PUA - System Informer Execution
  query: grep('\\SystemInformer.exe', this['FolderPath']) or grep('SystemInformer.exe',
    this['ProcessVersionInfoOriginalFileName']) or grep('System Informer', this['ProcessVersionInfoFileDescription'])
    or grep('System Informer', this['ProcessVersionInfoProductName']) or grep('19426363A37C03C3ED6FEDF57B6696EC',
    this['MD5']) or grep('8B12C6DA8FAC0D5E8AB999C31E5EA04AF32D53DC', this['SHA1'])
    or grep('8EE9D84DE50803545937A63C686822388A3338497CDDB660D5D69CF68B68F287', this['SHA256'])
  sigma_id: 5722dff1-4bdd-4949-86ab-fbaf707e767a
- name: PUA - WebBrowserPassView Execution
  query: grep('Web Browser Password Viewer', this['ProcessVersionInfoFileDescription'])
    or grep('\\WebBrowserPassView.exe', this['FolderPath'])
  sigma_id: d0dae994-26c6-4d2d-83b5-b3c8b79ae513
- name: PUA - Wsudo Suspicious Execution
  query: grep('\\wsudo.exe', this['FolderPath']) or grep('wsudo.exe', this['ProcessVersionInfoOriginalFileName'])
    or grep('Windows sudo utility', this['ProcessVersionInfoFileDescription']) or
    grep('\\wsudo-bridge.exe', this['InitiatingProcessFolderPath']) or grep('-u System',
    this['ProcessCommandLine']) or grep('-uSystem', this['ProcessCommandLine']) or
    grep('-u TrustedInstaller', this['ProcessCommandLine']) or grep('-uTrustedInstaller',
    this['ProcessCommandLine']) or grep(' --ti ', this['ProcessCommandLine'])
  sigma_id: bdeeabc9-ff2a-4a51-be59-bb253aac7891
- name: Python Inline Command Execution
  query: (grep('python.exe', this['ProcessVersionInfoOriginalFileName']) or grep('python.exe',
    this['FolderPath']) or grep('python3.exe', this['FolderPath']) or grep('python2.exe',
    this['FolderPath'])) and grep(' -c', this['ProcessCommandLine']) and not (grep('C:\\Program
    Files\\Python', this['InitiatingProcessFolderPath']) and grep('\\python.exe',
    this['InitiatingProcessFolderPath']) and grep('-E -s -m ensurepip -U --default-pip',
    this['InitiatingProcessCommandLine']) or grep('\\AppData\\Local\\Programs\\Microsoft
    VS Code\\Code.exe', this['InitiatingProcessFolderPath']))
  sigma_id: 899133d5-4d7c-4a7f-94ee-27355c879d90
- name: Python Spawning Pretty TTY on Windows
  query: (grep('python.exe', this['FolderPath']) or grep('python3.exe', this['FolderPath'])
    or grep('python2.exe', this['FolderPath'])) and (grep('import pty', this['ProcessCommandLine'])
    and grep('.spawn(', this['ProcessCommandLine']) or grep('from pty import spawn',
    this['ProcessCommandLine']))
  sigma_id: 480e7e51-e797-47e3-8d72-ebfce65b6d8d
- name: Potentially Suspicious Usage Of Qemu
  query: (grep('-m 1M', this['ProcessCommandLine']) or grep('-m 2M', this['ProcessCommandLine'])
    or grep('-m 3M', this['ProcessCommandLine'])) and grep('restrict=off', this['ProcessCommandLine'])
    and grep('-netdev ', this['ProcessCommandLine']) and grep('connect=', this['ProcessCommandLine'])
    and grep('-nographic', this['ProcessCommandLine']) and not (grep(' -cdrom ', this['ProcessCommandLine'])
    or grep(' type=virt ', this['ProcessCommandLine']) or grep(' -blockdev ', this['ProcessCommandLine']))
  sigma_id: 5fc297ae-25b6-488a-8f25-cc12ac29b744
- name: Query Usage To Exfil Data
  query: grep(':\\Windows\\System32\\query.exe', this['FolderPath']) and (grep('session
    >', this['ProcessCommandLine']) or grep('process >', this['ProcessCommandLine']))
  sigma_id: 53ef0cef-fa24-4f25-a34a-6c72dfa2e6e2
- name: Rar Usage with Password and Compression Level
  query: grep(' -hp', this['ProcessCommandLine']) and (grep(' -m', this['ProcessCommandLine'])
    or grep(' a ', this['ProcessCommandLine']))
  sigma_id: faa48cae-6b25-4f00-a094-08947fef582f
- name: Suspicious Greedy Compression Using Rar.EXE
  query: '(grep(''\\rar.exe'', this[''FolderPath'']) or grep(''Command line RAR'',
    this[''ProcessVersionInfoFileDescription'']) or grep(''.exe a '', this[''ProcessCommandLine''])
    or grep('' a -m'', this[''ProcessCommandLine''])) and grep('' -hp'', this[''ProcessCommandLine''])
    and grep('' -r '', this[''ProcessCommandLine'']) and ((grep('' '', this[''ProcessCommandLine''])
    or grep('':.'', this[''ProcessCommandLine''])) or (grep('' '', this[''ProcessCommandLine''])
    or grep(''(\'':\\\'', <SpecialChars.WILDCARD_MULTI: 1>, \''.\'')'', this[''ProcessCommandLine'']))
    or (grep('' '', this[''ProcessCommandLine'']) or grep('':\\$Recycle.bin\\'', this[''ProcessCommandLine'']))
    or (grep('' '', this[''ProcessCommandLine'']) or grep('':\\PerfLogs\\'', this[''ProcessCommandLine'']))
    or (grep('' '', this[''ProcessCommandLine'']) or grep('':\\Temp'', this[''ProcessCommandLine'']))
    or (grep('' '', this[''ProcessCommandLine'']) or grep('':\\Users\\Public\\'',
    this[''ProcessCommandLine''])) or (grep('' '', this[''ProcessCommandLine'']) or
    grep('':\\Windows\\'', this[''ProcessCommandLine''])) or grep('' %public%'', this[''ProcessCommandLine'']))'
  sigma_id: afe52666-401e-4a02-b4ff-5d128990b8cb
- name: Suspicious RASdial Activity
  query: grep('rasdial.exe', this['FolderPath'])
  sigma_id: 6bba49bf-7f8c-47d6-a1bb-6b4dece4640e
- name: Process Memory Dump via RdrLeakDiag.EXE
  query: "(grep('\\\\rdrleakdiag.exe', this['FolderPath']) or grep('RdrLeakDiag.exe',\
    \ this['ProcessVersionInfoOriginalFileName'])) and (grep('-memdmp', this['ProcessCommandLine'])\
    \ or grep('/memdmp', this['ProcessCommandLine']) or grep('\u2013memdmp', this['ProcessCommandLine'])\
    \ or grep('\u2014memdmp', this['ProcessCommandLine']) or grep('\u2015memdmp',\
    \ this['ProcessCommandLine']) or grep('fullmemdmp', this['ProcessCommandLine']))\
    \ and (grep(' -o ', this['ProcessCommandLine']) or grep(' /o ', this['ProcessCommandLine'])\
    \ or grep(' \u2013o ', this['ProcessCommandLine']) or grep(' \u2014o ', this['ProcessCommandLine'])\
    \ or grep(' \u2015o ', this['ProcessCommandLine']) or grep(' -p ', this['ProcessCommandLine'])\
    \ or grep(' /p ', this['ProcessCommandLine']) or grep(' \u2013p ', this['ProcessCommandLine'])\
    \ or grep(' \u2014p ', this['ProcessCommandLine']) or grep(' \u2015p ', this['ProcessCommandLine']))"
  sigma_id: edadb1e5-5919-4e4c-8462-a9e643b02c4b
- name: Potential Persistence Attempt Via Run Keys Using Reg.EXE
  query: grep('reg', this['ProcessCommandLine']) and grep(' ADD ', this['ProcessCommandLine'])
    and grep('Software\\Microsoft\\Windows\\CurrentVersion\\Run', this['ProcessCommandLine'])
  sigma_id: de587dce-915e-4218-aac4-835ca6af6f70
- name: Add SafeBoot Keys Via Reg Utility
  query: (grep('\\reg.exe', this['FolderPath']) or grep('reg.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot', this['ProcessCommandLine'])
    and (grep(' copy ', this['ProcessCommandLine']) or grep(' add ', this['ProcessCommandLine']))
  sigma_id: d7662ff6-9e97-4596-a61d-9839e32dee8d
- name: Suspicious Reg Add BitLocker
  query: grep('REG', this['ProcessCommandLine']) and grep('ADD', this['ProcessCommandLine'])
    and grep('\\SOFTWARE\\Policies\\Microsoft\\FVE', this['ProcessCommandLine']) and
    grep('/v', this['ProcessCommandLine']) and grep('/f', this['ProcessCommandLine'])
    and (grep('EnableBDEWithNoTPM', this['ProcessCommandLine']) or grep('UseAdvancedStartup',
    this['ProcessCommandLine']) or grep('UseTPM', this['ProcessCommandLine']) or grep('UseTPMKey',
    this['ProcessCommandLine']) or grep('UseTPMKeyPIN', this['ProcessCommandLine'])
    or grep('RecoveryKeyMessageSource', this['ProcessCommandLine']) or grep('UseTPMPIN',
    this['ProcessCommandLine']) or grep('RecoveryKeyMessage', this['ProcessCommandLine']))
  sigma_id: 0e0255bf-2548-47b8-9582-c0955c9283f5
- name: Dropping Of Password Filter DLL
  query: grep('HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa', this['ProcessCommandLine'])
    and grep('scecli\\0', this['ProcessCommandLine']) and grep('reg add', this['ProcessCommandLine'])
  sigma_id: b7966f4a-b333-455b-8370-8ca53c229762
- name: Suspicious Windows Defender Folder Exclusion Added Via Reg.EXE
  query: grep('\\reg.exe', this['FolderPath']) and (grep('SOFTWARE\\Microsoft\\Windows
    Defender\\Exclusions\\Paths', this['ProcessCommandLine']) or grep('SOFTWARE\\Microsoft\\Microsoft
    Antimalware\\Exclusions\\Paths', this['ProcessCommandLine'])) and grep('ADD ',
    this['ProcessCommandLine']) and grep('/t ', this['ProcessCommandLine']) and grep('REG_DWORD
    ', this['ProcessCommandLine']) and grep('/v ', this['ProcessCommandLine']) and
    grep('/d ', this['ProcessCommandLine']) and grep('0', this['ProcessCommandLine'])
  sigma_id: 48917adc-a28e-4f5d-b729-11e75da8941f
- name: SafeBoot Registry Key Deleted Via Reg.EXE
  query: (grep('reg.exe', this['FolderPath']) or grep('reg.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' delete ', this['ProcessCommandLine']) and grep('\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot',
    this['ProcessCommandLine'])
  sigma_id: fc0e89b5-adb0-43c1-b749-c12a10ec37de
- name: Service Registry Key Deleted Via Reg.EXE
  query: (grep('reg.exe', this['FolderPath']) or grep('reg.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' delete ', this['ProcessCommandLine']) and grep('\\SYSTEM\\CurrentControlSet\\services\\',
    this['ProcessCommandLine'])
  sigma_id: 05b2aa93-1210-42c8-8d9a-2fcc13b284f5
- name: Potentially Suspicious Desktop Background Change Using Reg.EXE
  query: (grep('\\reg.exe', this['FolderPath']) or grep('reg.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('add', this['ProcessCommandLine']) and (grep('Control Panel\\Desktop',
    this['ProcessCommandLine']) or grep('CurrentVersion\\Policies\\ActiveDesktop',
    this['ProcessCommandLine']) or grep('CurrentVersion\\Policies\\System', this['ProcessCommandLine']))
    and (grep('/v NoChangingWallpaper', this['ProcessCommandLine']) and grep('/d 1',
    this['ProcessCommandLine']) or grep('/v Wallpaper', this['ProcessCommandLine'])
    and grep('/t REG_SZ', this['ProcessCommandLine']) or grep('/v WallpaperStyle',
    this['ProcessCommandLine']) and grep('/d 2', this['ProcessCommandLine']))
  sigma_id: 8cbc9475-8d05-4e27-9c32-df960716c701
- name: Direct Autorun Keys Modification
  query: grep('\\reg.exe', this['FolderPath']) and grep('add', this['ProcessCommandLine'])
    and (grep('\\software\\Microsoft\\Windows\\CurrentVersion\\Run', this['ProcessCommandLine'])
    or grep('\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit',
    this['ProcessCommandLine']) or grep('\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell',
    this['ProcessCommandLine']) or grep('\\software\\Microsoft\\Windows NT\\CurrentVersion\\Windows',
    this['ProcessCommandLine']) or grep('\\software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User
    Shell Folders', this['ProcessCommandLine']) or grep('\\system\\CurrentControlSet\\Control\\SafeBoot\\AlternateShell',
    this['ProcessCommandLine']))
  sigma_id: 24357373-078f-44ed-9ac4-6d334a668a11
- name: Security Service Disabled Via Reg.EXE
  query: grep('reg', this['ProcessCommandLine']) and grep('add', this['ProcessCommandLine'])
    and grep('d 4', this['ProcessCommandLine']) and grep('v Start', this['ProcessCommandLine'])
    and (grep('\\AppIDSvc', this['ProcessCommandLine']) or grep('\\MsMpSvc', this['ProcessCommandLine'])
    or grep('\\NisSrv', this['ProcessCommandLine']) or grep('\\SecurityHealthService',
    this['ProcessCommandLine']) or grep('\\Sense', this['ProcessCommandLine']) or
    grep('\\UsoSvc', this['ProcessCommandLine']) or grep('\\WdBoot', this['ProcessCommandLine'])
    or grep('\\WdFilter', this['ProcessCommandLine']) or grep('\\WdNisDrv', this['ProcessCommandLine'])
    or grep('\\WdNisSvc', this['ProcessCommandLine']) or grep('\\WinDefend', this['ProcessCommandLine'])
    or grep('\\wscsvc', this['ProcessCommandLine']) or grep('\\wuauserv', this['ProcessCommandLine']))
  sigma_id: 5e95028c-5229-4214-afae-d653d573d0ec
- name: Dumping of Sensitive Hives Via Reg.EXE
  query: "(grep('\\\\reg.exe', this['FolderPath']) or grep('reg.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep(' save ', this['ProcessCommandLine']) or grep(' export ', this['ProcessCommandLine'])\
    \ or grep(' \u02E2ave ', this['ProcessCommandLine']) or grep(' e\u02E3port ',\
    \ this['ProcessCommandLine'])) and (grep('hklm', this['ProcessCommandLine']) or\
    \ grep('hk\u02EAm', this['ProcessCommandLine']) or grep('hkey_local_machine',\
    \ this['ProcessCommandLine']) or grep('hkey_\u02EAocal_machine', this['ProcessCommandLine'])\
    \ or grep('hkey_loca\u02EA_machine', this['ProcessCommandLine']) or grep('hkey_\u02EA\
    oca\u02EA_machine', this['ProcessCommandLine'])) and (grep('\\\\system', this['ProcessCommandLine'])\
    \ or grep('\\\\sam', this['ProcessCommandLine']) or grep('\\\\security', this['ProcessCommandLine'])\
    \ or grep('\\\\\u02E2ystem', this['ProcessCommandLine']) or grep('\\\\sy\u02E2\
    tem', this['ProcessCommandLine']) or grep('\\\\\u02E2y\u02E2tem', this['ProcessCommandLine'])\
    \ or grep('\\\\\u02E2am', this['ProcessCommandLine']) or grep('\\\\\u02E2ecurity',\
    \ this['ProcessCommandLine']))"
  sigma_id: fd877b94-9bb5-4191-bb25-d79cbd93c167
- name: Windows Recall Feature Enabled Via Reg.EXE
  query: (grep('\\reg.exe', this['FolderPath']) or grep('reg.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('Microsoft\\Windows\\WindowsAI', this['ProcessCommandLine']) and grep('DisableAIDataAnalysis',
    this['ProcessCommandLine']) and (grep('add', this['ProcessCommandLine']) or grep('0',
    this['ProcessCommandLine']) or grep('delete', this['ProcessCommandLine']))
  sigma_id: 817f252c-5143-4dae-b418-48c3e9f63728
- name: Enumeration for Credentials in Registry
  query: grep('\\reg.exe', this['FolderPath']) and grep(' query ', this['ProcessCommandLine'])
    and grep('/t ', this['ProcessCommandLine']) and grep('REG_SZ', this['ProcessCommandLine'])
    and grep('/s', this['ProcessCommandLine']) and (grep('/f ', this['ProcessCommandLine'])
    and grep('HKLM', this['ProcessCommandLine']) or grep('/f ', this['ProcessCommandLine'])
    and grep('HKCU', this['ProcessCommandLine']) or grep('HKCU\\Software\\SimonTatham\\PuTTY\\Sessions',
    this['ProcessCommandLine']))
  sigma_id: e0b0c2ab-3d52-46d9-8cb7-049dc775fbd1
- name: Potential Suspicious Registry File Imported Via Reg.EXE
  query: (grep('\\reg.exe', this['FolderPath']) or grep('reg.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' import ', this['ProcessCommandLine']) and (grep('C:\\Users\\', this['ProcessCommandLine'])
    or grep('%temp%', this['ProcessCommandLine']) or grep('%tmp%', this['ProcessCommandLine'])
    or grep('%appdata%', this['ProcessCommandLine']) or grep('\\AppData\\Local\\Temp\\',
    this['ProcessCommandLine']) or grep('C:\\Windows\\Temp\\', this['ProcessCommandLine'])
    or grep('C:\\ProgramData\\', this['ProcessCommandLine']))
  sigma_id: 62e0298b-e994-4189-bc87-bc699aa62d97
- name: RestrictedAdminMode Registry Value Tampering - ProcCreation
  query: grep('\\System\\CurrentControlSet\\Control\\Lsa\\', this['ProcessCommandLine'])
    and grep('DisableRestrictedAdmin', this['ProcessCommandLine'])
  sigma_id: 28ac00d6-22d9-4a3c-927f-bbd770104573
- name: LSA PPL Protection Disabled Via Reg.EXE
  query: (grep('\\reg.exe', this['FolderPath']) or grep('reg.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('SYSTEM\\CurrentControlSet\\Control\\Lsa', this['ProcessCommandLine'])
    and grep(' add ', this['ProcessCommandLine']) and grep(' /d 0', this['ProcessCommandLine'])
    and grep(' /v RunAsPPL ', this['ProcessCommandLine'])
  sigma_id: 8c0eca51-0f88-4db2-9183-fdfb10c703f9
- name: Modify Group Policy Settings
  query: (grep('\\reg.exe', this['FolderPath']) or grep('reg.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('\\SOFTWARE\\Policies\\Microsoft\\Windows\\System', this['ProcessCommandLine'])
    and (grep('GroupPolicyRefreshTimeDC', this['ProcessCommandLine']) or grep('GroupPolicyRefreshTimeOffsetDC',
    this['ProcessCommandLine']) or grep('GroupPolicyRefreshTime', this['ProcessCommandLine'])
    or grep('GroupPolicyRefreshTimeOffset', this['ProcessCommandLine']) or grep('EnableSmartScreen',
    this['ProcessCommandLine']) or grep('ShellSmartScreenLevel', this['ProcessCommandLine']))
  sigma_id: ada4b0c4-758b-46ac-9033-9004613a150d
- name: Enable LM Hash Storage - ProcCreation
  query: grep('\\System\\CurrentControlSet\\Control\\Lsa', this['ProcessCommandLine'])
    and grep('NoLMHash', this['ProcessCommandLine']) and grep(' 0', this['ProcessCommandLine'])
  sigma_id: 98dedfdd-8333-49d4-9f23-d7018cccae53
- name: Suspicious Reg Add Open Command
  query: grep('reg', this['ProcessCommandLine']) and grep('add', this['ProcessCommandLine'])
    and grep('hkcu\\software\\classes\\ms-settings\\shell\\open\\command', this['ProcessCommandLine'])
    and grep('/ve ', this['ProcessCommandLine']) and grep('/d', this['ProcessCommandLine'])
    or grep('reg', this['ProcessCommandLine']) and grep('add', this['ProcessCommandLine'])
    and grep('hkcu\\software\\classes\\ms-settings\\shell\\open\\command', this['ProcessCommandLine'])
    and grep('/v', this['ProcessCommandLine']) and grep('DelegateExecute', this['ProcessCommandLine'])
    or grep('reg', this['ProcessCommandLine']) and grep('delete', this['ProcessCommandLine'])
    and grep('hkcu\\software\\classes\\ms-settings', this['ProcessCommandLine'])
  sigma_id: dd3ee8cc-f751-41c9-ba53-5a32ed47e563
- name: Potential Configuration And Service Reconnaissance Via Reg.EXE
  query: (grep('\\reg.exe', this['FolderPath']) or grep('reg.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('query', this['ProcessCommandLine']) and (grep('currentVersion\\windows',
    this['ProcessCommandLine']) or grep('winlogon\\', this['ProcessCommandLine'])
    or grep('currentVersion\\shellServiceObjectDelayLoad', this['ProcessCommandLine'])
    or grep('currentVersion\\run', this['ProcessCommandLine']) or grep('currentVersion\\policies\\explorer\\run',
    this['ProcessCommandLine']) or grep('currentcontrolset\\services', this['ProcessCommandLine']))
  sigma_id: 970007b7-ce32-49d0-a4a4-fbef016950bd
- name: Potential Tampering With RDP Related Registry Keys Via Reg.EXE
  query: (grep('\\reg.exe', this['FolderPath']) or grep('reg.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' add ', this['ProcessCommandLine']) and grep('\\CurrentControlSet\\Control\\Terminal
    Server', this['ProcessCommandLine']) and grep('REG_DWORD', this['ProcessCommandLine'])
    and grep(' /f', this['ProcessCommandLine']) and (grep('Licensing Core', this['ProcessCommandLine'])
    and grep('EnableConcurrentSessions', this['ProcessCommandLine']) or grep('WinStations\\RDP-Tcp',
    this['ProcessCommandLine']) or grep('MaxInstanceCount', this['ProcessCommandLine'])
    or grep('fEnableWinStation', this['ProcessCommandLine']) or grep('TSUserEnabled',
    this['ProcessCommandLine']) or grep('TSEnabled', this['ProcessCommandLine']) or
    grep('TSAppCompat', this['ProcessCommandLine']) or grep('IdleWinStationPoolCount',
    this['ProcessCommandLine']) or grep('TSAdvertise', this['ProcessCommandLine'])
    or grep('AllowTSConnections', this['ProcessCommandLine']) or grep('fSingleSessionPerUser',
    this['ProcessCommandLine']) or grep('fDenyTSConnections', this['ProcessCommandLine']))
  sigma_id: 0d5675be-bc88-4172-86d3-1e96a4476536
- name: Suspicious ScreenSave Change by Reg.exe
  query: grep('\\reg.exe', this['FolderPath']) and (grep('HKEY_CURRENT_USER\\Control
    Panel\\Desktop', this['ProcessCommandLine']) or grep('HKCU\\Control Panel\\Desktop',
    this['ProcessCommandLine'])) and (grep('/v ScreenSaveActive', this['ProcessCommandLine'])
    and grep('/t REG_SZ', this['ProcessCommandLine']) and grep('/d 1', this['ProcessCommandLine'])
    and grep('/f', this['ProcessCommandLine']) or grep('/v ScreenSaveTimeout', this['ProcessCommandLine'])
    and grep('/t REG_SZ', this['ProcessCommandLine']) and grep('/d ', this['ProcessCommandLine'])
    and grep('/f', this['ProcessCommandLine']) or grep('/v ScreenSaverIsSecure', this['ProcessCommandLine'])
    and grep('/t REG_SZ', this['ProcessCommandLine']) and grep('/d 0', this['ProcessCommandLine'])
    and grep('/f', this['ProcessCommandLine']) or grep('/v SCRNSAVE.EXE', this['ProcessCommandLine'])
    and grep('/t REG_SZ', this['ProcessCommandLine']) and grep('/d ', this['ProcessCommandLine'])
    and grep('.scr', this['ProcessCommandLine']) and grep('/f', this['ProcessCommandLine']))
  sigma_id: 0fc35fc3-efe6-4898-8a37-0b233339524f
- name: Changing Existing Service ImagePath Value Via Reg.EXE
  query: "grep('\\\\reg.exe', this['FolderPath']) and grep('add ', this['ProcessCommandLine'])\
    \ and grep('SYSTEM\\\\CurrentControlSet\\\\Services\\\\', this['ProcessCommandLine'])\
    \ and grep(' ImagePath ', this['ProcessCommandLine']) and (grep(' -d ', this['ProcessCommandLine'])\
    \ or grep(' /d ', this['ProcessCommandLine']) or grep(' \u2013d ', this['ProcessCommandLine'])\
    \ or grep(' \u2014d ', this['ProcessCommandLine']) or grep(' \u2015d ', this['ProcessCommandLine']))"
  sigma_id: 9b0b7ac3-6223-47aa-a3fd-e8f211e637db
- name: Detected Windows Software Discovery
  query: grep('\\reg.exe', this['FolderPath']) and grep('query', this['ProcessCommandLine'])
    and grep('\\software\\', this['ProcessCommandLine']) and grep('/v', this['ProcessCommandLine'])
    and grep('svcversion', this['ProcessCommandLine'])
  sigma_id: e13f668e-7f95-443d-98d2-1816a7648a7b
- name: Reg Add Suspicious Paths
  query: (grep('\\reg.exe', this['FolderPath']) or grep('reg.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('\\AppDataLow\\Software\\Microsoft\\', this['ProcessCommandLine']) or
    grep('\\Policies\\Microsoft\\Windows\\OOBE', this['ProcessCommandLine']) or grep('\\Policies\\Microsoft\\Windows
    NT\\CurrentVersion\\Winlogon', this['ProcessCommandLine']) or grep('\\SOFTWARE\\Microsoft\\Windows
    NT\\Currentversion\\Winlogon', this['ProcessCommandLine']) or grep('\\CurrentControlSet\\Control\\SecurityProviders\\WDigest',
    this['ProcessCommandLine']) or grep('\\Microsoft\\Windows Defender\\', this['ProcessCommandLine']))
  sigma_id: b7e2a8d4-74bb-4b78-adc9-3f92af2d4829
- name: Disabled Volume Snapshots
  query: grep('\\Services\\VSS\\Diag', this['ProcessCommandLine']) and grep('/d Disabled',
    this['ProcessCommandLine'])
  sigma_id: dee4af55-1f22-4e1d-a9d2-4bdc7ecb472a
- name: Suspicious Windows Defender Registry Key Tampering Via Reg.EXE
  query: (grep('\\reg.exe', this['FolderPath']) or grep('reg.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('SOFTWARE\\Microsoft\\Windows Defender\\', this['ProcessCommandLine'])
    or grep('SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center', this['ProcessCommandLine'])
    or grep('SOFTWARE\\Policies\\Microsoft\\Windows Defender\\', this['ProcessCommandLine']))
    and (grep(' add ', this['ProcessCommandLine']) and grep('d 0', this['ProcessCommandLine'])
    and (grep('DisallowExploitProtectionOverride', this['ProcessCommandLine']) or
    grep('EnableControlledFolderAccess', this['ProcessCommandLine']) or grep('MpEnablePus',
    this['ProcessCommandLine']) or grep('PUAProtection', this['ProcessCommandLine'])
    or grep('SpynetReporting', this['ProcessCommandLine']) or grep('SubmitSamplesConsent',
    this['ProcessCommandLine']) or grep('TamperProtection', this['ProcessCommandLine']))
    or grep(' add ', this['ProcessCommandLine']) and grep('d 1', this['ProcessCommandLine'])
    and (grep('DisableAntiSpyware', this['ProcessCommandLine']) or grep('DisableAntiSpywareRealtimeProtection',
    this['ProcessCommandLine']) or grep('DisableAntiVirus', this['ProcessCommandLine'])
    or grep('DisableArchiveScanning', this['ProcessCommandLine']) or grep('DisableBehaviorMonitoring',
    this['ProcessCommandLine']) or grep('DisableBlockAtFirstSeen', this['ProcessCommandLine'])
    or grep('DisableConfig', this['ProcessCommandLine']) or grep('DisableEnhancedNotifications',
    this['ProcessCommandLine']) or grep('DisableIntrusionPreventionSystem', this['ProcessCommandLine'])
    or grep('DisableIOAVProtection', this['ProcessCommandLine']) or grep('DisableOnAccessProtection',
    this['ProcessCommandLine']) or grep('DisablePrivacyMode', this['ProcessCommandLine'])
    or grep('DisableRealtimeMonitoring', this['ProcessCommandLine']) or grep('DisableRoutinelyTakingAction',
    this['ProcessCommandLine']) or grep('DisableScanOnRealtimeEnable', this['ProcessCommandLine'])
    or grep('DisableScriptScanning', this['ProcessCommandLine']) or grep('Notification_Suppress',
    this['ProcessCommandLine']) or grep('SignatureDisableUpdateOnStartupWithoutEngine',
    this['ProcessCommandLine'])))
  sigma_id: 452bce90-6fb0-43cc-97a5-affc283139b3
- name: Write Protect For Storage Disabled
  query: grep('\\System\\CurrentControlSet\\Control', this['ProcessCommandLine'])
    and grep('Write Protection', this['ProcessCommandLine']) and grep('0', this['ProcessCommandLine'])
    and grep('storage', this['ProcessCommandLine'])
  sigma_id: 75f7a0e2-7154-4c4d-9eae-5cdb4e0a5c13
- name: Potentially Suspicious Execution Of Regasm/Regsvcs With Uncommon Extension
  query: (grep('\\Regsvcs.exe', this['FolderPath']) or grep('\\Regasm.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['RegSvcs.exe', 'RegAsm.exe'])
    and (grep('.dat', this['ProcessCommandLine']) or grep('.gif', this['ProcessCommandLine'])
    or grep('.jpeg', this['ProcessCommandLine']) or grep('.jpg', this['ProcessCommandLine'])
    or grep('.png', this['ProcessCommandLine']) or grep('.txt', this['ProcessCommandLine']))
  sigma_id: e9f8f8cc-07cc-4e81-b724-f387db9175e4
- name: Potentially Suspicious Execution Of Regasm/Regsvcs From Uncommon Location
  query: (grep('\\Regsvcs.exe', this['FolderPath']) or grep('\\Regasm.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['RegSvcs.exe', 'RegAsm.exe'])
    and (grep('\\AppData\\Local\\Temp\\', this['ProcessCommandLine']) or grep('\\Microsoft\\Windows\\Start
    Menu\\Programs\\Startup\\', this['ProcessCommandLine']) or grep('\\PerfLogs\\',
    this['ProcessCommandLine']) or grep('\\Users\\Public\\', this['ProcessCommandLine'])
    or grep('\\Windows\\Temp\\', this['ProcessCommandLine']))
  sigma_id: cc368ed0-2411-45dc-a222-510ace303cb2
- name: Exports Critical Registry Keys To a File
  query: "(grep('\\\\regedit.exe', this['FolderPath']) or grep('REGEDIT.EXE', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep(' -E ', this['ProcessCommandLine']) or grep(' /E ', this['ProcessCommandLine'])\
    \ or grep(' \u2013E ', this['ProcessCommandLine']) or grep(' \u2014E ', this['ProcessCommandLine'])\
    \ or grep(' \u2015E ', this['ProcessCommandLine'])) and (grep('hklm', this['ProcessCommandLine'])\
    \ or grep('hkey_local_machine', this['ProcessCommandLine'])) and (grep('\\\\system',\
    \ this['ProcessCommandLine']) or grep('\\\\sam', this['ProcessCommandLine']) or\
    \ grep('\\\\security', this['ProcessCommandLine']))"
  sigma_id: 82880171-b475-4201-b811-e9c826cd5eaa
- name: Regedit as Trusted Installer
  query: grep('\\regedit.exe', this['FolderPath']) and (grep('\\TrustedInstaller.exe',
    this['InitiatingProcessFolderPath']) or grep('\\ProcessHacker.exe', this['InitiatingProcessFolderPath']))
  sigma_id: 883835a7-df45-43e4-bf1d-4268768afda4
- name: DLL Execution Via Register-cimprovider.exe
  query: grep('\\register-cimprovider.exe', this['FolderPath']) and grep('-path',
    this['ProcessCommandLine']) and grep('dll', this['ProcessCommandLine'])
  sigma_id: a2910908-e86f-4687-aeba-76a5f996e652
- name: Enumeration for 3rd Party Creds From CLI
  query: grep('\\Software\\SimonTatham\\PuTTY\\Sessions', this['ProcessCommandLine'])
    or grep('\\Software\\SimonTatham\\PuTTY\\SshHostKeys\\', this['ProcessCommandLine'])
    or grep('\\Software\\Mobatek\\MobaXterm\\', this['ProcessCommandLine']) or grep('\\Software\\WOW6432Node\\Radmin\\v3.0\\Server\\Parameters\\Radmin',
    this['ProcessCommandLine']) or grep('\\Software\\Aerofox\\FoxmailPreview', this['ProcessCommandLine'])
    or grep('\\Software\\Aerofox\\Foxmail\\V3.1', this['ProcessCommandLine']) or grep('\\Software\\IncrediMail\\Identities',
    this['ProcessCommandLine']) or grep('\\Software\\Qualcomm\\Eudora\\CommandLine',
    this['ProcessCommandLine']) or grep('\\Software\\RimArts\\B2\\Settings', this['ProcessCommandLine'])
    or grep('\\Software\\OpenVPN-GUI\\configs', this['ProcessCommandLine']) or grep('\\Software\\Martin
    Prikryl\\WinSCP 2\\Sessions', this['ProcessCommandLine']) or grep('\\Software\\FTPWare\\COREFTP\\Sites',
    this['ProcessCommandLine']) or grep('\\Software\\DownloadManager\\Passwords',
    this['ProcessCommandLine']) or grep('\\Software\\OpenSSH\\Agent\\Keys', this['ProcessCommandLine'])
    or grep('\\Software\\TightVNC\\Server', this['ProcessCommandLine']) or grep('\\Software\\ORL\\WinVNC3\\Password',
    this['ProcessCommandLine']) or grep('\\Software\\RealVNC\\WinVNC4', this['ProcessCommandLine'])
  sigma_id: 87a476dc-0079-4583-a985-dee7a20a03de
- name: IE ZoneMap Setting Downgraded To MyComputer Zone For HTTP Protocols Via CLI
  query: grep('\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults',
    this['ProcessCommandLine']) and grep('http', this['ProcessCommandLine']) and grep('
    0', this['ProcessCommandLine'])
  sigma_id: 10344bb3-7f65-46c2-b915-2d00d47be5b0
- name: Suspicious Debugger Registration Cmdline
  query: grep('\\CurrentVersion\\Image File Execution Options\\', this['ProcessCommandLine'])
    and (grep('sethc.exe', this['ProcessCommandLine']) or grep('utilman.exe', this['ProcessCommandLine'])
    or grep('osk.exe', this['ProcessCommandLine']) or grep('magnify.exe', this['ProcessCommandLine'])
    or grep('narrator.exe', this['ProcessCommandLine']) or grep('displayswitch.exe',
    this['ProcessCommandLine']) or grep('atbroker.exe', this['ProcessCommandLine'])
    or grep('HelpPane.exe', this['ProcessCommandLine']))
  sigma_id: ae215552-081e-44c7-805f-be16f975c8a2
- name: Potential Persistence Via Logon Scripts - CommandLine
  query: grep('UserInitMprLogonScript', this['ProcessCommandLine'])
  sigma_id: 21d856f9-9281-4ded-9377-51a1a6e2a432
- name: Potential Credential Dumping Attempt Using New NetworkProvider - CLI
  query: grep('\\System\\CurrentControlSet\\Services\\', this['ProcessCommandLine'])
    and grep('\\NetworkProvider', this['ProcessCommandLine'])
  sigma_id: baef1ec6-2ca9-47a3-97cc-4cf2bda10b77
- name: Python Function Execution Security Warning Disabled In Excel
  query: grep('\\Microsoft\\Office\\', this['ProcessCommandLine']) and grep('\\Excel\\Security',
    this['ProcessCommandLine']) and grep('PythonFunctionWarnings', this['ProcessCommandLine'])
    and grep(' 0', this['ProcessCommandLine'])
  sigma_id: 023c654f-8f16-44d9-bb2b-00ff36a62af9
- name: Potential Privilege Escalation via Service Permissions Weakness
  query: (this['ProcessIntegrityLevel'] in ['Medium', 'S-1-16-8192']) and grep('ControlSet',
    this['ProcessCommandLine']) and grep('services', this['ProcessCommandLine']) and
    (grep('\\ImagePath', this['ProcessCommandLine']) or grep('\\FailureCommand', this['ProcessCommandLine'])
    or grep('\\ServiceDll', this['ProcessCommandLine']))
  sigma_id: 0f9c21f1-6a73-4b0e-9809-cb562cb8d981
- name: Potential Provisioning Registry Key Abuse For Binary Proxy Execution
  query: grep('SOFTWARE\\Microsoft\\Provisioning\\Commands\\', this['ProcessCommandLine'])
  sigma_id: 2a4b3e61-9d22-4e4a-b60f-6e8f0cde6f25
- name: Potential PowerShell Execution Policy Tampering - ProcCreation
  query: (grep('\\ShellIds\\Microsoft.PowerShell\\ExecutionPolicy', this['ProcessCommandLine'])
    or grep('\\Policies\\Microsoft\\Windows\\PowerShell\\ExecutionPolicy', this['ProcessCommandLine']))
    and (grep('Bypass', this['ProcessCommandLine']) or grep('RemoteSigned', this['ProcessCommandLine'])
    or grep('Unrestricted', this['ProcessCommandLine']))
  sigma_id: cf2e938e-9a3e-4fe8-a347-411642b28a9f
- name: Hiding User Account Via SpecialAccounts Registry Key - CommandLine
  query: grep('\\reg.exe', this['FolderPath']) and grep('\\SOFTWARE\\Microsoft\\Windows
    NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList', this['ProcessCommandLine'])
    and grep('add', this['ProcessCommandLine']) and grep('/v', this['ProcessCommandLine'])
    and grep('/d 0', this['ProcessCommandLine'])
  sigma_id: 9ec9fb1b-e059-4489-9642-f270c207923d
- name: Persistence Via TypedPaths - CommandLine
  query: grep('\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths',
    this['ProcessCommandLine'])
  sigma_id: ec88289a-7e1a-4cc3-8d18-bd1f60e4b9ba
- name: Potential Regsvr32 Commandline Flag Anomaly
  query: "grep('\\\\regsvr32.exe', this['FolderPath']) and (grep(' -i:', this['ProcessCommandLine'])\
    \ or grep(' /i:', this['ProcessCommandLine']) or grep(' \u2013i:', this['ProcessCommandLine'])\
    \ or grep(' \u2014i:', this['ProcessCommandLine']) or grep(' \u2015i:', this['ProcessCommandLine']))\
    \ and not grep(' -n ', this['ProcessCommandLine']) or grep(' /n ', this['ProcessCommandLine'])\
    \ or grep(' \u2013n ', this['ProcessCommandLine']) or grep(' \u2014n ', this['ProcessCommandLine'])\
    \ or grep(' \u2015n ', this['ProcessCommandLine'])"
  sigma_id: b236190c-1c61-41e9-84b3-3fe03f6d76b0
- name: Potentially Suspicious Regsvr32 HTTP IP Pattern
  query: (grep('\\regsvr32.exe', this['FolderPath']) or grep('REGSVR32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' /i:http://1', this['ProcessCommandLine']) or grep(' /i:http://2',
    this['ProcessCommandLine']) or grep(' /i:http://3', this['ProcessCommandLine'])
    or grep(' /i:http://4', this['ProcessCommandLine']) or grep(' /i:http://5', this['ProcessCommandLine'])
    or grep(' /i:http://6', this['ProcessCommandLine']) or grep(' /i:http://7', this['ProcessCommandLine'])
    or grep(' /i:http://8', this['ProcessCommandLine']) or grep(' /i:http://9', this['ProcessCommandLine'])
    or grep(' /i:https://1', this['ProcessCommandLine']) or grep(' /i:https://2',
    this['ProcessCommandLine']) or grep(' /i:https://3', this['ProcessCommandLine'])
    or grep(' /i:https://4', this['ProcessCommandLine']) or grep(' /i:https://5',
    this['ProcessCommandLine']) or grep(' /i:https://6', this['ProcessCommandLine'])
    or grep(' /i:https://7', this['ProcessCommandLine']) or grep(' /i:https://8',
    this['ProcessCommandLine']) or grep(' /i:https://9', this['ProcessCommandLine'])
    or grep(' -i:http://1', this['ProcessCommandLine']) or grep(' -i:http://2', this['ProcessCommandLine'])
    or grep(' -i:http://3', this['ProcessCommandLine']) or grep(' -i:http://4', this['ProcessCommandLine'])
    or grep(' -i:http://5', this['ProcessCommandLine']) or grep(' -i:http://6', this['ProcessCommandLine'])
    or grep(' -i:http://7', this['ProcessCommandLine']) or grep(' -i:http://8', this['ProcessCommandLine'])
    or grep(' -i:http://9', this['ProcessCommandLine']) or grep(' -i:https://1', this['ProcessCommandLine'])
    or grep(' -i:https://2', this['ProcessCommandLine']) or grep(' -i:https://3',
    this['ProcessCommandLine']) or grep(' -i:https://4', this['ProcessCommandLine'])
    or grep(' -i:https://5', this['ProcessCommandLine']) or grep(' -i:https://6',
    this['ProcessCommandLine']) or grep(' -i:https://7', this['ProcessCommandLine'])
    or grep(' -i:https://8', this['ProcessCommandLine']) or grep(' -i:https://9',
    this['ProcessCommandLine']))
  sigma_id: 2dd2c217-bf68-437a-b57c-fe9fd01d5de8
- name: Potentially Suspicious Regsvr32 HTTP/FTP Pattern
  query: (grep('\\regsvr32.exe', this['FolderPath']) or grep('REGSVR32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' /i', this['ProcessCommandLine']) or grep(' -i', this['ProcessCommandLine']))
    and (grep('ftp', this['ProcessCommandLine']) or grep('http', this['ProcessCommandLine']))
  sigma_id: 867356ee-9352-41c9-a8f2-1be690d78216
- name: Suspicious Regsvr32 Execution From Remote Share
  query: (grep('\\regsvr32.exe', this['FolderPath']) or grep('\\REGSVR32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep(' \\', this['ProcessCommandLine'])
  sigma_id: 88a87a10-384b-4ad7-8871-2f9bf9259ce5
- name: Potentially Suspicious Child Process Of Regsvr32
  query: grep('\\regsvr32.exe', this['InitiatingProcessFolderPath']) and (grep('\\calc.exe',
    this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']) or grep('\\explorer.exe',
    this['FolderPath']) or grep('\\mshta.exe', this['FolderPath']) or grep('\\net.exe',
    this['FolderPath']) or grep('\\net1.exe', this['FolderPath']) or grep('\\nltest.exe',
    this['FolderPath']) or grep('\\notepad.exe', this['FolderPath']) or grep('\\powershell.exe',
    this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']) or grep('\\reg.exe',
    this['FolderPath']) or grep('\\schtasks.exe', this['FolderPath']) or grep('\\werfault.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath'])) and not (grep('\\werfault.exe',
    this['FolderPath']) and grep(' -u -p ', this['ProcessCommandLine']))
  sigma_id: 6f0947a4-1c5e-4e0d-8ac7-53159b8f23ca
- name: Regsvr32 Execution From Potential Suspicious Location
  query: (grep('\\regsvr32.exe', this['FolderPath']) or grep('REGSVR32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and (grep(':\\ProgramData\\', this['ProcessCommandLine']) or grep(':\\Temp\\',
    this['ProcessCommandLine']) or grep(':\\Users\\Public\\', this['ProcessCommandLine'])
    or grep(':\\Windows\\Temp\\', this['ProcessCommandLine']) or grep('\\AppData\\Local\\Temp\\',
    this['ProcessCommandLine']) or grep('\\AppData\\Roaming\\', this['ProcessCommandLine']))
  sigma_id: 9525dc73-0327-438c-8c04-13c0e037e9da
- name: Regsvr32 Execution From Highly Suspicious Location
  query: (grep('\\regsvr32.exe', this['FolderPath']) or grep('REGSVR32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and (grep(':\\PerfLogs\\', this['ProcessCommandLine']) or grep(':\\Temp\\', this['ProcessCommandLine'])
    or grep('\\Windows\\Registration\\CRMLog', this['ProcessCommandLine']) or grep('\\Windows\\System32\\com\\dmp\\',
    this['ProcessCommandLine']) or grep('\\Windows\\System32\\FxsTmp\\', this['ProcessCommandLine'])
    or grep('\\Windows\\System32\\Microsoft\\Crypto\\RSA\\MachineKeys\\', this['ProcessCommandLine'])
    or grep('\\Windows\\System32\\spool\\drivers\\color\\', this['ProcessCommandLine'])
    or grep('\\Windows\\System32\\spool\\PRINTERS\\', this['ProcessCommandLine'])
    or grep('\\Windows\\System32\\spool\\SERVERS\\', this['ProcessCommandLine']) or
    grep('\\Windows\\System32\\Tasks_Migrated\\', this['ProcessCommandLine']) or grep('\\Windows\\System32\\Tasks\\Microsoft\\Windows\\SyncCenter\\',
    this['ProcessCommandLine']) or grep('\\Windows\\SysWOW64\\com\\dmp\\', this['ProcessCommandLine'])
    or grep('\\Windows\\SysWOW64\\FxsTmp\\', this['ProcessCommandLine']) or grep('\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\PLA\\System\\',
    this['ProcessCommandLine']) or grep('\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\SyncCenter\\',
    this['ProcessCommandLine']) or grep('\\Windows\\Tasks\\', this['ProcessCommandLine'])
    or grep('\\Windows\\Tracing\\', this['ProcessCommandLine']) or (grep(' "C:\\',
    this['ProcessCommandLine']) or grep(' C:\\', this['ProcessCommandLine']) or grep('
    \'C:\\', this['ProcessCommandLine']) or grep('D:\\', this['ProcessCommandLine']))
    and not (grep('C:\\Program Files (x86)\\', this['ProcessCommandLine']) or grep('C:\\Program
    Files\\', this['ProcessCommandLine']) or grep('C:\\ProgramData\\', this['ProcessCommandLine'])
    or grep('C:\\Users\\', this['ProcessCommandLine']) or grep(' C:\\Windows\\', this['ProcessCommandLine'])
    or grep(' "C:\\Windows\\', this['ProcessCommandLine']) or grep(' \'C:\\Windows\\',
    this['ProcessCommandLine']))) and not (false or this['ProcessCommandLine']==null)
  sigma_id: 327ff235-94eb-4f06-b9de-aaee571324be
- name: Regsvr32 DLL Execution With Suspicious File Extension
  query: (grep('\\regsvr32.exe', this['FolderPath']) or grep('REGSVR32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and (grep('.bin', this['ProcessCommandLine']) or grep('.bmp', this['ProcessCommandLine'])
    or grep('.cr2', this['ProcessCommandLine']) or grep('.dat', this['ProcessCommandLine'])
    or grep('.eps', this['ProcessCommandLine']) or grep('.gif', this['ProcessCommandLine'])
    or grep('.ico', this['ProcessCommandLine']) or grep('.jpeg', this['ProcessCommandLine'])
    or grep('.jpg', this['ProcessCommandLine']) or grep('.nef', this['ProcessCommandLine'])
    or grep('.orf', this['ProcessCommandLine']) or grep('.png', this['ProcessCommandLine'])
    or grep('.raw', this['ProcessCommandLine']) or grep('.sr2', this['ProcessCommandLine'])
    or grep('.temp', this['ProcessCommandLine']) or grep('.tif', this['ProcessCommandLine'])
    or grep('.tiff', this['ProcessCommandLine']) or grep('.tmp', this['ProcessCommandLine'])
    or grep('.rtf', this['ProcessCommandLine']) or grep('.txt', this['ProcessCommandLine']))
  sigma_id: 089fc3d2-71e8-4763-a8a5-c97fbb0a403e
- name: Scripting/CommandLine Process Spawned Regsvr32
  query: (grep('\\cmd.exe', this['InitiatingProcessFolderPath']) or grep('\\cscript.exe',
    this['InitiatingProcessFolderPath']) or grep('\\mshta.exe', this['InitiatingProcessFolderPath'])
    or grep('\\powershell_ise.exe', this['InitiatingProcessFolderPath']) or grep('\\powershell.exe',
    this['InitiatingProcessFolderPath']) or grep('\\pwsh.exe', this['InitiatingProcessFolderPath'])
    or grep('\\wscript.exe', this['InitiatingProcessFolderPath'])) and grep('\\regsvr32.exe',
    this['FolderPath']) and not (grep('C:\\Windows\\System32\\cmd.exe', this['InitiatingProcessFolderPath'])
    and grep(' /s C:\\Windows\\System32\\RpcProxy\\RpcProxy.dll', this['ProcessCommandLine']))
  sigma_id: ab37a6ec-6068-432b-a64e-2c7bf95b1d22
- name: Regsvr32 DLL Execution With Uncommon Extension
  query: (grep('\\regsvr32.exe', this['FolderPath']) or grep('REGSVR32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and not (grep('.ax', this['ProcessCommandLine']) or grep('.cpl', this['ProcessCommandLine'])
    or grep('.dll', this['ProcessCommandLine']) or grep('.ocx', this['ProcessCommandLine'])
    or this['ProcessCommandLine']==null or false) and not (grep('.ppl', this['ProcessCommandLine'])
    or grep('.bav', this['ProcessCommandLine']))
  sigma_id: 50919691-7302-437f-8e10-1fe088afa145
- name: Remote Access Tool - AnyDesk Execution
  query: grep('\\AnyDesk.exe', this['FolderPath']) or grep('AnyDesk', this['ProcessVersionInfoFileDescription'])
    or grep('AnyDesk', this['ProcessVersionInfoProductName']) or grep('AnyDesk Software
    GmbH', this['ProcessVersionInfoCompanyName'])
  sigma_id: b52e84a3-029e-4529-b09b-71d19dd27e94
- name: Remote Access Tool - AnyDesk Piped Password Via CLI
  query: grep('/c ', this['ProcessCommandLine']) and grep('echo ', this['ProcessCommandLine'])
    and grep('.exe --set-password', this['ProcessCommandLine'])
  sigma_id: b1377339-fda6-477a-b455-ac0923f9ec2c
- name: Remote Access Tool - AnyDesk Execution With Known Revoked Signing Certificate
  query: (grep('\\AnyDesk.exe', this['FolderPath']) or grep('AnyDesk', this['ProcessVersionInfoFileDescription'])
    or grep('AnyDesk', this['ProcessVersionInfoProductName']) or grep('AnyDesk Software
    GmbH', this['ProcessVersionInfoCompanyName'])) and (grep('7.0.', this['ProcessVersionInfoProductVersion'])
    or grep('7.1.', this['ProcessVersionInfoProductVersion']) or grep('8.0.1', this['ProcessVersionInfoProductVersion'])
    or grep('8.0.2', this['ProcessVersionInfoProductVersion']) or grep('8.0.3', this['ProcessVersionInfoProductVersion'])
    or grep('8.0.4', this['ProcessVersionInfoProductVersion']) or grep('8.0.5', this['ProcessVersionInfoProductVersion'])
    or grep('8.0.6', this['ProcessVersionInfoProductVersion']) or grep('8.0.7', this['ProcessVersionInfoProductVersion']))
    and not (grep(' --remove', this['ProcessCommandLine']) or grep(' --uninstall',
    this['ProcessCommandLine']))
  sigma_id: 41f407b5-3096-44ea-a74f-96d04fbc41be
- name: Remote Access Tool - AnyDesk Silent Installation
  query: grep('--install', this['ProcessCommandLine']) and grep('--start-with-win',
    this['ProcessCommandLine']) and grep('--silent', this['ProcessCommandLine'])
  sigma_id: 114e7f1c-f137-48c8-8f54-3088c24ce4b9
- name: Remote Access Tool - Anydesk Execution From Suspicious Folder
  query: (grep('\\AnyDesk.exe', this['FolderPath']) or grep('AnyDesk', this['ProcessVersionInfoFileDescription'])
    or grep('AnyDesk', this['ProcessVersionInfoProductName']) or grep('AnyDesk Software
    GmbH', this['ProcessVersionInfoCompanyName'])) and not (grep('\\AppData\\', this['FolderPath'])
    or grep('Program Files (x86)\\AnyDesk', this['FolderPath']) or grep('Program Files\\AnyDesk',
    this['FolderPath']))
  sigma_id: 065b00ca-5d5c-4557-ac95-64a6d0b64d86
- name: Remote Access Tool - GoToAssist Execution
  query: grep('GoTo Opener', this['ProcessVersionInfoFileDescription']) or grep('GoTo
    Opener', this['ProcessVersionInfoProductName']) or grep('LogMeIn, Inc.', this['ProcessVersionInfoCompanyName'])
  sigma_id: b6d98a4f-cef0-4abf-bbf6-24132854a83d
- name: Remote Access Tool - LogMeIn Execution
  query: grep('LMIGuardianSvc', this['ProcessVersionInfoFileDescription']) or grep('LMIGuardianSvc',
    this['ProcessVersionInfoProductName']) or grep('LogMeIn, Inc.', this['ProcessVersionInfoCompanyName'])
  sigma_id: d85873ef-a0f8-4c48-a53a-6b621f11729d
- name: Remote Access Tool - MeshAgent Command Execution via MeshCentral
  query: grep('\\meshagent.exe', this['InitiatingProcessFolderPath']) and (grep('\\cmd.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']))
  sigma_id: 74a2b202-73e0-4693-9a3a-9d36146d0775
- name: Remote Access Tool - NetSupport Execution
  query: grep('NetSupport Client Configurator', this['ProcessVersionInfoFileDescription'])
    or grep('NetSupport Remote Control', this['ProcessVersionInfoProductName']) or
    grep('NetSupport Ltd', this['ProcessVersionInfoCompanyName']) or grep('PCICFGUI.EXE',
    this['ProcessVersionInfoOriginalFileName'])
  sigma_id: 758ff488-18d5-4cbe-8ec4-02b6285a434f
- name: Remote Access Tool - NetSupport Execution From Unusual Location
  query: (grep('\\client32.exe', this['FolderPath']) or grep('NetSupport Remote Control',
    this['ProcessVersionInfoProductName']) or grep('client32.exe', this['ProcessVersionInfoOriginalFileName'])
    or grep('IMPHASH=a9d50692e95b79723f3e76fcf70d023e', this['Hashes'])) and not (grep('C:\\Program
    Files\\', this['FolderPath']) or grep('C:\\Program Files (x86)\\', this['FolderPath']))
  sigma_id: 37e8d358-6408-4853-82f4-98333fca7014
- name: Remote Access Tool - RURAT Execution From Unusual Location
  query: (grep('\\rutserv.exe', this['FolderPath']) or grep('\\rfusclient.exe', this['FolderPath'])
    or grep('Remote Utilities', this['ProcessVersionInfoProductName'])) and not (grep('C:\\Program
    Files\\Remote Utilities', this['FolderPath']) or grep('C:\\Program Files (x86)\\Remote
    Utilities', this['FolderPath']))
  sigma_id: e01fa958-6893-41d4-ae03-182477c5e77d
- name: Remote Access Tool - ScreenConnect Execution
  query: grep('ScreenConnect Service', this['ProcessVersionInfoFileDescription'])
    or grep('ScreenConnect', this['ProcessVersionInfoProductName']) or grep('ScreenConnect
    Software', this['ProcessVersionInfoCompanyName'])
  sigma_id: 57bff678-25d1-4d6c-8211-8ca106d12053
- name: Remote Access Tool - ScreenConnect Installation Execution
  query: grep('e=Access&', this['ProcessCommandLine']) and grep('y=Guest&', this['ProcessCommandLine'])
    and grep('&p=', this['ProcessCommandLine']) and grep('&c=', this['ProcessCommandLine'])
    and grep('&k=', this['ProcessCommandLine'])
  sigma_id: 75bfe6e6-cd8e-429e-91d3-03921e1d7962
- name: Remote Access Tool - ScreenConnect Potential Suspicious Remote Command Execution
  query: grep(':\\Windows\\TEMP\\ScreenConnect\\', this['InitiatingProcessCommandLine'])
    and grep('run.cmd', this['InitiatingProcessCommandLine']) and (grep('\\bitsadmin.exe',
    this['FolderPath']) or grep('\\cmd.exe', this['FolderPath']) or grep('\\curl.exe',
    this['FolderPath']) or grep('\\dllhost.exe', this['FolderPath']) or grep('\\net.exe',
    this['FolderPath']) or grep('\\nltest.exe', this['FolderPath']) or grep('\\powershell.exe',
    this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']) or grep('\\rundll32.exe',
    this['FolderPath']) or grep('\\wevtutil.exe', this['FolderPath']))
  sigma_id: 7b582f1a-b318-4c6a-bf4e-66fe49bf55a5
- name: Remote Access Tool - ScreenConnect Server Web Shell Execution
  query: grep('\\ScreenConnect.Service.exe', this['InitiatingProcessFolderPath'])
    and (grep('\\cmd.exe', this['FolderPath']) or grep('\\csc.exe', this['FolderPath']))
  sigma_id: b19146a3-25d4-41b4-928b-1e2a92641b1b
- name: Remote Access Tool - Simple Help Execution
  query: (grep('\\JWrapper-Remote Access\\', this['FolderPath']) or grep('\\JWrapper-Remote
    Support\\', this['FolderPath'])) and grep('\\SimpleService.exe', this['FolderPath'])
  sigma_id: 95e60a2b-4705-444b-b7da-ba0ea81a3ee2
- name: Remote Access Tool - UltraViewer Execution
  query: grep('UltraViewer', this['ProcessVersionInfoProductName']) or grep('DucFabulous
    Co,ltd', this['ProcessVersionInfoCompanyName']) or grep('UltraViewer_Desktop.exe',
    this['ProcessVersionInfoOriginalFileName'])
  sigma_id: 88656cec-6c3b-487c-82c0-f73ebb805503
- name: Renamed AdFind Execution
  query: (grep('domainlist', this['ProcessCommandLine']) or grep('trustdmp', this['ProcessCommandLine'])
    or grep('dcmodes', this['ProcessCommandLine']) or grep('adinfo', this['ProcessCommandLine'])
    or grep(' dclist ', this['ProcessCommandLine']) or grep('computer_pwdnotreqd',
    this['ProcessCommandLine']) or grep('objectcategory=', this['ProcessCommandLine'])
    or grep('-subnets -f', this['ProcessCommandLine']) or grep('name="Domain Admins"',
    this['ProcessCommandLine']) or grep('-sc u:', this['ProcessCommandLine']) or grep('domainncs',
    this['ProcessCommandLine']) or grep('dompol', this['ProcessCommandLine']) or grep('
    oudmp ', this['ProcessCommandLine']) or grep('subnetdmp', this['ProcessCommandLine'])
    or grep('gpodmp', this['ProcessCommandLine']) or grep('fspdmp', this['ProcessCommandLine'])
    or grep('users_noexpire', this['ProcessCommandLine']) or grep('computers_active',
    this['ProcessCommandLine']) or grep('computers_pwdnotreqd', this['ProcessCommandLine'])
    or grep('IMPHASH=BCA5675746D13A1F246E2DA3C2217492', this['Hashes']) or grep('IMPHASH=53E117A96057EAF19C41380D0E87F1C2',
    this['Hashes']) or grep('AdFind.exe', this['ProcessVersionInfoOriginalFileName']))
    and not grep('\\AdFind.exe', this['FolderPath'])
  sigma_id: df55196f-f105-44d3-a675-e9dfb6cc2f2b
- name: Renamed AutoHotkey.EXE Execution
  query: (grep('AutoHotkey', this['ProcessVersionInfoProductName']) or grep('AutoHotkey',
    this['ProcessVersionInfoFileDescription']) or this['ProcessVersionInfoOriginalFileName']
    in ['AutoHotkey.exe', 'AutoHotkey.rc']) and not (grep('\\AutoHotkey.exe', this['FolderPath'])
    or grep('\\AutoHotkey32.exe', this['FolderPath']) or grep('\\AutoHotkey32_UIA.exe',
    this['FolderPath']) or grep('\\AutoHotkey64.exe', this['FolderPath']) or grep('\\AutoHotkey64_UIA.exe',
    this['FolderPath']) or grep('\\AutoHotkeyA32.exe', this['FolderPath']) or grep('\\AutoHotkeyA32_UIA.exe',
    this['FolderPath']) or grep('\\AutoHotkeyU32.exe', this['FolderPath']) or grep('\\AutoHotkeyU32_UIA.exe',
    this['FolderPath']) or grep('\\AutoHotkeyU64.exe', this['FolderPath']) or grep('\\AutoHotkeyU64_UIA.exe',
    this['FolderPath']) or grep('\\AutoHotkey', this['FolderPath']))
  sigma_id: 0f16d9cf-0616-45c8-8fad-becc11b5a41c
- name: Renamed AutoIt Execution
  query: (grep(' /AutoIt3ExecuteScript', this['ProcessCommandLine']) or grep(' /ErrorStdOut',
    this['ProcessCommandLine']) or grep('IMPHASH=FDC554B3A8683918D731685855683DDF',
    this['Hashes']) or grep('IMPHASH=CD30A61B60B3D60CECDB034C8C83C290', this['Hashes'])
    or grep('IMPHASH=F8A00C72F2D667D2EDBB234D0C0AE000', this['Hashes']) or this['ProcessVersionInfoOriginalFileName']
    in ['AutoIt3.exe', 'AutoIt2.exe', 'AutoIt.exe']) and not (grep('\\AutoIt.exe',
    this['FolderPath']) or grep('\\AutoIt2.exe', this['FolderPath']) or grep('\\AutoIt3_x64.exe',
    this['FolderPath']) or grep('\\AutoIt3.exe', this['FolderPath']))
  sigma_id: f4264e47-f522-4c38-a420-04525d5b880f
- name: Potential Defense Evasion Via Binary Rename
  query: (this['ProcessVersionInfoOriginalFileName'] in ['Cmd.Exe', 'CONHOST.EXE',
    '7z.exe', 'WinRAR.exe', 'wevtutil.exe', 'net.exe', 'net1.exe', 'netsh.exe', 'InstallUtil.exe'])
    and not (grep('\\cmd.exe', this['FolderPath']) or grep('\\conhost.exe', this['FolderPath'])
    or grep('\\7z.exe', this['FolderPath']) or grep('\\WinRAR.exe', this['FolderPath'])
    or grep('\\wevtutil.exe', this['FolderPath']) or grep('\\net.exe', this['FolderPath'])
    or grep('\\net1.exe', this['FolderPath']) or grep('\\netsh.exe', this['FolderPath'])
    or grep('\\InstallUtil.exe', this['FolderPath']))
  sigma_id: 36480ae1-a1cb-4eaa-a0d6-29801d7e9142
- name: Potential Defense Evasion Via Rename Of Highly Relevant Binaries
  query: (grep('Execute processes remotely', this['ProcessVersionInfoFileDescription'])
    or grep('Sysinternals PsExec', this['ProcessVersionInfoProductName']) or grep('Windows
    PowerShell', this['ProcessVersionInfoFileDescription']) or grep('pwsh', this['ProcessVersionInfoFileDescription'])
    or this['ProcessVersionInfoOriginalFileName'] in ['certutil.exe', 'cmstp.exe',
    'cscript.exe', 'IE4UINIT.EXE', 'mshta.exe', 'msiexec.exe', 'msxsl.exe', 'powershell_ise.exe',
    'powershell.exe', 'psexec.c', 'psexec.exe', 'psexesvc.exe', 'pwsh.dll', 'reg.exe',
    'regsvr32.exe', 'rundll32.exe', 'WerMgr', 'wmic.exe', 'wscript.exe']) and not
    (grep('\\certutil.exe', this['FolderPath']) or grep('\\cmstp.exe', this['FolderPath'])
    or grep('\\cscript.exe', this['FolderPath']) or grep('\\ie4uinit.exe', this['FolderPath'])
    or grep('\\mshta.exe', this['FolderPath']) or grep('\\msiexec.exe', this['FolderPath'])
    or grep('\\msxsl.exe', this['FolderPath']) or grep('\\powershell_ise.exe', this['FolderPath'])
    or grep('\\powershell.exe', this['FolderPath']) or grep('\\psexec.exe', this['FolderPath'])
    or grep('\\psexec64.exe', this['FolderPath']) or grep('\\PSEXESVC.exe', this['FolderPath'])
    or grep('\\pwsh.exe', this['FolderPath']) or grep('\\reg.exe', this['FolderPath'])
    or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\rundll32.exe', this['FolderPath'])
    or grep('\\wermgr.exe', this['FolderPath']) or grep('\\wmic.exe', this['FolderPath'])
    or grep('\\wscript.exe', this['FolderPath']))
  sigma_id: 0ba1da6d-b6ce-4366-828c-18826c9de23e
- name: Renamed BOINC Client Execution
  query: grep('BOINC.exe', this['ProcessVersionInfoOriginalFileName']) and not grep('\\BOINC.exe',
    this['FolderPath'])
  sigma_id: 30d07da2-83ab-45d8-ae75-ec7c0edcaffc
- name: Renamed BrowserCore.EXE Execution
  query: grep('BrowserCore.exe', this['ProcessVersionInfoOriginalFileName']) and not
    grep('\\BrowserCore.exe', this['FolderPath'])
  sigma_id: 8a4519e8-e64a-40b6-ae85-ba8ad2177559
- name: Renamed Cloudflared.EXE Execution
  query: (grep(' tunnel ', this['ProcessCommandLine']) and grep('cleanup ', this['ProcessCommandLine'])
    and (grep('-config ', this['ProcessCommandLine']) or grep('-connector-id ', this['ProcessCommandLine']))
    or grep(' tunnel ', this['ProcessCommandLine']) and grep(' run ', this['ProcessCommandLine'])
    and (grep('-config ', this['ProcessCommandLine']) or grep('-credentials-contents
    ', this['ProcessCommandLine']) or grep('-credentials-file ', this['ProcessCommandLine'])
    or grep('-token ', this['ProcessCommandLine'])) or grep('-url', this['ProcessCommandLine'])
    and grep('tunnel', this['ProcessCommandLine']) or grep('2fb6c04c4f95fb8d158af94c137f90ac820716deaf88d8ebec956254e046cb29',
    this['SHA256']) or grep('b3d21940a10fdef5e415ad70331ce257c24fe3bcf7722262302e0421791f87e8',
    this['SHA256']) or grep('1fbd8362b2d2d2e6a5750ae3db69cd1815e6c1d31da48a98b796450971a8e039',
    this['SHA256']) or grep('0409c9b12f9d0eda86e461ed9bdabeefb00172b26322079681a0bdf48e68dc28',
    this['SHA256']) or grep('7cfb411d04bac42ef93d1f0c93c0a481e38c6f4612b97ae89d4702595988edc7',
    this['SHA256']) or grep('5b3c2d846ab162dc6bc595cce3a49de5731afde5d6060be7066d21b013a28373',
    this['SHA256']) or grep('ce95df7f69664c3df19b76028e115931919a71517b776da7b42d353e2ff4a670',
    this['SHA256']) or grep('1293525a19cfe3bc8296b62fbfe19f083632ed644a1c18c10b045a1d3030d81a',
    this['SHA256']) or grep('af2b9161cfcb654b16408cd6b098afe9d1fb61a037d18d7090a119d4c0c8e0f0',
    this['SHA256']) or grep('39ddceb56a15798826a5fc4892fa2b474c444bb4d7a8bf2fa95e41cab10fa7a1',
    this['SHA256']) or grep('ccd11f2328023a0e7929e845d5b6e7bc783fb4650d65faef3ae090239d4bbce2',
    this['SHA256']) or grep('b6e5c5d2567ae8c69cc012ebcae30e6c9b5359d64a58d17ba75ec89f8bce71ac',
    this['SHA256']) or grep('f813484ea441404f18caad96f28138e8aaf0cb256163c09c2ab8a3acab87f69f',
    this['SHA256']) or grep('fc4a0802ab9c7409b892ca00636bec61e2acfc911bccfdeb9978b8ab5a2f828d',
    this['SHA256']) or grep('083150724b49604c8765c1ba19541fa260b133be0acb0647fcd936d81f054499',
    this['SHA256']) or grep('44303d6572956f28a0f2e4b188934fb9874f2584f5c81fa431a463cfbf28083b',
    this['SHA256']) or grep('5d38c46032a58e28ae5f7d174d8761ec3d64d186677f3ec53af5f51afb9bfd2f',
    this['SHA256']) or grep('e1e70fa42059911bc6685fafef957f9a73fc66f214d0704a9b932683a5204032',
    this['SHA256']) or grep('c01356092a365b84f84f0e66870bd1a05ba3feb53cafd973fa5fea2534bee234',
    this['SHA256']) or grep('b3f9c06151e30ee43d39e788a79cd918a314f24e04fe87f3de8272a2057b624f',
    this['SHA256']) or grep('cd81b2792f0739f473c31c9cb7cf2313154bfa28b839975802b90e8790bb5058',
    this['SHA256']) or grep('9ec7e6c8e1bfd883663d8d9d62c9e4f9ae373b731407181e32491b27a7218a2c',
    this['SHA256']) or grep('c2cfd23fdc6c0e1b1ffa0e545cbe556f18d11b362b4a89ba0713f6ab01c4827f',
    this['SHA256']) or grep('53f8adbd76c0eb16f5e43cadde422474d8a06f9c8f959389c1930042ad8beaa5',
    this['SHA256']) or grep('648c8d2f8001c113d2986dd00b7bbd181593d462bef73522cee212c4f71f95b3',
    this['SHA256']) or grep('ae047e2095e46c3f9c518b2be67ec753f4f0aad23b261a361fcb6144dcdb63b4',
    this['SHA256']) or grep('3153d2baa462978dd22ab33d1c2274ecc88c200225d6a3327f98d5b752d08f5c',
    this['SHA256']) or grep('f49cde976e628012c9db73e1c8d76081944ecf2297cdafeb78bb13290da274c4',
    this['SHA256']) or grep('d2513e58bb03ccc83affde685c6ef987924c37ce6707d8e9857e2524b0d7e90f',
    this['SHA256']) or grep('bb67c7623ba92fe64ffd9816b8d5b3b1ea3013960a30bd4cf6e295b3eb5b1bad',
    this['SHA256']) or grep('b34b3c3a91e3165d1481f0b3ec23eab93a1cfba94345a6cbfe5b18ddbd48eac7',
    this['SHA256']) or grep('f7848034e010d55f15e474ca998f96391e320ff29b00cfcc4c5e536529703e75',
    this['SHA256']) or grep('b6fc9493778cbe3bfc062d73f5cc604bc0ff058bc5e5dc6aac87f3a4008b54b6',
    this['SHA256']) or grep('f5c5e962577e2293c4ad10603816dce7cc273585969615fbf4e4bfa9eaff1688',
    this['SHA256']) or grep('d14c52d9220b606f428a8fe9f7c108b0d6f14cf71e7384749e98e6a95962e68f',
    this['SHA256']) or grep('d3a0e1a79158f3985cd49607ebe0cdfcc49cb9af96b8f43aefd0cdfe2f22e663',
    this['SHA256']) or grep('2fbbfc8299537ff80cadf9d0e27c223fe0ccb9052bf9d8763ad717bbfa521c77',
    this['SHA256']) or grep('19074674c6fbdaa573b3081745e5e26144fdf7a086d14e0e220d1814f1f13078',
    this['SHA256'])) and not (grep('\\cloudflared.exe', this['FolderPath']) or grep('\\cloudflared-windows-386.exe',
    this['FolderPath']) or grep('\\cloudflared-windows-amd64.exe', this['FolderPath']))
  sigma_id: e0c69ebd-b54f-4aed-8ae3-e3467843f3f0
- name: Renamed CreateDump Utility Execution
  query: (grep('FX_VER_INTERNALNAME_STR', this['ProcessVersionInfoOriginalFileName'])
    or grep(' -u ', this['ProcessCommandLine']) and grep(' -f ', this['ProcessCommandLine'])
    and grep('.dmp', this['ProcessCommandLine']) or grep(' --full ', this['ProcessCommandLine'])
    and grep(' --name ', this['ProcessCommandLine']) and grep('.dmp', this['ProcessCommandLine']))
    and not grep('\\createdump.exe', this['FolderPath'])
  sigma_id: 1a1ed54a-2ba4-4221-94d5-01dee560d71e
- name: Renamed CURL.EXE Execution
  query: (grep('curl.exe', this['ProcessVersionInfoOriginalFileName']) or grep('The
    curl executable', this['ProcessVersionInfoFileDescription'])) and not grep('\\curl',
    this['FolderPath'])
  sigma_id: 7530cd3d-7671-43e3-b209-976966f6ea48
- name: Renamed ZOHO Dctask64 Execution
  query: (grep('IMPHASH=6834B1B94E49701D77CCB3C0895E1AFD', this['Hashes']) or grep('IMPHASH=1BB6F93B129F398C7C4A76BB97450BBA',
    this['Hashes']) or grep('IMPHASH=FAA2AC19875FADE461C8D89DCF2710A3', this['Hashes'])
    or grep('IMPHASH=F1039CED4B91572AB7847D26032E6BBF', this['Hashes'])) and not grep('\\dctask64.exe',
    this['FolderPath'])
  sigma_id: 340a090b-c4e9-412e-bb36-b4b16fe96f9b
- name: Renamed FTP.EXE Execution
  query: grep('ftp.exe', this['ProcessVersionInfoOriginalFileName']) and not grep('\\ftp.exe',
    this['FolderPath'])
  sigma_id: 277a4393-446c-449a-b0ed-7fdc7795244c
- name: Renamed Gpg.EXE Execution
  query: grep('gpg.exe', this['ProcessVersionInfoOriginalFileName']) and not (grep('\\gpg.exe',
    this['FolderPath']) or grep('\\gpg2.exe', this['FolderPath']))
  sigma_id: ec0722a3-eb5c-4a56-8ab2-bf6f20708592
- name: Renamed Jusched.EXE Execution
  query: (this['ProcessVersionInfoFileDescription'] in ['Java Update Scheduler', 'Java(TM)
    Update Scheduler']) and not grep('\\jusched.exe', this['FolderPath'])
  sigma_id: edd8a48c-1b9f-4ba1-83aa-490338cd1ccb
- name: Renamed Mavinject.EXE Execution
  query: (this['ProcessVersionInfoOriginalFileName'] in ['mavinject32.exe', 'mavinject64.exe'])
    and not (grep('\\mavinject32.exe', this['FolderPath']) or grep('\\mavinject64.exe',
    this['FolderPath']))
  sigma_id: e6474a1b-5390-49cd-ab41-8d88655f7394
- name: Renamed MegaSync Execution
  query: grep('megasync.exe', this['ProcessVersionInfoOriginalFileName']) and not
    grep('\\megasync.exe', this['FolderPath'])
  sigma_id: 643bdcac-8b82-49f4-9fd9-25a90b929f3b
- name: Renamed Msdt.EXE Execution
  query: grep('msdt.exe', this['ProcessVersionInfoOriginalFileName']) and not grep('\\msdt.exe',
    this['FolderPath'])
  sigma_id: bd1c6866-65fc-44b2-be51-5588fcff82b9
- name: Renamed Microsoft Teams Execution
  query: (this['ProcessVersionInfoOriginalFileName'] in ['msteams.exe', 'teams.exe'])
    and not (grep('\\msteams.exe', this['FolderPath']) or grep('\\teams.exe', this['FolderPath']))
  sigma_id: 88f46b67-14d4-4f45-ac2c-d66984f22191
- name: Renamed NetSupport RAT Execution
  query: (grep('NetSupport Remote Control', this['ProcessVersionInfoProductName'])
    or grep('client32.exe', this['ProcessVersionInfoOriginalFileName']) or grep('IMPHASH=A9D50692E95B79723F3E76FCF70D023E',
    this['Hashes'])) and not grep('\\client32.exe', this['FolderPath'])
  sigma_id: 0afbd410-de03-4078-8491-f132303cb67d
- name: Renamed NirCmd.EXE Execution
  query: grep('NirCmd.exe', this['ProcessVersionInfoOriginalFileName']) and not (grep('\\nircmd.exe',
    this['FolderPath']) or grep('\\nircmdc.exe', this['FolderPath']))
  sigma_id: 264982dc-dbad-4dce-b707-1e0d3e0f73d9
- name: Renamed Office Binary Execution
  query: (this['ProcessVersionInfoOriginalFileName'] in ['Excel.exe', 'MSACCESS.EXE',
    'MSPUB.EXE', 'OneNote.exe', 'OneNoteM.exe', 'OUTLOOK.EXE', 'POWERPNT.EXE', 'WinWord.exe']
    or this['ProcessVersionInfoFileDescription'] in ['Microsoft Access', 'Microsoft
    Excel', 'Microsoft OneNote', 'Microsoft Outlook', 'Microsoft PowerPoint', 'Microsoft
    Publisher', 'Microsoft Word', 'Sent to OneNote Tool']) and not (grep('\\EXCEL.exe',
    this['FolderPath']) or grep('\\excelcnv.exe', this['FolderPath']) or grep('\\MSACCESS.exe',
    this['FolderPath']) or grep('\\MSPUB.EXE', this['FolderPath']) or grep('\\ONENOTE.EXE',
    this['FolderPath']) or grep('\\ONENOTEM.EXE', this['FolderPath']) or grep('\\OUTLOOK.EXE',
    this['FolderPath']) or grep('\\POWERPNT.EXE', this['FolderPath']) or grep('\\WINWORD.exe',
    this['FolderPath']))
  sigma_id: 0b0cd537-fc77-4e6e-a973-e53495c1083d
- name: Renamed PAExec Execution
  query: (grep('PAExec Application', this['ProcessVersionInfoFileDescription']) or
    grep('PAExec.exe', this['ProcessVersionInfoOriginalFileName']) or grep('PAExec',
    this['ProcessVersionInfoProductName']) or grep('IMPHASH=11D40A7B7876288F919AB819CC2D9802',
    this['Hashes']) or grep('IMPHASH=6444f8a34e99b8f7d9647de66aabe516', this['Hashes'])
    or grep('IMPHASH=dfd6aa3f7b2b1035b76b718f1ddc689f', this['Hashes']) or grep('IMPHASH=1a6cca4d5460b1710a12dea39e4a592c',
    this['Hashes'])) and not (grep('\\paexec.exe', this['FolderPath']) or grep('C:\\Windows\\PAExec-',
    this['FolderPath']))
  sigma_id: c4e49831-1496-40cf-8ce1-b53f942b02f9
- name: Renamed PingCastle Binary Execution
  query: (this['ProcessVersionInfoOriginalFileName'] in ['PingCastleReporting.exe',
    'PingCastleCloud.exe', 'PingCastle.exe'] or grep('--scanner aclcheck', this['ProcessCommandLine'])
    or grep('--scanner antivirus', this['ProcessCommandLine']) or grep('--scanner
    computerversion', this['ProcessCommandLine']) or grep('--scanner foreignusers',
    this['ProcessCommandLine']) or grep('--scanner laps_bitlocker', this['ProcessCommandLine'])
    or grep('--scanner localadmin', this['ProcessCommandLine']) or grep('--scanner
    nullsession', this['ProcessCommandLine']) or grep('--scanner nullsession-trust',
    this['ProcessCommandLine']) or grep('--scanner oxidbindings', this['ProcessCommandLine'])
    or grep('--scanner remote', this['ProcessCommandLine']) or grep('--scanner share',
    this['ProcessCommandLine']) or grep('--scanner smb', this['ProcessCommandLine'])
    or grep('--scanner smb3querynetwork', this['ProcessCommandLine']) or grep('--scanner
    spooler', this['ProcessCommandLine']) or grep('--scanner startup', this['ProcessCommandLine'])
    or grep('--scanner zerologon', this['ProcessCommandLine']) or grep('--no-enum-limit',
    this['ProcessCommandLine']) or grep('--healthcheck', this['ProcessCommandLine'])
    and grep('--level Full', this['ProcessCommandLine']) or grep('--healthcheck',
    this['ProcessCommandLine']) and grep('--server ', this['ProcessCommandLine']))
    and not (grep('\\PingCastleReporting.exe', this['FolderPath']) or grep('\\PingCastleCloud.exe',
    this['FolderPath']) or grep('\\PingCastle.exe', this['FolderPath']))
  sigma_id: 2433a154-bb3d-42e4-86c3-a26bdac91c45
- name: Renamed Plink Execution
  query: (grep('Plink', this['ProcessVersionInfoOriginalFileName']) or grep(' -l forward',
    this['ProcessCommandLine']) and grep(' -P ', this['ProcessCommandLine']) and grep('
    -R ', this['ProcessCommandLine'])) and not grep('\\plink.exe', this['FolderPath'])
  sigma_id: 1c12727d-02bf-45ff-a9f3-d49806a3cf43
- name: Visual Studio NodejsTools PressAnyKey Renamed Execution
  query: grep('Microsoft.NodejsTools.PressAnyKey.exe', this['ProcessVersionInfoOriginalFileName'])
    and not grep('\\Microsoft.NodejsTools.PressAnyKey.exe', this['FolderPath'])
  sigma_id: 65c3ca2c-525f-4ced-968e-246a713d164f
- name: Potential Renamed Rundll32 Execution
  query: grep('DllRegisterServer', this['ProcessCommandLine']) and not grep('\\rundll32.exe',
    this['FolderPath'])
  sigma_id: 2569ed8c-1147-498a-9b8c-2ad3656b10ed
- name: Renamed Remote Utilities RAT (RURAT) Execution
  query: grep('Remote Utilities', this['ProcessVersionInfoProductName']) and not (grep('\\rutserv.exe',
    this['FolderPath']) or grep('\\rfusclient.exe', this['FolderPath']))
  sigma_id: 9ef27c24-4903-4192-881a-3adde7ff92a5
- name: Renamed SysInternals DebugView Execution
  query: grep('Sysinternals DebugView', this['ProcessVersionInfoProductName']) and
    not (grep('Dbgview.exe', this['ProcessVersionInfoOriginalFileName']) and grep('\\Dbgview.exe',
    this['FolderPath']))
  sigma_id: cd764533-2e07-40d6-a718-cfeec7f2da7f
- name: Renamed ProcDump Execution
  query: "(grep('procdump', this['ProcessVersionInfoOriginalFileName']) or (grep('\
    \ -ma ', this['ProcessCommandLine']) or grep(' /ma ', this['ProcessCommandLine'])\
    \ or grep(' \u2013ma ', this['ProcessCommandLine']) or grep(' \u2014ma ', this['ProcessCommandLine'])\
    \ or grep(' \u2015ma ', this['ProcessCommandLine']) or grep(' -mp ', this['ProcessCommandLine'])\
    \ or grep(' /mp ', this['ProcessCommandLine']) or grep(' \u2013mp ', this['ProcessCommandLine'])\
    \ or grep(' \u2014mp ', this['ProcessCommandLine']) or grep(' \u2015mp ', this['ProcessCommandLine']))\
    \ and (grep(' -accepteula', this['ProcessCommandLine']) or grep(' /accepteula',\
    \ this['ProcessCommandLine']) or grep(' \u2013accepteula', this['ProcessCommandLine'])\
    \ or grep(' \u2014accepteula', this['ProcessCommandLine']) or grep(' \u2015accepteula',\
    \ this['ProcessCommandLine']))) and not (grep('\\\\procdump.exe', this['FolderPath'])\
    \ or grep('\\\\procdump64.exe', this['FolderPath']))"
  sigma_id: 4a0b2c7e-7cb2-495d-8b63-5f268e7bfd67
- name: Renamed PsExec Service Execution
  query: grep('psexesvc.exe', this['ProcessVersionInfoOriginalFileName']) and not
    grep('C:\\Windows\\PSEXESVC.exe', this['FolderPath'])
  sigma_id: 51ae86a2-e2e1-4097-ad85-c46cb6851de4
- name: Renamed Sysinternals Sdelete Execution
  query: grep('sdelete.exe', this['ProcessVersionInfoOriginalFileName']) and not (grep('\\sdelete.exe',
    this['FolderPath']) or grep('\\sdelete64.exe', this['FolderPath']))
  sigma_id: c1d867fe-8d95-4487-aab4-e53f2d339f90
- name: Renamed Vmnat.exe Execution
  query: grep('vmnat.exe', this['ProcessVersionInfoOriginalFileName']) and not grep('vmnat.exe',
    this['FolderPath'])
  sigma_id: 7b4f794b-590a-4ad4-ba18-7964a2832205
- name: Renamed Whoami Execution
  query: grep('whoami.exe', this['ProcessVersionInfoOriginalFileName']) and not grep('\\whoami.exe',
    this['FolderPath'])
  sigma_id: f1086bf7-a0c4-4a37-9102-01e573caf4a0
- name: Capture Credentials with Rpcping.exe
  query: "grep('\\\\rpcping.exe', this['FolderPath']) and (grep('-s', this['ProcessCommandLine'])\
    \ or grep('/s', this['ProcessCommandLine']) or grep('\u2013s', this['ProcessCommandLine'])\
    \ or grep('\u2014s', this['ProcessCommandLine']) or grep('\u2015s', this['ProcessCommandLine']))\
    \ and ((grep('-u', this['ProcessCommandLine']) or grep('/u', this['ProcessCommandLine'])\
    \ or grep('\u2013u', this['ProcessCommandLine']) or grep('\u2014u', this['ProcessCommandLine'])\
    \ or grep('\u2015u', this['ProcessCommandLine'])) and (grep('NTLM', this['ProcessCommandLine']))\
    \ or (grep('-t', this['ProcessCommandLine']) or grep('/t', this['ProcessCommandLine'])\
    \ or grep('\u2013t', this['ProcessCommandLine']) or grep('\u2014t', this['ProcessCommandLine'])\
    \ or grep('\u2015t', this['ProcessCommandLine'])) and (grep('ncacn_np', this['ProcessCommandLine'])))"
  sigma_id: 93671f99-04eb-4ab4-a161-70d446a84003
- name: Ruby Inline Command Execution
  query: (grep('\\ruby.exe', this['FolderPath']) or grep('ruby.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' -e', this['ProcessCommandLine'])
  sigma_id: 20a5ffa1-3848-4584-b6f8-c7c7fd9f69c8
- name: Suspicious Advpack Call Via Rundll32.EXE
  query: (grep('\\rundll32.exe', this['FolderPath']) or grep('RUNDLL32.EXE', this['ProcessVersionInfoOriginalFileName'])
    or grep('rundll32', this['ProcessCommandLine'])) and grep('advpack', this['ProcessCommandLine'])
    and (grep('#+', this['ProcessCommandLine']) and grep('12', this['ProcessCommandLine'])
    or grep('#-', this['ProcessCommandLine']))
  sigma_id: a1473adb-5338-4a20-b4c3-126763e2d3d3
- name: Suspicious Rundll32 Invoking Inline VBScript
  query: grep('rundll32.exe', this['ProcessCommandLine']) and grep('Execute', this['ProcessCommandLine'])
    and grep('RegRead', this['ProcessCommandLine']) and grep('window.close', this['ProcessCommandLine'])
  sigma_id: 1cc50f3f-1fc8-4acf-b2e9-6f172e1fdebd
- name: Rundll32 InstallScreenSaver Execution
  query: (grep('\\rundll32.exe', this['FolderPath']) or grep('RUNDLL32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('InstallScreenSaver', this['ProcessCommandLine'])
  sigma_id: 15bd98ea-55f4-4d37-b09a-e7caa0fa2221
- name: Suspicious Key Manager Access
  query: (grep('\\rundll32.exe', this['FolderPath']) or grep('RUNDLL32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('keymgr', this['ProcessCommandLine']) and grep('KRShowKeyMgr', this['ProcessCommandLine'])
  sigma_id: a4694263-59a8-4608-a3a0-6f8d3a51664c
- name: Mshtml.DLL RunHTMLApplication Suspicious Usage
  query: grep('\\..\\', this['ProcessCommandLine']) and grep('mshtml', this['ProcessCommandLine'])
    and (grep('#135', this['ProcessCommandLine']) or grep('RunHTMLApplication', this['ProcessCommandLine']))
  sigma_id: 4782eb5a-a513-4523-a0ac-f3082b26ac5c
- name: Rundll32 Execution Without CommandLine Parameters
  query: (grep('\\rundll32.exe', this['ProcessCommandLine']) or grep('\\rundll32.exe"',
    this['ProcessCommandLine']) or grep('\\rundll32', this['ProcessCommandLine']))
    and not (grep('\\AppData\\Local\\', this['InitiatingProcessFolderPath']) or grep('\\Microsoft\\Edge\\',
    this['InitiatingProcessFolderPath']))
  sigma_id: 1775e15e-b61b-4d14-a1a3-80981298085a
- name: Suspicious NTLM Authentication on the Printer Spooler Service
  query: (grep('\\rundll32.exe', this['FolderPath']) or grep('RUNDLL32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('C:\\windows\\system32\\davclnt.dll,DavSetCookie', this['ProcessCommandLine'])
    and grep('http', this['ProcessCommandLine']) and (grep('spoolss', this['ProcessCommandLine'])
    or grep('srvsvc', this['ProcessCommandLine']) or grep('/print/pipe/', this['ProcessCommandLine']))
  sigma_id: bb76d96b-821c-47cf-944b-7ce377864492
- name: Potential Obfuscated Ordinal Call Via Rundll32
  query: (grep('\\rundll32.exe', this['FolderPath']) or grep('RUNDLL32.EXE', this['ProcessVersionInfoOriginalFileName'])
    or grep('rundll32', this['ProcessCommandLine'])) and (grep('#+', this['ProcessCommandLine'])
    or grep('#-', this['ProcessCommandLine']))
  sigma_id: 43fa5350-db63-4b8f-9a01-789a427074e1
- name: Rundll32 Spawned Via Explorer.EXE
  query: grep('\\explorer.exe', this['InitiatingProcessFolderPath']) and (grep('\\rundll32.exe',
    this['FolderPath']) or grep('RUNDLL32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and not (grep(' C:\\Windows\\System32\\', this['ProcessCommandLine']) or grep('
    -localserver 22d8c27b-47a1-48d1-ad08-7da7abd79617', this['ProcessCommandLine']))
  sigma_id: 1723e720-616d-4ddc-ab02-f7e3685a4713
- name: Process Memory Dump Via Comsvcs.DLL
  query: '(grep(''\\rundll32.exe'', this[''FolderPath'']) or grep(''RUNDLL32.EXE'',
    this[''ProcessVersionInfoOriginalFileName'']) or grep(''rundll32'', this[''ProcessCommandLine'']))
    and grep(''comsvcs'', this[''ProcessCommandLine'']) and grep(''full'', this[''ProcessCommandLine''])
    and (grep(''#-'', this[''ProcessCommandLine'']) or grep(''#+'', this[''ProcessCommandLine''])
    or grep(''#24'', this[''ProcessCommandLine'']) or grep(''24 '', this[''ProcessCommandLine''])
    or grep(''MiniDump'', this[''ProcessCommandLine''])) or grep(''24'', this[''ProcessCommandLine''])
    and grep(''comsvcs'', this[''ProcessCommandLine'']) and grep(''full'', this[''ProcessCommandLine''])
    and (grep('' #'', this[''ProcessCommandLine'']) or grep('',#'', this[''ProcessCommandLine''])
    or grep('', #'', this[''ProcessCommandLine'']))'
  sigma_id: 646ea171-dded-4578-8a4d-65e9822892e3
- name: Rundll32 Registered COM Objects
  query: (grep('\\rundll32.exe', this['FolderPath']) or grep('RUNDLL32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and (grep('-sta ', this['ProcessCommandLine']) or grep('-localserver ', this['ProcessCommandLine']))
    and grep('{', this['ProcessCommandLine']) and grep('}', this['ProcessCommandLine'])
  sigma_id: f1edd233-30b5-4823-9e6a-c4171b24d316
- name: Suspicious Process Start Locations
  query: grep(':\\RECYCLER\\', this['FolderPath']) or grep(':\\SystemVolumeInformation\\',
    this['FolderPath']) or grep('C:\\Windows\\Tasks\\', this['FolderPath']) or grep('C:\\Windows\\debug\\',
    this['FolderPath']) or grep('C:\\Windows\\fonts\\', this['FolderPath']) or grep('C:\\Windows\\help\\',
    this['FolderPath']) or grep('C:\\Windows\\drivers\\', this['FolderPath']) or grep('C:\\Windows\\addins\\',
    this['FolderPath']) or grep('C:\\Windows\\cursors\\', this['FolderPath']) or grep('C:\\Windows\\system32\\tasks\\',
    this['FolderPath'])
  sigma_id: 15b75071-74cc-47e0-b4c6-b43744a62a2b
- name: Suspicious Rundll32 Setupapi.dll Activity
  query: grep('\\runonce.exe', this['FolderPath']) and grep('\\rundll32.exe', this['InitiatingProcessFolderPath'])
    and grep('setupapi.dll', this['InitiatingProcessCommandLine']) and grep('InstallHinfSection',
    this['InitiatingProcessCommandLine'])
  sigma_id: 285b85b1-a555-4095-8652-a8a4106af63f
- name: Shell32 DLL Execution in Suspicious Directory
  query: (grep('\\rundll32.exe', this['FolderPath']) or grep('RUNDLL32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('shell32.dll', this['ProcessCommandLine']) and grep('Control_RunDLL',
    this['ProcessCommandLine']) and (grep('%AppData%', this['ProcessCommandLine'])
    or grep('%LocalAppData%', this['ProcessCommandLine']) or grep('%Temp%', this['ProcessCommandLine'])
    or grep('%tmp%', this['ProcessCommandLine']) or grep('\\AppData\\', this['ProcessCommandLine'])
    or grep('\\Temp\\', this['ProcessCommandLine']) or grep('\\Users\\Public\\', this['ProcessCommandLine']))
  sigma_id: 32b96012-7892-429e-b26c-ac2bf46066ff
- name: Potential ShellDispatch.DLL Functionality Abuse
  query: (grep('\\rundll32.exe', this['FolderPath']) or grep('RUNDLL32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('RunDll_ShellExecuteW', this['ProcessCommandLine'])
  sigma_id: 82343930-652f-43f5-ab70-2ee9fdd6d5e9
- name: RunDLL32 Spawning Explorer
  query: grep('\\rundll32.exe', this['InitiatingProcessFolderPath']) and grep('\\explorer.exe',
    this['FolderPath']) and not grep('\\shell32.dll,Control_RunDLL', this['InitiatingProcessCommandLine'])
  sigma_id: caa06de8-fdef-4c91-826a-7f9e163eef4b
- name: Potentially Suspicious Rundll32 Activity
  query: (grep('javascript:', this['ProcessCommandLine']) and grep('.RegisterXLL',
    this['ProcessCommandLine']) or grep('url.dll', this['ProcessCommandLine']) and
    grep('OpenURL', this['ProcessCommandLine']) or grep('url.dll', this['ProcessCommandLine'])
    and grep('OpenURLA', this['ProcessCommandLine']) or grep('url.dll', this['ProcessCommandLine'])
    and grep('FileProtocolHandler', this['ProcessCommandLine']) or grep('zipfldr.dll',
    this['ProcessCommandLine']) and grep('RouteTheCall', this['ProcessCommandLine'])
    or grep('shell32.dll', this['ProcessCommandLine']) and grep('Control_RunDLL',
    this['ProcessCommandLine']) or grep('shell32.dll', this['ProcessCommandLine'])
    and grep('ShellExec_RunDLL', this['ProcessCommandLine']) or grep('mshtml.dll',
    this['ProcessCommandLine']) and grep('PrintHTML', this['ProcessCommandLine'])
    or grep('advpack.dll', this['ProcessCommandLine']) and grep('LaunchINFSection',
    this['ProcessCommandLine']) or grep('advpack.dll', this['ProcessCommandLine'])
    and grep('RegisterOCX', this['ProcessCommandLine']) or grep('ieadvpack.dll', this['ProcessCommandLine'])
    and grep('LaunchINFSection', this['ProcessCommandLine']) or grep('ieadvpack.dll',
    this['ProcessCommandLine']) and grep('RegisterOCX', this['ProcessCommandLine'])
    or grep('ieframe.dll', this['ProcessCommandLine']) and grep('OpenURL', this['ProcessCommandLine'])
    or grep('shdocvw.dll', this['ProcessCommandLine']) and grep('OpenURL', this['ProcessCommandLine'])
    or grep('syssetup.dll', this['ProcessCommandLine']) and grep('SetupInfObjectInstallAction',
    this['ProcessCommandLine']) or grep('setupapi.dll', this['ProcessCommandLine'])
    and grep('InstallHinfSection', this['ProcessCommandLine']) or grep('pcwutl.dll',
    this['ProcessCommandLine']) and grep('LaunchApplication', this['ProcessCommandLine'])
    or grep('dfshim.dll', this['ProcessCommandLine']) and grep('ShOpenVerbApplication',
    this['ProcessCommandLine']) or grep('dfshim.dll', this['ProcessCommandLine'])
    and grep('ShOpenVerbShortcut', this['ProcessCommandLine']) or grep('scrobj.dll',
    this['ProcessCommandLine']) and grep('GenerateTypeLib', this['ProcessCommandLine'])
    and grep('http', this['ProcessCommandLine']) or grep('shimgvw.dll', this['ProcessCommandLine'])
    and grep('ImageView_Fullscreen', this['ProcessCommandLine']) and grep('http',
    this['ProcessCommandLine']) or grep('comsvcs.dll', this['ProcessCommandLine'])
    and grep('MiniDump', this['ProcessCommandLine'])) and not (grep('shell32.dll,Control_RunDLL
    desk.cpl,screensaver,@screensaver', this['ProcessCommandLine']) or grep('C:\\Windows\\System32\\control.exe',
    this['InitiatingProcessFolderPath']) and grep('.cpl', this['InitiatingProcessCommandLine'])
    and grep('Shell32.dll', this['ProcessCommandLine']) and grep('Control_RunDLL',
    this['ProcessCommandLine']) and grep('.cpl', this['ProcessCommandLine']) or grep('C:\\Windows\\System32\\control.exe',
    this['InitiatingProcessFolderPath']) and grep('"C:\\Windows\\system32\\rundll32.exe"
    Shell32.dll,Control_RunDLL "C:\\Windows\\System32\\', this['ProcessCommandLine'])
    and grep('.cpl",', this['ProcessCommandLine']))
  sigma_id: e593cf51-88db-4ee1-b920-37e89012a3c9
- name: Suspicious Control Panel DLL Load
  query: grep('\\System32\\control.exe', this['InitiatingProcessFolderPath']) and
    (grep('\\rundll32.exe', this['FolderPath']) or grep('RUNDLL32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and not grep('Shell32.dll', this['ProcessCommandLine'])
  sigma_id: d7eb979b-c2b5-4a6f-a3a7-c87ce6763819
- name: Suspicious Rundll32 Execution With Image Extension
  query: (grep('\\rundll32.exe', this['FolderPath']) or grep('RUNDLL32.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('.bmp', this['ProcessCommandLine']) or grep('.cr2', this['ProcessCommandLine'])
    or grep('.eps', this['ProcessCommandLine']) or grep('.gif', this['ProcessCommandLine'])
    or grep('.ico', this['ProcessCommandLine']) or grep('.jpeg', this['ProcessCommandLine'])
    or grep('.jpg', this['ProcessCommandLine']) or grep('.nef', this['ProcessCommandLine'])
    or grep('.orf', this['ProcessCommandLine']) or grep('.png', this['ProcessCommandLine'])
    or grep('.raw', this['ProcessCommandLine']) or grep('.sr2', this['ProcessCommandLine'])
    or grep('.tif', this['ProcessCommandLine']) or grep('.tiff', this['ProcessCommandLine']))
  sigma_id: 4aa6040b-3f28-44e3-a769-9208e5feb5ec
- name: Suspicious Usage Of ShellExec_RunDLL
  query: grep('ShellExec_RunDLL', this['ProcessCommandLine']) and (grep('\\Desktop\\',
    this['ProcessCommandLine']) or grep('\\Temp\\', this['ProcessCommandLine']) or
    grep('\\Users\\Public\\', this['ProcessCommandLine']) or grep('comspec', this['ProcessCommandLine'])
    or grep('iex', this['ProcessCommandLine']) or grep('Invoke-', this['ProcessCommandLine'])
    or grep('msiexec', this['ProcessCommandLine']) or grep('odbcconf', this['ProcessCommandLine'])
    or grep('regsvr32', this['ProcessCommandLine']))
  sigma_id: d87bd452-6da1-456e-8155-7dc988157b7d
- name: Suspicious ShellExec_RunDLL Call Via Ordinal
  query: grep('SHELL32.DLL', this['InitiatingProcessCommandLine']) and (grep('#568',
    this['InitiatingProcessCommandLine']) or grep('#570', this['InitiatingProcessCommandLine'])
    or grep('#572', this['InitiatingProcessCommandLine']) or grep('#576', this['InitiatingProcessCommandLine']))
    and (grep('comspec', this['InitiatingProcessCommandLine']) or grep('iex', this['InitiatingProcessCommandLine'])
    or grep('Invoke-', this['InitiatingProcessCommandLine']) or grep('msiexec', this['InitiatingProcessCommandLine'])
    or grep('odbcconf', this['InitiatingProcessCommandLine']) or grep('regsvr32',
    this['InitiatingProcessCommandLine']) or grep('\\Desktop\\', this['InitiatingProcessCommandLine'])
    or grep('\\ProgramData\\', this['InitiatingProcessCommandLine']) or grep('\\Temp\\',
    this['InitiatingProcessCommandLine']) or grep('\\Users\\Public\\', this['InitiatingProcessCommandLine'])
    or grep('\\bash.exe', this['FolderPath']) or grep('\\bitsadmin.exe', this['FolderPath'])
    or grep('\\cmd.exe', this['FolderPath']) or grep('\\cscript.exe', this['FolderPath'])
    or grep('\\curl.exe', this['FolderPath']) or grep('\\mshta.exe', this['FolderPath'])
    or grep('\\msiexec.exe', this['FolderPath']) or grep('\\msxsl.exe', this['FolderPath'])
    or grep('\\odbcconf.exe', this['FolderPath']) or grep('\\powershell.exe', this['FolderPath'])
    or grep('\\pwsh.exe', this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath'])
    or grep('\\schtasks.exe', this['FolderPath']) or grep('\\wmic.exe', this['FolderPath'])
    or grep('\\wscript.exe', this['FolderPath']))
  sigma_id: 8823e85d-31d8-473e-b7f4-92da070f0fc6
- name: ShimCache Flush
  query: grep('rundll32', this['ProcessCommandLine']) and grep('apphelp.dll', this['ProcessCommandLine'])
    and (grep('ShimFlushCache', this['ProcessCommandLine']) or grep('#250', this['ProcessCommandLine']))
    or grep('rundll32', this['ProcessCommandLine']) and grep('kernel32.dll', this['ProcessCommandLine'])
    and (grep('BaseFlushAppcompatCache', this['ProcessCommandLine']) or grep('#46',
    this['ProcessCommandLine']))
  sigma_id: b0524451-19af-4efa-a46f-562a977f792e
- name: Suspicious Rundll32 Activity Invoking Sys File
  query: grep('rundll32.exe', this['ProcessCommandLine']) and (grep('.sys,', this['ProcessCommandLine'])
    or grep('.sys ', this['ProcessCommandLine']))
  sigma_id: 731231b9-0b5d-4219-94dd-abb6959aa7ea
- name: Potentially Suspicious Rundll32.EXE Execution of UDL File
  query: grep('\\explorer.exe', this['InitiatingProcessFolderPath']) and (grep('\\rundll32.exe',
    this['FolderPath']) or grep('RUNDLL32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('oledb32.dll', this['ProcessCommandLine']) and grep(',OpenDSLFile ',
    this['ProcessCommandLine']) and (grep('\\Users\\', this['ProcessCommandLine'])
    or grep('\\Downloads\\', this['ProcessCommandLine'])) and grep('.udl', this['ProcessCommandLine'])
  sigma_id: 0ea52357-cd59-4340-9981-c46c7e900428
- name: Rundll32 UNC Path Execution
  query: (grep('\\rundll32.exe', this['FolderPath']) or grep('RUNDLL32.EXE', this['ProcessVersionInfoOriginalFileName'])
    or grep('rundll32', this['ProcessCommandLine'])) and grep(' \\', this['ProcessCommandLine'])
  sigma_id: 5cdb711b-5740-4fb2-ba88-f7945027afac
- name: Rundll32 Execution With Uncommon DLL Extension
  query: (grep('\\rundll32.exe', this['FolderPath']) or grep('RUNDLL32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and not (this['ProcessCommandLine']==null or false or grep('.cpl ', this['ProcessCommandLine'])
    or grep('.cpl,', this['ProcessCommandLine']) or grep('.cpl"', this['ProcessCommandLine'])
    or grep('.cpl\'', this['ProcessCommandLine']) or grep('.dll ', this['ProcessCommandLine'])
    or grep('.dll,', this['ProcessCommandLine']) or grep('.dll"', this['ProcessCommandLine'])
    or grep('.dll\'', this['ProcessCommandLine']) or grep('.inf ', this['ProcessCommandLine'])
    or grep('.inf,', this['ProcessCommandLine']) or grep('.inf"', this['ProcessCommandLine'])
    or grep('.inf\'', this['ProcessCommandLine']) or grep('.cpl', this['ProcessCommandLine'])
    or grep('.dll', this['ProcessCommandLine']) or grep('.inf', this['ProcessCommandLine'])
    or grep(' -localserver ', this['ProcessCommandLine']) or grep('\\msiexec.exe',
    this['InitiatingProcessFolderPath']) and grep(':\\Windows\\Installer\\', this['ProcessCommandLine'])
    and grep('.tmp', this['ProcessCommandLine']) and grep('zzzzInvokeManagedCustomActionOutOfProc',
    this['ProcessCommandLine'])) and not (grep(':\\Users\\', this['InitiatingProcessCommandLine'])
    and grep('\\AppData\\Local\\Microsoft\\EdgeUpdate\\Install\\{', this['InitiatingProcessCommandLine'])
    and grep('\\EDGEMITMP_', this['InitiatingProcessCommandLine']) and grep('.tmp\\setup.exe',
    this['InitiatingProcessCommandLine']) and grep('--install-archive=', this['InitiatingProcessCommandLine'])
    and grep('--previous-version=', this['InitiatingProcessCommandLine']) and grep('--msedgewebview
    --verbose-logging --do-not-launch-msedge --user-level', this['InitiatingProcessCommandLine']))
  sigma_id: c3a99af4-35a9-4668-879e-c09aeb4f2bdf
- name: Suspicious Workstation Locking via Rundll32
  query: (grep('\\rundll32.exe', this['FolderPath']) or grep('RUNDLL32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('\\cmd.exe', this['InitiatingProcessFolderPath']) and grep('user32.dll,',
    this['ProcessCommandLine']) and grep('LockWorkStation', this['ProcessCommandLine'])
  sigma_id: 3b5b0213-0460-4e3f-8937-3abf98ff7dcc
- name: WebDav Client Execution Via Rundll32.EXE
  query: grep('\\svchost.exe', this['InitiatingProcessFolderPath']) and (grep('\\rundll32.exe',
    this['FolderPath']) or grep('RUNDLL32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('C:\\windows\\system32\\davclnt.dll,DavSetCookie', this['ProcessCommandLine'])
  sigma_id: 2dbd9d3d-9e27-42a8-b8df-f13825c6c3d5
- name: Rundll32 Execution Without Parameters
  query: this['ProcessCommandLine'] in ['rundll32.exe', 'rundll32']
  sigma_id: 5bb68627-3198-40ca-b458-49f973db8752
- name: Possible Privilege Escalation via Weak Service Permissions
  query: grep('\\sc.exe', this['FolderPath']) and (this['ProcessIntegrityLevel'] in
    ['Medium', 'S-1-16-8192']) and (grep('config', this['ProcessCommandLine']) and
    grep('binPath', this['ProcessCommandLine']) or grep('failure', this['ProcessCommandLine'])
    and grep('command', this['ProcessCommandLine']))
  sigma_id: d937b75f-a665-4480-88a5-2f20e9f9b22a
- name: Service StartupType Change Via Sc.EXE
  query: (grep('\\sc.exe', this['FolderPath']) or grep('sc.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' config ', this['ProcessCommandLine']) and grep('start', this['ProcessCommandLine'])
    and (grep('disabled', this['ProcessCommandLine']) or grep('demand', this['ProcessCommandLine']))
  sigma_id: 85c312b7-f44d-4a51-a024-d671c40b49fc
- name: New Kernel Driver Via SC.EXE
  query: grep('\\sc.exe', this['FolderPath']) and (grep('create', this['ProcessCommandLine'])
    or grep('config', this['ProcessCommandLine'])) and grep('binPath', this['ProcessCommandLine'])
    and grep('type', this['ProcessCommandLine']) and grep('kernel', this['ProcessCommandLine'])
  sigma_id: 431a1fdb-4799-4f3b-91c3-a683b003fc49
- name: Allow Service Access Using Security Descriptor Tampering Via Sc.EXE
  query: (grep('\\sc.exe', this['FolderPath']) or grep('sc.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('sdset', this['ProcessCommandLine']) and grep('A;', this['ProcessCommandLine'])
    and (grep(';IU', this['ProcessCommandLine']) or grep(';SU', this['ProcessCommandLine'])
    or grep(';BA', this['ProcessCommandLine']) or grep(';SY', this['ProcessCommandLine'])
    or grep(';WD', this['ProcessCommandLine']))
  sigma_id: 6c8fbee5-dee8-49bc-851d-c3142d02aa47
- name: Deny Service Access Using Security Descriptor Tampering Via Sc.EXE
  query: (grep('\\sc.exe', this['FolderPath']) or grep('sc.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('sdset', this['ProcessCommandLine']) and grep('D;', this['ProcessCommandLine'])
    and (grep(';IU', this['ProcessCommandLine']) or grep(';SU', this['ProcessCommandLine'])
    or grep(';BA', this['ProcessCommandLine']) or grep(';SY', this['ProcessCommandLine'])
    or grep(';WD', this['ProcessCommandLine']))
  sigma_id: 99cf1e02-00fb-4c0d-8375-563f978dfd37
- name: Service DACL Abuse To Hide Services Via Sc.EXE
  query: (grep('\\sc.exe', this['FolderPath']) or grep('sc.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('sdset', this['ProcessCommandLine']) and grep('DCLCWPDTSD', this['ProcessCommandLine'])
  sigma_id: a537cfc3-4297-4789-92b5-345bfd845ad0
- name: Service Security Descriptor Tampering Via Sc.EXE
  query: (grep('\\sc.exe', this['FolderPath']) or grep('sc.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('sdset', this['ProcessCommandLine'])
  sigma_id: 98c5aeef-32d5-492f-b174-64a691896d25
- name: Suspicious Service Path Modification
  query: grep('\\sc.exe', this['FolderPath']) and grep('config', this['ProcessCommandLine'])
    and grep('binPath', this['ProcessCommandLine']) and (grep('powershell', this['ProcessCommandLine'])
    or grep('cmd ', this['ProcessCommandLine']) or grep('mshta', this['ProcessCommandLine'])
    or grep('wscript', this['ProcessCommandLine']) or grep('cscript', this['ProcessCommandLine'])
    or grep('rundll32', this['ProcessCommandLine']) or grep('svchost', this['ProcessCommandLine'])
    or grep('dllhost', this['ProcessCommandLine']) or grep('cmd.exe /c', this['ProcessCommandLine'])
    or grep('cmd.exe /k', this['ProcessCommandLine']) or grep('cmd.exe /r', this['ProcessCommandLine'])
    or grep('cmd /c', this['ProcessCommandLine']) or grep('cmd /k', this['ProcessCommandLine'])
    or grep('cmd /r', this['ProcessCommandLine']) or grep('C:\\Users\\Public', this['ProcessCommandLine'])
    or grep('\\Downloads\\', this['ProcessCommandLine']) or grep('\\Desktop\\', this['ProcessCommandLine'])
    or grep('\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\', this['ProcessCommandLine'])
    or grep('C:\\Windows\\TEMP\\', this['ProcessCommandLine']) or grep('\\AppData\\Local\\Temp',
    this['ProcessCommandLine']))
  sigma_id: 138d3531-8793-4f50-a2cd-f291b2863d78
- name: Potential Persistence Attempt Via Existing Service Tampering
  query: grep('sc ', this['ProcessCommandLine']) and grep('config ', this['ProcessCommandLine'])
    and grep('binpath=', this['ProcessCommandLine']) or grep('sc ', this['ProcessCommandLine'])
    and grep('failure', this['ProcessCommandLine']) and grep('command=', this['ProcessCommandLine'])
    or (grep('reg ', this['ProcessCommandLine']) and grep('add ', this['ProcessCommandLine'])
    and grep('FailureCommand', this['ProcessCommandLine']) or grep('reg ', this['ProcessCommandLine'])
    and grep('add ', this['ProcessCommandLine']) and grep('ImagePath', this['ProcessCommandLine']))
    and (grep('.sh', this['ProcessCommandLine']) or grep('.exe', this['ProcessCommandLine'])
    or grep('.dll', this['ProcessCommandLine']) or grep('.bin$', this['ProcessCommandLine'])
    or grep('.bat', this['ProcessCommandLine']) or grep('.cmd', this['ProcessCommandLine'])
    or grep('.js', this['ProcessCommandLine']) or grep('.msh$', this['ProcessCommandLine'])
    or grep('.reg$', this['ProcessCommandLine']) or grep('.scr', this['ProcessCommandLine'])
    or grep('.ps', this['ProcessCommandLine']) or grep('.vb', this['ProcessCommandLine'])
    or grep('.jar', this['ProcessCommandLine']) or grep('.pl', this['ProcessCommandLine']))
  sigma_id: 38879043-7e1e-47a9-8d46-6bec88e201df
- name: Suspicious Schtasks Execution AppData Folder
  query: grep('\\schtasks.exe', this['FolderPath']) and grep('/Create', this['ProcessCommandLine'])
    and grep('/RU', this['ProcessCommandLine']) and grep('/TR', this['ProcessCommandLine'])
    and grep('C:\\Users\\', this['ProcessCommandLine']) and grep('\\AppData\\Local\\',
    this['ProcessCommandLine']) and (grep('NT AUT', this['ProcessCommandLine']) or
    grep(' SYSTEM ', this['ProcessCommandLine'])) and not (grep('\\AppData\\Local\\Temp\\',
    this['InitiatingProcessFolderPath']) and grep('TeamViewer_.exe', this['InitiatingProcessFolderPath'])
    and grep('\\schtasks.exe', this['FolderPath']) and grep('/TN TVInstallRestore',
    this['ProcessCommandLine']))
  sigma_id: c5c00f49-b3f9-45a6-997e-cfdecc6e1967
- name: Suspicious Modification Of Scheduled Tasks
  query: grep('\\schtasks.exe', this['FolderPath']) and grep(' /Change ', this['ProcessCommandLine'])
    and grep(' /TN ', this['ProcessCommandLine']) and (grep('\\AppData\\Local\\Temp',
    this['ProcessCommandLine']) or grep('\\AppData\\Roaming\\', this['ProcessCommandLine'])
    or grep('\\Users\\Public\\', this['ProcessCommandLine']) or grep('\\WINDOWS\\Temp\\',
    this['ProcessCommandLine']) or grep('\\Desktop\\', this['ProcessCommandLine'])
    or grep('\\Downloads\\', this['ProcessCommandLine']) or grep('\\Temporary Internet',
    this['ProcessCommandLine']) or grep('C:\\ProgramData\\', this['ProcessCommandLine'])
    or grep('C:\\Perflogs\\', this['ProcessCommandLine']) or grep('%ProgramData%',
    this['ProcessCommandLine']) or grep('%appdata%', this['ProcessCommandLine']) or
    grep('%comspec%', this['ProcessCommandLine']) or grep('%localappdata%', this['ProcessCommandLine']))
    and (grep('regsvr32', this['ProcessCommandLine']) or grep('rundll32', this['ProcessCommandLine'])
    or grep('cmd /c ', this['ProcessCommandLine']) or grep('cmd /k ', this['ProcessCommandLine'])
    or grep('cmd /r ', this['ProcessCommandLine']) or grep('cmd.exe /c ', this['ProcessCommandLine'])
    or grep('cmd.exe /k ', this['ProcessCommandLine']) or grep('cmd.exe /r ', this['ProcessCommandLine'])
    or grep('powershell', this['ProcessCommandLine']) or grep('mshta', this['ProcessCommandLine'])
    or grep('wscript', this['ProcessCommandLine']) or grep('cscript', this['ProcessCommandLine'])
    or grep('certutil', this['ProcessCommandLine']) or grep('bitsadmin', this['ProcessCommandLine'])
    or grep('bash.exe', this['ProcessCommandLine']) or grep('bash ', this['ProcessCommandLine'])
    or grep('scrcons', this['ProcessCommandLine']) or grep('wmic ', this['ProcessCommandLine'])
    or grep('wmic.exe', this['ProcessCommandLine']) or grep('forfiles', this['ProcessCommandLine'])
    or grep('scriptrunner', this['ProcessCommandLine']) or grep('hh.exe', this['ProcessCommandLine'])
    or grep('hh ', this['ProcessCommandLine']))
  sigma_id: 1c0e41cd-21bb-4433-9acc-4a2cd6367b9b
- name: Suspicious Scheduled Task Creation Involving Temp Folder
  query: grep('\\schtasks.exe', this['FolderPath']) and grep(' /create ', this['ProcessCommandLine'])
    and grep(' /sc once ', this['ProcessCommandLine']) and grep('\\Temp\\', this['ProcessCommandLine'])
  sigma_id: 39019a4e-317f-4ce3-ae63-309a8c6b53c5
- name: Delete Important Scheduled Task
  query: grep('\\schtasks.exe', this['FolderPath']) and grep('/delete', this['ProcessCommandLine'])
    and grep('/tn', this['ProcessCommandLine']) and (grep('\\Windows\\BitLocker',
    this['ProcessCommandLine']) or grep('\\Windows\\ExploitGuard', this['ProcessCommandLine'])
    or grep('\\Windows\\SystemRestore\\SR', this['ProcessCommandLine']) or grep('\\Windows\\UpdateOrchestrator\\',
    this['ProcessCommandLine']) or grep('\\Windows\\Windows Defender\\', this['ProcessCommandLine'])
    or grep('\\Windows\\WindowsBackup\\', this['ProcessCommandLine']) or grep('\\Windows\\WindowsUpdate\\',
    this['ProcessCommandLine']))
  sigma_id: dbc1f800-0fe0-4bc0-9c66-292c2abe3f78
- name: Delete All Scheduled Tasks
  query: 'grep(''\\schtasks.exe'', this[''FolderPath'']) and grep('' /delete '', this[''ProcessCommandLine''])
    and grep(''(\''/tn \'', <SpecialChars.WILDCARD_MULTI: 1>)'', this[''ProcessCommandLine''])
    and grep('' /f'', this[''ProcessCommandLine''])'
  sigma_id: 220457c1-1c9f-4c2e-afe6-9598926222c1
- name: Disable Important Scheduled Task
  query: grep('\\schtasks.exe', this['FolderPath']) and grep('/Change', this['ProcessCommandLine'])
    and grep('/TN', this['ProcessCommandLine']) and grep('/disable', this['ProcessCommandLine'])
    and (grep('\\Windows\\BitLocker', this['ProcessCommandLine']) or grep('\\Windows\\ExploitGuard',
    this['ProcessCommandLine']) or grep('\\Windows\\ExploitGuard\\ExploitGuard MDM
    policy Refresh', this['ProcessCommandLine']) or grep('\\Windows\\SystemRestore\\SR',
    this['ProcessCommandLine']) or grep('\\Windows\\UpdateOrchestrator\\', this['ProcessCommandLine'])
    or grep('\\Windows\\Windows Defender\\', this['ProcessCommandLine']) or grep('\\Windows\\WindowsBackup\\',
    this['ProcessCommandLine']) or grep('\\Windows\\WindowsUpdate\\', this['ProcessCommandLine']))
  sigma_id: 9ac94dc8-9042-493c-ba45-3b5e7c86b980
- name: Schedule Task Creation From Env Variable Or Potentially Suspicious Path Via
    Schtasks.EXE
  query: (grep('\\schtasks.exe', this['FolderPath']) and grep(' /create ', this['ProcessCommandLine'])
    and (grep(':\\Perflogs', this['ProcessCommandLine']) or grep(':\\Users\\All Users\\',
    this['ProcessCommandLine']) or grep(':\\Users\\Default\\', this['ProcessCommandLine'])
    or grep(':\\Users\\Public', this['ProcessCommandLine']) or grep(':\\Windows\\Temp',
    this['ProcessCommandLine']) or grep('\\AppData\\Local\\', this['ProcessCommandLine'])
    or grep('\\AppData\\Roaming\\', this['ProcessCommandLine']) or grep('%AppData%',
    this['ProcessCommandLine']) or grep('%Public%', this['ProcessCommandLine'])) or
    grep('\\svchost.exe -k netsvcs -p -s Schedule', this['InitiatingProcessCommandLine'])
    and (grep(':\\Perflogs', this['ProcessCommandLine']) or grep(':\\Windows\\Temp',
    this['ProcessCommandLine']) or grep('\\Users\\Public', this['ProcessCommandLine'])
    or grep('%Public%', this['ProcessCommandLine']))) and not (grep('unattended.ini',
    this['InitiatingProcessCommandLine']) or grep('update_task.xml', this['ProcessCommandLine'])
    or grep('/Create /TN TVInstallRestore /TR', this['ProcessCommandLine']) or grep('/Create
    /Xml "C:\\Users\\', this['ProcessCommandLine']) and grep('\\AppData\\Local\\Temp\\.CR.',
    this['ProcessCommandLine']) and grep('Avira_Security_Installation.xml', this['ProcessCommandLine'])
    or grep('/Create /F /TN', this['ProcessCommandLine']) and grep('/Xml ', this['ProcessCommandLine'])
    and grep('\\AppData\\Local\\Temp\\is-', this['ProcessCommandLine']) and grep('Avira_',
    this['ProcessCommandLine']) and (grep('.tmp\\UpdateFallbackTask.xml', this['ProcessCommandLine'])
    or grep('.tmp\\WatchdogServiceControlManagerTimeout.xml', this['ProcessCommandLine'])
    or grep('.tmp\\SystrayAutostart.xml', this['ProcessCommandLine']) or grep('.tmp\\MaintenanceTask.xml',
    this['ProcessCommandLine'])) or grep('\\AppData\\Local\\Temp\\', this['ProcessCommandLine'])
    and grep('/Create /TN "klcp_update" /XML ', this['ProcessCommandLine']) and grep('\\klcp_update_task.xml',
    this['ProcessCommandLine']))
  sigma_id: 81325ce1-be01-4250-944f-b4789644556f
- name: Schtasks From Suspicious Folders
  query: (grep('\\schtasks.exe', this['FolderPath']) or grep('schtasks.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' /create ', this['ProcessCommandLine']) and (grep('powershell', this['ProcessCommandLine'])
    or grep('pwsh', this['ProcessCommandLine']) or grep('cmd /c ', this['ProcessCommandLine'])
    or grep('cmd /k ', this['ProcessCommandLine']) or grep('cmd /r ', this['ProcessCommandLine'])
    or grep('cmd.exe /c ', this['ProcessCommandLine']) or grep('cmd.exe /k ', this['ProcessCommandLine'])
    or grep('cmd.exe /r ', this['ProcessCommandLine'])) and (grep('C:\\ProgramData\\',
    this['ProcessCommandLine']) or grep('%ProgramData%', this['ProcessCommandLine']))
  sigma_id: 8a8379b8-780b-4dbf-b1e9-31c8d112fefb
- name: Suspicious Scheduled Task Name As GUID
  query: grep('\\schtasks.exe', this['FolderPath']) and grep('/Create ', this['ProcessCommandLine'])
    and (grep('/TN "{', this['ProcessCommandLine']) or grep('/TN \'{', this['ProcessCommandLine'])
    or grep('/TN {', this['ProcessCommandLine'])) and (grep('}"', this['ProcessCommandLine'])
    or grep('}\'', this['ProcessCommandLine']) or grep('} ', this['ProcessCommandLine']))
  sigma_id: ff2fff64-4cd6-4a2b-ba7d-e28a30bbe66b
- name: Uncommon One Time Only Scheduled Task At 00:00
  query: (grep('\\schtasks.exe', this['FolderPath']) or grep('schtasks.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('wscript', this['ProcessCommandLine']) or grep('vbscript', this['ProcessCommandLine'])
    or grep('cscript', this['ProcessCommandLine']) or grep('wmic ', this['ProcessCommandLine'])
    or grep('wmic.exe', this['ProcessCommandLine']) or grep('regsvr32.exe', this['ProcessCommandLine'])
    or grep('powershell', this['ProcessCommandLine']) or grep('\\AppData\\', this['ProcessCommandLine']))
    and grep('once', this['ProcessCommandLine']) and grep('00:00', this['ProcessCommandLine'])
  sigma_id: 970823b7-273b-460a-8afc-3a6811998529
- name: Potential Persistence Via Microsoft Compatibility Appraiser
  query: (grep('\\schtasks.exe', this['FolderPath']) or grep('schtasks.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('run ', this['ProcessCommandLine']) and grep('\\Application Experience\\Microsoft
    Compatibility Appraiser', this['ProcessCommandLine'])
  sigma_id: f548a603-c9f2-4c89-b511-b089f7e94549
- name: Potential Persistence Via Powershell Search Order Hijacking - Task
  query: grep('C:\\WINDOWS\\System32\\svchost.exe', this['InitiatingProcessFolderPath'])
    and grep('-k netsvcs', this['InitiatingProcessCommandLine']) and grep('-s Schedule',
    this['InitiatingProcessCommandLine']) and (grep(' -windowstyle hidden', this['ProcessCommandLine'])
    or grep(' -w hidden', this['ProcessCommandLine']) or grep(' -ep bypass', this['ProcessCommandLine'])
    or grep(' -noni', this['ProcessCommandLine']))
  sigma_id: b66474aa-bd92-4333-a16c-298155b120df
- name: Scheduled Task Executing Payload from Registry
  query: (grep('\\schtasks.exe', this['FolderPath']) or grep('schtasks.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('/Create', this['ProcessCommandLine']) and (grep('Get-ItemProperty',
    this['ProcessCommandLine']) or grep(' gp ', this['ProcessCommandLine'])) and (grep('HKCU:',
    this['ProcessCommandLine']) or grep('HKLM:', this['ProcessCommandLine']) or grep('registry::',
    this['ProcessCommandLine']) or grep('HKEY_', this['ProcessCommandLine'])) and
    not (grep('FromBase64String', this['ProcessCommandLine']) or grep('encodedcommand',
    this['ProcessCommandLine']))
  sigma_id: 86588b36-c6d3-465f-9cee-8f9093e07798
- name: Scheduled Task Executing Encoded Payload from Registry
  query: (grep('\\schtasks.exe', this['FolderPath']) or grep('schtasks.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('/Create', this['ProcessCommandLine']) and (grep('FromBase64String',
    this['ProcessCommandLine']) or grep('encodedcommand', this['ProcessCommandLine']))
    and (grep('Get-ItemProperty', this['ProcessCommandLine']) or grep(' gp ', this['ProcessCommandLine']))
    and (grep('HKCU:', this['ProcessCommandLine']) or grep('HKLM:', this['ProcessCommandLine'])
    or grep('registry::', this['ProcessCommandLine']) or grep('HKEY_', this['ProcessCommandLine']))
  sigma_id: c4eeeeae-89f4-43a7-8b48-8d1bdfa66c78
- name: Suspicious Schtasks Schedule Types
  query: (grep('\\schtasks.exe', this['FolderPath']) or grep('schtasks.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' ONLOGON ', this['ProcessCommandLine']) or grep(' ONSTART ', this['ProcessCommandLine'])
    or grep(' ONCE ', this['ProcessCommandLine']) or grep(' ONIDLE ', this['ProcessCommandLine']))
    and not (grep('NT AUT', this['ProcessCommandLine']) or grep(' SYSTEM', this['ProcessCommandLine'])
    or grep('HIGHEST', this['ProcessCommandLine']))
  sigma_id: 24c8392b-aa3c-46b7-a545-43f71657fe98
- name: Suspicious Schtasks Schedule Type With High Privileges
  query: (grep('\\schtasks.exe', this['FolderPath']) or grep('schtasks.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' ONLOGON ', this['ProcessCommandLine']) or grep(' ONSTART ', this['ProcessCommandLine'])
    or grep(' ONCE ', this['ProcessCommandLine']) or grep(' ONIDLE ', this['ProcessCommandLine']))
    and (grep('NT AUT', this['ProcessCommandLine']) or grep(' SYSTEM', this['ProcessCommandLine'])
    or grep('HIGHEST', this['ProcessCommandLine']))
  sigma_id: 7a02e22e-b885-4404-b38b-1ddc7e65258a
- name: Suspicious Scheduled Task Creation via Masqueraded XML File
  query: (grep('\\schtasks.exe', this['FolderPath']) or grep('schtasks.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('/create', this['ProcessCommandLine']) or grep('-create', this['ProcessCommandLine']))
    and (grep('/xml', this['ProcessCommandLine']) or grep('-xml', this['ProcessCommandLine']))
    and not (grep('.xml', this['ProcessCommandLine']) or this['ProcessIntegrityLevel']
    in ['System', 'S-1-16-16384'] or grep('\\rundll32.exe', this['InitiatingProcessFolderPath'])
    and grep(':\\WINDOWS\\Installer\\MSI', this['InitiatingProcessCommandLine']) and
    grep('.tmp,zzzzInvokeManagedCustomActionOutOfProc', this['InitiatingProcessCommandLine']))
    and not ((grep(':\\ProgramData\\OEM\\UpgradeTool\\CareCenter_', this['InitiatingProcessFolderPath'])
    or grep('\\BUnzip\\Setup_msi.exe', this['InitiatingProcessFolderPath'])) or grep(':\\Program
    Files\\Axis Communications\\AXIS Camera Station\\SetupActions.exe', this['InitiatingProcessFolderPath'])
    or grep(':\\Program Files\\Axis Communications\\AXIS Device Manager\\AdmSetupActions.exe',
    this['InitiatingProcessFolderPath']) or grep(':\\Program Files (x86)\\Zemana\\AntiMalware\\AntiMalware.exe',
    this['InitiatingProcessFolderPath']) or grep(':\\Program Files\\Dell\\SupportAssist\\pcdrcui.exe',
    this['InitiatingProcessFolderPath']))
  sigma_id: dd2a821e-3b07-4d3b-a9ac-929fe4c6ca0c
- name: Suspicious Command Patterns In Scheduled Task Creation
  query: grep('\\schtasks.exe', this['FolderPath']) and grep('/Create ', this['ProcessCommandLine'])
    and ((grep('/sc minute ', this['ProcessCommandLine']) or grep('/ru system ', this['ProcessCommandLine']))
    and (grep('cmd /c', this['ProcessCommandLine']) or grep('cmd /k', this['ProcessCommandLine'])
    or grep('cmd /r', this['ProcessCommandLine']) or grep('cmd.exe /c ', this['ProcessCommandLine'])
    or grep('cmd.exe /k ', this['ProcessCommandLine']) or grep('cmd.exe /r ', this['ProcessCommandLine']))
    or grep(' -decode ', this['ProcessCommandLine']) or grep(' -enc ', this['ProcessCommandLine'])
    or grep(' -w hidden ', this['ProcessCommandLine']) or grep(' bypass ', this['ProcessCommandLine'])
    or grep(' IEX', this['ProcessCommandLine']) or grep('.DownloadData', this['ProcessCommandLine'])
    or grep('.DownloadFile', this['ProcessCommandLine']) or grep('.DownloadString',
    this['ProcessCommandLine']) or grep('/c start /min ', this['ProcessCommandLine'])
    or grep('FromBase64String', this['ProcessCommandLine']) or grep('mshta http',
    this['ProcessCommandLine']) or grep('mshta.exe http', this['ProcessCommandLine'])
    or (grep(':\\ProgramData\\', this['ProcessCommandLine']) or grep(':\\Temp\\',
    this['ProcessCommandLine']) or grep(':\\Tmp\\', this['ProcessCommandLine']) or
    grep(':\\Users\\Public\\', this['ProcessCommandLine']) or grep(':\\Windows\\Temp\\',
    this['ProcessCommandLine']) or grep('\\AppData\\', this['ProcessCommandLine'])
    or grep('%AppData%', this['ProcessCommandLine']) or grep('%Temp%', this['ProcessCommandLine'])
    or grep('%tmp%', this['ProcessCommandLine'])) and (grep('cscript', this['ProcessCommandLine'])
    or grep('curl', this['ProcessCommandLine']) or grep('wscript', this['ProcessCommandLine'])))
  sigma_id: f2c64357-b1d2-41b7-849f-34d2682c0fad
- name: Schtasks Creation Or Modification With SYSTEM Privileges
  query: grep('\\schtasks.exe', this['FolderPath']) and (grep(' /change ', this['ProcessCommandLine'])
    or grep(' /create ', this['ProcessCommandLine'])) and grep('/ru ', this['ProcessCommandLine'])
    and (grep('NT AUT', this['ProcessCommandLine']) or grep(' SYSTEM ', this['ProcessCommandLine']))
    and not (grep('\\schtasks.exe', this['FolderPath']) and grep('/TN TVInstallRestore',
    this['ProcessCommandLine']) and grep('\\TeamViewer_.exe', this['ProcessCommandLine'])
    or grep('/Create /F /RU System /SC WEEKLY /TN AviraSystemSpeedupVerify /TR ',
    this['ProcessCommandLine']) or grep(':\\Program Files (x86)\\Avira\\System Speedup\\setup\\avira_speedup_setup.exe',
    this['ProcessCommandLine']) or grep('/VERIFY /VERYSILENT /NOSTART /NODOTNET /NORESTART"
    /RL HIGHEST', this['ProcessCommandLine']))
  sigma_id: 89ca78fd-b37c-4310-b3d3-81a023f83936
- name: Script Event Consumer Spawning Process
  query: grep('\\scrcons.exe', this['InitiatingProcessFolderPath']) and (grep('\\svchost.exe',
    this['FolderPath']) or grep('\\dllhost.exe', this['FolderPath']) or grep('\\powershell.exe',
    this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']) or grep('\\wscript.exe',
    this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']) or grep('\\schtasks.exe',
    this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\mshta.exe',
    this['FolderPath']) or grep('\\rundll32.exe', this['FolderPath']) or grep('\\msiexec.exe',
    this['FolderPath']) or grep('\\msbuild.exe', this['FolderPath']))
  sigma_id: f6d1dd2f-b8ce-40ca-bc23-062efb686b34
- name: Potential Shim Database Persistence via Sdbinst.EXE
  query: (grep('\\sdbinst.exe', this['FolderPath']) or grep('sdbinst.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('.sdb', this['ProcessCommandLine']) and not (grep('\\msiexec.exe', this['InitiatingProcessFolderPath'])
    and (grep(':\\Program Files (x86)\\IIS Express\\iisexpressshim.sdb', this['ProcessCommandLine'])
    or grep(':\\Program Files\\IIS Express\\iisexpressshim.sdb', this['ProcessCommandLine'])))
  sigma_id: 517490a7-115a-48c6-8862-1a481504d5a8
- name: Uncommon Extension Shim Database Installation Via Sdbinst.EXE
  query: (grep('\\sdbinst.exe', this['FolderPath']) or grep('sdbinst.exe', this['ProcessVersionInfoOriginalFileName']))
    and not (grep('.sdb', this['ProcessCommandLine']) or grep(' -c', this['ProcessCommandLine'])
    or grep(' -f', this['ProcessCommandLine']) or grep(' -mm', this['ProcessCommandLine'])
    or grep(' -t', this['ProcessCommandLine']) or grep(' -m -bg', this['ProcessCommandLine'])
    or this['ProcessCommandLine']==null or false)
  sigma_id: 18ee686c-38a3-4f65-9f44-48a077141f42
- name: Sdclt Child Processes
  query: grep('\\sdclt.exe', this['InitiatingProcessFolderPath'])
  sigma_id: da2738f2-fadb-4394-afa7-0a0674885afa
- name: Sdiagnhost Calling Suspicious Child Process
  query: grep('\\sdiagnhost.exe', this['InitiatingProcessFolderPath']) and (grep('\\powershell.exe',
    this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']) or grep('\\cmd.exe',
    this['FolderPath']) or grep('\\mshta.exe', this['FolderPath']) or grep('\\cscript.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath']) or grep('\\taskkill.exe',
    this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\rundll32.exe',
    this['FolderPath']) or grep('\\calc.exe', this['FolderPath'])) and not (grep('\\cmd.exe',
    this['FolderPath']) and grep('bits', this['ProcessCommandLine']) or grep('\\powershell.exe',
    this['FolderPath']) and (grep('-noprofile -', this['ProcessCommandLine']) or grep('-noprofile',
    this['ProcessCommandLine'])))
  sigma_id: f3d39c45-de1a-4486-a687-ab126124f744
- name: Potential Suspicious Activity Using SeCEdit
  query: (grep('\\secedit.exe', this['FolderPath']) or grep('SeCEdit', this['ProcessVersionInfoOriginalFileName']))
    and (grep('/export', this['ProcessCommandLine']) and grep('/cfg', this['ProcessCommandLine'])
    or grep('/configure', this['ProcessCommandLine']) and grep('/db', this['ProcessCommandLine']))
  sigma_id: c2c76b77-32be-4d1f-82c9-7e544bdfe0eb
- name: Suspicious Serv-U Process Pattern
  query: grep('\\Serv-U.exe', this['InitiatingProcessFolderPath']) and (grep('\\cmd.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath']) or grep('\\cscript.exe',
    this['FolderPath']) or grep('\\sh.exe', this['FolderPath']) or grep('\\bash.exe',
    this['FolderPath']) or grep('\\schtasks.exe', this['FolderPath']) or grep('\\regsvr32.exe',
    this['FolderPath']) or grep('\\wmic.exe', this['FolderPath']) or grep('\\mshta.exe',
    this['FolderPath']) or grep('\\rundll32.exe', this['FolderPath']) or grep('\\msiexec.exe',
    this['FolderPath']) or grep('\\forfiles.exe', this['FolderPath']) or grep('\\scriptrunner.exe',
    this['FolderPath']))
  sigma_id: 58f4ea09-0fc2-4520-ba18-b85c540b0eaf
- name: Uncommon Child Process Of Setres.EXE
  query: grep('\\setres.exe', this['InitiatingProcessFolderPath']) and grep('\\choice',
    this['FolderPath']) and not (grep('C:\\Windows\\System32\\choice.exe', this['FolderPath'])
    or grep('C:\\Windows\\SysWOW64\\choice.exe', this['FolderPath']))
  sigma_id: 835e75bf-4bfd-47a4-b8a6-b766cac8bcb7
- name: Potential SPN Enumeration Via Setspn.EXE
  query: (grep('\\setspn.exe', this['FolderPath']) or grep('setspn.exe', this['ProcessVersionInfoOriginalFileName'])
    or grep('Query or reset the computer', this['ProcessVersionInfoFileDescription'])
    and grep('SPN attribute', this['ProcessVersionInfoFileDescription'])) and (grep('
    -q ', this['ProcessCommandLine']) or grep(' /q ', this['ProcessCommandLine']))
  sigma_id: 1eeed653-dbc8-4187-ad0c-eeebb20e6599
- name: Setup16.EXE Execution With Custom .Lst File
  query: grep('C:\\Windows\\SysWOW64\\setup16.exe', this['InitiatingProcessFolderPath'])
    and grep(' -m ', this['InitiatingProcessCommandLine']) and not grep('C:\\~MSSETUP.T\\',
    this['FolderPath'])
  sigma_id: 99c8be4f-3087-4f9f-9c24-8c7e257b442e
- name: Suspicious Execution of Shutdown
  query: grep('\\shutdown.exe', this['FolderPath']) and (grep('/r ', this['ProcessCommandLine'])
    or grep('/s ', this['ProcessCommandLine']))
  sigma_id: 34ebb878-1b15-4895-b352-ca2eeb99b274
- name: Suspicious Execution of Shutdown to Log Out
  query: grep('\\shutdown.exe', this['FolderPath']) and grep('/l', this['ProcessCommandLine'])
  sigma_id: ec290c06-9b6b-4338-8b6b-095c0f284f10
- name: Uncommon Sigverif.EXE Child Process
  query: grep('\\sigverif.exe', this['InitiatingProcessFolderPath']) and not (this['FolderPath']
    in ['C:\\Windows\\System32\\WerFault.exe', 'C:\\Windows\\SysWOW64\\WerFault.exe'])
  sigma_id: 7d4aaec2-08ed-4430-8b96-28420e030e04
- name: Uncommon Child Processes Of SndVol.exe
  query: grep('\\SndVol.exe', this['InitiatingProcessFolderPath']) and not (grep('\\rundll32.exe',
    this['FolderPath']) and grep(' shell32.dll,Control_RunDLL ', this['ProcessCommandLine']))
  sigma_id: ba42babc-0666-4393-a4f7-ceaf5a69191e
- name: Audio Capture via SoundRecorder
  query: grep('\\SoundRecorder.exe', this['FolderPath']) and grep('/FILE', this['ProcessCommandLine'])
  sigma_id: 83865853-59aa-449e-9600-74b9d89a6d6e
- name: Suspicious Splwow64 Without Params
  query: grep('\\splwow64.exe', this['FolderPath']) and grep('splwow64.exe', this['ProcessCommandLine'])
  sigma_id: 1f1a8509-2cbb-44f5-8751-8e1571518ce2
- name: Suspicious Spool Service Child Process
  query: grep('\\spoolsv.exe', this['InitiatingProcessFolderPath']) and (this['ProcessIntegrityLevel']
    in ['System', 'S-1-16-16384']) and (grep('\\gpupdate.exe', this['FolderPath'])
    or grep('\\whoami.exe', this['FolderPath']) or grep('\\nltest.exe', this['FolderPath'])
    or grep('\\taskkill.exe', this['FolderPath']) or grep('\\wmic.exe', this['FolderPath'])
    or grep('\\taskmgr.exe', this['FolderPath']) or grep('\\sc.exe', this['FolderPath'])
    or grep('\\findstr.exe', this['FolderPath']) or grep('\\curl.exe', this['FolderPath'])
    or grep('\\wget.exe', this['FolderPath']) or grep('\\certutil.exe', this['FolderPath'])
    or grep('\\bitsadmin.exe', this['FolderPath']) or grep('\\accesschk.exe', this['FolderPath'])
    or grep('\\wevtutil.exe', this['FolderPath']) or grep('\\bcdedit.exe', this['FolderPath'])
    or grep('\\fsutil.exe', this['FolderPath']) or grep('\\cipher.exe', this['FolderPath'])
    or grep('\\schtasks.exe', this['FolderPath']) or grep('\\write.exe', this['FolderPath'])
    or grep('\\wuauclt.exe', this['FolderPath']) or grep('\\systeminfo.exe', this['FolderPath'])
    or grep('\\reg.exe', this['FolderPath']) or grep('\\query.exe', this['FolderPath'])
    or (grep('\\net.exe', this['FolderPath']) or grep('\\net1.exe', this['FolderPath']))
    and not grep('start', this['ProcessCommandLine']) or grep('\\cmd.exe', this['FolderPath'])
    and not (grep('.spl', this['ProcessCommandLine']) or grep('route add', this['ProcessCommandLine'])
    or grep('program files', this['ProcessCommandLine'])) or grep('\\netsh.exe', this['FolderPath'])
    and not (grep('add portopening', this['ProcessCommandLine']) or grep('rule name',
    this['ProcessCommandLine'])) or (grep('\\powershell.exe', this['FolderPath'])
    or grep('\\pwsh.exe', this['FolderPath'])) and not grep('.spl', this['ProcessCommandLine'])
    or (grep('\\rundll32.exe', this['FolderPath']) or grep('RUNDLL32.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('rundll32.exe', this['ProcessCommandLine']))
  sigma_id: dcdbc940-0bff-46b2-95f3-2d73f848e33b
- name: Veeam Backup Database Suspicious Query
  query: grep('\\sqlcmd.exe', this['FolderPath']) and grep('VeeamBackup', this['ProcessCommandLine'])
    and grep('From ', this['ProcessCommandLine']) and (grep('BackupRepositories',
    this['ProcessCommandLine']) or grep('Backups', this['ProcessCommandLine']) or
    grep('Credentials', this['ProcessCommandLine']) or grep('HostCreds', this['ProcessCommandLine'])
    or grep('SmbFileShares', this['ProcessCommandLine']) or grep('Ssh_creds', this['ProcessCommandLine'])
    or grep('VSphereInfo', this['ProcessCommandLine']))
  sigma_id: 696bfb54-227e-4602-ac5b-30d9d2053312
- name: VeeamBackup Database Credentials Dump Via Sqlcmd.EXE
  query: grep('\\sqlcmd.exe', this['FolderPath']) and grep('SELECT', this['ProcessCommandLine'])
    and grep('TOP', this['ProcessCommandLine']) and grep('[VeeamBackup].[dbo].[Credentials]',
    this['ProcessCommandLine'])
  sigma_id: b57ba453-b384-4ab9-9f40-1038086b4e53
- name: SQLite Chromium Profile Data DB Access
  query: (grep('SQLite', this['ProcessVersionInfoProductName']) or grep('\\sqlite.exe',
    this['FolderPath']) or grep('\\sqlite3.exe', this['FolderPath'])) and (grep('\\User
    Data\\', this['ProcessCommandLine']) or grep('\\Opera Software\\', this['ProcessCommandLine'])
    or grep('\\ChromiumViewer\\', this['ProcessCommandLine'])) and (grep('Login Data',
    this['ProcessCommandLine']) or grep('Cookies', this['ProcessCommandLine']) or
    grep('Web Data', this['ProcessCommandLine']) or grep('History', this['ProcessCommandLine'])
    or grep('Bookmarks', this['ProcessCommandLine']))
  sigma_id: 24c77512-782b-448a-8950-eddb0785fc71
- name: SQLite Firefox Profile Data DB Access
  query: (grep('SQLite', this['ProcessVersionInfoProductName']) or grep('\\sqlite.exe',
    this['FolderPath']) or grep('\\sqlite3.exe', this['FolderPath'])) and (grep('cookies.sqlite',
    this['ProcessCommandLine']) or grep('places.sqlite', this['ProcessCommandLine']))
  sigma_id: 4833155a-4053-4c9c-a997-777fcea0baa7
- name: Arbitrary File Download Via Squirrel.EXE
  query: (grep('\\squirrel.exe', this['FolderPath']) or grep('\\update.exe', this['FolderPath']))
    and (grep(' --download ', this['ProcessCommandLine']) or grep(' --update ', this['ProcessCommandLine'])
    or grep(' --updateRollback=', this['ProcessCommandLine'])) and grep('http', this['ProcessCommandLine'])
  sigma_id: 1e75c1cc-c5d4-42aa-ac3d-91b0b68b3b4c
- name: Process Proxy Execution Via Squirrel.EXE
  query: (grep('\\squirrel.exe', this['FolderPath']) or grep('\\update.exe', this['FolderPath']))
    and (grep('--processStart', this['ProcessCommandLine']) or grep('--processStartAndWait',
    this['ProcessCommandLine']) or grep('--createShortcut', this['ProcessCommandLine']))
    and not (grep(':\\Users\\', this['ProcessCommandLine']) and grep('\\AppData\\Local\\Discord\\Update.exe',
    this['ProcessCommandLine']) and grep(' --processStart', this['ProcessCommandLine'])
    and grep('Discord.exe', this['ProcessCommandLine']) or grep(':\\Users\\', this['ProcessCommandLine'])
    and grep('\\AppData\\Local\\GitHubDesktop\\Update.exe', this['ProcessCommandLine'])
    and grep('GitHubDesktop.exe', this['ProcessCommandLine']) and (grep('--createShortcut',
    this['ProcessCommandLine']) or grep('--processStartAndWait', this['ProcessCommandLine']))
    or grep(':\\Users\\', this['ProcessCommandLine']) and grep('\\AppData\\Local\\Microsoft\\Teams\\Update.exe',
    this['ProcessCommandLine']) and grep('Teams.exe', this['ProcessCommandLine'])
    and (grep('--processStart', this['ProcessCommandLine']) or grep('--createShortcut',
    this['ProcessCommandLine'])) or grep(':\\Users\\', this['ProcessCommandLine'])
    and grep('\\AppData\\Local\\yammerdesktop\\Update.exe', this['ProcessCommandLine'])
    and grep('Yammer.exe', this['ProcessCommandLine']) and (grep('--processStart',
    this['ProcessCommandLine']) or grep('--createShortcut', this['ProcessCommandLine'])))
  sigma_id: 45239e6a-b035-4aaf-b339-8ad379fcb67e
- name: Port Forwarding Activity Via SSH.EXE
  query: "grep('\\\\ssh.exe', this['FolderPath']) and (grep(' -R ', this['ProcessCommandLine'])\
    \ or grep(' /R ', this['ProcessCommandLine']) or grep(' \u2013R ', this['ProcessCommandLine'])\
    \ or grep(' \u2014R ', this['ProcessCommandLine']) or grep(' \u2015R ', this['ProcessCommandLine']))"
  sigma_id: 327f48c1-a6db-4eb8-875a-f6981f1b0183
- name: Program Executed Using Proxy/Local Command Via SSH.EXE
  query: grep('C:\\Windows\\System32\\OpenSSH\\sshd.exe', this['InitiatingProcessFolderPath'])
    or grep('\\ssh.exe', this['FolderPath']) and (grep('ProxyCommand=', this['ProcessCommandLine'])
    or grep('PermitLocalCommand', this['ProcessCommandLine']) and grep('LocalCommand',
    this['ProcessCommandLine']))
  sigma_id: 7d6d30b8-5b91-4b90-a891-46cccaf29598
- name: Potential RDP Tunneling Via SSH
  query: grep('\\ssh.exe', this['FolderPath']) and grep(':3389', this['ProcessCommandLine'])
  sigma_id: f7d7ebd5-a016-46e2-9c54-f9932f2d386d
- name: Potential Amazon SSM Agent Hijacking
  query: grep('\\amazon-ssm-agent.exe', this['FolderPath']) and grep('-register ',
    this['ProcessCommandLine']) and grep('-code ', this['ProcessCommandLine']) and
    grep('-id ', this['ProcessCommandLine']) and grep('-region ', this['ProcessCommandLine'])
  sigma_id: d20ee2f4-822c-4827-9e15-41500b1fff10
- name: Execution via stordiag.exe
  query: grep('\\stordiag.exe', this['InitiatingProcessFolderPath']) and (grep('\\schtasks.exe',
    this['FolderPath']) or grep('\\systeminfo.exe', this['FolderPath']) or grep('\\fltmc.exe',
    this['FolderPath'])) and not (grep('c:\\windows\\system32\\', this['InitiatingProcessFolderPath'])
    or grep('c:\\windows\\syswow64\\', this['InitiatingProcessFolderPath']))
  sigma_id: 961e0abb-1b1e-4c84-a453-aafe56ad0d34
- name: Start of NT Virtual DOS Machine
  query: grep('\\ntvdm.exe', this['FolderPath']) or grep('\\csrstub.exe', this['FolderPath'])
  sigma_id: 16905e21-66ee-42fe-b256-1318ada2d770
- name: Abused Debug Privilege by Arbitrary Parent Processes
  query: (grep('\\winlogon.exe', this['InitiatingProcessFolderPath']) or grep('\\services.exe',
    this['InitiatingProcessFolderPath']) or grep('\\lsass.exe', this['InitiatingProcessFolderPath'])
    or grep('\\csrss.exe', this['InitiatingProcessFolderPath']) or grep('\\smss.exe',
    this['InitiatingProcessFolderPath']) or grep('\\wininit.exe', this['InitiatingProcessFolderPath'])
    or grep('\\spoolsv.exe', this['InitiatingProcessFolderPath']) or grep('\\searchindexer.exe',
    this['InitiatingProcessFolderPath'])) and (grep('AUTHORI', this['AccountName'])
    or grep('AUTORI', this['AccountName'])) and (grep('\\powershell.exe', this['FolderPath'])
    or grep('\\pwsh.exe', this['FolderPath']) or grep('\\cmd.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll',
    'Cmd.Exe']) and not (grep(' route ', this['ProcessCommandLine']) and grep(' ADD
    ', this['ProcessCommandLine']))
  sigma_id: d522eca2-2973-4391-a3e0-ef0374321dae
- name: User Added to Local Administrators Group
  query: (grep('localgroup ', this['ProcessCommandLine']) and grep(' /add', this['ProcessCommandLine'])
    or grep('Add-LocalGroupMember ', this['ProcessCommandLine']) and grep(' -Group
    ', this['ProcessCommandLine'])) and (grep(' administrators ', this['ProcessCommandLine'])
    or grep(' administrateur', this['ProcessCommandLine']))
  sigma_id: ad720b90-25ad-43ff-9b5e-5c841facc8e5
- name: User Added To Highly Privileged Group
  query: (grep('localgroup ', this['ProcessCommandLine']) and grep(' /add', this['ProcessCommandLine'])
    or grep('Add-LocalGroupMember ', this['ProcessCommandLine']) and grep(' -Group
    ', this['ProcessCommandLine'])) and (grep('Group Policy Creator Owners', this['ProcessCommandLine'])
    or grep('Schema Admins', this['ProcessCommandLine']))
  sigma_id: 10fb649c-3600-4d37-b1e6-56ea90bb7e09
- name: User Added to Remote Desktop Users Group
  query: "(grep('localgroup ', this['ProcessCommandLine']) and grep(' /add', this['ProcessCommandLine'])\
    \ or grep('Add-LocalGroupMember ', this['ProcessCommandLine']) and grep(' -Group\
    \ ', this['ProcessCommandLine'])) and (grep('Remote Desktop Users', this['ProcessCommandLine'])\
    \ or grep('Utilisateurs du Bureau \xE0 distance', this['ProcessCommandLine'])\
    \ or grep('Usuarios de escritorio remoto', this['ProcessCommandLine']))"
  sigma_id: ffa28e60-bdb1-46e0-9f82-05f7a61cc06e
- name: Execute From Alternate Data Streams
  query: grep('txt:', this['ProcessCommandLine']) and (grep('type ', this['ProcessCommandLine'])
    and grep(' > ', this['ProcessCommandLine']) or grep('makecab ', this['ProcessCommandLine'])
    and grep('.cab', this['ProcessCommandLine']) or grep('reg ', this['ProcessCommandLine'])
    and grep(' export ', this['ProcessCommandLine']) or grep('regedit ', this['ProcessCommandLine'])
    and grep(' /E ', this['ProcessCommandLine']) or grep('esentutl ', this['ProcessCommandLine'])
    and grep(' /y ', this['ProcessCommandLine']) and grep(' /d ', this['ProcessCommandLine'])
    and grep(' /o ', this['ProcessCommandLine']))
  sigma_id: 7f43c430-5001-4f8b-aaa9-c3b88f18fa5c
- name: Always Install Elevated Windows Installer
  query: (grep('\\Windows\\Installer\\', this['FolderPath']) and grep('msi', this['FolderPath'])
    and grep('tmp', this['FolderPath']) or grep('\\msiexec.exe', this['FolderPath'])
    and (this['ProcessIntegrityLevel'] in ['System', 'S-1-16-16384'])) and (grep('AUTHORI',
    this['AccountName']) or grep('AUTORI', this['AccountName'])) and not (grep('C:\\Windows\\System32\\services.exe',
    this['InitiatingProcessFolderPath']) or grep('\\system32\\msiexec.exe /V', this['ProcessCommandLine'])
    or grep('\\system32\\msiexec.exe /V', this['InitiatingProcessCommandLine']) or
    grep('C:\\ProgramData\\Sophos\\', this['InitiatingProcessFolderPath']) or grep('C:\\ProgramData\\Avira\\',
    this['InitiatingProcessFolderPath']) or grep('C:\\Program Files\\Avast Software\\',
    this['InitiatingProcessFolderPath']) or grep('C:\\Program Files (x86)\\Avast Software\\',
    this['InitiatingProcessFolderPath']) or grep('C:\\Program Files\\Google\\Update\\',
    this['InitiatingProcessFolderPath']) or grep('C:\\Program Files (x86)\\Google\\Update\\',
    this['InitiatingProcessFolderPath']))
  sigma_id: cd951fdc-4b2f-47f5-ba99-a33bf61e3770
- name: Potentially Suspicious Windows App Activity
  query: grep('C:\\Program Files\\WindowsApps\\', this['InitiatingProcessFolderPath'])
    and (grep('\\cmd.exe', this['FolderPath']) or grep('\\cscript.exe', this['FolderPath'])
    or grep('\\mshta.exe', this['FolderPath']) or grep('\\powershell.exe', this['FolderPath'])
    or grep('\\pwsh.exe', this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath'])
    or grep('\\rundll32.exe', this['FolderPath']) or grep('\\wscript.exe', this['FolderPath'])
    or grep('cmd /c', this['ProcessCommandLine']) or grep('Invoke-', this['ProcessCommandLine'])
    or grep('Base64', this['ProcessCommandLine'])) and not (grep(':\\Program Files\\WindowsApps\\Microsoft.WindowsTerminal',
    this['InitiatingProcessFolderPath']) and grep('\\WindowsTerminal.exe', this['InitiatingProcessFolderPath'])
    and (grep('\\powershell.exe', this['FolderPath']) or grep('\\cmd.exe', this['FolderPath'])
    or grep('\\pwsh.exe', this['FolderPath'])))
  sigma_id: f91ed517-a6ba-471d-9910-b3b4a398c0f3
- name: Arbitrary Shell Command Execution Via Settingcontent-Ms
  query: grep('.SettingContent-ms', this['ProcessCommandLine']) and not grep('immersivecontrolpanel',
    this['ProcessCommandLine'])
  sigma_id: 24de4f3b-804c-4165-b442-5a06a2302c7e
- name: Phishing Pattern ISO in Archive
  query: (grep('\\Winrar.exe', this['InitiatingProcessFolderPath']) or grep('\\7zFM.exe',
    this['InitiatingProcessFolderPath']) or grep('\\peazip.exe', this['InitiatingProcessFolderPath']))
    and (grep('\\isoburn.exe', this['FolderPath']) or grep('\\PowerISO.exe', this['FolderPath'])
    or grep('\\ImgBurn.exe', this['FolderPath']))
  sigma_id: fcdf69e5-a3d3-452a-9724-26f2308bf2b1
- name: Automated Collection Command Prompt
  query: (grep('.doc', this['ProcessCommandLine']) or grep('.docx', this['ProcessCommandLine'])
    or grep('.xls', this['ProcessCommandLine']) or grep('.xlsx', this['ProcessCommandLine'])
    or grep('.ppt', this['ProcessCommandLine']) or grep('.pptx', this['ProcessCommandLine'])
    or grep('.rtf', this['ProcessCommandLine']) or grep('.pdf', this['ProcessCommandLine'])
    or grep('.txt', this['ProcessCommandLine'])) and (grep('dir ', this['ProcessCommandLine'])
    and grep(' /b ', this['ProcessCommandLine']) and grep(' /s ', this['ProcessCommandLine'])
    or grep('FINDSTR.EXE', this['ProcessVersionInfoOriginalFileName']) and (grep('
    /e ', this['ProcessCommandLine']) or grep(' /si ', this['ProcessCommandLine'])))
  sigma_id: f576a613-2392-4067-9d1a-9345fb58d8d1
- name: Bad Opsec Defaults Sacrificial Processes With Improper Arguments
  query: (grep('\\WerFault.exe', this['FolderPath']) and grep('WerFault.exe', this['ProcessCommandLine'])
    or grep('\\rundll32.exe', this['FolderPath']) and grep('rundll32.exe', this['ProcessCommandLine'])
    or grep('\\regsvcs.exe', this['FolderPath']) and grep('regsvcs.exe', this['ProcessCommandLine'])
    or grep('\\regasm.exe', this['FolderPath']) and grep('regasm.exe', this['ProcessCommandLine'])
    or grep('\\regsvr32.exe', this['FolderPath']) and grep('regsvr32.exe', this['ProcessCommandLine']))
    and not (grep('\\AppData\\Local\\Microsoft\\EdgeUpdate\\Install\\{', this['InitiatingProcessFolderPath'])
    and grep('\\rundll32.exe', this['FolderPath']) and grep('rundll32.exe', this['ProcessCommandLine'])
    or (grep('\\AppData\\Local\\BraveSoftware\\Brave-Browser\\Application\\', this['InitiatingProcessFolderPath'])
    or grep('\\AppData\\Local\\Google\\Chrome\\Application\\', this['InitiatingProcessFolderPath']))
    and grep('\\Installer\\setup.exe', this['InitiatingProcessFolderPath']) and grep('--uninstall
    ', this['InitiatingProcessCommandLine']) and grep('\\rundll32.exe', this['FolderPath'])
    and grep('rundll32.exe', this['ProcessCommandLine']))
  sigma_id: a7c3d773-caef-227e-a7e7-c2f13c622329
- name: Potential Suspicious Browser Launch From Document Reader Process
  query: (grep('Acrobat Reader', this['InitiatingProcessFolderPath']) or grep('Microsoft
    Office', this['InitiatingProcessFolderPath']) or grep('PDF Reader', this['InitiatingProcessFolderPath']))
    and (grep('\\brave.exe', this['FolderPath']) or grep('\\chrome.exe', this['FolderPath'])
    or grep('\\firefox.exe', this['FolderPath']) or grep('\\msedge.exe', this['FolderPath'])
    or grep('\\opera.exe', this['FolderPath']) or grep('\\maxthon.exe', this['FolderPath'])
    or grep('\\seamonkey.exe', this['FolderPath']) or grep('\\vivaldi.exe', this['FolderPath'])
    or false) and grep('http', this['ProcessCommandLine'])
  sigma_id: 1193d960-2369-499f-a158-7b50a31df682
- name: Suspicious Child Process Created as System
  query: "(grep('AUTHORI', this['InitiatingProcessAccountName']) or grep('AUTORI',\
    \ this['InitiatingProcessAccountName'])) and (grep('NETWORK SERVICE', this['InitiatingProcessAccountName'])\
    \ and false or grep('LOCAL SERVICE', this['InitiatingProcessAccountName']) and\
    \ false) and (grep('AUTHORI', this['AccountName']) or grep('AUTORI', this['AccountName']))\
    \ and (grep('SYSTEM', this['AccountName']) and false or grep('Syst\xE8me', this['AccountName'])\
    \ and false or grep('\u0421\u0418\u0421\u0422\u0415\u041C\u0410', this['AccountName'])\
    \ and false) and (this['ProcessIntegrityLevel'] in ['System', 'S-1-16-16384'])\
    \ and not (grep('\\\\rundll32.exe', this['FolderPath']) and grep('DavSetCookie',\
    \ this['ProcessCommandLine']))"
  sigma_id: 590a5f4c-6c8c-4f10-8307-89afe9453a9d
- name: Potential Commandline Obfuscation Using Escape Characters
  query: grep('h^t^t^p', this['ProcessCommandLine']) or grep('h"t"t"p', this['ProcessCommandLine'])
  sigma_id: f0cdd048-82dc-4f7a-8a7a-b87a52b6d0fd
- name: Potential CommandLine Obfuscation Using Unicode Characters From Suspicious
    Image
  query: "(grep('\\\\cmd.exe', this['FolderPath']) or grep('\\\\cscript.exe', this['FolderPath'])\
    \ or grep('\\\\powershell.exe', this['FolderPath']) or grep('\\\\pwsh.exe', this['FolderPath'])\
    \ or grep('\\\\wscript.exe', this['FolderPath'])) and (this['ProcessVersionInfoOriginalFileName']\
    \ in ['Cmd.EXE', 'cscript.exe', 'PowerShell.EXE', 'pwsh.dll', 'wscript.exe'])\
    \ and (grep('\u02E3', this['ProcessCommandLine']) or grep('\u02EA', this['ProcessCommandLine'])\
    \ or grep('\u02E2', this['ProcessCommandLine']) or grep('\u2215', this['ProcessCommandLine'])\
    \ or grep('\u2044', this['ProcessCommandLine']) or grep('\u2015', this['ProcessCommandLine'])\
    \ or grep('\u2014', this['ProcessCommandLine']) or grep('\_', this['ProcessCommandLine'])\
    \ or grep('\xAF', this['ProcessCommandLine']) or grep('\xAE', this['ProcessCommandLine'])\
    \ or grep('\xB6', this['ProcessCommandLine']))"
  sigma_id: 584bca0f-3608-4402-80fd-4075ff6072e3
- name: Potential Command Line Path Traversal Evasion Attempt
  query: (grep('\\Windows\\', this['FolderPath']) and (grep('\\..\\Windows\\', this['ProcessCommandLine'])
    or grep('\\..\\System32\\', this['ProcessCommandLine']) or grep('\\..\\..\\',
    this['ProcessCommandLine'])) or grep('.exe\\..\\', this['ProcessCommandLine']))
    and not (grep('\\Google\\Drive\\googledrivesync.exe\\..\\', this['ProcessCommandLine'])
    or grep('\\Citrix\\Virtual Smart Card\\Citrix.Authentication.VirtualSmartcard.Launcher.exe\\..\\',
    this['ProcessCommandLine']))
  sigma_id: 1327381e-6ab0-4f38-b583-4c1b8346a56b
- name: Potential Browser Data Stealing
  query: (grep('copy-item', this['ProcessCommandLine']) or grep('copy ', this['ProcessCommandLine'])
    or grep('cpi ', this['ProcessCommandLine']) or grep(' cp ', this['ProcessCommandLine'])
    or grep('move ', this['ProcessCommandLine']) or grep('move-item', this['ProcessCommandLine'])
    or grep(' mi ', this['ProcessCommandLine']) or grep(' mv ', this['ProcessCommandLine'])
    or grep('\\xcopy.exe', this['FolderPath']) or grep('\\robocopy.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['XCOPY.EXE', 'robocopy.exe'])
    and (grep('\\Amigo\\User Data', this['ProcessCommandLine']) or grep('\\BraveSoftware\\Brave-Browser\\User
    Data', this['ProcessCommandLine']) or grep('\\CentBrowser\\User Data', this['ProcessCommandLine'])
    or grep('\\Chromium\\User Data', this['ProcessCommandLine']) or grep('\\CocCoc\\Browser\\User
    Data', this['ProcessCommandLine']) or grep('\\Comodo\\Dragon\\User Data', this['ProcessCommandLine'])
    or grep('\\Elements Browser\\User Data', this['ProcessCommandLine']) or grep('\\Epic
    Privacy Browser\\User Data', this['ProcessCommandLine']) or grep('\\Google\\Chrome
    Beta\\User Data', this['ProcessCommandLine']) or grep('\\Google\\Chrome SxS\\User
    Data', this['ProcessCommandLine']) or grep('\\Google\\Chrome\\User Data\\', this['ProcessCommandLine'])
    or grep('\\Kometa\\User Data', this['ProcessCommandLine']) or grep('\\Maxthon5\\Users',
    this['ProcessCommandLine']) or grep('\\Microsoft\\Edge\\User Data', this['ProcessCommandLine'])
    or grep('\\Mozilla\\Firefox\\Profiles', this['ProcessCommandLine']) or grep('\\Nichrome\\User
    Data', this['ProcessCommandLine']) or grep('\\Opera Software\\Opera GX Stable\\',
    this['ProcessCommandLine']) or grep('\\Opera Software\\Opera Neon\\User Data',
    this['ProcessCommandLine']) or grep('\\Opera Software\\Opera Stable\\', this['ProcessCommandLine'])
    or grep('\\Orbitum\\User Data', this['ProcessCommandLine']) or grep('\\QIP Surf\\User
    Data', this['ProcessCommandLine']) or grep('\\Sputnik\\User Data', this['ProcessCommandLine'])
    or grep('\\Torch\\User Data', this['ProcessCommandLine']) or grep('\\uCozMedia\\Uran\\User
    Data', this['ProcessCommandLine']) or grep('\\Vivaldi\\User Data', this['ProcessCommandLine']))
  sigma_id: 47147b5b-9e17-4d76-b8d2-7bac24c5ce1b
- name: Copy From Or To Admin Share Or Sysvol Folder
  query: ((grep('\\', this['ProcessCommandLine']) or grep('$', this['ProcessCommandLine']))
    or grep('\\Sysvol\\', this['ProcessCommandLine'])) and (grep('\\robocopy.exe',
    this['FolderPath']) or grep('\\xcopy.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['robocopy.exe', 'XCOPY.EXE'] or (grep('\\cmd.exe', this['FolderPath']) or
    grep('Cmd.Exe', this['ProcessVersionInfoOriginalFileName'])) and grep('copy',
    this['ProcessCommandLine']) or (grep('\\powershell.exe', this['FolderPath']) or
    grep('\\pwsh.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['PowerShell.EXE', 'pwsh.dll']) and (grep('copy-item', this['ProcessCommandLine'])
    or grep('copy ', this['ProcessCommandLine']) or grep('cpi ', this['ProcessCommandLine'])
    or grep(' cp ', this['ProcessCommandLine']) or grep('move ', this['ProcessCommandLine'])
    or grep('move-item', this['ProcessCommandLine']) or grep(' mi ', this['ProcessCommandLine'])
    or grep(' mv ', this['ProcessCommandLine'])))
  sigma_id: 855bc8b5-2ae8-402e-a9ed-b889e6df1900
- name: Suspicious Copy From or To System Directory
  query: (grep('\\cmd.exe', this['FolderPath']) and grep('copy ', this['ProcessCommandLine'])
    or (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']))
    and (grep('copy-item', this['ProcessCommandLine']) or grep(' copy ', this['ProcessCommandLine'])
    or grep('cpi ', this['ProcessCommandLine']) or grep(' cp ', this['ProcessCommandLine']))
    or grep('\\robocopy.exe', this['FolderPath']) or grep('\\xcopy.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['robocopy.exe', 'XCOPY.EXE'])
    and (grep('\\System32', this['ProcessCommandLine']) or grep('\\SysWOW64', this['ProcessCommandLine'])
    or grep('\\WinSxS', this['ProcessCommandLine']))
  sigma_id: fff9d2b7-e11c-4a69-93d3-40ef66189767
- name: LOL-Binary Copied From System Directory
  query: (grep('\\cmd.exe', this['FolderPath']) and grep('copy ', this['ProcessCommandLine'])
    or (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']))
    and (grep('copy-item', this['ProcessCommandLine']) or grep(' copy ', this['ProcessCommandLine'])
    or grep('cpi ', this['ProcessCommandLine']) or grep(' cp ', this['ProcessCommandLine']))
    or grep('\\robocopy.exe', this['FolderPath']) or grep('\\xcopy.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['robocopy.exe', 'XCOPY.EXE'])
    and (grep('\\System32', this['ProcessCommandLine']) or grep('\\SysWOW64', this['ProcessCommandLine'])
    or grep('\\WinSxS', this['ProcessCommandLine'])) and (grep('\\bitsadmin.exe',
    this['ProcessCommandLine']) or grep('\\calc.exe', this['ProcessCommandLine'])
    or grep('\\certutil.exe', this['ProcessCommandLine']) or grep('\\cmdl32.exe',
    this['ProcessCommandLine']) or grep('\\cscript.exe', this['ProcessCommandLine'])
    or grep('\\mshta.exe', this['ProcessCommandLine']) or grep('\\rundll32.exe', this['ProcessCommandLine'])
    or grep('\\wscript.exe', this['ProcessCommandLine']))
  sigma_id: f5d19838-41b5-476c-98d8-ba8af4929ee2
- name: Potential Crypto Mining Activity
  query: (grep(' --cpu-priority=', this['ProcessCommandLine']) or grep('--donate-level=0',
    this['ProcessCommandLine']) or grep(' -o pool.', this['ProcessCommandLine']) or
    grep(' --nicehash', this['ProcessCommandLine']) or grep(' --algo=rx/0 ', this['ProcessCommandLine'])
    or grep('stratum+tcp://', this['ProcessCommandLine']) or grep('stratum+udp://',
    this['ProcessCommandLine']) or grep('LS1kb25hdGUtbGV2ZWw9', this['ProcessCommandLine'])
    or grep('0tZG9uYXRlLWxldmVsP', this['ProcessCommandLine']) or grep('tLWRvbmF0ZS1sZXZlbD',
    this['ProcessCommandLine']) or grep('c3RyYXR1bSt0Y3A6Ly', this['ProcessCommandLine'])
    or grep('N0cmF0dW0rdGNwOi8v', this['ProcessCommandLine']) or grep('zdHJhdHVtK3RjcDovL',
    this['ProcessCommandLine']) or grep('c3RyYXR1bSt1ZHA6Ly', this['ProcessCommandLine'])
    or grep('N0cmF0dW0rdWRwOi8v', this['ProcessCommandLine']) or grep('zdHJhdHVtK3VkcDovL',
    this['ProcessCommandLine'])) and not (grep(' pool.c ', this['ProcessCommandLine'])
    or grep(' pool.o ', this['ProcessCommandLine']) or grep('gcc -', this['ProcessCommandLine']))
  sigma_id: 66c3b204-9f88-4d0a-a7f7-8a57d521ca55
- name: Potential Data Exfiltration Activity Via CommandLine Tools
  query: ((grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or grep('\\cmd.exe', this['FolderPath'])) and (grep('Invoke-WebRequest', this['ProcessCommandLine'])
    or grep('iwr ', this['ProcessCommandLine']) or grep('wget ', this['ProcessCommandLine'])
    or grep('curl ', this['ProcessCommandLine'])) and grep(' -ur', this['ProcessCommandLine'])
    and grep(' -me', this['ProcessCommandLine']) and grep(' -b', this['ProcessCommandLine'])
    and grep(' POST ', this['ProcessCommandLine']) or grep('\\curl.exe', this['FolderPath'])
    and grep('--ur', this['ProcessCommandLine']) and (grep(' -d ', this['ProcessCommandLine'])
    or grep(' --data ', this['ProcessCommandLine'])) or grep('\\wget.exe', this['FolderPath'])
    and (grep('--post-data', this['ProcessCommandLine']) or grep('--post-file', this['ProcessCommandLine'])))
    and (grep('Get-Content', this['ProcessCommandLine']) or grep('GetBytes', this['ProcessCommandLine'])
    or grep('hostname', this['ProcessCommandLine']) or grep('ifconfig', this['ProcessCommandLine'])
    or grep('ipconfig', this['ProcessCommandLine']) or grep('net view', this['ProcessCommandLine'])
    or grep('netstat', this['ProcessCommandLine']) or grep('nltest', this['ProcessCommandLine'])
    or grep('qprocess', this['ProcessCommandLine']) or grep('sc query', this['ProcessCommandLine'])
    or grep('systeminfo', this['ProcessCommandLine']) or grep('tasklist', this['ProcessCommandLine'])
    or grep('ToBase64String', this['ProcessCommandLine']) or grep('whoami', this['ProcessCommandLine'])
    or grep('type ', this['ProcessCommandLine']) and grep(' > ', this['ProcessCommandLine'])
    and grep(' C:\\', this['ProcessCommandLine']))
  sigma_id: 7d1aaf3d-4304-425c-b7c3-162055e0b3ab
- name: Raccine Uninstall
  query: grep('taskkill ', this['ProcessCommandLine']) and grep('RaccineSettings.exe',
    this['ProcessCommandLine']) or grep('reg.exe', this['ProcessCommandLine']) and
    grep('delete', this['ProcessCommandLine']) and grep('Raccine Tray', this['ProcessCommandLine'])
    or grep('schtasks', this['ProcessCommandLine']) and grep('/DELETE', this['ProcessCommandLine'])
    and grep('Raccine Rules Updater', this['ProcessCommandLine'])
  sigma_id: a31eeaed-3fd5-478e-a8ba-e62c6b3f9ecc
- name: Suspicious Double Extension File Execution
  query: (grep('.doc.exe', this['FolderPath']) or grep('.docx.exe', this['FolderPath'])
    or grep('.xls.exe', this['FolderPath']) or grep('.xlsx.exe', this['FolderPath'])
    or grep('.ppt.exe', this['FolderPath']) or grep('.pptx.exe', this['FolderPath'])
    or grep('.rtf.exe', this['FolderPath']) or grep('.pdf.exe', this['FolderPath'])
    or grep('.txt.exe', this['FolderPath']) or grep('      .exe', this['FolderPath'])
    or grep('______.exe', this['FolderPath']) or grep('.doc.js', this['FolderPath'])
    or grep('.docx.js', this['FolderPath']) or grep('.xls.js', this['FolderPath'])
    or grep('.xlsx.js', this['FolderPath']) or grep('.ppt.js', this['FolderPath'])
    or grep('.pptx.js', this['FolderPath']) or grep('.rtf.js', this['FolderPath'])
    or grep('.pdf.js', this['FolderPath']) or grep('.txt.js', this['FolderPath']))
    and (grep('.doc.exe', this['ProcessCommandLine']) or grep('.docx.exe', this['ProcessCommandLine'])
    or grep('.xls.exe', this['ProcessCommandLine']) or grep('.xlsx.exe', this['ProcessCommandLine'])
    or grep('.ppt.exe', this['ProcessCommandLine']) or grep('.pptx.exe', this['ProcessCommandLine'])
    or grep('.rtf.exe', this['ProcessCommandLine']) or grep('.pdf.exe', this['ProcessCommandLine'])
    or grep('.txt.exe', this['ProcessCommandLine']) or grep('      .exe', this['ProcessCommandLine'])
    or grep('______.exe', this['ProcessCommandLine']) or grep('.doc.js', this['ProcessCommandLine'])
    or grep('.docx.js', this['ProcessCommandLine']) or grep('.xls.js', this['ProcessCommandLine'])
    or grep('.xlsx.js', this['ProcessCommandLine']) or grep('.ppt.js', this['ProcessCommandLine'])
    or grep('.pptx.js', this['ProcessCommandLine']) or grep('.rtf.js', this['ProcessCommandLine'])
    or grep('.pdf.js', this['ProcessCommandLine']) or grep('.txt.js', this['ProcessCommandLine']))
  sigma_id: 1cdd9a09-06c9-4769-99ff-626e2b3991b8
- name: Suspicious Parent Double Extension File Execution
  query: grep('.doc.lnk', this['InitiatingProcessFolderPath']) or grep('.docx.lnk',
    this['InitiatingProcessFolderPath']) or grep('.xls.lnk', this['InitiatingProcessFolderPath'])
    or grep('.xlsx.lnk', this['InitiatingProcessFolderPath']) or grep('.ppt.lnk',
    this['InitiatingProcessFolderPath']) or grep('.pptx.lnk', this['InitiatingProcessFolderPath'])
    or grep('.rtf.lnk', this['InitiatingProcessFolderPath']) or grep('.pdf.lnk', this['InitiatingProcessFolderPath'])
    or grep('.txt.lnk', this['InitiatingProcessFolderPath']) or grep('.doc.js', this['InitiatingProcessFolderPath'])
    or grep('.docx.js', this['InitiatingProcessFolderPath']) or grep('.xls.js', this['InitiatingProcessFolderPath'])
    or grep('.xlsx.js', this['InitiatingProcessFolderPath']) or grep('.ppt.js', this['InitiatingProcessFolderPath'])
    or grep('.pptx.js', this['InitiatingProcessFolderPath']) or grep('.rtf.js', this['InitiatingProcessFolderPath'])
    or grep('.pdf.js', this['InitiatingProcessFolderPath']) or grep('.txt.js', this['InitiatingProcessFolderPath'])
    or grep('.doc.lnk', this['InitiatingProcessCommandLine']) or grep('.docx.lnk',
    this['InitiatingProcessCommandLine']) or grep('.xls.lnk', this['InitiatingProcessCommandLine'])
    or grep('.xlsx.lnk', this['InitiatingProcessCommandLine']) or grep('.ppt.lnk',
    this['InitiatingProcessCommandLine']) or grep('.pptx.lnk', this['InitiatingProcessCommandLine'])
    or grep('.rtf.lnk', this['InitiatingProcessCommandLine']) or grep('.pdf.lnk',
    this['InitiatingProcessCommandLine']) or grep('.txt.lnk', this['InitiatingProcessCommandLine'])
    or grep('.doc.js', this['InitiatingProcessCommandLine']) or grep('.docx.js', this['InitiatingProcessCommandLine'])
    or grep('.xls.js', this['InitiatingProcessCommandLine']) or grep('.xlsx.js', this['InitiatingProcessCommandLine'])
    or grep('.ppt.js', this['InitiatingProcessCommandLine']) or grep('.pptx.js', this['InitiatingProcessCommandLine'])
    or grep('.rtf.js', this['InitiatingProcessCommandLine']) or grep('.pdf.js', this['InitiatingProcessCommandLine'])
    or grep('.txt.js', this['InitiatingProcessCommandLine'])
  sigma_id: 5e6a80c8-2d45-4633-9ef4-fa2671a39c5c
- name: Suspicious Download from Office Domain
  query: (grep('\\curl.exe', this['FolderPath']) or grep('\\wget.exe', this['FolderPath'])
    or grep('Invoke-WebRequest', this['ProcessCommandLine']) or grep('iwr ', this['ProcessCommandLine'])
    or grep('curl ', this['ProcessCommandLine']) or grep('wget ', this['ProcessCommandLine'])
    or grep('Start-BitsTransfer', this['ProcessCommandLine']) or grep('.DownloadFile(',
    this['ProcessCommandLine']) or grep('.DownloadString(', this['ProcessCommandLine']))
    and (grep('https://attachment.outlook.live.net/owa/', this['ProcessCommandLine'])
    or grep('https://onenoteonlinesync.onenote.com/onenoteonlinesync/', this['ProcessCommandLine']))
  sigma_id: 00d49ed5-4491-4271-a8db-650a4ef6f8c1
- name: DumpStack.log Defender Evasion
  query: grep('\\DumpStack.log', this['FolderPath']) or grep(' -o DumpStack.log',
    this['ProcessCommandLine'])
  sigma_id: 4f647cfa-b598-4e12-ad69-c68dd16caef8
- name: Always Install Elevated MSI Spawned Cmd And Powershell
  query: (grep('\\cmd.exe', this['FolderPath']) or grep('\\powershell.exe', this['FolderPath'])
    or grep('\\pwsh.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['Cmd.Exe', 'PowerShell.EXE', 'pwsh.dll']) and grep('\\Windows\\Installer\\',
    this['InitiatingProcessFolderPath']) and grep('msi', this['InitiatingProcessFolderPath'])
    and grep('tmp', this['InitiatingProcessFolderPath'])
  sigma_id: 1e53dd56-8d83-4eb4-a43e-b790a05510aa
- name: Suspicious Electron Application Child Processes
  query: (grep('\\chrome.exe', this['InitiatingProcessFolderPath']) or grep('\\discord.exe',
    this['InitiatingProcessFolderPath']) or grep('\\GitHubDesktop.exe', this['InitiatingProcessFolderPath'])
    or grep('\\keybase.exe', this['InitiatingProcessFolderPath']) or grep('\\msedge.exe',
    this['InitiatingProcessFolderPath']) or grep('\\msedgewebview2.exe', this['InitiatingProcessFolderPath'])
    or grep('\\msteams.exe', this['InitiatingProcessFolderPath']) or grep('\\slack.exe',
    this['InitiatingProcessFolderPath']) or grep('\\teams.exe', this['InitiatingProcessFolderPath']))
    and (grep('\\cmd.exe', this['FolderPath']) or grep('\\cscript.exe', this['FolderPath'])
    or grep('\\mshta.exe', this['FolderPath']) or grep('\\powershell.exe', this['FolderPath'])
    or grep('\\pwsh.exe', this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath'])
    or grep('\\whoami.exe', this['FolderPath']) or grep('\\wscript.exe', this['FolderPath'])
    or grep(':\\ProgramData\\', this['FolderPath']) or grep(':\\Temp\\', this['FolderPath'])
    or grep('\\AppData\\Local\\Temp\\', this['FolderPath']) or grep('\\Users\\Public\\',
    this['FolderPath']) or grep('\\Windows\\Temp\\', this['FolderPath'])) and not
    (grep('\\Discord.exe', this['InitiatingProcessFolderPath']) and grep('\\cmd.exe',
    this['FolderPath']) and grep('\\NVSMI\\nvidia-smi.exe', this['ProcessCommandLine']))
  sigma_id: f26eb764-fd89-464b-85e2-dc4a8e6e77b8
- name: Potentially Suspicious Electron Application CommandLine
  query: (grep('\\chrome.exe', this['FolderPath']) or grep('\\code.exe', this['FolderPath'])
    or grep('\\discord.exe', this['FolderPath']) or grep('\\GitHubDesktop.exe', this['FolderPath'])
    or grep('\\keybase.exe', this['FolderPath']) or grep('\\msedge_proxy.exe', this['FolderPath'])
    or grep('\\msedge.exe', this['FolderPath']) or grep('\\msedgewebview2.exe', this['FolderPath'])
    or grep('\\msteams.exe', this['FolderPath']) or grep('\\slack.exe', this['FolderPath'])
    or grep('\\Teams.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['chrome.exe', 'code.exe', 'discord.exe', 'GitHubDesktop.exe', 'keybase.exe',
    'msedge_proxy.exe', 'msedge.exe', 'msedgewebview2.exe', 'msteams.exe', 'slack.exe',
    'Teams.exe']) and (grep('--browser-subprocess-path', this['ProcessCommandLine'])
    or grep('--gpu-launcher', this['ProcessCommandLine']) or grep('--renderer-cmd-prefix',
    this['ProcessCommandLine']) or grep('--utility-cmd-prefix', this['ProcessCommandLine']))
  sigma_id: 378a05d8-963c-46c9-bcce-13c7657eac99
- name: Elevated System Shell Spawned From Uncommon Parent Location
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or grep('\\cmd.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['PowerShell.EXE', 'pwsh.dll', 'Cmd.Exe']) and (grep('AUTHORI', this['AccountName'])
    or grep('AUTORI', this['AccountName'])) and grep('0x3e7', this['LogonId']) and
    not (grep(':\\Program Files (x86)\\', this['InitiatingProcessFolderPath']) or
    grep(':\\Program Files\\', this['InitiatingProcessFolderPath']) or grep(':\\ProgramData\\',
    this['InitiatingProcessFolderPath']) or grep(':\\Windows\\System32\\', this['InitiatingProcessFolderPath'])
    or grep(':\\Windows\\SysWOW64\\', this['InitiatingProcessFolderPath']) or grep(':\\Windows\\Temp\\',
    this['InitiatingProcessFolderPath']) or grep(':\\Windows\\WinSxS\\', this['InitiatingProcessFolderPath'])
    or this['InitiatingProcessFolderPath']==null or false) and not (grep(':\\ManageEngine\\ADManager
    Plus\\pgsql\\bin\\postgres.exe', this['InitiatingProcessFolderPath']) and grep('\\cmd.exe',
    this['FolderPath']) or grep(':\\WINDOWS\\system32\\cmd.exe /c "', this['ProcessCommandLine'])
    and grep(':\\WINDOWS\\Temp\\asgard2-agent\\', this['CurrentDirectory']) or grep(':\\IBM\\SpectrumProtect\\webserver\\scripts\\',
    this['InitiatingProcessFolderPath']) and grep(':\\IBM\\SpectrumProtect\\webserver\\scripts\\',
    this['ProcessCommandLine']))
  sigma_id: 178e615d-e666-498b-9630-9ed363038101
- name: Hidden Powershell in Link File Pattern
  query: grep('C:\\Windows\\explorer.exe', this['InitiatingProcessFolderPath']) and
    grep('C:\\Windows\\System32\\cmd.exe', this['FolderPath']) and grep('powershell',
    this['ProcessCommandLine']) and grep('.lnk', this['ProcessCommandLine'])
  sigma_id: 30e92f50-bb5a-4884-98b5-d20aa80f3d7a
- name: Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 1
  query: "grep('\U0001F600', this['ProcessCommandLine']) or grep('\U0001F603', this['ProcessCommandLine'])\
    \ or grep('\U0001F604', this['ProcessCommandLine']) or grep('\U0001F601', this['ProcessCommandLine'])\
    \ or grep('\U0001F606', this['ProcessCommandLine']) or grep('\U0001F605', this['ProcessCommandLine'])\
    \ or grep('\U0001F602', this['ProcessCommandLine']) or grep('\U0001F923', this['ProcessCommandLine'])\
    \ or grep('\U0001F972', this['ProcessCommandLine']) or grep('\U0001F979', this['ProcessCommandLine'])\
    \ or grep('\u263A\uFE0F', this['ProcessCommandLine']) or grep('\U0001F60A', this['ProcessCommandLine'])\
    \ or grep('\U0001F607', this['ProcessCommandLine']) or grep('\U0001F642', this['ProcessCommandLine'])\
    \ or grep('\U0001F643', this['ProcessCommandLine']) or grep('\U0001F609', this['ProcessCommandLine'])\
    \ or grep('\U0001F60C', this['ProcessCommandLine']) or grep('\U0001F60D', this['ProcessCommandLine'])\
    \ or grep('\U0001F970', this['ProcessCommandLine']) or grep('\U0001F618', this['ProcessCommandLine'])\
    \ or grep('\U0001F617', this['ProcessCommandLine']) or grep('\U0001F619', this['ProcessCommandLine'])\
    \ or grep('\U0001F61A', this['ProcessCommandLine']) or grep('\U0001F60B', this['ProcessCommandLine'])\
    \ or grep('\U0001F61B', this['ProcessCommandLine']) or grep('\U0001F61D', this['ProcessCommandLine'])\
    \ or grep('\U0001F61C', this['ProcessCommandLine']) or grep('\U0001F92A', this['ProcessCommandLine'])\
    \ or grep('\U0001F928', this['ProcessCommandLine']) or grep('\U0001F9D0', this['ProcessCommandLine'])\
    \ or grep('\U0001F913', this['ProcessCommandLine']) or grep('\U0001F60E', this['ProcessCommandLine'])\
    \ or grep('\U0001F978', this['ProcessCommandLine']) or grep('\U0001F929', this['ProcessCommandLine'])\
    \ or grep('\U0001F973', this['ProcessCommandLine']) or grep('\U0001F60F', this['ProcessCommandLine'])\
    \ or grep('\U0001F612', this['ProcessCommandLine']) or grep('\U0001F61E', this['ProcessCommandLine'])\
    \ or grep('\U0001F614', this['ProcessCommandLine']) or grep('\U0001F61F', this['ProcessCommandLine'])\
    \ or grep('\U0001F615', this['ProcessCommandLine']) or grep('\U0001F641', this['ProcessCommandLine'])\
    \ or grep('\u2639\uFE0F', this['ProcessCommandLine']) or grep('\U0001F623', this['ProcessCommandLine'])\
    \ or grep('\U0001F616', this['ProcessCommandLine']) or grep('\U0001F62B', this['ProcessCommandLine'])\
    \ or grep('\U0001F629', this['ProcessCommandLine']) or grep('\U0001F97A', this['ProcessCommandLine'])\
    \ or grep('\U0001F622', this['ProcessCommandLine']) or grep('\U0001F62D', this['ProcessCommandLine'])\
    \ or grep('\U0001F62E\u200D\U0001F4A8', this['ProcessCommandLine']) or grep('\U0001F624\
    ', this['ProcessCommandLine']) or grep('\U0001F620', this['ProcessCommandLine'])\
    \ or grep('\U0001F621', this['ProcessCommandLine']) or grep('\U0001F92C', this['ProcessCommandLine'])\
    \ or grep('\U0001F92F', this['ProcessCommandLine']) or grep('\U0001F633', this['ProcessCommandLine'])\
    \ or grep('\U0001F975', this['ProcessCommandLine']) or grep('\U0001F976', this['ProcessCommandLine'])\
    \ or grep('\U0001F631', this['ProcessCommandLine']) or grep('\U0001F628', this['ProcessCommandLine'])\
    \ or grep('\U0001F630', this['ProcessCommandLine']) or grep('\U0001F625', this['ProcessCommandLine'])\
    \ or grep('\U0001F613', this['ProcessCommandLine']) or grep('\U0001FAE3', this['ProcessCommandLine'])\
    \ or grep('\U0001F917', this['ProcessCommandLine']) or grep('\U0001FAE1', this['ProcessCommandLine'])\
    \ or grep('\U0001F914', this['ProcessCommandLine']) or grep('\U0001FAE2', this['ProcessCommandLine'])\
    \ or grep('\U0001F92D', this['ProcessCommandLine']) or grep('\U0001F92B', this['ProcessCommandLine'])\
    \ or grep('\U0001F925', this['ProcessCommandLine']) or grep('\U0001F636', this['ProcessCommandLine'])\
    \ or grep('\U0001F636\u200D\U0001F32B\uFE0F', this['ProcessCommandLine']) or grep('\U0001F610\
    ', this['ProcessCommandLine']) or grep('\U0001F611', this['ProcessCommandLine'])\
    \ or grep('\U0001F62C', this['ProcessCommandLine']) or grep('\U0001FAE0', this['ProcessCommandLine'])\
    \ or grep('\U0001F644', this['ProcessCommandLine']) or grep('\U0001F62F', this['ProcessCommandLine'])\
    \ or grep('\U0001F626', this['ProcessCommandLine']) or grep('\U0001F627', this['ProcessCommandLine'])\
    \ or grep('\U0001F62E', this['ProcessCommandLine']) or grep('\U0001F632', this['ProcessCommandLine'])\
    \ or grep('\U0001F971', this['ProcessCommandLine']) or grep('\U0001F634', this['ProcessCommandLine'])\
    \ or grep('\U0001F924', this['ProcessCommandLine']) or grep('\U0001F62A', this['ProcessCommandLine'])\
    \ or grep('\U0001F635', this['ProcessCommandLine']) or grep('\U0001F635\u200D\U0001F4AB\
    ', this['ProcessCommandLine']) or grep('\U0001FAE5', this['ProcessCommandLine'])\
    \ or grep('\U0001F910', this['ProcessCommandLine']) or grep('\U0001F974', this['ProcessCommandLine'])\
    \ or grep('\U0001F922', this['ProcessCommandLine']) or grep('\U0001F92E', this['ProcessCommandLine'])\
    \ or grep('\U0001F927', this['ProcessCommandLine']) or grep('\U0001F637', this['ProcessCommandLine'])\
    \ or grep('\U0001F912', this['ProcessCommandLine']) or grep('\U0001F915', this['ProcessCommandLine'])\
    \ or grep('\U0001F911', this['ProcessCommandLine']) or grep('\U0001F920', this['ProcessCommandLine'])\
    \ or grep('\U0001F608', this['ProcessCommandLine']) or grep('\U0001F47F', this['ProcessCommandLine'])\
    \ or grep('\U0001F479', this['ProcessCommandLine']) or grep('\U0001F47A', this['ProcessCommandLine'])\
    \ or grep('\U0001F921', this['ProcessCommandLine']) or grep('\U0001F4A9', this['ProcessCommandLine'])\
    \ or grep('\U0001F47B', this['ProcessCommandLine']) or grep('\U0001F480', this['ProcessCommandLine'])\
    \ or grep('\u2620\uFE0F', this['ProcessCommandLine']) or grep('\U0001F47D', this['ProcessCommandLine'])\
    \ or grep('\U0001F47E', this['ProcessCommandLine']) or grep('\U0001F916', this['ProcessCommandLine'])\
    \ or grep('\U0001F383', this['ProcessCommandLine']) or grep('\U0001F63A', this['ProcessCommandLine'])\
    \ or grep('\U0001F638', this['ProcessCommandLine']) or grep('\U0001F639', this['ProcessCommandLine'])\
    \ or grep('\U0001F63B', this['ProcessCommandLine']) or grep('\U0001F63C', this['ProcessCommandLine'])\
    \ or grep('\U0001F63D', this['ProcessCommandLine']) or grep('\U0001F640', this['ProcessCommandLine'])\
    \ or grep('\U0001F63F', this['ProcessCommandLine']) or grep('\U0001F63E', this['ProcessCommandLine'])\
    \ or grep('\U0001F44B', this['ProcessCommandLine']) or grep('\U0001F91A', this['ProcessCommandLine'])\
    \ or grep('\U0001F590', this['ProcessCommandLine']) or grep('\u270B', this['ProcessCommandLine'])\
    \ or grep('\U0001F596', this['ProcessCommandLine']) or grep('\U0001F44C', this['ProcessCommandLine'])\
    \ or grep('\U0001F90C', this['ProcessCommandLine']) or grep('\U0001F90F', this['ProcessCommandLine'])\
    \ or grep('\u270C\uFE0F', this['ProcessCommandLine']) or grep('\U0001F91E', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF0', this['ProcessCommandLine']) or grep('\U0001F91F', this['ProcessCommandLine'])\
    \ or grep('\U0001F918', this['ProcessCommandLine']) or grep('\U0001F919', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF5', this['ProcessCommandLine']) or grep('\U0001FAF1', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF2', this['ProcessCommandLine']) or grep('\U0001FAF3', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF4', this['ProcessCommandLine']) or grep('\U0001F448', this['ProcessCommandLine'])\
    \ or grep('\U0001F449', this['ProcessCommandLine']) or grep('\U0001F446', this['ProcessCommandLine'])\
    \ or grep('\U0001F595', this['ProcessCommandLine']) or grep('\U0001F447', this['ProcessCommandLine'])\
    \ or grep('\u261D\uFE0F', this['ProcessCommandLine']) or grep('\U0001F44D', this['ProcessCommandLine'])\
    \ or grep('\U0001F44E', this['ProcessCommandLine']) or grep('\u270A', this['ProcessCommandLine'])\
    \ or grep('\U0001F44A', this['ProcessCommandLine']) or grep('\U0001F91B', this['ProcessCommandLine'])\
    \ or grep('\U0001F91C', this['ProcessCommandLine']) or grep('\U0001F44F', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF6', this['ProcessCommandLine']) or grep('\U0001F64C', this['ProcessCommandLine'])\
    \ or grep('\U0001F450', this['ProcessCommandLine']) or grep('\U0001F932', this['ProcessCommandLine'])\
    \ or grep('\U0001F91D', this['ProcessCommandLine']) or grep('\U0001F64F', this['ProcessCommandLine'])\
    \ or grep('\u270D\uFE0F', this['ProcessCommandLine']) or grep('\U0001F4AA', this['ProcessCommandLine'])\
    \ or grep('\U0001F9BE', this['ProcessCommandLine']) or grep('\U0001F9B5', this['ProcessCommandLine'])\
    \ or grep('\U0001F9BF', this['ProcessCommandLine']) or grep('\U0001F9B6', this['ProcessCommandLine'])\
    \ or grep('\U0001F463', this['ProcessCommandLine']) or grep('\U0001F442', this['ProcessCommandLine'])\
    \ or grep('\U0001F9BB', this['ProcessCommandLine']) or grep('\U0001F443', this['ProcessCommandLine'])\
    \ or grep('\U0001FAC0', this['ProcessCommandLine']) or grep('\U0001FAC1', this['ProcessCommandLine'])\
    \ or grep('\U0001F9E0', this['ProcessCommandLine']) or grep('\U0001F9B7', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B4', this['ProcessCommandLine']) or grep('\U0001F440', this['ProcessCommandLine'])\
    \ or grep('\U0001F441', this['ProcessCommandLine']) or grep('\U0001F445', this['ProcessCommandLine'])\
    \ or grep('\U0001F444', this['ProcessCommandLine']) or grep('\U0001FAE6', this['ProcessCommandLine'])\
    \ or grep('\U0001F48B', this['ProcessCommandLine']) or grep('\U0001FA78', this['ProcessCommandLine'])\
    \ or grep('\U0001F476', this['ProcessCommandLine']) or grep('\U0001F467', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D2', this['ProcessCommandLine']) or grep('\U0001F466', this['ProcessCommandLine'])\
    \ or grep('\U0001F469', this['ProcessCommandLine']) or grep('\U0001F9D1', this['ProcessCommandLine'])\
    \ or grep('\U0001F468', this['ProcessCommandLine']) or grep('\U0001F469\u200D\U0001F9B1\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\u200D\U0001F9B1', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\u200D\U0001F9B1', this['ProcessCommandLine']) or grep('\U0001F469\
    \u200D\U0001F9B0', this['ProcessCommandLine']) or grep('\U0001F9D1\u200D\U0001F9B0\
    ', this['ProcessCommandLine']) or grep('\U0001F468\u200D\U0001F9B0', this['ProcessCommandLine'])\
    \ or grep('\U0001F471\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F471\
    ', this['ProcessCommandLine']) or grep('\U0001F471\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\u200D\U0001F9B3', this['ProcessCommandLine']) or grep('\U0001F9D1\
    \u200D\U0001F9B3', this['ProcessCommandLine']) or grep('\U0001F468\u200D\U0001F9B3\
    ', this['ProcessCommandLine']) or grep('\U0001F469\u200D\U0001F9B2', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\u200D\U0001F9B2', this['ProcessCommandLine']) or grep('\U0001F468\
    \u200D\U0001F9B2', this['ProcessCommandLine']) or grep('\U0001F9D4\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D4', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D4\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F475\
    ', this['ProcessCommandLine']) or grep('\U0001F9D3', this['ProcessCommandLine'])\
    \ or grep('\U0001F474', this['ProcessCommandLine']) or grep('\U0001F472', this['ProcessCommandLine'])\
    \ or grep('\U0001F473\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F473\
    ', this['ProcessCommandLine']) or grep('\U0001F473\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D5', this['ProcessCommandLine']) or grep('\U0001F46E\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F46E', this['ProcessCommandLine'])\
    \ or grep('\U0001F46E\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F477\
    \u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F477', this['ProcessCommandLine'])\
    \ or grep('\U0001F477\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F482\
    \u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F482', this['ProcessCommandLine'])\
    \ or grep('\U0001F482\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F575\
    \uFE0F\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F575\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F575\uFE0F\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\u200D\u2695\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D1\
    \u200D\u2695\uFE0F', this['ProcessCommandLine']) or grep('\U0001F468\u200D\u2695\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F469\u200D\U0001F33E', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\u200D\U0001F33E', this['ProcessCommandLine']) or grep('\U0001F468\
    \u200D\U0001F33E', this['ProcessCommandLine']) or grep('\U0001F469\u200D\U0001F373\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\u200D\U0001F373', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\u200D\U0001F373', this['ProcessCommandLine']) or grep('\U0001F469\
    \u200D\U0001F393', this['ProcessCommandLine']) or grep('\U0001F9D1\u200D\U0001F393\
    ', this['ProcessCommandLine']) or grep('\U0001F468\u200D\U0001F393', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\u200D\U0001F3A4', this['ProcessCommandLine']) or grep('\U0001F9D1\
    \u200D\U0001F3A4', this['ProcessCommandLine']) or grep('\U0001F468\u200D\U0001F3A4\
    ', this['ProcessCommandLine']) or grep('\U0001F469\u200D\U0001F3EB', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\u200D\U0001F3EB', this['ProcessCommandLine']) or grep('\U0001F468\
    \u200D\U0001F3EB', this['ProcessCommandLine']) or grep('\U0001F469\u200D\U0001F3ED\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\u200D\U0001F3ED', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\u200D\U0001F3ED', this['ProcessCommandLine']) or grep('\U0001F469\
    \u200D\U0001F4BB', this['ProcessCommandLine']) or grep('\U0001F9D1\u200D\U0001F4BB\
    ', this['ProcessCommandLine']) or grep('\U0001F468\u200D\U0001F4BB', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\u200D\U0001F4BC', this['ProcessCommandLine']) or grep('\U0001F9D1\
    \u200D\U0001F4BC', this['ProcessCommandLine']) or grep('\U0001F468\u200D\U0001F4BC\
    ', this['ProcessCommandLine']) or grep('\U0001F469\u200D\U0001F527', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\u200D\U0001F527', this['ProcessCommandLine']) or grep('\U0001F468\
    \u200D\U0001F527', this['ProcessCommandLine']) or grep('\U0001F469\u200D\U0001F52C\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\u200D\U0001F52C', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\u200D\U0001F52C', this['ProcessCommandLine']) or grep('\U0001F469\
    \u200D\U0001F3A8', this['ProcessCommandLine']) or grep('\U0001F9D1\u200D\U0001F3A8\
    ', this['ProcessCommandLine']) or grep('\U0001F468\u200D\U0001F3A8', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\u200D\U0001F692', this['ProcessCommandLine']) or grep('\U0001F9D1\
    \u200D\U0001F692', this['ProcessCommandLine']) or grep('\U0001F468\u200D\U0001F692\
    ', this['ProcessCommandLine']) or grep('\U0001F469\u200D\u2708\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\u200D\u2708\uFE0F', this['ProcessCommandLine']) or grep('\U0001F468\
    \u200D\u2708\uFE0F', this['ProcessCommandLine']) or grep('\U0001F469\u200D\U0001F680\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\u200D\U0001F680', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\u200D\U0001F680', this['ProcessCommandLine']) or grep('\U0001F469\
    \u200D\u2696\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D1\u200D\u2696\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F468\u200D\u2696\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F470\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F470\
    ', this['ProcessCommandLine']) or grep('\U0001F470\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F935\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F935\
    ', this['ProcessCommandLine']) or grep('\U0001F935\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F478', this['ProcessCommandLine']) or grep('\U0001FAC5', this['ProcessCommandLine'])\
    \ or grep('\U0001F934', this['ProcessCommandLine']) or grep('\U0001F977', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B8\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9B8\
    ', this['ProcessCommandLine']) or grep('\U0001F9B8\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B9\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9B9\
    ', this['ProcessCommandLine']) or grep('\U0001F9B9\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F936', this['ProcessCommandLine']) or grep('\U0001F9D1\u200D\U0001F384\
    ', this['ProcessCommandLine']) or grep('\U0001F385', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D9\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D9\
    ', this['ProcessCommandLine']) or grep('\U0001F9D9\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DD\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DD\
    ', this['ProcessCommandLine']) or grep('\U0001F9DD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DB\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DB\
    ', this['ProcessCommandLine']) or grep('\U0001F9DB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DF\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DF\
    ', this['ProcessCommandLine']) or grep('\U0001F9DF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DE\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DE\
    ', this['ProcessCommandLine']) or grep('\U0001F9DE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DC\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DC\
    ', this['ProcessCommandLine']) or grep('\U0001F9DC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DA\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DA\
    ', this['ProcessCommandLine']) or grep('\U0001F9DA\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9CC', this['ProcessCommandLine']) or grep('\U0001F47C', this['ProcessCommandLine'])\
    \ or grep('\U0001F930', this['ProcessCommandLine']) or grep('\U0001FAC4', this['ProcessCommandLine'])\
    \ or grep('\U0001FAC3', this['ProcessCommandLine']) or grep('\U0001F931', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\u200D\U0001F37C', this['ProcessCommandLine']) or grep('\U0001F9D1\
    \u200D\U0001F37C', this['ProcessCommandLine']) or grep('\U0001F468\u200D\U0001F37C\
    ', this['ProcessCommandLine']) or grep('\U0001F647\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F647', this['ProcessCommandLine']) or grep('\U0001F647\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F481\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F481', this['ProcessCommandLine']) or grep('\U0001F481\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F645\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F645', this['ProcessCommandLine']) or grep('\U0001F645\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F646\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F646', this['ProcessCommandLine']) or grep('\U0001F646\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F64B\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F64B', this['ProcessCommandLine']) or grep('\U0001F64B\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CF\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9CF', this['ProcessCommandLine']) or grep('\U0001F9CF\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F926\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F926', this['ProcessCommandLine']) or grep('\U0001F926\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F937\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F937', this['ProcessCommandLine']) or grep('\U0001F937\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F64E\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F64E', this['ProcessCommandLine']) or grep('\U0001F64E\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F64D\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F64D', this['ProcessCommandLine']) or grep('\U0001F64D\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F487\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F487', this['ProcessCommandLine']) or grep('\U0001F487\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F486\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F486', this['ProcessCommandLine']) or grep('\U0001F486\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D6\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D6', this['ProcessCommandLine']) or grep('\U0001F9D6\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F485', this['ProcessCommandLine'])\
    \ or grep('\U0001F483', this['ProcessCommandLine']) or grep('\U0001F57A', this['ProcessCommandLine'])\
    \ or grep('\U0001F46F\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F46F\
    ', this['ProcessCommandLine']) or grep('\U0001F46F\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F574', this['ProcessCommandLine']) or grep('\U0001F469\u200D\U0001F9BD\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\u200D\U0001F9BD', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\u200D\U0001F9BD', this['ProcessCommandLine']) or grep('\U0001F469\
    \u200D\U0001F9BC', this['ProcessCommandLine']) or grep('\U0001F9D1\u200D\U0001F9BC\
    ', this['ProcessCommandLine']) or grep('\U0001F468\u200D\U0001F9BC', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B6\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6B6\
    ', this['ProcessCommandLine']) or grep('\U0001F6B6\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\u200D\U0001F9AF', this['ProcessCommandLine']) or grep('\U0001F9D1\
    \u200D\U0001F9AF', this['ProcessCommandLine']) or grep('\U0001F468\u200D\U0001F9AF\
    ', this['ProcessCommandLine']) or grep('\U0001F9CE\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9CE', this['ProcessCommandLine']) or grep('\U0001F9CE\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F3C3\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C3', this['ProcessCommandLine']) or grep('\U0001F3C3\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CD\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9CD', this['ProcessCommandLine']) or grep('\U0001F9CD\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F46D', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\u200D\U0001F91D\u200D\U0001F9D1', this['ProcessCommandLine'])\
    \ or grep('\U0001F46C', this['ProcessCommandLine']) or grep('\U0001F46B', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\u200D\u2764\uFE0F\u200D\U0001F469', this['ProcessCommandLine'])\
    \ or grep('\U0001F491', this['ProcessCommandLine']) or grep('\U0001F468\u200D\u2764\
    \uFE0F\u200D\U0001F468', this['ProcessCommandLine']) or grep('\U0001F469\u200D\
    \u2764\uFE0F\u200D\U0001F468', this['ProcessCommandLine']) or grep('\U0001F469\
    \u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F469', this['ProcessCommandLine'])\
    \ or grep('\U0001F48F', this['ProcessCommandLine']) or grep('\U0001F468\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468', this['ProcessCommandLine']) or grep('\U0001F469\
    \u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468', this['ProcessCommandLine'])\
    \ or grep('\U0001F46A', this['ProcessCommandLine']) or grep('\U0001F468\u200D\U0001F469\
    \u200D\U0001F466', this['ProcessCommandLine']) or grep('\U0001F468\u200D\U0001F469\
    \u200D\U0001F467', this['ProcessCommandLine']) or grep('\U0001F468\u200D\U0001F469\
    \u200D\U0001F467\u200D\U0001F466', this['ProcessCommandLine']) or grep('\U0001F468\
    \u200D\U0001F469\u200D\U0001F466\u200D\U0001F466', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\u200D\U0001F469\u200D\U0001F467\u200D\U0001F467', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\u200D\U0001F468\u200D\U0001F466', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\u200D\U0001F468\u200D\U0001F467', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\u200D\U0001F468\u200D\U0001F467\u200D\U0001F466', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\u200D\U0001F468\u200D\U0001F466\u200D\U0001F466', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\u200D\U0001F468\u200D\U0001F467\u200D\U0001F467', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\u200D\U0001F469\u200D\U0001F466', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\u200D\U0001F469\u200D\U0001F467', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\u200D\U0001F469\u200D\U0001F467\u200D\U0001F466', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\u200D\U0001F469\u200D\U0001F466\u200D\U0001F466', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\u200D\U0001F469\u200D\U0001F467\u200D\U0001F467', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\u200D\U0001F466', this['ProcessCommandLine']) or grep('\U0001F468\
    \u200D\U0001F466\u200D\U0001F466', this['ProcessCommandLine']) or grep('\U0001F468\
    \u200D\U0001F467', this['ProcessCommandLine']) or grep('\U0001F468\u200D\U0001F467\
    \u200D\U0001F466', this['ProcessCommandLine']) or grep('\U0001F468\u200D\U0001F467\
    \u200D\U0001F467', this['ProcessCommandLine']) or grep('\U0001F469\u200D\U0001F466\
    ', this['ProcessCommandLine']) or grep('\U0001F469\u200D\U0001F466\u200D\U0001F466\
    ', this['ProcessCommandLine']) or grep('\U0001F469\u200D\U0001F467', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\u200D\U0001F467\u200D\U0001F466', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\u200D\U0001F467\u200D\U0001F467', this['ProcessCommandLine'])\
    \ or grep('\U0001F5E3', this['ProcessCommandLine']) or grep('\U0001F464', this['ProcessCommandLine'])\
    \ or grep('\U0001F465', this['ProcessCommandLine']) or grep('\U0001FAC2', this['ProcessCommandLine'])\
    \ or grep('\U0001F9F3', this['ProcessCommandLine']) or grep('\U0001F302', this['ProcessCommandLine'])\
    \ or grep('\u2602\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9F5', this['ProcessCommandLine'])\
    \ or grep('\U0001FAA1', this['ProcessCommandLine']) or grep('\U0001FAA2', this['ProcessCommandLine'])\
    \ or grep('\U0001F9F6', this['ProcessCommandLine']) or grep('\U0001F453', this['ProcessCommandLine'])\
    \ or grep('\U0001F576', this['ProcessCommandLine']) or grep('\U0001F97D', this['ProcessCommandLine'])\
    \ or grep('\U0001F97C', this['ProcessCommandLine']) or grep('\U0001F9BA', this['ProcessCommandLine'])\
    \ or grep('\U0001F454', this['ProcessCommandLine']) or grep('\U0001F455', this['ProcessCommandLine'])\
    \ or grep('\U0001F456', this['ProcessCommandLine']) or grep('\U0001F9E3', this['ProcessCommandLine'])\
    \ or grep('\U0001F9E4', this['ProcessCommandLine']) or grep('\U0001F9E5', this['ProcessCommandLine'])\
    \ or grep('\U0001F9E6', this['ProcessCommandLine']) or grep('\U0001F457', this['ProcessCommandLine'])\
    \ or grep('\U0001F458', this['ProcessCommandLine']) or grep('\U0001F97B', this['ProcessCommandLine'])\
    \ or grep('\U0001FA74', this['ProcessCommandLine']) or grep('\U0001FA71', this['ProcessCommandLine'])\
    \ or grep('\U0001FA72', this['ProcessCommandLine']) or grep('\U0001FA73', this['ProcessCommandLine'])\
    \ or grep('\U0001F459', this['ProcessCommandLine']) or grep('\U0001F45A', this['ProcessCommandLine'])\
    \ or grep('\U0001F45B', this['ProcessCommandLine']) or grep('\U0001F45C', this['ProcessCommandLine'])\
    \ or grep('\U0001F45D', this['ProcessCommandLine']) or grep('\U0001F392', this['ProcessCommandLine'])\
    \ or grep('\U0001F45E', this['ProcessCommandLine']) or grep('\U0001F45F', this['ProcessCommandLine'])\
    \ or grep('\U0001F97E', this['ProcessCommandLine']) or grep('\U0001F97F', this['ProcessCommandLine'])\
    \ or grep('\U0001F460', this['ProcessCommandLine']) or grep('\U0001F461', this['ProcessCommandLine'])\
    \ or grep('\U0001FA70', this['ProcessCommandLine']) or grep('\U0001F462', this['ProcessCommandLine'])\
    \ or grep('\U0001F451', this['ProcessCommandLine']) or grep('\U0001F452', this['ProcessCommandLine'])\
    \ or grep('\U0001F3A9', this['ProcessCommandLine']) or grep('\U0001F393', this['ProcessCommandLine'])\
    \ or grep('\U0001F9E2', this['ProcessCommandLine']) or grep('\u26D1', this['ProcessCommandLine'])\
    \ or grep('\U0001FA96', this['ProcessCommandLine']) or grep('\U0001F484', this['ProcessCommandLine'])\
    \ or grep('\U0001F48D', this['ProcessCommandLine']) or grep('\U0001F4BC', this['ProcessCommandLine'])\
    \ or grep('\U0001F44B\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F91A\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F590\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\u270B\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F596\U0001F3FB\
    ', this['ProcessCommandLine']) or grep('\U0001F44C\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F90C\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F90F\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\u270C\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F91E\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001FAF0\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F91F\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F918\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F919\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001FAF5\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF1\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001FAF2\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001FAF3\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF4\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F448\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F449\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F446\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F595\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F447\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\u261D\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F44D\U0001F3FB\
    ', this['ProcessCommandLine']) or grep('\U0001F44E\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\u270A\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F44A\U0001F3FB\
    ', this['ProcessCommandLine']) or grep('\U0001F91B\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F91C\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F44F\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001FAF6\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F64C\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F450\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F932\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F64F\U0001F3FB', this['ProcessCommandLine']) or grep('\u270D\U0001F3FB\
    ', this['ProcessCommandLine']) or grep('\U0001F4AA\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B5\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F9B6\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F442\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F9BB\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F443\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F476\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F467\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F9D2\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F466\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F9D1\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FB\u200D\U0001F9B1', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FB\u200D\U0001F9B1', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FB\u200D\U0001F9B1', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FB\u200D\U0001F9B0', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FB\u200D\U0001F9B0', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FB\u200D\U0001F9B0', this['ProcessCommandLine'])\
    \ or grep('\U0001F471\U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F471\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F471\
    \U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F469\
    \U0001F3FB\u200D\U0001F9B3', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\
    \u200D\U0001F9B3', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\
    \U0001F9B3', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\U0001F9B2\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\U0001F9B2',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\U0001F9B2',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D4\U0001F3FB\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9D4\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D4\U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F475\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F9D3\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F474\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F472\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F473\
    \U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F473\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F473\U0001F3FB\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D5\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F46E\U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F46E\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F46E\
    \U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F477\
    \U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F477\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F477\U0001F3FB\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F482\U0001F3FB\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F482\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F482\U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F575\U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F575\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F575\
    \U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F469\
    \U0001F3FB\u200D\u2695\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D1\
    \U0001F3FB\u200D\u2695\uFE0F', this['ProcessCommandLine']) or grep('\U0001F468\
    \U0001F3FB\u200D\u2695\uFE0F', this['ProcessCommandLine']) or grep('\U0001F469\
    \U0001F3FB\u200D\U0001F33E', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\
    \u200D\U0001F33E', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\
    \U0001F33E', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\U0001F373\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\U0001F373',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\U0001F373',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\U0001F393',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\U0001F393',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\U0001F393',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\U0001F3A4',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\U0001F3A4',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\U0001F3A4',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\U0001F3EB',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\U0001F3EB',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\U0001F3EB',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\U0001F3ED',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\U0001F3ED',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\U0001F3ED',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\U0001F4BB',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\U0001F4BB',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\U0001F4BB',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\U0001F4BC',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\U0001F4BC',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\U0001F4BC',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\U0001F527',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\U0001F527',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\U0001F527',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\U0001F52C',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\U0001F52C',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\U0001F52C',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\U0001F3A8',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\U0001F3A8',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\U0001F3A8',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\U0001F692',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\U0001F692',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\U0001F692',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\u2708\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\u2708\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\u2708\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\U0001F680',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\U0001F680',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\U0001F680',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\u2696\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\u2696\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\u2696\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F470\U0001F3FB\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F470\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F470\U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F935\U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F935\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F935\
    \U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F478\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001FAC5\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F934\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F977\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F9B8\U0001F3FB\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9B8\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B8\U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B9\U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B9\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F9B9\
    \U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F936\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\U0001F384\
    ', this['ProcessCommandLine']) or grep('\U0001F385\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D9\U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D9\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F9D9\
    \U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DD\
    \U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DD\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F9DD\U0001F3FB\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DB\U0001F3FB\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DB\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DB\U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DC\U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DC\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F9DC\
    \U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DA\
    \U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DA\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F9DA\U0001F3FB\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F47C\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F930\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001FAC4\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001FAC3\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F931\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F469\
    \U0001F3FB\u200D\U0001F37C', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\
    \u200D\U0001F37C', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\
    \U0001F37C', this['ProcessCommandLine']) or grep('\U0001F647\U0001F3FB\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F647\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F647\U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F481\U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F481\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F481\
    \U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F645\
    \U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F645\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F645\U0001F3FB\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F646\U0001F3FB\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F646\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F646\U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F64B\U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F64B\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F64B\
    \U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CF\
    \U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CF\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F9CF\U0001F3FB\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F926\U0001F3FB\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F926\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F926\U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F937\U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F937\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F937\
    \U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F64E\
    \U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F64E\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F64E\U0001F3FB\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F64D\U0001F3FB\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F64D\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F64D\U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F487\U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F487\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F487\
    \U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F486\
    \U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F486\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F486\U0001F3FB\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D6\U0001F3FB\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D6\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D6\U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F483\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F57A\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F574\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FB\u200D\U0001F9BD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FB\u200D\U0001F9BD', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FB\u200D\U0001F9BD', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FB\u200D\U0001F9BC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FB\u200D\U0001F9BC', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FB\u200D\U0001F9BC', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B6\U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B6\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F6B6\
    \U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F469\
    \U0001F3FB\u200D\U0001F9AF', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\
    \u200D\U0001F9AF', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\
    \U0001F9AF', this['ProcessCommandLine']) or grep('\U0001F9CE\U0001F3FB\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CE\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F9CE\U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C3\U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C3\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F3C3\
    \U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CD\
    \U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CD\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F9CD\U0001F3FB\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F46D\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FB\u200D\U0001F91D\u200D\U0001F9D1\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F46C\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F46B\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F9D7\U0001F3FB\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D7\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D7\U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C7\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F3C2\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F3CC\U0001F3FB\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CC\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F3CC\U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C4\U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C4\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F3C4\
    \U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6A3\
    \U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6A3\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F6A3\U0001F3FB\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CA\U0001F3FB\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CA\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F3CA\U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u26F9\U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine']) or\
    \ grep('\u26F9\U0001F3FB', this['ProcessCommandLine']) or grep('\u26F9\U0001F3FB\
    \u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CB\U0001F3FB\
    \u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CB\U0001F3FB\
    ', this['ProcessCommandLine']) or grep('\U0001F3CB\U0001F3FB\u200D\u2642\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F6B4\U0001F3FB\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F6B4\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B4\U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B5\U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B5\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F6B5\
    \U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F938\
    \U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F938\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F938\U0001F3FB\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F93D\U0001F3FB\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F93D\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F93D\U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F93E\U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F93E\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F93E\
    \U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F939\
    \U0001F3FB\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F939\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F939\U0001F3FB\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D8\U0001F3FB\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D8\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D8\U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6C0\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F6CC\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F44B\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F91A\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F590\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\u270B\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F596\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F44C\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F90C\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F90F\U0001F3FC', this['ProcessCommandLine']) or grep('\u270C\U0001F3FC\
    ', this['ProcessCommandLine']) or grep('\U0001F91E\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF0\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F91F\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F918\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F919\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001FAF5\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF2\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001FAF3\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001FAF4\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F448\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F449\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F446\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F595\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F447\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\u261D\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F44D\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F44E\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\u270A\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F44A\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F91B\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F91C\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F44F\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001FAF6\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F64C\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F450\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F932\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F64F\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\u270D\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F4AA\U0001F3FC\
    ', this['ProcessCommandLine']) or grep('\U0001F9B5\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B6\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F442\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F9BB\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F443\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F476\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F467\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D2\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F466\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F468\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\U0001F9B1\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\U0001F9B1',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\U0001F9B1',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\U0001F9B0',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\U0001F9B0',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\U0001F9B0',\
    \ this['ProcessCommandLine']) or grep('\U0001F471\U0001F3FC\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F471\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F471\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FC\u200D\U0001F9B3', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FC\u200D\U0001F9B3', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FC\u200D\U0001F9B3', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FC\u200D\U0001F9B2', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FC\u200D\U0001F9B2', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FC\u200D\U0001F9B2', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D4\U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D4\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F9D4\
    \U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F475\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F9D3\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F474\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F472\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F473\U0001F3FC\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F473\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F473\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D5\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F46E\
    \U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F46E\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F46E\U0001F3FC\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F477\U0001F3FC\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F477\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F477\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F482\U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F482\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F482\
    \U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F575\
    \U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F575\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F575\U0001F3FC\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\u2695\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\u2695\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\u2695\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\U0001F33E\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\U0001F33E',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\U0001F33E',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\U0001F373',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\U0001F373',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\U0001F373',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\U0001F393',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\U0001F393',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\U0001F393',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\U0001F3A4',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\U0001F3A4',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\U0001F3A4',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\U0001F3EB',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\U0001F3EB',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\U0001F3EB',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\U0001F3ED',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\U0001F3ED',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\U0001F3ED',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\U0001F4BB',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\U0001F4BB',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\U0001F4BB',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\U0001F4BC',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\U0001F4BC',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\U0001F4BC',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\U0001F527',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\U0001F527',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\U0001F527',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\U0001F52C',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\U0001F52C',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\U0001F52C',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\U0001F3A8',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\U0001F3A8',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\U0001F3A8',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\U0001F692',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\U0001F692',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\U0001F692',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\u2708\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\u2708\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\u2708\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\U0001F680',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\U0001F680',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\U0001F680',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\u2696\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\u2696\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\u2696\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F470\U0001F3FC\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F470\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F470\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F935\U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F935\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F935\
    \U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F478\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001FAC5\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F934\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F977\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F9B8\U0001F3FC\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9B8\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B8\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B9\U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B9\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F9B9\
    \U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F936\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\U0001F384\
    ', this['ProcessCommandLine']) or grep('\U0001F385\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D9\U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D9\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F9D9\
    \U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DD\
    \U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DD\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F9DD\U0001F3FC\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DB\U0001F3FC\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DB\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DB\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DC\U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DC\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F9DC\
    \U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DA\
    \U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DA\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F9DA\U0001F3FC\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F47C\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F930\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001FAC4\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001FAC3\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F931\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F469\
    \U0001F3FC\u200D\U0001F37C', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\
    \u200D\U0001F37C', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\
    \U0001F37C', this['ProcessCommandLine']) or grep('\U0001F647\U0001F3FC\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F647\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F647\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F481\U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F481\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F481\
    \U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F645\
    \U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F645\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F645\U0001F3FC\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F646\U0001F3FC\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F646\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F646\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F64B\U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F64B\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F64B\
    \U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CF\
    \U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CF\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F9CF\U0001F3FC\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F926\U0001F3FC\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F926\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F926\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F937\U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine'])"
  sigma_id: 4a30ac0c-b9d6-4e01-b71a-5f851bbf4259
- name: Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 2
  query: "grep('\U0001F937\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F937\
    \U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F64E\
    \U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F64E\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F64E\U0001F3FC\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F64D\U0001F3FC\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F64D\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F64D\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F487\U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F487\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F487\
    \U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F486\
    \U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F486\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F486\U0001F3FC\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D6\U0001F3FC\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D6\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D6\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F483\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F57A\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F574\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FC\u200D\U0001F9BD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FC\u200D\U0001F9BD', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FC\u200D\U0001F9BD', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FC\u200D\U0001F9BC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FC\u200D\U0001F9BC', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FC\u200D\U0001F9BC', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B6\U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B6\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F6B6\
    \U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F469\
    \U0001F3FC\u200D\U0001F9AF', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\
    \u200D\U0001F9AF', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\
    \U0001F9AF', this['ProcessCommandLine']) or grep('\U0001F9CE\U0001F3FC\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CE\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9CE\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C3\U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C3\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F3C3\
    \U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CD\
    \U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CD\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F9CD\U0001F3FC\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F46D\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FC\u200D\U0001F91D\u200D\U0001F9D1\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F46C\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F46B\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F9D7\U0001F3FC\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D7\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D7\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C7\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F3C2\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F3CC\U0001F3FC\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CC\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F3CC\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C4\U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C4\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F3C4\
    \U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6A3\
    \U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6A3\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F6A3\U0001F3FC\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CA\U0001F3FC\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CA\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F3CA\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u26F9\U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine']) or\
    \ grep('\u26F9\U0001F3FC', this['ProcessCommandLine']) or grep('\u26F9\U0001F3FC\
    \u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CB\U0001F3FC\
    \u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CB\U0001F3FC\
    ', this['ProcessCommandLine']) or grep('\U0001F3CB\U0001F3FC\u200D\u2642\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F6B4\U0001F3FC\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F6B4\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B4\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B5\U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B5\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F6B5\
    \U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F938\
    \U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F938\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F938\U0001F3FC\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F93D\U0001F3FC\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F93D\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F93D\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F93E\U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F93E\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F93E\
    \U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F939\
    \U0001F3FC\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F939\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F939\U0001F3FC\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D8\U0001F3FC\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D8\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D8\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6C0\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F6CC\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F44B\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F91A\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F590\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\u270B\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F596\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F44C\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F90C\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F90F\U0001F3FD', this['ProcessCommandLine']) or grep('\u270C\U0001F3FD\
    ', this['ProcessCommandLine']) or grep('\U0001F91E\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF0\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F91F\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F918\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F919\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAF5\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF2\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAF3\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAF4\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F448\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F449\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F446\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F595\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F447\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\u261D\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F44D\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F44E\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\u270A\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F44A\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F91B\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F91C\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F44F\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAF6\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F64C\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F450\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F932\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F64F\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\u270D\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F4AA\U0001F3FD\
    ', this['ProcessCommandLine']) or grep('\U0001F9B5\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B6\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F442\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F9BB\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F443\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F476\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F467\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D2\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F466\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F468\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\U0001F9B1\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\U0001F9B1',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\U0001F9B1',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\U0001F9B0',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\U0001F9B0',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\U0001F9B0',\
    \ this['ProcessCommandLine']) or grep('\U0001F471\U0001F3FD\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F471\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F471\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FD\u200D\U0001F9B3', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FD\u200D\U0001F9B3', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FD\u200D\U0001F9B3', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FD\u200D\U0001F9B2', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FD\u200D\U0001F9B2', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FD\u200D\U0001F9B2', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D4\U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D4\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F9D4\
    \U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F475\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F9D3\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F474\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F472\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F473\U0001F3FD\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F473\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F473\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D5\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F46E\
    \U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F46E\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F46E\U0001F3FD\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F477\U0001F3FD\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F477\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F477\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F482\U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F482\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F482\
    \U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F575\
    \U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F575\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F575\U0001F3FD\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\u2695\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\u2695\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\u2695\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\U0001F33E\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\U0001F33E',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\U0001F33E',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\U0001F373',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\U0001F373',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\U0001F373',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\U0001F393',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\U0001F393',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\U0001F393',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\U0001F3A4',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\U0001F3A4',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\U0001F3A4',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\U0001F3EB',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\U0001F3EB',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\U0001F3EB',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\U0001F3ED',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\U0001F3ED',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\U0001F3ED',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\U0001F4BB',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\U0001F4BB',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\U0001F4BB',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\U0001F4BC',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\U0001F4BC',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\U0001F4BC',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\U0001F527',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\U0001F527',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\U0001F527',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\U0001F52C',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\U0001F52C',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\U0001F52C',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\U0001F3A8',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\U0001F3A8',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\U0001F3A8',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\U0001F692',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\U0001F692',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\U0001F692',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\u2708\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\u2708\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\u2708\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\U0001F680',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\U0001F680',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\U0001F680',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\u2696\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\u2696\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\u2696\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F470\U0001F3FD\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F470\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F470\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F935\U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F935\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F935\
    \U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F478\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAC5\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F934\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F977\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F9B8\U0001F3FD\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9B8\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B8\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B9\U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B9\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F9B9\
    \U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F936\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\U0001F384\
    ', this['ProcessCommandLine']) or grep('\U0001F385\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D9\U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D9\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F9D9\
    \U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DD\
    \U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DD\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F9DD\U0001F3FD\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DB\U0001F3FD\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DB\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DB\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DC\U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DC\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F9DC\
    \U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DA\
    \U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DA\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F9DA\U0001F3FD\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F47C\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F930\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAC4\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAC3\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F931\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F469\
    \U0001F3FD\u200D\U0001F37C', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\
    \u200D\U0001F37C', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\
    \U0001F37C', this['ProcessCommandLine']) or grep('\U0001F647\U0001F3FD\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F647\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F647\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F481\U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F481\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F481\
    \U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F645\
    \U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F645\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F645\U0001F3FD\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F646\U0001F3FD\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F646\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F646\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F64B\U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F64B\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F64B\
    \U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CF\
    \U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CF\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F9CF\U0001F3FD\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F926\U0001F3FD\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F926\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F926\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F937\U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F937\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F937\
    \U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F64E\
    \U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F64E\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F64E\U0001F3FD\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F64D\U0001F3FD\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F64D\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F64D\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F487\U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F487\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F487\
    \U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F486\
    \U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F486\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F486\U0001F3FD\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D6\U0001F3FD\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D6\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D6\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F483\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F57A\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F574\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FD\u200D\U0001F9BD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FD\u200D\U0001F9BD', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FD\u200D\U0001F9BD', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FD\u200D\U0001F9BC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FD\u200D\U0001F9BC', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FD\u200D\U0001F9BC', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B6\U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B6\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F6B6\
    \U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F469\
    \U0001F3FD\u200D\U0001F9AF', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\
    \u200D\U0001F9AF', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\
    \U0001F9AF', this['ProcessCommandLine']) or grep('\U0001F9CE\U0001F3FD\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CE\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9CE\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C3\U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C3\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F3C3\
    \U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CD\
    \U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CD\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F9CD\U0001F3FD\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F46D\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FD\u200D\U0001F91D\u200D\U0001F9D1\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F46C\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F46B\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F9D7\U0001F3FD\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D7\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D7\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C7\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F3C2\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F3CC\U0001F3FD\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CC\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F3CC\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C4\U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C4\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F3C4\
    \U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6A3\
    \U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6A3\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F6A3\U0001F3FD\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CA\U0001F3FD\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CA\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F3CA\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u26F9\U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine']) or\
    \ grep('\u26F9\U0001F3FD', this['ProcessCommandLine']) or grep('\u26F9\U0001F3FD\
    \u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CB\U0001F3FD\
    \u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CB\U0001F3FD\
    ', this['ProcessCommandLine']) or grep('\U0001F3CB\U0001F3FD\u200D\u2642\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F6B4\U0001F3FD\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F6B4\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B4\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B5\U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B5\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F6B5\
    \U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F938\
    \U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F938\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F938\U0001F3FD\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F93D\U0001F3FD\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F93D\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F93D\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F93E\U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F93E\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F93E\
    \U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F939\
    \U0001F3FD\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F939\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F939\U0001F3FD\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D8\U0001F3FD\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D8\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D8\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6C0\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F6CC\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F44B\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F91A\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F590\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\u270B\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F596\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F44C\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F90C\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F90F\U0001F3FE', this['ProcessCommandLine']) or grep('\u270C\U0001F3FE\
    ', this['ProcessCommandLine']) or grep('\U0001F91E\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF0\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F91F\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F918\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F919\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAF5\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF2\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAF3\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAF4\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F448\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F449\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F446\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F595\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F447\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\u261D\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F44D\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F44E\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\u270A\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F44A\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F91B\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F91C\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F44F\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAF6\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F64C\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F450\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F932\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F64F\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\u270D\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F4AA\U0001F3FE\
    ', this['ProcessCommandLine']) or grep('\U0001F9B5\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B6\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F442\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F9BB\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F443\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F476\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F467\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D2\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F466\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F468\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\U0001F9B1\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\U0001F9B1',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\U0001F9B1',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\U0001F9B0',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\U0001F9B0',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\U0001F9B0',\
    \ this['ProcessCommandLine']) or grep('\U0001F471\U0001F3FE\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F471\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F471\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FE\u200D\U0001F9B3', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FE\u200D\U0001F9B3', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FE\u200D\U0001F9B3', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FE\u200D\U0001F9B2', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FE\u200D\U0001F9B2', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FE\u200D\U0001F9B2', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D4\U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D4\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F9D4\
    \U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F475\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F9D3\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F474\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F472\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F473\U0001F3FE\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F473\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F473\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D5\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F46E\
    \U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F46E\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F46E\U0001F3FE\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F477\U0001F3FE\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F477\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F477\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F482\U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F482\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F482\
    \U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F575\
    \U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F575\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F575\U0001F3FE\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\u2695\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\u2695\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\u2695\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\U0001F33E\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\U0001F33E',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\U0001F33E',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\U0001F373',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\U0001F373',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\U0001F373',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\U0001F393',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\U0001F393',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\U0001F393',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\U0001F3A4',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\U0001F3A4',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\U0001F3A4',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\U0001F3EB',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\U0001F3EB',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\U0001F3EB',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\U0001F3ED',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\U0001F3ED',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\U0001F3ED',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\U0001F4BB',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\U0001F4BB',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\U0001F4BB',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\U0001F4BC',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\U0001F4BC',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\U0001F4BC',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\U0001F527',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\U0001F527',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\U0001F527',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\U0001F52C',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\U0001F52C',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\U0001F52C',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\U0001F3A8',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\U0001F3A8',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\U0001F3A8',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\U0001F692',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\U0001F692',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\U0001F692',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\u2708\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\u2708\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\u2708\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\U0001F680',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\U0001F680',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\U0001F680',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\u2696\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\u2696\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\u2696\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F470\U0001F3FE\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F470\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F470\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F935\U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F935\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F935\
    \U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F478\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAC5\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F934\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F977\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F9B8\U0001F3FE\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9B8\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B8\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B9\U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B9\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F9B9\
    \U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F936\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\U0001F384\
    ', this['ProcessCommandLine']) or grep('\U0001F385\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D9\U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D9\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F9D9\
    \U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DD\
    \U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DD\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F9DD\U0001F3FE\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DB\U0001F3FE\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DB\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DB\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DC\U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DC\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F9DC\
    \U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DA\
    \U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DA\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F9DA\U0001F3FE\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F47C\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F930\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAC4\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAC3\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F931\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F469\
    \U0001F3FE\u200D\U0001F37C', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\
    \u200D\U0001F37C', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\
    \U0001F37C', this['ProcessCommandLine']) or grep('\U0001F647\U0001F3FE\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F647\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F647\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F481\U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F481\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F481\
    \U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F645\
    \U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F645\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F645\U0001F3FE\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F646\U0001F3FE\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F646\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F646\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F64B\U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F64B\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F64B\
    \U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CF\
    \U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CF\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F9CF\U0001F3FE\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F926\U0001F3FE\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F926\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F926\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F937\U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F937\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F937\
    \U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F64E\
    \U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F64E\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F64E\U0001F3FE\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F64D\U0001F3FE\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F64D\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F64D\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F487\U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F487\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F487\
    \U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F486\
    \U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F486\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F486\U0001F3FE\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D6\U0001F3FE\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D6\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D6\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F483\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F57A\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\U0001F9BD\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\U0001F9BD',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\U0001F9BD',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\U0001F9BC',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\U0001F9BC',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\U0001F9BC',\
    \ this['ProcessCommandLine']) or grep('\U0001F6B6\U0001F3FE\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F6B6\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B6\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FE\u200D\U0001F9AF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FE\u200D\U0001F9AF', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FE\u200D\U0001F9AF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9CE\U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9CE\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F9CE\
    \U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3C3\
    \U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3C3\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F3C3\U0001F3FE\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CD\U0001F3FE\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CD\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F9CD\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F46D\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F9D1\
    \U0001F3FE\u200D\U0001F91D\u200D\U0001F9D1\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F46C\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F46B\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F9D7\U0001F3FE\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D7\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D7\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C7\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F3C2\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F3CC\U0001F3FE\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CC\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F3CC\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C4\U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C4\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F3C4\
    \U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6A3\
    \U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6A3\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F6A3\U0001F3FE\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CA\U0001F3FE\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CA\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F3CA\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u26F9\U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine']) or\
    \ grep('\u26F9\U0001F3FE', this['ProcessCommandLine']) or grep('\u26F9\U0001F3FE\
    \u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CB\U0001F3FE\
    \u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CB\U0001F3FE\
    ', this['ProcessCommandLine']) or grep('\U0001F3CB\U0001F3FE\u200D\u2642\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F6B4\U0001F3FE\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F6B4\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B4\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B5\U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B5\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F6B5\
    \U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F938\
    \U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F938\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F938\U0001F3FE\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F93D\U0001F3FE\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F93D\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F93D\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F93E\U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F93E\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F93E\
    \U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F939\
    \U0001F3FE\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F939\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F939\U0001F3FE\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D8\U0001F3FE\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D8\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D8\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6C0\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F6CC\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F44B\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F91A\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F590\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\u270B\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F596\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F44C\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F90C\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F90F\U0001F3FF', this['ProcessCommandLine']) or grep('\u270C\U0001F3FF\
    ', this['ProcessCommandLine']) or grep('\U0001F91E\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF0\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F91F\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F918\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F919\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001FAF5\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF2\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001FAF3\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001FAF4\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F448\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F449\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F446\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F595\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F447\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\u261D\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F44D\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F44E\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\u270A\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F44A\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F91B\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F91C\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F44F\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001FAF6\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F64C\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F450\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F932\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F64F\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\u270D\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F933\U0001F3FF\
    ', this['ProcessCommandLine']) or grep('\U0001F4AA\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B5\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9B6\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F442\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9BB\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F443\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F476\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F467\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9D2\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F466\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9D1\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FF\u200D\U0001F9B1', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FF\u200D\U0001F9B1', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FF\u200D\U0001F9B1', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FF\u200D\U0001F9B0', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FF\u200D\U0001F9B0', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FF\u200D\U0001F9B0', this['ProcessCommandLine'])\
    \ or grep('\U0001F471\U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F471\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F471\
    \U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F469\
    \U0001F3FF\u200D\U0001F9B3', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\
    \u200D\U0001F9B3', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\
    \U0001F9B3', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\U0001F9B2\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\U0001F9B2',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\U0001F9B2',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D4\U0001F3FF\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9D4\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D4\U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F475\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9D3\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F474\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F472\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F473\
    \U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F473\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F473\U0001F3FF\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D5\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F46E\U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F46E\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F46E\
    \U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F477\
    \U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F477\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F477\U0001F3FF\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F482\U0001F3FF\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F482\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F482\U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F575\U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F575\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F575\
    \U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F469\
    \U0001F3FF\u200D\u2695\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D1\
    \U0001F3FF\u200D\u2695\uFE0F', this['ProcessCommandLine']) or grep('\U0001F468\
    \U0001F3FF\u200D\u2695\uFE0F', this['ProcessCommandLine']) or grep('\U0001F469\
    \U0001F3FF\u200D\U0001F33E', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\
    \u200D\U0001F33E', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\
    \U0001F33E', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\U0001F373\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\U0001F373',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\U0001F373',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\U0001F393',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\U0001F393',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\U0001F393',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\U0001F3A4',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\U0001F3A4',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\U0001F3A4',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\U0001F3EB',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\U0001F3EB',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\U0001F3EB',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\U0001F3ED',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\U0001F3ED',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\U0001F3ED',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\U0001F4BB',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\U0001F4BB',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\U0001F4BB',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\U0001F4BC',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\U0001F4BC',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\U0001F4BC',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\U0001F527',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\U0001F527',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\U0001F527',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\U0001F52C',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\U0001F52C',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\U0001F52C',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\U0001F3A8',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\U0001F3A8',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\U0001F3A8',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\U0001F692',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\U0001F692',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\U0001F692',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\u2708\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\u2708\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\u2708\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\U0001F680',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\U0001F680',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\U0001F680',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\u2696\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\u2696\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\u2696\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F470\U0001F3FF\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F470\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F470\U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F935\U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F935\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F935\
    \U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F478\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001FAC5\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F934\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F977\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9B8\U0001F3FF\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9B8\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B8\U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B9\U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9B9\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9B9\
    \U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F936\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\U0001F384\
    ', this['ProcessCommandLine']) or grep('\U0001F385\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D9\U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D9\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9D9\
    \U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DD\
    \U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DD\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9DD\U0001F3FF\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DB\U0001F3FF\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DB\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DB\U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DC\U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9DC\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9DC\
    \U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DA\
    \U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9DA\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9DA\U0001F3FF\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F47C\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F930\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001FAC4\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001FAC3\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F931\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F469\
    \U0001F3FF\u200D\U0001F37C', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\
    \u200D\U0001F37C', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\
    \U0001F37C', this['ProcessCommandLine']) or grep('\U0001F647\U0001F3FF\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F647\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F647\U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F481\U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F481\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F481\
    \U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F645\
    \U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F645\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F645\U0001F3FF\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F646\U0001F3FF\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F646\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F646\U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F64B\U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F64B\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F64B\
    \U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CF\
    \U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CF\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9CF\U0001F3FF\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F926\U0001F3FF\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F926\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F926\U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F937\U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F937\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F937\
    \U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F64E\
    \U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F64E\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F64E\U0001F3FF\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F64D\U0001F3FF\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F64D\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F64D\U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F487\U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F487\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F487\
    \U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F486\
    \U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F486\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F486\U0001F3FF\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D6\U0001F3FF\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D6\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D6\U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F483\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F57A\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F574\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FF\u200D\U0001F9BD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FF\u200D\U0001F9BD', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FF\u200D\U0001F9BD', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FF\u200D\U0001F9BC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FF\u200D\U0001F9BC', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FF\u200D\U0001F9BC', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B6\U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B6\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F6B6\
    \U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F469\
    \U0001F3FF\u200D\U0001F9AF', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\
    \u200D\U0001F9AF', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\
    \U0001F9AF', this['ProcessCommandLine']) or grep('\U0001F9CE\U0001F3FF\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CE\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9CE\U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C3\U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C3\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F3C3\
    \U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CD\
    \U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9CD\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9CD\U0001F3FF\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F46D\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FF\u200D\U0001F91D\u200D\U0001F9D1\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F46C\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F46B\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9D7\U0001F3FF\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D7\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D7\U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C7\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F3C2\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F3CC\U0001F3FF\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CC\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F3CC\U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C4\U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C4\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F3C4\
    \U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6A3\
    \U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6A3\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F6A3\U0001F3FF\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CA\U0001F3FF\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CA\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F3CA\U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u26F9\U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine']) or\
    \ grep('\u26F9\U0001F3FF', this['ProcessCommandLine']) or grep('\u26F9\U0001F3FF\
    \u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CB\U0001F3FF\
    \u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CB\U0001F3FF\
    ', this['ProcessCommandLine']) or grep('\U0001F3CB\U0001F3FF\u200D\u2642\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F6B4\U0001F3FF\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F6B4\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B4\U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B5\U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B5\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F6B5\
    \U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F938\
    \U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F938\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F938\U0001F3FF\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F93D\U0001F3FF\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F93D\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F93D\U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F93E\U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F93E\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F93E\
    \U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F939\
    \U0001F3FF\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F939\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F939\U0001F3FF\u200D\u2642\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D8\U0001F3FF\u200D\u2640\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D8\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D8\U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6C0\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F6CC\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F436', this['ProcessCommandLine'])\
    \ or grep('\U0001F431', this['ProcessCommandLine']) or grep('\U0001F42D', this['ProcessCommandLine'])\
    \ or grep('\U0001F439', this['ProcessCommandLine']) or grep('\U0001F430', this['ProcessCommandLine'])\
    \ or grep('\U0001F98A', this['ProcessCommandLine']) or grep('\U0001F43B', this['ProcessCommandLine'])\
    \ or grep('\U0001F43C', this['ProcessCommandLine']) or grep('\U0001F43B\u200D\u2744\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F428', this['ProcessCommandLine'])\
    \ or grep('\U0001F42F', this['ProcessCommandLine']) or grep('\U0001F981', this['ProcessCommandLine'])\
    \ or grep('\U0001F42E', this['ProcessCommandLine']) or grep('\U0001F437', this['ProcessCommandLine'])\
    \ or grep('\U0001F43D', this['ProcessCommandLine']) or grep('\U0001F438', this['ProcessCommandLine'])\
    \ or grep('\U0001F435', this['ProcessCommandLine']) or grep('\U0001F648', this['ProcessCommandLine'])\
    \ or grep('\U0001F649', this['ProcessCommandLine']) or grep('\U0001F64A', this['ProcessCommandLine'])\
    \ or grep('\U0001F412', this['ProcessCommandLine']) or grep('\U0001F414', this['ProcessCommandLine'])\
    \ or grep('\U0001F427', this['ProcessCommandLine']) or grep('\U0001F426', this['ProcessCommandLine'])\
    \ or grep('\U0001F424', this['ProcessCommandLine']) or grep('\U0001F423', this['ProcessCommandLine'])\
    \ or grep('\U0001F425', this['ProcessCommandLine'])"
  sigma_id: c98f2a0d-e1b8-4f76-90d3-359caf88d6b9
- name: Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 3
  query: "grep('\U0001F986', this['ProcessCommandLine']) or grep('\U0001F985', this['ProcessCommandLine'])\
    \ or grep('\U0001F989', this['ProcessCommandLine']) or grep('\U0001F987', this['ProcessCommandLine'])\
    \ or grep('\U0001F43A', this['ProcessCommandLine']) or grep('\U0001F417', this['ProcessCommandLine'])\
    \ or grep('\U0001F434', this['ProcessCommandLine']) or grep('\U0001F984', this['ProcessCommandLine'])\
    \ or grep('\U0001F41D', this['ProcessCommandLine']) or grep('\U0001FAB1', this['ProcessCommandLine'])\
    \ or grep('\U0001F41B', this['ProcessCommandLine']) or grep('\U0001F98B', this['ProcessCommandLine'])\
    \ or grep('\U0001F40C', this['ProcessCommandLine']) or grep('\U0001F41E', this['ProcessCommandLine'])\
    \ or grep('\U0001F41C', this['ProcessCommandLine']) or grep('\U0001FAB0', this['ProcessCommandLine'])\
    \ or grep('\U0001FAB2', this['ProcessCommandLine']) or grep('\U0001FAB3', this['ProcessCommandLine'])\
    \ or grep('\U0001F99F', this['ProcessCommandLine']) or grep('\U0001F997', this['ProcessCommandLine'])\
    \ or grep('\U0001F577', this['ProcessCommandLine']) or grep('\U0001F578', this['ProcessCommandLine'])\
    \ or grep('\U0001F982', this['ProcessCommandLine']) or grep('\U0001F422', this['ProcessCommandLine'])\
    \ or grep('\U0001F40D', this['ProcessCommandLine']) or grep('\U0001F98E', this['ProcessCommandLine'])\
    \ or grep('\U0001F996', this['ProcessCommandLine']) or grep('\U0001F995', this['ProcessCommandLine'])\
    \ or grep('\U0001F419', this['ProcessCommandLine']) or grep('\U0001F991', this['ProcessCommandLine'])\
    \ or grep('\U0001F990', this['ProcessCommandLine']) or grep('\U0001F99E', this['ProcessCommandLine'])\
    \ or grep('\U0001F980', this['ProcessCommandLine']) or grep('\U0001FAB8', this['ProcessCommandLine'])\
    \ or grep('\U0001F421', this['ProcessCommandLine']) or grep('\U0001F420', this['ProcessCommandLine'])\
    \ or grep('\U0001F41F', this['ProcessCommandLine']) or grep('\U0001F42C', this['ProcessCommandLine'])\
    \ or grep('\U0001F433', this['ProcessCommandLine']) or grep('\U0001F40B', this['ProcessCommandLine'])\
    \ or grep('\U0001F988', this['ProcessCommandLine']) or grep('\U0001F40A', this['ProcessCommandLine'])\
    \ or grep('\U0001F405', this['ProcessCommandLine']) or grep('\U0001F406', this['ProcessCommandLine'])\
    \ or grep('\U0001F993', this['ProcessCommandLine']) or grep('\U0001F98D', this['ProcessCommandLine'])\
    \ or grep('\U0001F9A7', this['ProcessCommandLine']) or grep('\U0001F9A3', this['ProcessCommandLine'])\
    \ or grep('\U0001F418', this['ProcessCommandLine']) or grep('\U0001F99B', this['ProcessCommandLine'])\
    \ or grep('\U0001F98F', this['ProcessCommandLine']) or grep('\U0001F42A', this['ProcessCommandLine'])\
    \ or grep('\U0001F42B', this['ProcessCommandLine']) or grep('\U0001F992', this['ProcessCommandLine'])\
    \ or grep('\U0001F998', this['ProcessCommandLine']) or grep('\U0001F9AC', this['ProcessCommandLine'])\
    \ or grep('\U0001F403', this['ProcessCommandLine']) or grep('\U0001F402', this['ProcessCommandLine'])\
    \ or grep('\U0001F404', this['ProcessCommandLine']) or grep('\U0001F40E', this['ProcessCommandLine'])\
    \ or grep('\U0001F416', this['ProcessCommandLine']) or grep('\U0001F40F', this['ProcessCommandLine'])\
    \ or grep('\U0001F411', this['ProcessCommandLine']) or grep('\U0001F999', this['ProcessCommandLine'])\
    \ or grep('\U0001F410', this['ProcessCommandLine']) or grep('\U0001F98C', this['ProcessCommandLine'])\
    \ or grep('\U0001F415', this['ProcessCommandLine']) or grep('\U0001F429', this['ProcessCommandLine'])\
    \ or grep('\U0001F9AE', this['ProcessCommandLine']) or grep('\U0001F415\u200D\U0001F9BA\
    ', this['ProcessCommandLine']) or grep('\U0001F408', this['ProcessCommandLine'])\
    \ or grep('\U0001F408\u200D\u2B1B', this['ProcessCommandLine']) or grep('\U0001FAB6\
    ', this['ProcessCommandLine']) or grep('\U0001F413', this['ProcessCommandLine'])\
    \ or grep('\U0001F983', this['ProcessCommandLine']) or grep('\U0001F9A4', this['ProcessCommandLine'])\
    \ or grep('\U0001F99A', this['ProcessCommandLine']) or grep('\U0001F99C', this['ProcessCommandLine'])\
    \ or grep('\U0001F9A2', this['ProcessCommandLine']) or grep('\U0001F9A9', this['ProcessCommandLine'])\
    \ or grep('\U0001F54A', this['ProcessCommandLine']) or grep('\U0001F407', this['ProcessCommandLine'])\
    \ or grep('\U0001F99D', this['ProcessCommandLine']) or grep('\U0001F9A8', this['ProcessCommandLine'])\
    \ or grep('\U0001F9A1', this['ProcessCommandLine']) or grep('\U0001F9AB', this['ProcessCommandLine'])\
    \ or grep('\U0001F9A6', this['ProcessCommandLine']) or grep('\U0001F9A5', this['ProcessCommandLine'])\
    \ or grep('\U0001F401', this['ProcessCommandLine']) or grep('\U0001F400', this['ProcessCommandLine'])\
    \ or grep('\U0001F43F', this['ProcessCommandLine']) or grep('\U0001F994', this['ProcessCommandLine'])\
    \ or grep('\U0001F43E', this['ProcessCommandLine']) or grep('\U0001F409', this['ProcessCommandLine'])\
    \ or grep('\U0001F432', this['ProcessCommandLine']) or grep('\U0001F335', this['ProcessCommandLine'])\
    \ or grep('\U0001F384', this['ProcessCommandLine']) or grep('\U0001F332', this['ProcessCommandLine'])\
    \ or grep('\U0001F333', this['ProcessCommandLine']) or grep('\U0001F334', this['ProcessCommandLine'])\
    \ or grep('\U0001FAB9', this['ProcessCommandLine']) or grep('\U0001FABA', this['ProcessCommandLine'])\
    \ or grep('\U0001FAB5', this['ProcessCommandLine']) or grep('\U0001F331', this['ProcessCommandLine'])\
    \ or grep('\U0001F33F', this['ProcessCommandLine']) or grep('\u2618\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F340', this['ProcessCommandLine']) or grep('\U0001F38D', this['ProcessCommandLine'])\
    \ or grep('\U0001FAB4', this['ProcessCommandLine']) or grep('\U0001F38B', this['ProcessCommandLine'])\
    \ or grep('\U0001F343', this['ProcessCommandLine']) or grep('\U0001F342', this['ProcessCommandLine'])\
    \ or grep('\U0001F341', this['ProcessCommandLine']) or grep('\U0001F344', this['ProcessCommandLine'])\
    \ or grep('\U0001F41A', this['ProcessCommandLine']) or grep('\U0001FAA8', this['ProcessCommandLine'])\
    \ or grep('\U0001F33E', this['ProcessCommandLine']) or grep('\U0001F490', this['ProcessCommandLine'])\
    \ or grep('\U0001F337', this['ProcessCommandLine']) or grep('\U0001FAB7', this['ProcessCommandLine'])\
    \ or grep('\U0001F339', this['ProcessCommandLine']) or grep('\U0001F940', this['ProcessCommandLine'])\
    \ or grep('\U0001F33A', this['ProcessCommandLine']) or grep('\U0001F338', this['ProcessCommandLine'])\
    \ or grep('\U0001F33C', this['ProcessCommandLine']) or grep('\U0001F33B', this['ProcessCommandLine'])\
    \ or grep('\U0001F31E', this['ProcessCommandLine']) or grep('\U0001F31D', this['ProcessCommandLine'])\
    \ or grep('\U0001F31B', this['ProcessCommandLine']) or grep('\U0001F31C', this['ProcessCommandLine'])\
    \ or grep('\U0001F31A', this['ProcessCommandLine']) or grep('\U0001F315', this['ProcessCommandLine'])\
    \ or grep('\U0001F316', this['ProcessCommandLine']) or grep('\U0001F317', this['ProcessCommandLine'])\
    \ or grep('\U0001F318', this['ProcessCommandLine']) or grep('\U0001F311', this['ProcessCommandLine'])\
    \ or grep('\U0001F312', this['ProcessCommandLine']) or grep('\U0001F313', this['ProcessCommandLine'])\
    \ or grep('\U0001F314', this['ProcessCommandLine']) or grep('\U0001F319', this['ProcessCommandLine'])\
    \ or grep('\U0001F30E', this['ProcessCommandLine']) or grep('\U0001F30D', this['ProcessCommandLine'])\
    \ or grep('\U0001F30F', this['ProcessCommandLine']) or grep('\U0001FA90', this['ProcessCommandLine'])\
    \ or grep('\U0001F4AB', this['ProcessCommandLine']) or grep('\u2B50\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F31F', this['ProcessCommandLine']) or grep('\u2728', this['ProcessCommandLine'])\
    \ or grep('\u26A1\uFE0F', this['ProcessCommandLine']) or grep('\u2604\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\U0001F4A5', this['ProcessCommandLine'])\
    \ or grep('\U0001F525', this['ProcessCommandLine']) or grep('\U0001F32A', this['ProcessCommandLine'])\
    \ or grep('\U0001F308', this['ProcessCommandLine']) or grep('\u2600\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F324', this['ProcessCommandLine']) or grep('\u26C5\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F325', this['ProcessCommandLine']) or grep('\u2601\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F326', this['ProcessCommandLine']) or grep('\U0001F327', this['ProcessCommandLine'])\
    \ or grep('\u26C8', this['ProcessCommandLine']) or grep('\U0001F329', this['ProcessCommandLine'])\
    \ or grep('\U0001F328', this['ProcessCommandLine']) or grep('\u2744\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u2603\uFE0F', this['ProcessCommandLine']) or grep('\u26C4\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\U0001F32C', this['ProcessCommandLine'])\
    \ or grep('\U0001F4A8', this['ProcessCommandLine']) or grep('\U0001F4A7', this['ProcessCommandLine'])\
    \ or grep('\U0001F4A6', this['ProcessCommandLine']) or grep('\U0001FAE7', this['ProcessCommandLine'])\
    \ or grep('\u2614\uFE0F', this['ProcessCommandLine']) or grep('\u2602\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\U0001F30A', this['ProcessCommandLine'])\
    \ or grep('\U0001F32B\U0001F34F', this['ProcessCommandLine']) or grep('\U0001F34E\
    ', this['ProcessCommandLine']) or grep('\U0001F350', this['ProcessCommandLine'])\
    \ or grep('\U0001F34A', this['ProcessCommandLine']) or grep('\U0001F34B', this['ProcessCommandLine'])\
    \ or grep('\U0001F34C', this['ProcessCommandLine']) or grep('\U0001F349', this['ProcessCommandLine'])\
    \ or grep('\U0001F347', this['ProcessCommandLine']) or grep('\U0001F353', this['ProcessCommandLine'])\
    \ or grep('\U0001FAD0', this['ProcessCommandLine']) or grep('\U0001F348', this['ProcessCommandLine'])\
    \ or grep('\U0001F352', this['ProcessCommandLine']) or grep('\U0001F351', this['ProcessCommandLine'])\
    \ or grep('\U0001F96D', this['ProcessCommandLine']) or grep('\U0001F34D', this['ProcessCommandLine'])\
    \ or grep('\U0001F965', this['ProcessCommandLine']) or grep('\U0001F95D', this['ProcessCommandLine'])\
    \ or grep('\U0001F345', this['ProcessCommandLine']) or grep('\U0001F346', this['ProcessCommandLine'])\
    \ or grep('\U0001F951', this['ProcessCommandLine']) or grep('\U0001F966', this['ProcessCommandLine'])\
    \ or grep('\U0001F96C', this['ProcessCommandLine']) or grep('\U0001F952', this['ProcessCommandLine'])\
    \ or grep('\U0001F336', this['ProcessCommandLine']) or grep('\U0001FAD1', this['ProcessCommandLine'])\
    \ or grep('\U0001F33D', this['ProcessCommandLine']) or grep('\U0001F955', this['ProcessCommandLine'])\
    \ or grep('\U0001FAD2', this['ProcessCommandLine']) or grep('\U0001F9C4', this['ProcessCommandLine'])\
    \ or grep('\U0001F9C5', this['ProcessCommandLine']) or grep('\U0001F954', this['ProcessCommandLine'])\
    \ or grep('\U0001F360', this['ProcessCommandLine']) or grep('\U0001FAD8', this['ProcessCommandLine'])\
    \ or grep('\U0001F950', this['ProcessCommandLine']) or grep('\U0001F96F', this['ProcessCommandLine'])\
    \ or grep('\U0001F35E', this['ProcessCommandLine']) or grep('\U0001F956', this['ProcessCommandLine'])\
    \ or grep('\U0001F968', this['ProcessCommandLine']) or grep('\U0001F9C0', this['ProcessCommandLine'])\
    \ or grep('\U0001F95A', this['ProcessCommandLine']) or grep('\U0001F373', this['ProcessCommandLine'])\
    \ or grep('\U0001F9C8', this['ProcessCommandLine']) or grep('\U0001F95E', this['ProcessCommandLine'])\
    \ or grep('\U0001F9C7', this['ProcessCommandLine']) or grep('\U0001F953', this['ProcessCommandLine'])\
    \ or grep('\U0001F969', this['ProcessCommandLine']) or grep('\U0001F357', this['ProcessCommandLine'])\
    \ or grep('\U0001F356', this['ProcessCommandLine']) or grep('\U0001F9B4', this['ProcessCommandLine'])\
    \ or grep('\U0001F32D', this['ProcessCommandLine']) or grep('\U0001F354', this['ProcessCommandLine'])\
    \ or grep('\U0001F35F', this['ProcessCommandLine']) or grep('\U0001F355', this['ProcessCommandLine'])\
    \ or grep('\U0001FAD3', this['ProcessCommandLine']) or grep('\U0001F96A', this['ProcessCommandLine'])\
    \ or grep('\U0001F959', this['ProcessCommandLine']) or grep('\U0001F9C6', this['ProcessCommandLine'])\
    \ or grep('\U0001F32E', this['ProcessCommandLine']) or grep('\U0001F32F', this['ProcessCommandLine'])\
    \ or grep('\U0001FAD4', this['ProcessCommandLine']) or grep('\U0001F957', this['ProcessCommandLine'])\
    \ or grep('\U0001F958', this['ProcessCommandLine']) or grep('\U0001FAD5', this['ProcessCommandLine'])\
    \ or grep('\U0001F96B', this['ProcessCommandLine']) or grep('\U0001F35D', this['ProcessCommandLine'])\
    \ or grep('\U0001F35C', this['ProcessCommandLine']) or grep('\U0001F372', this['ProcessCommandLine'])\
    \ or grep('\U0001F35B', this['ProcessCommandLine']) or grep('\U0001F363', this['ProcessCommandLine'])\
    \ or grep('\U0001F371', this['ProcessCommandLine']) or grep('\U0001F95F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9AA', this['ProcessCommandLine']) or grep('\U0001F364', this['ProcessCommandLine'])\
    \ or grep('\U0001F359', this['ProcessCommandLine']) or grep('\U0001F35A', this['ProcessCommandLine'])\
    \ or grep('\U0001F358', this['ProcessCommandLine']) or grep('\U0001F365', this['ProcessCommandLine'])\
    \ or grep('\U0001F960', this['ProcessCommandLine']) or grep('\U0001F96E', this['ProcessCommandLine'])\
    \ or grep('\U0001F362', this['ProcessCommandLine']) or grep('\U0001F361', this['ProcessCommandLine'])\
    \ or grep('\U0001F367', this['ProcessCommandLine']) or grep('\U0001F368', this['ProcessCommandLine'])\
    \ or grep('\U0001F366', this['ProcessCommandLine']) or grep('\U0001F967', this['ProcessCommandLine'])\
    \ or grep('\U0001F9C1', this['ProcessCommandLine']) or grep('\U0001F370', this['ProcessCommandLine'])\
    \ or grep('\U0001F382', this['ProcessCommandLine']) or grep('\U0001F36E', this['ProcessCommandLine'])\
    \ or grep('\U0001F36D', this['ProcessCommandLine']) or grep('\U0001F36C', this['ProcessCommandLine'])\
    \ or grep('\U0001F36B', this['ProcessCommandLine']) or grep('\U0001F37F', this['ProcessCommandLine'])\
    \ or grep('\U0001F369', this['ProcessCommandLine']) or grep('\U0001F36A', this['ProcessCommandLine'])\
    \ or grep('\U0001F330', this['ProcessCommandLine']) or grep('\U0001F95C', this['ProcessCommandLine'])\
    \ or grep('\U0001F36F', this['ProcessCommandLine']) or grep('\U0001F95B', this['ProcessCommandLine'])\
    \ or grep('\U0001F37C', this['ProcessCommandLine']) or grep('\U0001FAD6', this['ProcessCommandLine'])\
    \ or grep('\u2615\uFE0F', this['ProcessCommandLine']) or grep('\U0001F375', this['ProcessCommandLine'])\
    \ or grep('\U0001F9C3', this['ProcessCommandLine']) or grep('\U0001F964', this['ProcessCommandLine'])\
    \ or grep('\U0001F9CB', this['ProcessCommandLine']) or grep('\U0001FAD9', this['ProcessCommandLine'])\
    \ or grep('\U0001F376', this['ProcessCommandLine']) or grep('\U0001F37A', this['ProcessCommandLine'])\
    \ or grep('\U0001F37B', this['ProcessCommandLine']) or grep('\U0001F942', this['ProcessCommandLine'])\
    \ or grep('\U0001F377', this['ProcessCommandLine']) or grep('\U0001FAD7', this['ProcessCommandLine'])\
    \ or grep('\U0001F943', this['ProcessCommandLine']) or grep('\U0001F378', this['ProcessCommandLine'])\
    \ or grep('\U0001F379', this['ProcessCommandLine']) or grep('\U0001F9C9', this['ProcessCommandLine'])\
    \ or grep('\U0001F37E', this['ProcessCommandLine']) or grep('\U0001F9CA', this['ProcessCommandLine'])\
    \ or grep('\U0001F944', this['ProcessCommandLine']) or grep('\U0001F374', this['ProcessCommandLine'])\
    \ or grep('\U0001F37D', this['ProcessCommandLine']) or grep('\U0001F963', this['ProcessCommandLine'])\
    \ or grep('\U0001F961', this['ProcessCommandLine']) or grep('\U0001F962', this['ProcessCommandLine'])\
    \ or grep('\U0001F9C2', this['ProcessCommandLine']) or grep('\u26BD\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C0', this['ProcessCommandLine']) or grep('\U0001F3C8', this['ProcessCommandLine'])\
    \ or grep('\u26BE\uFE0F', this['ProcessCommandLine']) or grep('\U0001F94E', this['ProcessCommandLine'])\
    \ or grep('\U0001F3BE', this['ProcessCommandLine']) or grep('\U0001F3D0', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C9', this['ProcessCommandLine']) or grep('\U0001F94F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3B1', this['ProcessCommandLine']) or grep('\U0001FA80', this['ProcessCommandLine'])\
    \ or grep('\U0001F3D3', this['ProcessCommandLine']) or grep('\U0001F3F8', this['ProcessCommandLine'])\
    \ or grep('\U0001F3D2', this['ProcessCommandLine']) or grep('\U0001F3D1', this['ProcessCommandLine'])\
    \ or grep('\U0001F94D', this['ProcessCommandLine']) or grep('\U0001F3CF', this['ProcessCommandLine'])\
    \ or grep('\U0001FA83', this['ProcessCommandLine']) or grep('\U0001F945', this['ProcessCommandLine'])\
    \ or grep('\u26F3\uFE0F', this['ProcessCommandLine']) or grep('\U0001FA81', this['ProcessCommandLine'])\
    \ or grep('\U0001F3F9', this['ProcessCommandLine']) or grep('\U0001F3A3', this['ProcessCommandLine'])\
    \ or grep('\U0001F93F', this['ProcessCommandLine']) or grep('\U0001F94A', this['ProcessCommandLine'])\
    \ or grep('\U0001F94B', this['ProcessCommandLine']) or grep('\U0001F3BD', this['ProcessCommandLine'])\
    \ or grep('\U0001F6F9', this['ProcessCommandLine']) or grep('\U0001F6FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F6F7', this['ProcessCommandLine']) or grep('\u26F8', this['ProcessCommandLine'])\
    \ or grep('\U0001F94C', this['ProcessCommandLine']) or grep('\U0001F3BF', this['ProcessCommandLine'])\
    \ or grep('\u26F7', this['ProcessCommandLine']) or grep('\U0001F3C2', this['ProcessCommandLine'])\
    \ or grep('\U0001FA82', this['ProcessCommandLine']) or grep('\U0001F3CB\uFE0F\u200D\
    \u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CB\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3CB\uFE0F\u200D\u2642\uFE0F', this['ProcessCommandLine']) or\
    \ grep('\U0001F93C\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F93C\
    ', this['ProcessCommandLine']) or grep('\U0001F93C\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F938\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F938\
    ', this['ProcessCommandLine']) or grep('\U0001F938\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u26F9\uFE0F\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\u26F9\
    \uFE0F', this['ProcessCommandLine']) or grep('\u26F9\uFE0F\u200D\u2642\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\U0001F93A', this['ProcessCommandLine'])\
    \ or grep('\U0001F93E\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F93E\
    ', this['ProcessCommandLine']) or grep('\U0001F93E\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3CC\uFE0F\u200D\u2640\uFE0F', this['ProcessCommandLine']) or\
    \ grep('\U0001F3CC\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CC\uFE0F\
    \u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3C7', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D8\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D8\
    ', this['ProcessCommandLine']) or grep('\U0001F9D8\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C4\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3C4\
    ', this['ProcessCommandLine']) or grep('\U0001F3C4\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3CA\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3CA\
    ', this['ProcessCommandLine']) or grep('\U0001F3CA\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F93D\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F93D\
    ', this['ProcessCommandLine']) or grep('\U0001F93D\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6A3\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6A3\
    ', this['ProcessCommandLine']) or grep('\U0001F6A3\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D7\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F9D7\
    ', this['ProcessCommandLine']) or grep('\U0001F9D7\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B5\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6B5\
    ', this['ProcessCommandLine']) or grep('\U0001F6B5\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B4\u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6B4\
    ', this['ProcessCommandLine']) or grep('\U0001F6B4\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C6', this['ProcessCommandLine']) or grep('\U0001F947', this['ProcessCommandLine'])\
    \ or grep('\U0001F948', this['ProcessCommandLine']) or grep('\U0001F949', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C5', this['ProcessCommandLine']) or grep('\U0001F396', this['ProcessCommandLine'])\
    \ or grep('\U0001F3F5', this['ProcessCommandLine']) or grep('\U0001F397', this['ProcessCommandLine'])\
    \ or grep('\U0001F3AB', this['ProcessCommandLine']) or grep('\U0001F39F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3AA', this['ProcessCommandLine']) or grep('\U0001F939', this['ProcessCommandLine'])\
    \ or grep('\U0001F939\u200D\u2642\uFE0F', this['ProcessCommandLine']) or grep('\U0001F939\
    \u200D\u2640\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3AD', this['ProcessCommandLine'])\
    \ or grep('\U0001FA70', this['ProcessCommandLine']) or grep('\U0001F3A8', this['ProcessCommandLine'])\
    \ or grep('\U0001F3AC', this['ProcessCommandLine']) or grep('\U0001F3A4', this['ProcessCommandLine'])\
    \ or grep('\U0001F3A7', this['ProcessCommandLine']) or grep('\U0001F3BC', this['ProcessCommandLine'])\
    \ or grep('\U0001F3B9', this['ProcessCommandLine']) or grep('\U0001F941', this['ProcessCommandLine'])\
    \ or grep('\U0001FA98', this['ProcessCommandLine']) or grep('\U0001F3B7', this['ProcessCommandLine'])\
    \ or grep('\U0001F3BA', this['ProcessCommandLine']) or grep('\U0001FA97', this['ProcessCommandLine'])\
    \ or grep('\U0001F3B8', this['ProcessCommandLine']) or grep('\U0001FA95', this['ProcessCommandLine'])\
    \ or grep('\U0001F3BB', this['ProcessCommandLine']) or grep('\U0001F3B2', this['ProcessCommandLine'])\
    \ or grep('\u265F', this['ProcessCommandLine']) or grep('\U0001F3AF', this['ProcessCommandLine'])\
    \ or grep('\U0001F3B3', this['ProcessCommandLine']) or grep('\U0001F3AE', this['ProcessCommandLine'])\
    \ or grep('\U0001F3B0', this['ProcessCommandLine']) or grep('\U0001F9E9', this['ProcessCommandLine'])\
    \ or grep('\U0001F697', this['ProcessCommandLine']) or grep('\U0001F695', this['ProcessCommandLine'])\
    \ or grep('\U0001F699', this['ProcessCommandLine']) or grep('\U0001F68C', this['ProcessCommandLine'])\
    \ or grep('\U0001F68E', this['ProcessCommandLine']) or grep('\U0001F3CE', this['ProcessCommandLine'])\
    \ or grep('\U0001F693', this['ProcessCommandLine']) or grep('\U0001F691', this['ProcessCommandLine'])\
    \ or grep('\U0001F692', this['ProcessCommandLine']) or grep('\U0001F690', this['ProcessCommandLine'])\
    \ or grep('\U0001F6FB', this['ProcessCommandLine']) or grep('\U0001F69A', this['ProcessCommandLine'])\
    \ or grep('\U0001F69B', this['ProcessCommandLine']) or grep('\U0001F69C', this['ProcessCommandLine'])\
    \ or grep('\U0001F9AF', this['ProcessCommandLine']) or grep('\U0001F9BD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9BC', this['ProcessCommandLine']) or grep('\U0001F6F4', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B2', this['ProcessCommandLine']) or grep('\U0001F6F5', this['ProcessCommandLine'])\
    \ or grep('\U0001F3CD', this['ProcessCommandLine']) or grep('\U0001F6FA', this['ProcessCommandLine'])\
    \ or grep('\U0001F6A8', this['ProcessCommandLine']) or grep('\U0001F694', this['ProcessCommandLine'])\
    \ or grep('\U0001F68D', this['ProcessCommandLine']) or grep('\U0001F698', this['ProcessCommandLine'])\
    \ or grep('\U0001F696', this['ProcessCommandLine']) or grep('\U0001F6DE', this['ProcessCommandLine'])\
    \ or grep('\U0001F6A1', this['ProcessCommandLine']) or grep('\U0001F6A0', this['ProcessCommandLine'])\
    \ or grep('\U0001F69F', this['ProcessCommandLine']) or grep('\U0001F683', this['ProcessCommandLine'])\
    \ or grep('\U0001F68B', this['ProcessCommandLine']) or grep('\U0001F69E', this['ProcessCommandLine'])\
    \ or grep('\U0001F69D', this['ProcessCommandLine']) or grep('\U0001F684', this['ProcessCommandLine'])\
    \ or grep('\U0001F685', this['ProcessCommandLine']) or grep('\U0001F688', this['ProcessCommandLine'])\
    \ or grep('\U0001F682', this['ProcessCommandLine']) or grep('\U0001F686', this['ProcessCommandLine'])\
    \ or grep('\U0001F687', this['ProcessCommandLine']) or grep('\U0001F68A', this['ProcessCommandLine'])\
    \ or grep('\U0001F689', this['ProcessCommandLine']) or grep('\u2708\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6EB', this['ProcessCommandLine']) or grep('\U0001F6EC', this['ProcessCommandLine'])\
    \ or grep('\U0001F6E9', this['ProcessCommandLine']) or grep('\U0001F4BA', this['ProcessCommandLine'])\
    \ or grep('\U0001F6F0', this['ProcessCommandLine']) or grep('\U0001F680', this['ProcessCommandLine'])\
    \ or grep('\U0001F6F8', this['ProcessCommandLine']) or grep('\U0001F681', this['ProcessCommandLine'])\
    \ or grep('\U0001F6F6', this['ProcessCommandLine']) or grep('\u26F5\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6A4', this['ProcessCommandLine']) or grep('\U0001F6E5', this['ProcessCommandLine'])\
    \ or grep('\U0001F6F3', this['ProcessCommandLine']) or grep('\u26F4', this['ProcessCommandLine'])\
    \ or grep('\U0001F6A2', this['ProcessCommandLine']) or grep('\u2693\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6DF', this['ProcessCommandLine']) or grep('\U0001FA9D', this['ProcessCommandLine'])\
    \ or grep('\u26FD\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6A7', this['ProcessCommandLine'])\
    \ or grep('\U0001F6A6', this['ProcessCommandLine']) or grep('\U0001F6A5', this['ProcessCommandLine'])\
    \ or grep('\U0001F68F', this['ProcessCommandLine']) or grep('\U0001F5FA', this['ProcessCommandLine'])\
    \ or grep('\U0001F5FF', this['ProcessCommandLine']) or grep('\U0001F5FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F5FC', this['ProcessCommandLine']) or grep('\U0001F3F0', this['ProcessCommandLine'])\
    \ or grep('\U0001F3EF', this['ProcessCommandLine']) or grep('\U0001F3DF', this['ProcessCommandLine'])\
    \ or grep('\U0001F3A1', this['ProcessCommandLine']) or grep('\U0001F3A2', this['ProcessCommandLine'])\
    \ or grep('\U0001F6DD', this['ProcessCommandLine']) or grep('\U0001F3A0', this['ProcessCommandLine'])\
    \ or grep('\u26F2\uFE0F', this['ProcessCommandLine']) or grep('\u26F1', this['ProcessCommandLine'])\
    \ or grep('\U0001F3D6', this['ProcessCommandLine']) or grep('\U0001F3DD', this['ProcessCommandLine'])\
    \ or grep('\U0001F3DC', this['ProcessCommandLine']) or grep('\U0001F30B', this['ProcessCommandLine'])\
    \ or grep('\u26F0', this['ProcessCommandLine']) or grep('\U0001F3D4', this['ProcessCommandLine'])\
    \ or grep('\U0001F5FB', this['ProcessCommandLine']) or grep('\U0001F3D5', this['ProcessCommandLine'])\
    \ or grep('\u26FA\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6D6', this['ProcessCommandLine'])\
    \ or grep('\U0001F3E0', this['ProcessCommandLine']) or grep('\U0001F3E1', this['ProcessCommandLine'])\
    \ or grep('\U0001F3D8', this['ProcessCommandLine']) or grep('\U0001F3DA', this['ProcessCommandLine'])\
    \ or grep('\U0001F3D7', this['ProcessCommandLine']) or grep('\U0001F3ED', this['ProcessCommandLine'])\
    \ or grep('\U0001F3E2', this['ProcessCommandLine']) or grep('\U0001F3EC', this['ProcessCommandLine'])\
    \ or grep('\U0001F3E3', this['ProcessCommandLine']) or grep('\U0001F3E4', this['ProcessCommandLine'])\
    \ or grep('\U0001F3E5', this['ProcessCommandLine']) or grep('\U0001F3E6', this['ProcessCommandLine'])\
    \ or grep('\U0001F3E8', this['ProcessCommandLine']) or grep('\U0001F3EA', this['ProcessCommandLine'])\
    \ or grep('\U0001F3EB', this['ProcessCommandLine']) or grep('\U0001F3E9', this['ProcessCommandLine'])\
    \ or grep('\U0001F492', this['ProcessCommandLine']) or grep('\U0001F3DB', this['ProcessCommandLine'])\
    \ or grep('\u26EA\uFE0F', this['ProcessCommandLine']) or grep('\U0001F54C', this['ProcessCommandLine'])\
    \ or grep('\U0001F54D', this['ProcessCommandLine']) or grep('\U0001F6D5', this['ProcessCommandLine'])\
    \ or grep('\U0001F54B', this['ProcessCommandLine']) or grep('\u26E9', this['ProcessCommandLine'])\
    \ or grep('\U0001F6E4', this['ProcessCommandLine']) or grep('\U0001F6E3', this['ProcessCommandLine'])\
    \ or grep('\U0001F5FE', this['ProcessCommandLine']) or grep('\U0001F391', this['ProcessCommandLine'])\
    \ or grep('\U0001F3DE', this['ProcessCommandLine']) or grep('\U0001F305', this['ProcessCommandLine'])\
    \ or grep('\U0001F304', this['ProcessCommandLine']) or grep('\U0001F320', this['ProcessCommandLine'])\
    \ or grep('\U0001F387', this['ProcessCommandLine']) or grep('\U0001F386', this['ProcessCommandLine'])\
    \ or grep('\U0001F307', this['ProcessCommandLine']) or grep('\U0001F306', this['ProcessCommandLine'])\
    \ or grep('\U0001F3D9', this['ProcessCommandLine']) or grep('\U0001F303', this['ProcessCommandLine'])\
    \ or grep('\U0001F30C', this['ProcessCommandLine']) or grep('\U0001F309', this['ProcessCommandLine'])\
    \ or grep('\U0001F301', this['ProcessCommandLine']) or grep('\u231A\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F4F1', this['ProcessCommandLine']) or grep('\U0001F4F2', this['ProcessCommandLine'])\
    \ or grep('\U0001F4BB', this['ProcessCommandLine']) or grep('\u2328\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F5A5', this['ProcessCommandLine']) or grep('\U0001F5A8', this['ProcessCommandLine'])\
    \ or grep('\U0001F5B1', this['ProcessCommandLine']) or grep('\U0001F5B2', this['ProcessCommandLine'])\
    \ or grep('\U0001F579', this['ProcessCommandLine']) or grep('\U0001F5DC', this['ProcessCommandLine'])\
    \ or grep('\U0001F4BD', this['ProcessCommandLine']) or grep('\U0001F4BE', this['ProcessCommandLine'])\
    \ or grep('\U0001F4BF', this['ProcessCommandLine']) or grep('\U0001F4C0', this['ProcessCommandLine'])\
    \ or grep('\U0001F4FC', this['ProcessCommandLine']) or grep('\U0001F4F7', this['ProcessCommandLine'])\
    \ or grep('\U0001F4F8', this['ProcessCommandLine']) or grep('\U0001F4F9', this['ProcessCommandLine'])\
    \ or grep('\U0001F3A5', this['ProcessCommandLine']) or grep('\U0001F4FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F39E', this['ProcessCommandLine']) or grep('\U0001F4DE', this['ProcessCommandLine'])\
    \ or grep('\u260E\uFE0F', this['ProcessCommandLine']) or grep('\U0001F4DF', this['ProcessCommandLine'])\
    \ or grep('\U0001F4E0', this['ProcessCommandLine']) or grep('\U0001F4FA', this['ProcessCommandLine'])\
    \ or grep('\U0001F4FB', this['ProcessCommandLine']) or grep('\U0001F399', this['ProcessCommandLine'])\
    \ or grep('\U0001F39A', this['ProcessCommandLine']) or grep('\U0001F39B', this['ProcessCommandLine'])\
    \ or grep('\U0001F9ED', this['ProcessCommandLine']) or grep('\u23F1', this['ProcessCommandLine'])\
    \ or grep('\u23F2', this['ProcessCommandLine']) or grep('\u23F0', this['ProcessCommandLine'])\
    \ or grep('\U0001F570', this['ProcessCommandLine']) or grep('\u231B\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u23F3', this['ProcessCommandLine']) or grep('\U0001F4E1', this['ProcessCommandLine'])\
    \ or grep('\U0001F50B', this['ProcessCommandLine']) or grep('\U0001FAAB', this['ProcessCommandLine'])\
    \ or grep('\U0001F50C', this['ProcessCommandLine']) or grep('\U0001F4A1', this['ProcessCommandLine'])\
    \ or grep('\U0001F526', this['ProcessCommandLine']) or grep('\U0001F56F', this['ProcessCommandLine'])\
    \ or grep('\U0001FA94', this['ProcessCommandLine']) or grep('\U0001F9EF', this['ProcessCommandLine'])\
    \ or grep('\U0001F6E2', this['ProcessCommandLine']) or grep('\U0001F4B8', this['ProcessCommandLine'])\
    \ or grep('\U0001F4B5', this['ProcessCommandLine']) or grep('\U0001F4B4', this['ProcessCommandLine'])\
    \ or grep('\U0001F4B6', this['ProcessCommandLine']) or grep('\U0001F4B7', this['ProcessCommandLine'])\
    \ or grep('\U0001FA99', this['ProcessCommandLine']) or grep('\U0001F4B0', this['ProcessCommandLine'])\
    \ or grep('\U0001F4B3', this['ProcessCommandLine']) or grep('\U0001F48E', this['ProcessCommandLine'])\
    \ or grep('\u2696\uFE0F', this['ProcessCommandLine']) or grep('\U0001FA9C', this['ProcessCommandLine'])\
    \ or grep('\U0001F9F0', this['ProcessCommandLine']) or grep('\U0001FA9B', this['ProcessCommandLine'])\
    \ or grep('\U0001F527', this['ProcessCommandLine']) or grep('\U0001F528', this['ProcessCommandLine'])\
    \ or grep('\u2692', this['ProcessCommandLine']) or grep('\U0001F6E0', this['ProcessCommandLine'])\
    \ or grep('\u26CF', this['ProcessCommandLine']) or grep('\U0001FA9A', this['ProcessCommandLine'])\
    \ or grep('\U0001F529', this['ProcessCommandLine']) or grep('\u2699\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001FAA4', this['ProcessCommandLine']) or grep('\U0001F9F1', this['ProcessCommandLine'])\
    \ or grep('\u26D3', this['ProcessCommandLine']) or grep('\U0001F9F2', this['ProcessCommandLine'])\
    \ or grep('\U0001F52B', this['ProcessCommandLine']) or grep('\U0001F4A3', this['ProcessCommandLine'])\
    \ or grep('\U0001F9E8', this['ProcessCommandLine']) or grep('\U0001FA93', this['ProcessCommandLine'])\
    \ or grep('\U0001F52A', this['ProcessCommandLine']) or grep('\U0001F5E1', this['ProcessCommandLine'])\
    \ or grep('\u2694\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6E1', this['ProcessCommandLine'])\
    \ or grep('\U0001F6AC', this['ProcessCommandLine']) or grep('\u26B0\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001FAA6', this['ProcessCommandLine']) or grep('\u26B1\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F3FA', this['ProcessCommandLine']) or grep('\U0001F52E', this['ProcessCommandLine'])\
    \ or grep('\U0001F4FF', this['ProcessCommandLine']) or grep('\U0001F9FF', this['ProcessCommandLine'])\
    \ or grep('\U0001FAAC', this['ProcessCommandLine']) or grep('\U0001F488', this['ProcessCommandLine'])\
    \ or grep('\u2697\uFE0F', this['ProcessCommandLine']) or grep('\U0001F52D', this['ProcessCommandLine'])\
    \ or grep('\U0001F52C', this['ProcessCommandLine']) or grep('\U0001F573', this['ProcessCommandLine'])\
    \ or grep('\U0001FA79', this['ProcessCommandLine']) or grep('\U0001FA7A', this['ProcessCommandLine'])\
    \ or grep('\U0001FA7B', this['ProcessCommandLine']) or grep('\U0001FA7C', this['ProcessCommandLine'])\
    \ or grep('\U0001F48A', this['ProcessCommandLine']) or grep('\U0001F489', this['ProcessCommandLine'])\
    \ or grep('\U0001FA78', this['ProcessCommandLine']) or grep('\U0001F9EC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9A0', this['ProcessCommandLine']) or grep('\U0001F9EB', this['ProcessCommandLine'])\
    \ or grep('\U0001F9EA', this['ProcessCommandLine']) or grep('\U0001F321', this['ProcessCommandLine'])\
    \ or grep('\U0001F9F9', this['ProcessCommandLine']) or grep('\U0001FAA0', this['ProcessCommandLine'])\
    \ or grep('\U0001F9FA', this['ProcessCommandLine']) or grep('\U0001F9FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F6BD', this['ProcessCommandLine']) or grep('\U0001F6B0', this['ProcessCommandLine'])\
    \ or grep('\U0001F6BF', this['ProcessCommandLine']) or grep('\U0001F6C1', this['ProcessCommandLine'])\
    \ or grep('\U0001F6C0', this['ProcessCommandLine']) or grep('\U0001F9FC', this['ProcessCommandLine'])\
    \ or grep('\U0001FAA5', this['ProcessCommandLine']) or grep('\U0001FA92', this['ProcessCommandLine'])\
    \ or grep('\U0001F9FD', this['ProcessCommandLine']) or grep('\U0001FAA3', this['ProcessCommandLine'])\
    \ or grep('\U0001F9F4', this['ProcessCommandLine']) or grep('\U0001F6CE', this['ProcessCommandLine'])\
    \ or grep('\U0001F511', this['ProcessCommandLine']) or grep('\U0001F5DD', this['ProcessCommandLine'])\
    \ or grep('\U0001F6AA', this['ProcessCommandLine']) or grep('\U0001FA91', this['ProcessCommandLine'])\
    \ or grep('\U0001F6CB', this['ProcessCommandLine']) or grep('\U0001F6CF', this['ProcessCommandLine'])\
    \ or grep('\U0001F6CC', this['ProcessCommandLine']) or grep('\U0001F9F8', this['ProcessCommandLine'])\
    \ or grep('\U0001FA86', this['ProcessCommandLine']) or grep('\U0001F5BC', this['ProcessCommandLine'])\
    \ or grep('\U0001FA9E', this['ProcessCommandLine']) or grep('\U0001FA9F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6CD', this['ProcessCommandLine']) or grep('\U0001F6D2', this['ProcessCommandLine'])\
    \ or grep('\U0001F381', this['ProcessCommandLine']) or grep('\U0001F388', this['ProcessCommandLine'])\
    \ or grep('\U0001F38F', this['ProcessCommandLine']) or grep('\U0001F380', this['ProcessCommandLine'])\
    \ or grep('\U0001FA84', this['ProcessCommandLine']) or grep('\U0001FA85', this['ProcessCommandLine'])\
    \ or grep('\U0001F38A', this['ProcessCommandLine']) or grep('\U0001F389', this['ProcessCommandLine'])\
    \ or grep('\U0001FAA9', this['ProcessCommandLine']) or grep('\U0001F38E', this['ProcessCommandLine'])\
    \ or grep('\U0001F3EE', this['ProcessCommandLine']) or grep('\U0001F390', this['ProcessCommandLine'])\
    \ or grep('\U0001F9E7', this['ProcessCommandLine']) or grep('\u2709\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F4E9', this['ProcessCommandLine']) or grep('\U0001F4E8', this['ProcessCommandLine'])\
    \ or grep('\U0001F4E7', this['ProcessCommandLine']) or grep('\U0001F48C', this['ProcessCommandLine'])\
    \ or grep('\U0001F4E5', this['ProcessCommandLine']) or grep('\U0001F4E4', this['ProcessCommandLine'])\
    \ or grep('\U0001F4E6', this['ProcessCommandLine']) or grep('\U0001F3F7', this['ProcessCommandLine'])\
    \ or grep('\U0001FAA7', this['ProcessCommandLine']) or grep('\U0001F4EA', this['ProcessCommandLine'])\
    \ or grep('\U0001F4EB', this['ProcessCommandLine']) or grep('\U0001F4EC', this['ProcessCommandLine'])\
    \ or grep('\U0001F4ED', this['ProcessCommandLine']) or grep('\U0001F4EE', this['ProcessCommandLine'])\
    \ or grep('\U0001F4EF', this['ProcessCommandLine']) or grep('\U0001F4DC', this['ProcessCommandLine'])\
    \ or grep('\U0001F4C3', this['ProcessCommandLine']) or grep('\U0001F4C4', this['ProcessCommandLine'])\
    \ or grep('\U0001F4D1', this['ProcessCommandLine']) or grep('\U0001F9FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F4CA', this['ProcessCommandLine']) or grep('\U0001F4C8', this['ProcessCommandLine'])\
    \ or grep('\U0001F4C9', this['ProcessCommandLine']) or grep('\U0001F5D2', this['ProcessCommandLine'])\
    \ or grep('\U0001F5D3', this['ProcessCommandLine']) or grep('\U0001F4C6', this['ProcessCommandLine'])\
    \ or grep('\U0001F4C5', this['ProcessCommandLine']) or grep('\U0001F5D1', this['ProcessCommandLine'])\
    \ or grep('\U0001FAAA', this['ProcessCommandLine']) or grep('\U0001F4C7', this['ProcessCommandLine'])\
    \ or grep('\U0001F5C3', this['ProcessCommandLine']) or grep('\U0001F5F3', this['ProcessCommandLine'])\
    \ or grep('\U0001F5C4', this['ProcessCommandLine']) or grep('\U0001F4CB', this['ProcessCommandLine'])\
    \ or grep('\U0001F4C1', this['ProcessCommandLine']) or grep('\U0001F4C2', this['ProcessCommandLine'])\
    \ or grep('\U0001F5C2', this['ProcessCommandLine']) or grep('\U0001F5DE', this['ProcessCommandLine'])\
    \ or grep('\U0001F4F0', this['ProcessCommandLine']) or grep('\U0001F4D3', this['ProcessCommandLine'])\
    \ or grep('\U0001F4D4', this['ProcessCommandLine']) or grep('\U0001F4D2', this['ProcessCommandLine'])\
    \ or grep('\U0001F4D5', this['ProcessCommandLine']) or grep('\U0001F4D7', this['ProcessCommandLine'])\
    \ or grep('\U0001F4D8', this['ProcessCommandLine']) or grep('\U0001F4D9', this['ProcessCommandLine'])\
    \ or grep('\U0001F4DA', this['ProcessCommandLine']) or grep('\U0001F4D6', this['ProcessCommandLine'])\
    \ or grep('\U0001F516', this['ProcessCommandLine']) or grep('\U0001F9F7', this['ProcessCommandLine'])\
    \ or grep('\U0001F517', this['ProcessCommandLine']) or grep('\U0001F4CE', this['ProcessCommandLine'])\
    \ or grep('\U0001F587', this['ProcessCommandLine']) or grep('\U0001F4D0', this['ProcessCommandLine'])\
    \ or grep('\U0001F4CF', this['ProcessCommandLine']) or grep('\U0001F9EE', this['ProcessCommandLine'])\
    \ or grep('\U0001F4CC', this['ProcessCommandLine']) or grep('\U0001F4CD', this['ProcessCommandLine'])\
    \ or grep('\u2702\uFE0F', this['ProcessCommandLine']) or grep('\U0001F58A', this['ProcessCommandLine'])\
    \ or grep('\U0001F58B', this['ProcessCommandLine']) or grep('\u2712\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F58C', this['ProcessCommandLine']) or grep('\U0001F58D', this['ProcessCommandLine'])\
    \ or grep('\U0001F4DD', this['ProcessCommandLine']) or grep('\u270F\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F50D', this['ProcessCommandLine']) or grep('\U0001F50E', this['ProcessCommandLine'])\
    \ or grep('\U0001F50F', this['ProcessCommandLine']) or grep('\U0001F510', this['ProcessCommandLine'])\
    \ or grep('\U0001F512', this['ProcessCommandLine']) or grep('\U0001F513\u2764\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9E1', this['ProcessCommandLine'])\
    \ or grep('\U0001F49B', this['ProcessCommandLine']) or grep('\U0001F49A', this['ProcessCommandLine'])\
    \ or grep('\U0001F499', this['ProcessCommandLine']) or grep('\U0001F49C', this['ProcessCommandLine'])\
    \ or grep('\U0001F5A4', this['ProcessCommandLine']) or grep('\U0001F90D', this['ProcessCommandLine'])\
    \ or grep('\U0001F90E', this['ProcessCommandLine']) or grep('\u2764\uFE0F\u200D\
    \U0001F525', this['ProcessCommandLine']) or grep('\u2764\uFE0F\u200D\U0001FA79\
    ', this['ProcessCommandLine']) or grep('\U0001F494', this['ProcessCommandLine'])\
    \ or grep('\u2763\uFE0F', this['ProcessCommandLine']) or grep('\U0001F495', this['ProcessCommandLine'])\
    \ or grep('\U0001F49E', this['ProcessCommandLine']) or grep('\U0001F493', this['ProcessCommandLine'])\
    \ or grep('\U0001F497', this['ProcessCommandLine']) or grep('\U0001F496', this['ProcessCommandLine'])\
    \ or grep('\U0001F498', this['ProcessCommandLine']) or grep('\U0001F49D', this['ProcessCommandLine'])\
    \ or grep('\U0001F49F', this['ProcessCommandLine']) or grep('\u262E\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u271D\uFE0F', this['ProcessCommandLine']) or grep('\u262A\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\U0001F549', this['ProcessCommandLine'])\
    \ or grep('\u2638\uFE0F', this['ProcessCommandLine']) or grep('\u2721\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\U0001F52F', this['ProcessCommandLine'])\
    \ or grep('\U0001F54E', this['ProcessCommandLine']) or grep('\u262F\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u2626\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6D0', this['ProcessCommandLine'])\
    \ or grep('\u26CE', this['ProcessCommandLine']) or grep('\u2648\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u2649\uFE0F', this['ProcessCommandLine']) or grep('\u264A\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\u264B\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u264C\uFE0F', this['ProcessCommandLine']) or grep('\u264D\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\u264E\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u264F\uFE0F', this['ProcessCommandLine']) or grep('\u2650\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\u2651\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u2652\uFE0F', this['ProcessCommandLine']) or grep('\u2653\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\U0001F194', this['ProcessCommandLine'])\
    \ or grep('\u269B\uFE0F', this['ProcessCommandLine']) or grep('\U0001F251', this['ProcessCommandLine'])\
    \ or grep('\u2622\uFE0F', this['ProcessCommandLine']) or grep('\u2623\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\U0001F4F4', this['ProcessCommandLine'])\
    \ or grep('\U0001F4F3', this['ProcessCommandLine']) or grep('\U0001F236', this['ProcessCommandLine'])\
    \ or grep('\U0001F21A\uFE0F', this['ProcessCommandLine']) or grep('\U0001F238\
    ', this['ProcessCommandLine']) or grep('\U0001F23A', this['ProcessCommandLine'])\
    \ or grep('\U0001F237\uFE0F', this['ProcessCommandLine']) or grep('\u2734\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F19A', this['ProcessCommandLine'])\
    \ or grep('\U0001F4AE', this['ProcessCommandLine']) or grep('\U0001F250', this['ProcessCommandLine'])\
    \ or grep('\u3299\uFE0F', this['ProcessCommandLine']) or grep('\u3297\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\U0001F234', this['ProcessCommandLine'])\
    \ or grep('\U0001F235', this['ProcessCommandLine']) or grep('\U0001F239', this['ProcessCommandLine'])\
    \ or grep('\U0001F232', this['ProcessCommandLine']) or grep('\U0001F170\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F171\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F18E', this['ProcessCommandLine']) or grep('\U0001F191', this['ProcessCommandLine'])\
    \ or grep('\U0001F17E\uFE0F', this['ProcessCommandLine']) or grep('\U0001F198\
    ', this['ProcessCommandLine']) or grep('\u274C', this['ProcessCommandLine']) or\
    \ grep('\u2B55\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6D1', this['ProcessCommandLine'])\
    \ or grep('\u26D4\uFE0F', this['ProcessCommandLine']) or grep('\U0001F4DB', this['ProcessCommandLine'])\
    \ or grep('\U0001F6AB', this['ProcessCommandLine']) or grep('\U0001F4AF', this['ProcessCommandLine'])\
    \ or grep('\U0001F4A2', this['ProcessCommandLine']) or grep('\u2668\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B7', this['ProcessCommandLine']) or grep('\U0001F6AF', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B3', this['ProcessCommandLine']) or grep('\U0001F6B1', this['ProcessCommandLine'])\
    \ or grep('\U0001F51E', this['ProcessCommandLine']) or grep('\U0001F4F5', this['ProcessCommandLine'])\
    \ or grep('\U0001F6AD', this['ProcessCommandLine']) or grep('\u2757\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u2755', this['ProcessCommandLine']) or grep('\u2753', this['ProcessCommandLine'])\
    \ or grep('\u2754', this['ProcessCommandLine']) or grep('\u203C\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u2049\uFE0F', this['ProcessCommandLine']) or grep('\U0001F505', this['ProcessCommandLine'])\
    \ or grep('\U0001F506', this['ProcessCommandLine']) or grep('\u303D\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u26A0\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6B8', this['ProcessCommandLine'])\
    \ or grep('\U0001F531', this['ProcessCommandLine']) or grep('\u269C\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F530', this['ProcessCommandLine']) or grep('\u267B\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u2705', this['ProcessCommandLine']) or grep('\U0001F22F\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F4B9', this['ProcessCommandLine']) or grep('\u2747\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u2733\uFE0F', this['ProcessCommandLine']) or grep('\u274E', this['ProcessCommandLine'])\
    \ or grep('\U0001F310', this['ProcessCommandLine']) or grep('\U0001F4A0', this['ProcessCommandLine'])\
    \ or grep('\u24C2\uFE0F', this['ProcessCommandLine']) or grep('\U0001F300', this['ProcessCommandLine'])\
    \ or grep('\U0001F4A4', this['ProcessCommandLine']) or grep('\U0001F3E7', this['ProcessCommandLine'])\
    \ or grep('\U0001F6BE', this['ProcessCommandLine']) or grep('\u267F\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F17F\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6D7\
    ', this['ProcessCommandLine']) or grep('\U0001F233', this['ProcessCommandLine'])\
    \ or grep('\U0001F202\uFE0F', this['ProcessCommandLine']) or grep('\U0001F6C2\
    ', this['ProcessCommandLine']) or grep('\U0001F6C3', this['ProcessCommandLine'])\
    \ or grep('\U0001F6C4', this['ProcessCommandLine']) or grep('\U0001F6C5', this['ProcessCommandLine'])\
    \ or grep('\U0001F6B9', this['ProcessCommandLine']) or grep('\U0001F6BA', this['ProcessCommandLine'])\
    \ or grep('\U0001F6BC', this['ProcessCommandLine']) or grep('\u26A7', this['ProcessCommandLine'])\
    \ or grep('\U0001F6BB', this['ProcessCommandLine']) or grep('\U0001F6AE', this['ProcessCommandLine'])\
    \ or grep('\U0001F3A6', this['ProcessCommandLine']) or grep('\U0001F4F6', this['ProcessCommandLine'])\
    \ or grep('\U0001F201', this['ProcessCommandLine']) or grep('\U0001F523', this['ProcessCommandLine'])\
    \ or grep('\u2139\uFE0F', this['ProcessCommandLine']) or grep('\U0001F524', this['ProcessCommandLine'])\
    \ or grep('\U0001F521', this['ProcessCommandLine']) or grep('\U0001F520', this['ProcessCommandLine'])\
    \ or grep('\U0001F196', this['ProcessCommandLine']) or grep('\U0001F197', this['ProcessCommandLine'])\
    \ or grep('\U0001F199', this['ProcessCommandLine']) or grep('\U0001F192', this['ProcessCommandLine'])\
    \ or grep('\U0001F195', this['ProcessCommandLine']) or grep('\U0001F193', this['ProcessCommandLine'])\
    \ or grep('0\uFE0F\u20E3', this['ProcessCommandLine']) or grep('1\uFE0F\u20E3\
    ', this['ProcessCommandLine']) or grep('2\uFE0F\u20E3', this['ProcessCommandLine'])\
    \ or grep('3\uFE0F\u20E3', this['ProcessCommandLine']) or grep('4\uFE0F\u20E3\
    ', this['ProcessCommandLine']) or grep('5\uFE0F\u20E3', this['ProcessCommandLine'])\
    \ or grep('6\uFE0F\u20E3', this['ProcessCommandLine']) or grep('7\uFE0F\u20E3\
    ', this['ProcessCommandLine']) or grep('8\uFE0F\u20E3', this['ProcessCommandLine'])\
    \ or grep('9\uFE0F\u20E3', this['ProcessCommandLine']) or grep('\U0001F51F', this['ProcessCommandLine'])\
    \ or grep('\U0001F522', this['ProcessCommandLine']) or grep('#\uFE0F\u20E3', this['ProcessCommandLine'])\
    \ or grep('\uFE0F\u20E3', this['ProcessCommandLine']) or grep('\u23CF\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\u25B6\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u23F8', this['ProcessCommandLine']) or grep('\u23EF', this['ProcessCommandLine'])\
    \ or grep('\u23F9', this['ProcessCommandLine']) or grep('\u23FA', this['ProcessCommandLine'])\
    \ or grep('\u23ED', this['ProcessCommandLine']) or grep('\u23EE', this['ProcessCommandLine'])\
    \ or grep('\u23E9', this['ProcessCommandLine']) or grep('\u23EA', this['ProcessCommandLine'])\
    \ or grep('\u23EB', this['ProcessCommandLine']) or grep('\u23EC', this['ProcessCommandLine'])\
    \ or grep('\u25C0\uFE0F', this['ProcessCommandLine']) or grep('\U0001F53C', this['ProcessCommandLine'])\
    \ or grep('\U0001F53D', this['ProcessCommandLine']) or grep('\u27A1\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u2B05\uFE0F', this['ProcessCommandLine']) or grep('\u2B06\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\u2B07\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u2197\uFE0F', this['ProcessCommandLine']) or grep('\u2198\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\u2199\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u2196\uFE0F', this['ProcessCommandLine']) or grep('\u2195\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\u2194\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u21AA\uFE0F', this['ProcessCommandLine']) or grep('\u21A9\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\u2934\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u2935\uFE0F', this['ProcessCommandLine']) or grep('\U0001F500', this['ProcessCommandLine'])\
    \ or grep('\U0001F501', this['ProcessCommandLine']) or grep('\U0001F502', this['ProcessCommandLine'])\
    \ or grep('\U0001F504', this['ProcessCommandLine']) or grep('\U0001F503', this['ProcessCommandLine'])\
    \ or grep('\U0001F3B5', this['ProcessCommandLine']) or grep('\U0001F3B6', this['ProcessCommandLine'])\
    \ or grep('\u2795', this['ProcessCommandLine']) or grep('\u2796', this['ProcessCommandLine'])\
    \ or grep('\u2797', this['ProcessCommandLine']) or grep('\u2716\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F7F0', this['ProcessCommandLine']) or grep('\u267E', this['ProcessCommandLine'])\
    \ or grep('\U0001F4B2', this['ProcessCommandLine']) or grep('\U0001F4B1', this['ProcessCommandLine'])\
    \ or grep('\u2122\uFE0F', this['ProcessCommandLine']) or grep('\xA9\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\xAE\uFE0F', this['ProcessCommandLine']) or grep('\u3030\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u27B0', this['ProcessCommandLine']) or grep('\u27BF', this['ProcessCommandLine'])\
    \ or grep('\U0001F51A', this['ProcessCommandLine']) or grep('\U0001F519', this['ProcessCommandLine'])\
    \ or grep('\U0001F51B', this['ProcessCommandLine']) or grep('\U0001F51D', this['ProcessCommandLine'])\
    \ or grep('\U0001F51C', this['ProcessCommandLine']) or grep('\u2714\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u2611\uFE0F', this['ProcessCommandLine']) or grep('\U0001F518', this['ProcessCommandLine'])\
    \ or grep('\U0001F534', this['ProcessCommandLine']) or grep('\U0001F7E0', this['ProcessCommandLine'])\
    \ or grep('\U0001F7E1', this['ProcessCommandLine']) or grep('\U0001F7E2', this['ProcessCommandLine'])\
    \ or grep('\U0001F535', this['ProcessCommandLine']) or grep('\U0001F7E3', this['ProcessCommandLine'])\
    \ or grep('\u26AB\uFE0F', this['ProcessCommandLine']) or grep('\u26AA\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\U0001F7E4', this['ProcessCommandLine'])\
    \ or grep('\U0001F53A', this['ProcessCommandLine']) or grep('\U0001F53B', this['ProcessCommandLine'])"
  sigma_id: f9578658-9e71-4711-b634-3f9b50cd3c06
- name: Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 4
  query: "grep('\U0001F538', this['ProcessCommandLine']) or grep('\U0001F539', this['ProcessCommandLine'])\
    \ or grep('\U0001F536', this['ProcessCommandLine']) or grep('\U0001F537', this['ProcessCommandLine'])\
    \ or grep('\U0001F533', this['ProcessCommandLine']) or grep('\U0001F532', this['ProcessCommandLine'])\
    \ or grep('\u25AA\uFE0F', this['ProcessCommandLine']) or grep('\u25AB\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\u25FE\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u25FD\uFE0F', this['ProcessCommandLine']) or grep('\u25FC\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\u25FB\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F7E5', this['ProcessCommandLine']) or grep('\U0001F7E7', this['ProcessCommandLine'])\
    \ or grep('\U0001F7E8', this['ProcessCommandLine']) or grep('\U0001F7E9', this['ProcessCommandLine'])\
    \ or grep('\U0001F7E6', this['ProcessCommandLine']) or grep('\U0001F7EA', this['ProcessCommandLine'])\
    \ or grep('\u2B1B\uFE0F', this['ProcessCommandLine']) or grep('\u2B1C\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\U0001F7EB', this['ProcessCommandLine'])\
    \ or grep('\U0001F508', this['ProcessCommandLine']) or grep('\U0001F507', this['ProcessCommandLine'])\
    \ or grep('\U0001F509', this['ProcessCommandLine']) or grep('\U0001F50A', this['ProcessCommandLine'])\
    \ or grep('\U0001F514', this['ProcessCommandLine']) or grep('\U0001F515', this['ProcessCommandLine'])\
    \ or grep('\U0001F4E3', this['ProcessCommandLine']) or grep('\U0001F4E2', this['ProcessCommandLine'])\
    \ or grep('\U0001F441\u200D\U0001F5E8', this['ProcessCommandLine']) or grep('\U0001F4AC\
    ', this['ProcessCommandLine']) or grep('\U0001F4AD', this['ProcessCommandLine'])\
    \ or grep('\U0001F5EF', this['ProcessCommandLine']) or grep('\u2660\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\u2663\uFE0F', this['ProcessCommandLine']) or grep('\u2665\uFE0F',\
    \ this['ProcessCommandLine']) or grep('\u2666\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F0CF', this['ProcessCommandLine']) or grep('\U0001F3B4', this['ProcessCommandLine'])\
    \ or grep('\U0001F004\uFE0F', this['ProcessCommandLine']) or grep('\U0001F550\
    ', this['ProcessCommandLine']) or grep('\U0001F551', this['ProcessCommandLine'])\
    \ or grep('\U0001F552', this['ProcessCommandLine']) or grep('\U0001F553', this['ProcessCommandLine'])\
    \ or grep('\U0001F554', this['ProcessCommandLine']) or grep('\U0001F555', this['ProcessCommandLine'])\
    \ or grep('\U0001F556', this['ProcessCommandLine']) or grep('\U0001F557', this['ProcessCommandLine'])\
    \ or grep('\U0001F558', this['ProcessCommandLine']) or grep('\U0001F559', this['ProcessCommandLine'])\
    \ or grep('\U0001F55A', this['ProcessCommandLine']) or grep('\U0001F55B', this['ProcessCommandLine'])\
    \ or grep('\U0001F55C', this['ProcessCommandLine']) or grep('\U0001F55D', this['ProcessCommandLine'])\
    \ or grep('\U0001F55E', this['ProcessCommandLine']) or grep('\U0001F55F', this['ProcessCommandLine'])\
    \ or grep('\U0001F560', this['ProcessCommandLine']) or grep('\U0001F561', this['ProcessCommandLine'])\
    \ or grep('\U0001F562', this['ProcessCommandLine']) or grep('\U0001F563', this['ProcessCommandLine'])\
    \ or grep('\U0001F564', this['ProcessCommandLine']) or grep('\U0001F565', this['ProcessCommandLine'])\
    \ or grep('\U0001F566', this['ProcessCommandLine']) or grep('\U0001F567\u2722\
    ', this['ProcessCommandLine']) or grep('\u2723', this['ProcessCommandLine']) or\
    \ grep('\u2724', this['ProcessCommandLine']) or grep('\u2725', this['ProcessCommandLine'])\
    \ or grep('\u2726', this['ProcessCommandLine']) or grep('\u2727', this['ProcessCommandLine'])\
    \ or grep('\u2605', this['ProcessCommandLine']) or grep('\u2606', this['ProcessCommandLine'])\
    \ or grep('\u272F', this['ProcessCommandLine']) or grep('\u2721\uFE0E', this['ProcessCommandLine'])\
    \ or grep('\u2729', this['ProcessCommandLine']) or grep('\u272A', this['ProcessCommandLine'])\
    \ or grep('\u272B', this['ProcessCommandLine']) or grep('\u272C', this['ProcessCommandLine'])\
    \ or grep('\u272D', this['ProcessCommandLine']) or grep('\u272E', this['ProcessCommandLine'])\
    \ or grep('\u2736', this['ProcessCommandLine']) or grep('\u2737', this['ProcessCommandLine'])\
    \ or grep('\u2735', this['ProcessCommandLine']) or grep('\u2738', this['ProcessCommandLine'])\
    \ or grep('\u2739', this['ProcessCommandLine']) or grep('\u2192', this['ProcessCommandLine'])\
    \ or grep('\u21D2', this['ProcessCommandLine']) or grep('\u27F9', this['ProcessCommandLine'])\
    \ or grep('\u21E8', this['ProcessCommandLine']) or grep('\u21FE', this['ProcessCommandLine'])\
    \ or grep('\u27BE', this['ProcessCommandLine']) or grep('\u21E2', this['ProcessCommandLine'])\
    \ or grep('\u261B', this['ProcessCommandLine']) or grep('\u261E', this['ProcessCommandLine'])\
    \ or grep('\u2794', this['ProcessCommandLine']) or grep('\u279C', this['ProcessCommandLine'])\
    \ or grep('\u2799', this['ProcessCommandLine']) or grep('\u279B', this['ProcessCommandLine'])\
    \ or grep('\u279D', this['ProcessCommandLine']) or grep('\u279E', this['ProcessCommandLine'])\
    \ or grep('\u2660\uFE0E', this['ProcessCommandLine']) or grep('\u2663\uFE0E',\
    \ this['ProcessCommandLine']) or grep('\u2665\uFE0E', this['ProcessCommandLine'])\
    \ or grep('\u2666\uFE0E', this['ProcessCommandLine']) or grep('\u2664', this['ProcessCommandLine'])\
    \ or grep('\u2667', this['ProcessCommandLine']) or grep('\u2661', this['ProcessCommandLine'])\
    \ or grep('\u2662', this['ProcessCommandLine']) or grep('\u265A', this['ProcessCommandLine'])\
    \ or grep('\u265B', this['ProcessCommandLine']) or grep('\u265C', this['ProcessCommandLine'])\
    \ or grep('\u265D', this['ProcessCommandLine']) or grep('\u265E', this['ProcessCommandLine'])\
    \ or grep('\u265F', this['ProcessCommandLine']) or grep('\u2654', this['ProcessCommandLine'])\
    \ or grep('\u2655', this['ProcessCommandLine']) or grep('\u2656', this['ProcessCommandLine'])\
    \ or grep('\u2657', this['ProcessCommandLine']) or grep('\u2658', this['ProcessCommandLine'])\
    \ or grep('\u2659', this['ProcessCommandLine']) or grep('\u2680', this['ProcessCommandLine'])\
    \ or grep('\u2681', this['ProcessCommandLine']) or grep('\u2682', this['ProcessCommandLine'])\
    \ or grep('\u2683', this['ProcessCommandLine']) or grep('\u2684', this['ProcessCommandLine'])\
    \ or grep('\u2685', this['ProcessCommandLine']) or grep('\U0001F0A0', this['ProcessCommandLine'])\
    \ or grep('\u2688', this['ProcessCommandLine']) or grep('\u2689', this['ProcessCommandLine'])\
    \ or grep('\u2686', this['ProcessCommandLine']) or grep('\u2687', this['ProcessCommandLine'])\
    \ or grep('\U00013000', this['ProcessCommandLine']) or grep('\U00013001', this['ProcessCommandLine'])\
    \ or grep('\U00013002', this['ProcessCommandLine']) or grep('\U00013003', this['ProcessCommandLine'])\
    \ or grep('\U00013004', this['ProcessCommandLine']) or grep('\U00013005', this['ProcessCommandLine'])\
    \ or grep('\U00013006', this['ProcessCommandLine']) or grep('\U00013007', this['ProcessCommandLine'])\
    \ or grep('\U00013008', this['ProcessCommandLine']) or grep('\U00013009', this['ProcessCommandLine'])\
    \ or grep('\U0001300A', this['ProcessCommandLine']) or grep('\U0001300B', this['ProcessCommandLine'])\
    \ or grep('\U0001300C', this['ProcessCommandLine']) or grep('\U0001300D', this['ProcessCommandLine'])\
    \ or grep('\U0001300E', this['ProcessCommandLine']) or grep('\U0001300F', this['ProcessCommandLine'])\
    \ or grep('\U00013010', this['ProcessCommandLine']) or grep('\U00013011', this['ProcessCommandLine'])\
    \ or grep('\U00013012', this['ProcessCommandLine']) or grep('\U00013013', this['ProcessCommandLine'])\
    \ or grep('\U00013014', this['ProcessCommandLine']) or grep('\U00013015', this['ProcessCommandLine'])\
    \ or grep('\U00013016', this['ProcessCommandLine']) or grep('\U00013017', this['ProcessCommandLine'])\
    \ or grep('\U00013018', this['ProcessCommandLine']) or grep('\U00013019', this['ProcessCommandLine'])\
    \ or grep('\U0001301A', this['ProcessCommandLine']) or grep('\U0001301B', this['ProcessCommandLine'])\
    \ or grep('\U0001301C', this['ProcessCommandLine']) or grep('\U0001301D\U0001F3F3\
    \uFE0F', this['ProcessCommandLine']) or grep('\U0001F3F4', this['ProcessCommandLine'])\
    \ or grep('\U0001F3C1', this['ProcessCommandLine']) or grep('\U0001F6A9', this['ProcessCommandLine'])\
    \ or grep('\U0001F3F3\uFE0F\u200D\U0001F308', this['ProcessCommandLine']) or grep('\U0001F3F3\
    \uFE0F\u200D\u26A7\uFE0F', this['ProcessCommandLine']) or grep('\U0001F3F4\u200D\
    \u2620\uFE0F', this['ProcessCommandLine']) or grep('\U0001F1E6\U0001F1EB', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E6\U0001F1FD', this['ProcessCommandLine']) or grep('\U0001F1E6\
    \U0001F1F1', this['ProcessCommandLine']) or grep('\U0001F1E9\U0001F1FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E6\U0001F1F8', this['ProcessCommandLine']) or grep('\U0001F1E6\
    \U0001F1E9', this['ProcessCommandLine']) or grep('\U0001F1E6\U0001F1F4', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E6\U0001F1EE', this['ProcessCommandLine']) or grep('\U0001F1E6\
    \U0001F1F6', this['ProcessCommandLine']) or grep('\U0001F1E6\U0001F1EC', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E6\U0001F1F7', this['ProcessCommandLine']) or grep('\U0001F1E6\
    \U0001F1F2', this['ProcessCommandLine']) or grep('\U0001F1E6\U0001F1FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E6\U0001F1FA', this['ProcessCommandLine']) or grep('\U0001F1E6\
    \U0001F1F9', this['ProcessCommandLine']) or grep('\U0001F1E6\U0001F1FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E7\U0001F1F8', this['ProcessCommandLine']) or grep('\U0001F1E7\
    \U0001F1ED', this['ProcessCommandLine']) or grep('\U0001F1E7\U0001F1E9', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E7\U0001F1E7', this['ProcessCommandLine']) or grep('\U0001F1E7\
    \U0001F1FE', this['ProcessCommandLine']) or grep('\U0001F1E7\U0001F1EA', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E7\U0001F1FF', this['ProcessCommandLine']) or grep('\U0001F1E7\
    \U0001F1EF', this['ProcessCommandLine']) or grep('\U0001F1E7\U0001F1F2', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E7\U0001F1F9', this['ProcessCommandLine']) or grep('\U0001F1E7\
    \U0001F1F4', this['ProcessCommandLine']) or grep('\U0001F1E7\U0001F1E6', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E7\U0001F1FC', this['ProcessCommandLine']) or grep('\U0001F1E7\
    \U0001F1F7', this['ProcessCommandLine']) or grep('\U0001F1EE\U0001F1F4', this['ProcessCommandLine'])\
    \ or grep('\U0001F1FB\U0001F1EC', this['ProcessCommandLine']) or grep('\U0001F1E7\
    \U0001F1F3', this['ProcessCommandLine']) or grep('\U0001F1E7\U0001F1EC', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E7\U0001F1EB', this['ProcessCommandLine']) or grep('\U0001F1E7\
    \U0001F1EE', this['ProcessCommandLine']) or grep('\U0001F1F0\U0001F1ED', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E8\U0001F1F2', this['ProcessCommandLine']) or grep('\U0001F1E8\
    \U0001F1E6', this['ProcessCommandLine']) or grep('\U0001F1EE\U0001F1E8', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E8\U0001F1FB', this['ProcessCommandLine']) or grep('\U0001F1E7\
    \U0001F1F6', this['ProcessCommandLine']) or grep('\U0001F1F0\U0001F1FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E8\U0001F1EB', this['ProcessCommandLine']) or grep('\U0001F1F9\
    \U0001F1E9', this['ProcessCommandLine']) or grep('\U0001F1E8\U0001F1F1', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E8\U0001F1F3', this['ProcessCommandLine']) or grep('\U0001F1E8\
    \U0001F1FD', this['ProcessCommandLine']) or grep('\U0001F1E8\U0001F1E8', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E8\U0001F1F4', this['ProcessCommandLine']) or grep('\U0001F1F0\
    \U0001F1F2', this['ProcessCommandLine']) or grep('\U0001F1E8\U0001F1EC', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E8\U0001F1E9', this['ProcessCommandLine']) or grep('\U0001F1E8\
    \U0001F1F0', this['ProcessCommandLine']) or grep('\U0001F1E8\U0001F1F7', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E8\U0001F1EE', this['ProcessCommandLine']) or grep('\U0001F1ED\
    \U0001F1F7', this['ProcessCommandLine']) or grep('\U0001F1E8\U0001F1FA', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E8\U0001F1FC', this['ProcessCommandLine']) or grep('\U0001F1E8\
    \U0001F1FE', this['ProcessCommandLine']) or grep('\U0001F1E8\U0001F1FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E9\U0001F1F0', this['ProcessCommandLine']) or grep('\U0001F1E9\
    \U0001F1EF', this['ProcessCommandLine']) or grep('\U0001F1E9\U0001F1F2', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E9\U0001F1F4', this['ProcessCommandLine']) or grep('\U0001F1EA\
    \U0001F1E8', this['ProcessCommandLine']) or grep('\U0001F1EA\U0001F1EC', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F8\U0001F1FB', this['ProcessCommandLine']) or grep('\U0001F1EC\
    \U0001F1F6', this['ProcessCommandLine']) or grep('\U0001F1EA\U0001F1F7', this['ProcessCommandLine'])\
    \ or grep('\U0001F1EA\U0001F1EA', this['ProcessCommandLine']) or grep('\U0001F1EA\
    \U0001F1F9', this['ProcessCommandLine']) or grep('\U0001F1EA\U0001F1FA', this['ProcessCommandLine'])\
    \ or grep('\U0001F1EB\U0001F1F0', this['ProcessCommandLine']) or grep('\U0001F1EB\
    \U0001F1F4', this['ProcessCommandLine']) or grep('\U0001F1EB\U0001F1EF', this['ProcessCommandLine'])\
    \ or grep('\U0001F1EB\U0001F1EE', this['ProcessCommandLine']) or grep('\U0001F1EB\
    \U0001F1F7', this['ProcessCommandLine']) or grep('\U0001F1EC\U0001F1EB', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F5\U0001F1EB', this['ProcessCommandLine']) or grep('\U0001F1F9\
    \U0001F1EB', this['ProcessCommandLine']) or grep('\U0001F1EC\U0001F1E6', this['ProcessCommandLine'])\
    \ or grep('\U0001F1EC\U0001F1F2', this['ProcessCommandLine']) or grep('\U0001F1EC\
    \U0001F1EA', this['ProcessCommandLine']) or grep('\U0001F1E9\U0001F1EA', this['ProcessCommandLine'])\
    \ or grep('\U0001F1EC\U0001F1ED', this['ProcessCommandLine']) or grep('\U0001F1EC\
    \U0001F1EE', this['ProcessCommandLine']) or grep('\U0001F1EC\U0001F1F7', this['ProcessCommandLine'])\
    \ or grep('\U0001F1EC\U0001F1F1', this['ProcessCommandLine']) or grep('\U0001F1EC\
    \U0001F1E9', this['ProcessCommandLine']) or grep('\U0001F1EC\U0001F1F5', this['ProcessCommandLine'])\
    \ or grep('\U0001F1EC\U0001F1FA', this['ProcessCommandLine']) or grep('\U0001F1EC\
    \U0001F1F9', this['ProcessCommandLine']) or grep('\U0001F1EC\U0001F1EC', this['ProcessCommandLine'])\
    \ or grep('\U0001F1EC\U0001F1F3', this['ProcessCommandLine']) or grep('\U0001F1EC\
    \U0001F1FC', this['ProcessCommandLine']) or grep('\U0001F1EC\U0001F1FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F1ED\U0001F1F9', this['ProcessCommandLine']) or grep('\U0001F1ED\
    \U0001F1F3', this['ProcessCommandLine']) or grep('\U0001F1ED\U0001F1F0', this['ProcessCommandLine'])\
    \ or grep('\U0001F1ED\U0001F1FA', this['ProcessCommandLine']) or grep('\U0001F1EE\
    \U0001F1F8', this['ProcessCommandLine']) or grep('\U0001F1EE\U0001F1F3', this['ProcessCommandLine'])\
    \ or grep('\U0001F1EE\U0001F1E9', this['ProcessCommandLine']) or grep('\U0001F1EE\
    \U0001F1F7', this['ProcessCommandLine']) or grep('\U0001F1EE\U0001F1F6', this['ProcessCommandLine'])\
    \ or grep('\U0001F1EE\U0001F1EA', this['ProcessCommandLine']) or grep('\U0001F1EE\
    \U0001F1F2', this['ProcessCommandLine']) or grep('\U0001F1EE\U0001F1F1', this['ProcessCommandLine'])\
    \ or grep('\U0001F1EE\U0001F1F9', this['ProcessCommandLine']) or grep('\U0001F1EF\
    \U0001F1F2', this['ProcessCommandLine']) or grep('\U0001F1EF\U0001F1F5', this['ProcessCommandLine'])\
    \ or grep('\U0001F38C', this['ProcessCommandLine']) or grep('\U0001F1EF\U0001F1EA\
    ', this['ProcessCommandLine']) or grep('\U0001F1EF\U0001F1F4', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F0\U0001F1FF', this['ProcessCommandLine']) or grep('\U0001F1F0\
    \U0001F1EA', this['ProcessCommandLine']) or grep('\U0001F1F0\U0001F1EE', this['ProcessCommandLine'])\
    \ or grep('\U0001F1FD\U0001F1F0', this['ProcessCommandLine']) or grep('\U0001F1F0\
    \U0001F1FC', this['ProcessCommandLine']) or grep('\U0001F1F0\U0001F1EC', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F1\U0001F1E6', this['ProcessCommandLine']) or grep('\U0001F1F1\
    \U0001F1FB', this['ProcessCommandLine']) or grep('\U0001F1F1\U0001F1E7', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F1\U0001F1F8', this['ProcessCommandLine']) or grep('\U0001F1F1\
    \U0001F1F7', this['ProcessCommandLine']) or grep('\U0001F1F1\U0001F1FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F1\U0001F1EE', this['ProcessCommandLine']) or grep('\U0001F1F1\
    \U0001F1F9', this['ProcessCommandLine']) or grep('\U0001F1F1\U0001F1FA', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F2\U0001F1F4', this['ProcessCommandLine']) or grep('\U0001F1F2\
    \U0001F1F0', this['ProcessCommandLine']) or grep('\U0001F1F2\U0001F1EC', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F2\U0001F1FC', this['ProcessCommandLine']) or grep('\U0001F1F2\
    \U0001F1FE', this['ProcessCommandLine']) or grep('\U0001F1F2\U0001F1FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F2\U0001F1F1', this['ProcessCommandLine']) or grep('\U0001F1F2\
    \U0001F1F9', this['ProcessCommandLine']) or grep('\U0001F1F2\U0001F1ED', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F2\U0001F1F6', this['ProcessCommandLine']) or grep('\U0001F1F2\
    \U0001F1F7', this['ProcessCommandLine']) or grep('\U0001F1F2\U0001F1FA', this['ProcessCommandLine'])\
    \ or grep('\U0001F1FE\U0001F1F9', this['ProcessCommandLine']) or grep('\U0001F1F2\
    \U0001F1FD', this['ProcessCommandLine']) or grep('\U0001F1EB\U0001F1F2', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F2\U0001F1E9', this['ProcessCommandLine']) or grep('\U0001F1F2\
    \U0001F1E8', this['ProcessCommandLine']) or grep('\U0001F1F2\U0001F1F3', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F2\U0001F1EA', this['ProcessCommandLine']) or grep('\U0001F1F2\
    \U0001F1F8', this['ProcessCommandLine']) or grep('\U0001F1F2\U0001F1E6', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F2\U0001F1FF', this['ProcessCommandLine']) or grep('\U0001F1F2\
    \U0001F1F2', this['ProcessCommandLine']) or grep('\U0001F1F3\U0001F1E6', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F3\U0001F1F7', this['ProcessCommandLine']) or grep('\U0001F1F3\
    \U0001F1F5', this['ProcessCommandLine']) or grep('\U0001F1F3\U0001F1F1', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F3\U0001F1E8', this['ProcessCommandLine']) or grep('\U0001F1F3\
    \U0001F1FF', this['ProcessCommandLine']) or grep('\U0001F1F3\U0001F1EE', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F3\U0001F1EA', this['ProcessCommandLine']) or grep('\U0001F1F3\
    \U0001F1EC', this['ProcessCommandLine']) or grep('\U0001F1F3\U0001F1FA', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F3\U0001F1EB', this['ProcessCommandLine']) or grep('\U0001F1F0\
    \U0001F1F5', this['ProcessCommandLine']) or grep('\U0001F1F2\U0001F1F5', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F3\U0001F1F4', this['ProcessCommandLine']) or grep('\U0001F1F4\
    \U0001F1F2', this['ProcessCommandLine']) or grep('\U0001F1F5\U0001F1F0', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F5\U0001F1FC', this['ProcessCommandLine']) or grep('\U0001F1F5\
    \U0001F1F8', this['ProcessCommandLine']) or grep('\U0001F1F5\U0001F1E6', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F5\U0001F1EC', this['ProcessCommandLine']) or grep('\U0001F1F5\
    \U0001F1FE', this['ProcessCommandLine']) or grep('\U0001F1F5\U0001F1EA', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F5\U0001F1ED', this['ProcessCommandLine']) or grep('\U0001F1F5\
    \U0001F1F3', this['ProcessCommandLine']) or grep('\U0001F1F5\U0001F1F1', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F5\U0001F1F9', this['ProcessCommandLine']) or grep('\U0001F1F5\
    \U0001F1F7', this['ProcessCommandLine']) or grep('\U0001F1F6\U0001F1E6', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F7\U0001F1EA', this['ProcessCommandLine']) or grep('\U0001F1F7\
    \U0001F1F4', this['ProcessCommandLine']) or grep('\U0001F1F7\U0001F1FA', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F7\U0001F1FC', this['ProcessCommandLine']) or grep('\U0001F1FC\
    \U0001F1F8', this['ProcessCommandLine']) or grep('\U0001F1F8\U0001F1F2', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F8\U0001F1E6', this['ProcessCommandLine']) or grep('\U0001F1F8\
    \U0001F1F3', this['ProcessCommandLine']) or grep('\U0001F1F7\U0001F1F8', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F8\U0001F1E8', this['ProcessCommandLine']) or grep('\U0001F1F8\
    \U0001F1F1', this['ProcessCommandLine']) or grep('\U0001F1F8\U0001F1EC', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F8\U0001F1FD', this['ProcessCommandLine']) or grep('\U0001F1F8\
    \U0001F1F0', this['ProcessCommandLine']) or grep('\U0001F1F8\U0001F1EE', this['ProcessCommandLine'])\
    \ or grep('\U0001F1EC\U0001F1F8', this['ProcessCommandLine']) or grep('\U0001F1F8\
    \U0001F1E7', this['ProcessCommandLine']) or grep('\U0001F1F8\U0001F1F4', this['ProcessCommandLine'])\
    \ or grep('\U0001F1FF\U0001F1E6', this['ProcessCommandLine']) or grep('\U0001F1F0\
    \U0001F1F7', this['ProcessCommandLine']) or grep('\U0001F1F8\U0001F1F8', this['ProcessCommandLine'])\
    \ or grep('\U0001F1EA\U0001F1F8', this['ProcessCommandLine']) or grep('\U0001F1F1\
    \U0001F1F0', this['ProcessCommandLine']) or grep('\U0001F1E7\U0001F1F1', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F8\U0001F1ED', this['ProcessCommandLine']) or grep('\U0001F1F0\
    \U0001F1F3', this['ProcessCommandLine']) or grep('\U0001F1F1\U0001F1E8', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F5\U0001F1F2', this['ProcessCommandLine']) or grep('\U0001F1FB\
    \U0001F1E8', this['ProcessCommandLine']) or grep('\U0001F1F8\U0001F1E9', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F8\U0001F1F7', this['ProcessCommandLine']) or grep('\U0001F1F8\
    \U0001F1FF', this['ProcessCommandLine']) or grep('\U0001F1F8\U0001F1EA', this['ProcessCommandLine'])\
    \ or grep('\U0001F1E8\U0001F1ED', this['ProcessCommandLine']) or grep('\U0001F1F8\
    \U0001F1FE', this['ProcessCommandLine']) or grep('\U0001F1F9\U0001F1FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F9\U0001F1EF', this['ProcessCommandLine']) or grep('\U0001F1F9\
    \U0001F1FF', this['ProcessCommandLine']) or grep('\U0001F1F9\U0001F1ED', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F9\U0001F1F1', this['ProcessCommandLine']) or grep('\U0001F1F9\
    \U0001F1EC', this['ProcessCommandLine']) or grep('\U0001F1F9\U0001F1F0', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F9\U0001F1F4', this['ProcessCommandLine']) or grep('\U0001F1F9\
    \U0001F1F9', this['ProcessCommandLine']) or grep('\U0001F1F9\U0001F1F3', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F9\U0001F1F7', this['ProcessCommandLine']) or grep('\U0001F1F9\
    \U0001F1F2', this['ProcessCommandLine']) or grep('\U0001F1F9\U0001F1E8', this['ProcessCommandLine'])\
    \ or grep('\U0001F1F9\U0001F1FB', this['ProcessCommandLine']) or grep('\U0001F1FB\
    \U0001F1EE', this['ProcessCommandLine']) or grep('\U0001F1FA\U0001F1EC', this['ProcessCommandLine'])\
    \ or grep('\U0001F1FA\U0001F1E6', this['ProcessCommandLine']) or grep('\U0001F1E6\
    \U0001F1EA', this['ProcessCommandLine']) or grep('\U0001F1EC\U0001F1E7', this['ProcessCommandLine'])\
    \ or grep('\U0001F3F4\U000E0067\U000E0062\U000E0065\U000E006E\U000E0067\U000E007F\
    ', this['ProcessCommandLine']) or grep('\U0001F3F4\U000E0067\U000E0062\U000E0073\
    \U000E0063\U000E0074\U000E007F', this['ProcessCommandLine']) or grep('\U0001F3F4\
    \U000E0067\U000E0062\U000E0077\U000E006C\U000E0073\U000E007F', this['ProcessCommandLine'])\
    \ or grep('\U0001F1FA\U0001F1F3', this['ProcessCommandLine']) or grep('\U0001F1FA\
    \U0001F1F8', this['ProcessCommandLine']) or grep('\U0001F1FA\U0001F1FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F1FA\U0001F1FF', this['ProcessCommandLine']) or grep('\U0001F1FB\
    \U0001F1FA', this['ProcessCommandLine']) or grep('\U0001F1FB\U0001F1E6', this['ProcessCommandLine'])\
    \ or grep('\U0001F1FB\U0001F1EA', this['ProcessCommandLine']) or grep('\U0001F1FB\
    \U0001F1F3', this['ProcessCommandLine']) or grep('\U0001F1FC\U0001F1EB', this['ProcessCommandLine'])\
    \ or grep('\U0001F1EA\U0001F1ED', this['ProcessCommandLine']) or grep('\U0001F1FE\
    \U0001F1EA', this['ProcessCommandLine']) or grep('\U0001F1FF\U0001F1F2', this['ProcessCommandLine'])\
    \ or grep('\U0001F1FF\U0001F1FC\U0001FAE0', this['ProcessCommandLine']) or grep('\U0001FAE2\
    ', this['ProcessCommandLine']) or grep('\U0001FAE3', this['ProcessCommandLine'])\
    \ or grep('\U0001FAE1', this['ProcessCommandLine']) or grep('\U0001FAE5', this['ProcessCommandLine'])\
    \ or grep('\U0001FAE4', this['ProcessCommandLine']) or grep('\U0001F979', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF1', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FB\
    ', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF1\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAF1\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF2', this['ProcessCommandLine']) or grep('\U0001FAF2\U0001F3FB\
    ', this['ProcessCommandLine']) or grep('\U0001FAF2\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF2\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAF2\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAF2\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF3', this['ProcessCommandLine']) or grep('\U0001FAF3\U0001F3FB\
    ', this['ProcessCommandLine']) or grep('\U0001FAF3\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF3\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAF3\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAF3\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF4', this['ProcessCommandLine']) or grep('\U0001FAF4\U0001F3FB\
    ', this['ProcessCommandLine']) or grep('\U0001FAF4\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF4\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAF4\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAF4\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF0', this['ProcessCommandLine']) or grep('\U0001FAF0\U0001F3FB\
    ', this['ProcessCommandLine']) or grep('\U0001FAF0\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF0\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAF0\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAF0\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF5', this['ProcessCommandLine']) or grep('\U0001FAF5\U0001F3FB\
    ', this['ProcessCommandLine']) or grep('\U0001FAF5\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF5\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAF5\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAF5\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF6', this['ProcessCommandLine']) or grep('\U0001FAF6\U0001F3FB\
    ', this['ProcessCommandLine']) or grep('\U0001FAF6\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001FAF6\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAF6\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAF6\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F91D\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F91D\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F91D\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F91D\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F91D\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FB\u200D\U0001FAF2\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FB\u200D\U0001FAF2\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FB\u200D\U0001FAF2\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FB\u200D\U0001FAF2\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FC\u200D\U0001FAF2\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FC\u200D\U0001FAF2\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FC\u200D\U0001FAF2\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FC\u200D\U0001FAF2\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FD\u200D\U0001FAF2\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FD\u200D\U0001FAF2\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FD\u200D\U0001FAF2\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FD\u200D\U0001FAF2\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FE\u200D\U0001FAF2\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FE\u200D\U0001FAF2\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FE\u200D\U0001FAF2\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FE\u200D\U0001FAF2\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FF\u200D\U0001FAF2\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FF\u200D\U0001FAF2\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FF\u200D\U0001FAF2\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAF1\U0001F3FF\u200D\U0001FAF2\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAE6', this['ProcessCommandLine'])\
    \ or grep('\U0001FAC5', this['ProcessCommandLine']) or grep('\U0001FAC5\U0001F3FB\
    ', this['ProcessCommandLine']) or grep('\U0001FAC5\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001FAC5\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAC5\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAC5\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001FAC3', this['ProcessCommandLine']) or grep('\U0001FAC3\U0001F3FB\
    ', this['ProcessCommandLine']) or grep('\U0001FAC3\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001FAC3\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAC3\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAC3\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001FAC4', this['ProcessCommandLine']) or grep('\U0001FAC4\U0001F3FB\
    ', this['ProcessCommandLine']) or grep('\U0001FAC4\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001FAC4\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001FAC4\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001FAC4\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9CC', this['ProcessCommandLine']) or grep('\U0001FAB8', this['ProcessCommandLine'])\
    \ or grep('\U0001FAB7', this['ProcessCommandLine']) or grep('\U0001FAB9', this['ProcessCommandLine'])\
    \ or grep('\U0001FABA', this['ProcessCommandLine']) or grep('\U0001FAD8', this['ProcessCommandLine'])\
    \ or grep('\U0001FAD7', this['ProcessCommandLine']) or grep('\U0001FAD9', this['ProcessCommandLine'])\
    \ or grep('\U0001F6DD', this['ProcessCommandLine']) or grep('\U0001F6DE', this['ProcessCommandLine'])\
    \ or grep('\U0001F6DF', this['ProcessCommandLine']) or grep('\U0001FAAC', this['ProcessCommandLine'])\
    \ or grep('\U0001FAA9', this['ProcessCommandLine']) or grep('\U0001FAAB', this['ProcessCommandLine'])\
    \ or grep('\U0001FA7C', this['ProcessCommandLine']) or grep('\U0001FA7B', this['ProcessCommandLine'])\
    \ or grep('\U0001FAE7', this['ProcessCommandLine']) or grep('\U0001FAAA', this['ProcessCommandLine'])\
    \ or grep('\U0001F7F0', this['ProcessCommandLine']) or grep('\U0001F62E\u200D\U0001F4A8\
    ', this['ProcessCommandLine']) or grep('\U0001F635\u200D\U0001F4AB', this['ProcessCommandLine'])\
    \ or grep('\U0001F636\u200D\U0001F32B\uFE0F', this['ProcessCommandLine']) or grep('\u2764\
    \uFE0F\u200D\U0001F525', this['ProcessCommandLine']) or grep('\u2764\uFE0F\u200D\
    \U0001FA79', this['ProcessCommandLine']) or grep('\U0001F9D4\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9D4\U0001F3FB\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9D4\U0001F3FC\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9D4\U0001F3FD\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9D4\U0001F3FE\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9D4\U0001F3FF\u200D\u2640\uFE0F\
    ', this['ProcessCommandLine']) or grep('\U0001F9D4\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D4\U0001F3FB\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D4\U0001F3FC\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D4\U0001F3FD\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D4\U0001F3FE\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D4\U0001F3FF\u200D\u2642\uFE0F', this['ProcessCommandLine'])\
    \ or grep('\U0001F491\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F491\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F491\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F491\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F491\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F48F\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F48F\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F48F\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F48F\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F48F\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F468\
    \U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FC',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\u2764\uFE0F\u200D\
    \U0001F468\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\
    \u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FE', this['ProcessCommandLine']) or\
    \ grep('\U0001F468\U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FB',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\u2764\uFE0F\u200D\
    \U0001F468\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\
    \u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FD', this['ProcessCommandLine']) or\
    \ grep('\U0001F468\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FF',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\u2764\uFE0F\u200D\
    \U0001F468\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\
    \u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FC', this['ProcessCommandLine']) or\
    \ grep('\U0001F468\U0001F3FD\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FD\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FE',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\u2764\uFE0F\u200D\
    \U0001F468\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\
    \u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FB', this['ProcessCommandLine']) or\
    \ grep('\U0001F468\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FD',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\u2764\uFE0F\u200D\
    \U0001F468\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\
    \u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FF', this['ProcessCommandLine']) or\
    \ grep('\U0001F468\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FC',\
    \ this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\u2764\uFE0F\u200D\
    \U0001F468\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\
    \u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FE', this['ProcessCommandLine']) or\
    \ grep('\U0001F468\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FB',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\u2764\uFE0F\u200D\
    \U0001F468\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\
    \u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FD', this['ProcessCommandLine']) or\
    \ grep('\U0001F469\U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FF',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\u2764\uFE0F\u200D\
    \U0001F469\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\
    \u200D\u2764\uFE0F\u200D\U0001F469\U0001F3FC', this['ProcessCommandLine']) or\
    \ grep('\U0001F469\U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F469\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F469\U0001F3FE',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\u2764\uFE0F\u200D\
    \U0001F469\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\
    \u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FB', this['ProcessCommandLine']) or\
    \ grep('\U0001F469\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FD',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\u2764\uFE0F\u200D\
    \U0001F468\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\
    \u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FF', this['ProcessCommandLine']) or\
    \ grep('\U0001F469\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F469\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F469\U0001F3FC',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\u2764\uFE0F\u200D\
    \U0001F469\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\
    \u200D\u2764\uFE0F\u200D\U0001F469\U0001F3FE', this['ProcessCommandLine']) or\
    \ grep('\U0001F469\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F469\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FD\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FB',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\u2764\uFE0F\u200D\
    \U0001F468\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\
    \u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FD', this['ProcessCommandLine']) or\
    \ grep('\U0001F469\U0001F3FD\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FD\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FF',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\u2764\uFE0F\u200D\
    \U0001F469\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\
    \u200D\u2764\uFE0F\u200D\U0001F469\U0001F3FC', this['ProcessCommandLine']) or\
    \ grep('\U0001F469\U0001F3FD\u200D\u2764\uFE0F\u200D\U0001F469\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FD\u200D\u2764\uFE0F\u200D\U0001F469\U0001F3FE',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\u2764\uFE0F\u200D\
    \U0001F469\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\
    \u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FB', this['ProcessCommandLine']) or\
    \ grep('\U0001F469\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FD',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\u2764\uFE0F\u200D\
    \U0001F468\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\
    \u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FF', this['ProcessCommandLine']) or\
    \ grep('\U0001F469\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F469\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F469\U0001F3FC',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\u2764\uFE0F\u200D\
    \U0001F469\U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\
    \u200D\u2764\uFE0F\u200D\U0001F469\U0001F3FE', this['ProcessCommandLine']) or\
    \ grep('\U0001F469\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F469\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FB',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\u2764\uFE0F\u200D\
    \U0001F468\U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\
    \u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FD', this['ProcessCommandLine']) or\
    \ grep('\U0001F469\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F468\U0001F3FF',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\u2764\uFE0F\u200D\
    \U0001F469\U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\
    \u200D\u2764\uFE0F\u200D\U0001F469\U0001F3FC', this['ProcessCommandLine']) or\
    \ grep('\U0001F469\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F469\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F469\U0001F3FE',\
    \ this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\u2764\uFE0F\u200D\
    \U0001F469\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\
    \u200D\u2764\uFE0F\u200D\U0001F9D1\U0001F3FC', this['ProcessCommandLine']) or\
    \ grep('\U0001F9D1\U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F9D1\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F9D1\U0001F3FE',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\u2764\uFE0F\u200D\
    \U0001F9D1\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\
    \u200D\u2764\uFE0F\u200D\U0001F9D1\U0001F3FB', this['ProcessCommandLine']) or\
    \ grep('\U0001F9D1\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F9D1\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F9D1\U0001F3FE',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\u2764\uFE0F\u200D\
    \U0001F9D1\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\
    \u200D\u2764\uFE0F\u200D\U0001F9D1\U0001F3FB', this['ProcessCommandLine']) or\
    \ grep('\U0001F9D1\U0001F3FD\u200D\u2764\uFE0F\u200D\U0001F9D1\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FD\u200D\u2764\uFE0F\u200D\U0001F9D1\U0001F3FE',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\u2764\uFE0F\u200D\
    \U0001F9D1\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\
    \u200D\u2764\uFE0F\u200D\U0001F9D1\U0001F3FB', this['ProcessCommandLine']) or\
    \ grep('\U0001F9D1\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F9D1\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F9D1\U0001F3FD',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\u2764\uFE0F\u200D\
    \U0001F9D1\U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\
    \u200D\u2764\uFE0F\u200D\U0001F9D1\U0001F3FB', this['ProcessCommandLine']) or\
    \ grep('\U0001F9D1\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F9D1\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F9D1\U0001F3FD',\
    \ this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\u2764\uFE0F\u200D\
    \U0001F9D1\U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\
    \u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FB\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FC\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FD\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FD\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FD\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FE\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F468\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F468\U0001F3FF\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F469\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F469\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F469\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F469\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FB\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F469\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F469\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F469\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F469\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F469\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FC\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F469\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FD\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FD\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FD\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F469\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FD\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F469\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F469\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FD\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F469\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FD\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F469\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F469\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F469\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F469\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F469\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FE\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F469\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F468\U0001F3FE', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F468\
    \U0001F3FF', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F469\U0001F3FB', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F469\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F469\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F469\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F469\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F469\U0001F3FF\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F469\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F9D1\
    \U0001F3FC', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F9D1\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FB\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F9D1\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FB\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F9D1\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F9D1\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F9D1\U0001F3FD', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FC\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F9D1\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FC\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F9D1\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FD\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F9D1\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F9D1\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FD\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F9D1\
    \U0001F3FE', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FD\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F9D1\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F9D1\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F9D1\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FE\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F9D1\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FE\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F9D1\U0001F3FF', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F9D1\
    \U0001F3FB', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F9D1\U0001F3FC', this['ProcessCommandLine'])\
    \ or grep('\U0001F9D1\U0001F3FF\u200D\u2764\uFE0F\u200D\U0001F48B\u200D\U0001F9D1\
    \U0001F3FD', this['ProcessCommandLine']) or grep('\U0001F9D1\U0001F3FF\u200D\u2764\
    \uFE0F\u200D\U0001F48B\u200D\U0001F9D1\U0001F3FE', this['ProcessCommandLine'])"
  sigma_id: 225274c4-8dd1-40db-9e09-71dff4f6fb3c
- name: ETW Logging Tamper In .NET Processes Via CommandLine
  query: grep('COMPlus_ETWEnabled', this['ProcessCommandLine']) or grep('COMPlus_ETWFlags',
    this['ProcessCommandLine'])
  sigma_id: 41421f44-58f9-455d-838a-c398859841d4
- name: ETW Trace Evasion Activity
  query: grep('cl', this['ProcessCommandLine']) and grep('/Trace', this['ProcessCommandLine'])
    or grep('clear-log', this['ProcessCommandLine']) and grep('/Trace', this['ProcessCommandLine'])
    or grep('sl', this['ProcessCommandLine']) and grep('/e:false', this['ProcessCommandLine'])
    or grep('set-log', this['ProcessCommandLine']) and grep('/e:false', this['ProcessCommandLine'])
    or grep('logman', this['ProcessCommandLine']) and grep('update', this['ProcessCommandLine'])
    and grep('trace', this['ProcessCommandLine']) and grep('--p', this['ProcessCommandLine'])
    and grep('-ets', this['ProcessCommandLine']) or grep('Remove-EtwTraceProvider',
    this['ProcessCommandLine']) or grep('Set-EtwTraceProvider', this['ProcessCommandLine'])
    and grep('0x11', this['ProcessCommandLine'])
  sigma_id: a238b5d0-ce2d-4414-a676-7a531b3d13d6
- name: Suspicious Eventlog Clearing or Configuration Change Activity
  query: (grep('\\wevtutil.exe', this['FolderPath']) and (grep('clear-log ', this['ProcessCommandLine'])
    or grep(' cl ', this['ProcessCommandLine']) or grep('set-log ', this['ProcessCommandLine'])
    or grep(' sl ', this['ProcessCommandLine']) or grep('lfn:', this['ProcessCommandLine']))
    or (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']))
    and (grep('Clear-EventLog ', this['ProcessCommandLine']) or grep('Remove-EventLog
    ', this['ProcessCommandLine']) or grep('Limit-EventLog ', this['ProcessCommandLine'])
    or grep('Clear-WinEvent ', this['ProcessCommandLine'])) or (grep('\\powershell.exe',
    this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']) or grep('\\wmic.exe',
    this['FolderPath'])) and grep('ClearEventLog', this['ProcessCommandLine'])) and
    not ((this['InitiatingProcessFolderPath'] in ['C:\\Windows\\SysWOW64\\msiexec.exe',
    'C:\\Windows\\System32\\msiexec.exe']) and grep(' sl ', this['ProcessCommandLine']))
  sigma_id: cc36992a-4671-4f21-a91d-6c2b72a2edf5
- name: Potentially Suspicious EventLog Recon Activity Using Log Query Utilities
  query: (grep('Microsoft-Windows-PowerShell', this['ProcessCommandLine']) or grep('Microsoft-Windows-Security-Auditing',
    this['ProcessCommandLine']) or grep('Microsoft-Windows-TerminalServices-LocalSessionManager',
    this['ProcessCommandLine']) or grep('Microsoft-Windows-TerminalServices-RemoteConnectionManager',
    this['ProcessCommandLine']) or grep('Microsoft-Windows-Windows Defender', this['ProcessCommandLine'])
    or grep('PowerShellCore', this['ProcessCommandLine']) or grep('Security', this['ProcessCommandLine'])
    or grep('Windows PowerShell', this['ProcessCommandLine']) or grep('-InstanceId
    462', this['ProcessCommandLine']) or grep('.eventid -eq 462', this['ProcessCommandLine'])
    or (grep('EventCode=', this['ProcessCommandLine']) or grep('462', this['ProcessCommandLine']))
    or (grep('EventIdentifier=', this['ProcessCommandLine']) or grep('462', this['ProcessCommandLine']))
    or (grep('System[EventID=462', this['ProcessCommandLine']) or grep(']', this['ProcessCommandLine']))
    or grep('-InstanceId 4778', this['ProcessCommandLine']) or grep('.eventid -eq
    4778', this['ProcessCommandLine']) or grep('System[EventID=4778]', this['ProcessCommandLine'])
    or (grep('EventCode=', this['ProcessCommandLine']) or grep('4778', this['ProcessCommandLine']))
    or (grep('EventIdentifier=', this['ProcessCommandLine']) or grep('4778', this['ProcessCommandLine']))
    or grep('-InstanceId 25', this['ProcessCommandLine']) or grep('.eventid -eq 25',
    this['ProcessCommandLine']) or grep('System[EventID=25]', this['ProcessCommandLine'])
    or (grep('EventCode=', this['ProcessCommandLine']) or grep('25', this['ProcessCommandLine']))
    or (grep('EventIdentifier=', this['ProcessCommandLine']) or grep('25', this['ProcessCommandLine'])))
    and (grep('Select', this['ProcessCommandLine']) and grep('Win32_NTLogEvent', this['ProcessCommandLine'])
    or (grep('\\wevtutil.exe', this['FolderPath']) or grep('wevtutil.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' qe ', this['ProcessCommandLine']) or grep(' query-events ', this['ProcessCommandLine']))
    or (grep('\\wmic.exe', this['FolderPath']) or grep('wmic.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' ntevent', this['ProcessCommandLine']) or grep('Get-WinEvent ', this['ProcessCommandLine'])
    or grep('get-eventlog ', this['ProcessCommandLine']))
  sigma_id: beaa66d6-aa1b-4e3c-80f5-e0145369bfaf
- name: Potentially Suspicious Execution From Parent Process In Public Folder
  query: grep(':\\Users\\Public\\', this['InitiatingProcessFolderPath']) and (grep('\\bitsadmin.exe',
    this['FolderPath']) or grep('\\certutil.exe', this['FolderPath']) or grep('\\cmd.exe',
    this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']) or grep('\\mshta.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\rundll32.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath']) or grep('bitsadmin',
    this['ProcessCommandLine']) or grep('certutil', this['ProcessCommandLine']) or
    grep('cscript', this['ProcessCommandLine']) or grep('mshta', this['ProcessCommandLine'])
    or grep('powershell', this['ProcessCommandLine']) or grep('regsvr32', this['ProcessCommandLine'])
    or grep('rundll32', this['ProcessCommandLine']) or grep('wscript', this['ProcessCommandLine']))
  sigma_id: 69bd9b97-2be2-41b6-9816-fb08757a4d1a
- name: Process Execution From A Potentially Suspicious Folder
  query: (grep(':\\Perflogs\\', this['FolderPath']) or grep(':\\Users\\All Users\\',
    this['FolderPath']) or grep(':\\Users\\Default\\', this['FolderPath']) or grep(':\\Users\\NetworkService\\',
    this['FolderPath']) or grep(':\\Windows\\addins\\', this['FolderPath']) or grep(':\\Windows\\debug\\',
    this['FolderPath']) or grep(':\\Windows\\Fonts\\', this['FolderPath']) or grep(':\\Windows\\Help\\',
    this['FolderPath']) or grep(':\\Windows\\IME\\', this['FolderPath']) or grep(':\\Windows\\Media\\',
    this['FolderPath']) or grep(':\\Windows\\repair\\', this['FolderPath']) or grep(':\\Windows\\security\\',
    this['FolderPath']) or grep(':\\Windows\\System32\\Tasks\\', this['FolderPath'])
    or grep(':\\Windows\\Tasks\\', this['FolderPath']) or grep('$Recycle.bin', this['FolderPath'])
    or grep('\\config\\systemprofile\\', this['FolderPath']) or grep('\\Intel\\Logs\\',
    this['FolderPath']) or grep('\\RSA\\MachineKeys\\', this['FolderPath'])) and not
    (grep('C:\\Users\\Public\\IBM\\ClientSolutions\\Start_Programs\\', this['FolderPath'])
    or grep('C:\\Windows\\SysWOW64\\config\\systemprofile\\Citrix\\UpdaterBinaries\\',
    this['FolderPath']) and grep('\\CitrixReceiverUpdater.exe', this['FolderPath']))
  sigma_id: 3dfd06d2-eaf4-4532-9555-68aca59f57c4
- name: Suspicious File Characteristics Due to Missing Fields
  query: '(grep(''(<SpecialChars.WILDCARD_SINGLE: 2>,)'', this[''ProcessVersionInfoFileDescription''])
    and grep(''(<SpecialChars.WILDCARD_SINGLE: 2>,)'', this[''ProcessVersionInfoProductVersion''])
    or grep(''(<SpecialChars.WILDCARD_SINGLE: 2>,)'', this[''ProcessVersionInfoFileDescription''])
    and grep(''(<SpecialChars.WILDCARD_SINGLE: 2>,)'', this[''ProcessVersionInfoProductName''])
    or grep(''(<SpecialChars.WILDCARD_SINGLE: 2>,)'', this[''ProcessVersionInfoFileDescription''])
    and grep(''(<SpecialChars.WILDCARD_SINGLE: 2>,)'', this[''ProcessVersionInfoCompanyName'']))
    and grep(''\\Downloads\\'', this[''FolderPath''])'
  sigma_id: 9637e8a5-7131-4f7f-bdc7-2b05d8670c43
- name: Suspicious Reconnaissance Activity Via GatherNetworkInfo.VBS
  query: grep('gatherNetworkInfo.vbs', this['ProcessCommandLine']) and not (grep('\\cscript.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath']))
  sigma_id: 07aa184a-870d-413d-893a-157f317f6f58
- name: Potential Hidden Directory Creation Via NTFS INDEX_ALLOCATION Stream - CLI
  query: grep('::$index_allocation', this['ProcessCommandLine'])
  sigma_id: 0900463c-b33b-49a8-be1d-552a3b553dae
- name: Writing Of Malicious Files To The Fonts Folder
  query: (grep('echo', this['ProcessCommandLine']) or grep('copy', this['ProcessCommandLine'])
    or grep('type', this['ProcessCommandLine']) or grep('file createnew', this['ProcessCommandLine'])
    or grep('cacls', this['ProcessCommandLine'])) and grep('C:\\Windows\\Fonts\\',
    this['ProcessCommandLine']) and (grep('.sh', this['ProcessCommandLine']) or grep('.exe',
    this['ProcessCommandLine']) or grep('.dll', this['ProcessCommandLine']) or grep('.bin',
    this['ProcessCommandLine']) or grep('.bat', this['ProcessCommandLine']) or grep('.cmd',
    this['ProcessCommandLine']) or grep('.js', this['ProcessCommandLine']) or grep('.msh',
    this['ProcessCommandLine']) or grep('.reg', this['ProcessCommandLine']) or grep('.scr',
    this['ProcessCommandLine']) or grep('.ps', this['ProcessCommandLine']) or grep('.vb',
    this['ProcessCommandLine']) or grep('.jar', this['ProcessCommandLine']) or grep('.pl',
    this['ProcessCommandLine']) or grep('.inf', this['ProcessCommandLine']) or grep('.cpl',
    this['ProcessCommandLine']) or grep('.hta', this['ProcessCommandLine']) or grep('.msi',
    this['ProcessCommandLine']) or grep('.vbs', this['ProcessCommandLine']))
  sigma_id: ae9b0bd7-8888-4606-b444-0ed7410cb728
- name: Potential Homoglyph Attack Using Lookalike Characters
  query: "grep('\u0410', this['ProcessCommandLine']) or grep('\u0412', this['ProcessCommandLine'])\
    \ or grep('\u0415', this['ProcessCommandLine']) or grep('\u041A', this['ProcessCommandLine'])\
    \ or grep('\u041C', this['ProcessCommandLine']) or grep('\u041D', this['ProcessCommandLine'])\
    \ or grep('\u041E', this['ProcessCommandLine']) or grep('\u0420', this['ProcessCommandLine'])\
    \ or grep('\u0421', this['ProcessCommandLine']) or grep('\u0422', this['ProcessCommandLine'])\
    \ or grep('\u0425', this['ProcessCommandLine']) or grep('\u0405', this['ProcessCommandLine'])\
    \ or grep('\u0406', this['ProcessCommandLine']) or grep('\u0408', this['ProcessCommandLine'])\
    \ or grep('\u04AE', this['ProcessCommandLine']) or grep('\u04C0', this['ProcessCommandLine'])\
    \ or grep('\u050C', this['ProcessCommandLine']) or grep('\u051A', this['ProcessCommandLine'])\
    \ or grep('\u051C', this['ProcessCommandLine']) or grep('\u0391', this['ProcessCommandLine'])\
    \ or grep('\u0392', this['ProcessCommandLine']) or grep('\u0395', this['ProcessCommandLine'])\
    \ or grep('\u0396', this['ProcessCommandLine']) or grep('\u0397', this['ProcessCommandLine'])\
    \ or grep('\u0399', this['ProcessCommandLine']) or grep('\u039A', this['ProcessCommandLine'])\
    \ or grep('\u039C', this['ProcessCommandLine']) or grep('\u039D', this['ProcessCommandLine'])\
    \ or grep('\u039F', this['ProcessCommandLine']) or grep('\u03A1', this['ProcessCommandLine'])\
    \ or grep('\u03A4', this['ProcessCommandLine']) or grep('\u03A5', this['ProcessCommandLine'])\
    \ or grep('\u03A7', this['ProcessCommandLine']) or grep('\u0430', this['ProcessCommandLine'])\
    \ or grep('\u0435', this['ProcessCommandLine']) or grep('\u043E', this['ProcessCommandLine'])\
    \ or grep('\u0440', this['ProcessCommandLine']) or grep('\u0441', this['ProcessCommandLine'])\
    \ or grep('\u0445', this['ProcessCommandLine']) or grep('\u0455', this['ProcessCommandLine'])\
    \ or grep('\u0456', this['ProcessCommandLine']) or grep('\u04CF', this['ProcessCommandLine'])\
    \ or grep('\u0458', this['ProcessCommandLine']) or grep('\u04BB', this['ProcessCommandLine'])\
    \ or grep('\u0501', this['ProcessCommandLine']) or grep('\u051B', this['ProcessCommandLine'])\
    \ or grep('\u051D', this['ProcessCommandLine']) or grep('\u03BF', this['ProcessCommandLine'])"
  sigma_id: 32e280f1-8ad4-46ef-9e80-910657611fbc
- name: Execution Of Non-Existing File
  query: not grep('\\', this['FolderPath']) and not (this['FolderPath']==null or this['FolderPath']
    in ['-', '()'] or this['FolderPath'] in ['System', 'Registry', 'MemCompression',
    'vmmem'] or this['ProcessCommandLine'] in ['Registry', 'MemCompression', 'vmmem'])
  sigma_id: 71158e3f-df67-472b-930e-7d287acaa3e1
- name: Base64 MZ Header In CommandLine
  query: grep('TVqQAAMAAAAEAAAA', this['ProcessCommandLine']) or grep('TVpQAAIAAAAEAA8A',
    this['ProcessCommandLine']) or grep('TVqAAAEAAAAEABAA', this['ProcessCommandLine'])
    or grep('TVoAAAAAAAAAAAAA', this['ProcessCommandLine']) or grep('TVpTAQEAAAAEAAAA',
    this['ProcessCommandLine'])
  sigma_id: 22e58743-4ac8-4a9f-bf19-00a0428d8c5f
- name: Potential WinAPI Calls Via CommandLine
  query: (grep('AddSecurityPackage', this['ProcessCommandLine']) or grep('AdjustTokenPrivileges',
    this['ProcessCommandLine']) or grep('Advapi32', this['ProcessCommandLine']) or
    grep('CloseHandle', this['ProcessCommandLine']) or grep('CreateProcessWithToken',
    this['ProcessCommandLine']) or grep('CreatePseudoConsole', this['ProcessCommandLine'])
    or grep('CreateRemoteThread', this['ProcessCommandLine']) or grep('CreateThread',
    this['ProcessCommandLine']) or grep('CreateUserThread', this['ProcessCommandLine'])
    or grep('DangerousGetHandle', this['ProcessCommandLine']) or grep('DuplicateTokenEx',
    this['ProcessCommandLine']) or grep('EnumerateSecurityPackages', this['ProcessCommandLine'])
    or grep('FreeHGlobal', this['ProcessCommandLine']) or grep('FreeLibrary', this['ProcessCommandLine'])
    or grep('GetDelegateForFunctionPointer', this['ProcessCommandLine']) or grep('GetLogonSessionData',
    this['ProcessCommandLine']) or grep('GetModuleHandle', this['ProcessCommandLine'])
    or grep('GetProcAddress', this['ProcessCommandLine']) or grep('GetProcessHandle',
    this['ProcessCommandLine']) or grep('GetTokenInformation', this['ProcessCommandLine'])
    or grep('ImpersonateLoggedOnUser', this['ProcessCommandLine']) or grep('kernel32',
    this['ProcessCommandLine']) or grep('LoadLibrary', this['ProcessCommandLine'])
    or grep('memcpy', this['ProcessCommandLine']) or grep('MiniDumpWriteDump', this['ProcessCommandLine'])
    or grep('ntdll', this['ProcessCommandLine']) or grep('OpenDesktop', this['ProcessCommandLine'])
    or grep('OpenProcess', this['ProcessCommandLine']) or grep('OpenProcessToken',
    this['ProcessCommandLine']) or grep('OpenThreadToken', this['ProcessCommandLine'])
    or grep('OpenWindowStation', this['ProcessCommandLine']) or grep('PtrToString',
    this['ProcessCommandLine']) or grep('QueueUserApc', this['ProcessCommandLine'])
    or grep('ReadProcessMemory', this['ProcessCommandLine']) or grep('RevertToSelf',
    this['ProcessCommandLine']) or grep('RtlCreateUserThread', this['ProcessCommandLine'])
    or grep('secur32', this['ProcessCommandLine']) or grep('SetThreadToken', this['ProcessCommandLine'])
    or grep('VirtualAlloc', this['ProcessCommandLine']) or grep('VirtualFree', this['ProcessCommandLine'])
    or grep('VirtualProtect', this['ProcessCommandLine']) or grep('WaitForSingleObject',
    this['ProcessCommandLine']) or grep('WriteInt32', this['ProcessCommandLine'])
    or grep('WriteProcessMemory', this['ProcessCommandLine']) or grep('ZeroFreeGlobalAllocUnicode',
    this['ProcessCommandLine'])) and not (grep('\\MpCmdRun.exe', this['FolderPath'])
    and grep('GetLoadLibraryWAddress32', this['ProcessCommandLine']))
  sigma_id: ba3f5c1b-6272-4119-9dbd-0bc8d21c2702
- name: Potentially Suspicious JWT Token Search Via CLI
  query: grep('eyJ0eXAiOi', this['ProcessCommandLine']) or grep('eyJhbGciOi', this['ProcessCommandLine'])
    or grep(' eyJ0eX', this['ProcessCommandLine']) or grep(' "eyJ0eX"', this['ProcessCommandLine'])
    or grep(' \'eyJ0eX\'', this['ProcessCommandLine']) or grep(' eyJhbG', this['ProcessCommandLine'])
    or grep(' "eyJhbG"', this['ProcessCommandLine']) or grep(' \'eyJhbG\'', this['ProcessCommandLine'])
  sigma_id: 6d3a3952-6530-44a3-8554-cf17c116c615
- name: LOLBIN Execution From Abnormal Drive
  query: (grep('\\calc.exe', this['FolderPath']) or grep('\\certutil.exe', this['FolderPath'])
    or grep('\\cmstp.exe', this['FolderPath']) or grep('\\cscript.exe', this['FolderPath'])
    or grep('\\installutil.exe', this['FolderPath']) or grep('\\mshta.exe', this['FolderPath'])
    or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\rundll32.exe', this['FolderPath'])
    or grep('\\wscript.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['CALC.EXE', 'CertUtil.exe', 'CMSTP.EXE', 'cscript.exe', 'installutil.exe',
    'MSHTA.EXE', 'REGSVR32.EXE', 'RUNDLL32.EXE', 'wscript.exe']) and not (grep('C:\\',
    this['CurrentDirectory']) or false or this['CurrentDirectory']==null)
  sigma_id: d4ca7c59-e9e4-42d8-bf57-91a776efcb87
- name: LSASS Dump Keyword In CommandLine
  query: grep('lsass.dmp', this['ProcessCommandLine']) or grep('lsass.zip', this['ProcessCommandLine'])
    or grep('lsass.rar', this['ProcessCommandLine']) or grep('Andrew.dmp', this['ProcessCommandLine'])
    or grep('Coredump.dmp', this['ProcessCommandLine']) or grep('NotLSASS.zip', this['ProcessCommandLine'])
    or grep('lsass_2', this['ProcessCommandLine']) or grep('lsassdump', this['ProcessCommandLine'])
    or grep('lsassdmp', this['ProcessCommandLine']) or grep('lsass', this['ProcessCommandLine'])
    and grep('.dmp', this['ProcessCommandLine']) or grep('SQLDmpr', this['ProcessCommandLine'])
    and grep('.mdmp', this['ProcessCommandLine']) or grep('nanodump', this['ProcessCommandLine'])
    and grep('.dmp', this['ProcessCommandLine'])
  sigma_id: ffa6861c-4461-4f59-8a41-578c39f3f23e
- name: Potential File Download Via MS-AppInstaller Protocol Handler
  query: (grep('ms-appinstaller://', this['ProcessCommandLine']) or grep('source=',
    this['ProcessCommandLine'])) and grep('http', this['ProcessCommandLine'])
  sigma_id: 180c7c5c-d64b-4a63-86e9-68910451bc8b
- name: Suspicious Scan Loop Network
  query: (grep('for ', this['ProcessCommandLine']) or grep('foreach ', this['ProcessCommandLine']))
    and (grep('nslookup', this['ProcessCommandLine']) or grep('ping', this['ProcessCommandLine']))
  sigma_id: f8ad2e2c-40b6-4117-84d7-20b89896ab23
- name: Potential Network Sniffing Activity Using Network Tools
  query: grep('\\tshark.exe', this['FolderPath']) and grep('-i', this['ProcessCommandLine'])
    or grep('\\windump.exe', this['FolderPath'])
  sigma_id: ba1f7802-adc7-48b4-9ecb-81e227fddfd5
- name: Process Launched Without Image Name
  query: grep('\\.exe', this['FolderPath'])
  sigma_id: f208d6d8-d83a-4c2c-960d-877c37da84e5
- name: Execution of Suspicious File Type Extension
  query: not (grep('.bin', this['FolderPath']) or grep('.cgi', this['FolderPath'])
    or grep('.com', this['FolderPath']) or grep('.exe', this['FolderPath']) or grep('.scr',
    this['FolderPath']) or grep('.tmp', this['FolderPath'])) and not (this['FolderPath']
    in ['System', 'Registry', 'MemCompression', 'vmmem'] or grep(':\\Windows\\Installer\\MSI',
    this['FolderPath']) or grep(':\\Windows\\System32\\DriverStore\\FileRepository\\',
    this['FolderPath']) or grep(':\\Config.Msi\\', this['FolderPath']) and (grep('.rbf',
    this['FolderPath']) or grep('.rbs', this['FolderPath'])) or grep(':\\Windows\\Temp\\',
    this['InitiatingProcessFolderPath']) or grep(':\\Windows\\Temp\\', this['FolderPath'])
    or grep(':\\$Extend\\$Deleted\\', this['FolderPath']) or this['FolderPath'] in
    ['-', '()'] or this['FolderPath']==null) and not (grep(':\\ProgramData\\Avira\\',
    this['InitiatingProcessFolderPath']) or grep('NVIDIA\\NvBackend\\', this['FolderPath'])
    and grep('.dat', this['FolderPath']) or (grep(':\\Program Files (x86)\\WINPAKPRO\\',
    this['FolderPath']) or grep(':\\Program Files\\WINPAKPRO\\', this['FolderPath']))
    and grep('.ngn', this['FolderPath']) or grep(':\\Program Files (x86)\\MyQ\\Server\\pcltool.dll',
    this['FolderPath']) or grep(':\\Program Files\\MyQ\\Server\\pcltool.dll', this['FolderPath'])
    or grep('\\AppData\\Local\\Packages\\', this['FolderPath']) and grep('\\LocalState\\rootfs\\',
    this['FolderPath']) or grep('\\LZMA_EXE', this['FolderPath']) or grep(':\\Program
    Files\\Mozilla Firefox\\', this['FolderPath']) or grep('C:\\Windows\\System32\\services.exe',
    this['InitiatingProcessFolderPath']) and grep('com.docker.service', this['FolderPath']))
  sigma_id: c09dad97-1c78-4f71-b127-7edb2b8e491a
- name: Non-privileged Usage of Reg or Powershell
  query: (grep('reg ', this['ProcessCommandLine']) and grep('add', this['ProcessCommandLine'])
    or grep('powershell', this['ProcessCommandLine']) or grep('set-itemproperty',
    this['ProcessCommandLine']) or grep(' sp ', this['ProcessCommandLine']) or grep('new-itemproperty',
    this['ProcessCommandLine'])) and (this['ProcessIntegrityLevel'] in ['Medium',
    'S-1-16-8192']) and grep('ControlSet', this['ProcessCommandLine']) and grep('Services',
    this['ProcessCommandLine']) and (grep('ImagePath', this['ProcessCommandLine'])
    or grep('FailureCommand', this['ProcessCommandLine']) or grep('ServiceDLL', this['ProcessCommandLine']))
  sigma_id: 8f02c935-effe-45b3-8fc9-ef8696a9e41d
- name: Suspicious Process Patterns NTDS.DIT Exfil
  query: grep('\\NTDSDump.exe', this['FolderPath']) or grep('\\NTDSDumpEx.exe', this['FolderPath'])
    or grep('ntds.dit', this['ProcessCommandLine']) and grep('system.hiv', this['ProcessCommandLine'])
    or grep('NTDSgrab.ps1', this['ProcessCommandLine']) or grep('ac i ntds', this['ProcessCommandLine'])
    and grep('create full', this['ProcessCommandLine']) or grep('/c copy ', this['ProcessCommandLine'])
    and grep('\\windows\\ntds\\ntds.dit', this['ProcessCommandLine']) or grep('activate
    instance ntds', this['ProcessCommandLine']) and grep('create full', this['ProcessCommandLine'])
    or grep('powershell', this['ProcessCommandLine']) and grep('ntds.dit', this['ProcessCommandLine'])
    or grep('ntds.dit', this['ProcessCommandLine']) and (grep('\\apache', this['InitiatingProcessFolderPath'])
    or grep('\\tomcat', this['InitiatingProcessFolderPath']) or grep('\\AppData\\',
    this['InitiatingProcessFolderPath']) or grep('\\Temp\\', this['InitiatingProcessFolderPath'])
    or grep('\\Public\\', this['InitiatingProcessFolderPath']) or grep('\\PerfLogs\\',
    this['InitiatingProcessFolderPath']) or grep('\\apache', this['FolderPath']) or
    grep('\\tomcat', this['FolderPath']) or grep('\\AppData\\', this['FolderPath'])
    or grep('\\Temp\\', this['FolderPath']) or grep('\\Public\\', this['FolderPath'])
    or grep('\\PerfLogs\\', this['FolderPath']))
  sigma_id: 8bc64091-6875-4881-aaf9-7bd25b5dda08
- name: Potentially Suspicious Call To Win32_NTEventlogFile Class
  query: grep('Win32_NTEventlogFile', this['ProcessCommandLine']) and (grep('.BackupEventlog(',
    this['ProcessCommandLine']) or grep('.ChangeSecurityPermissions(', this['ProcessCommandLine'])
    or grep('.ChangeSecurityPermissionsEx(', this['ProcessCommandLine']) or grep('.ClearEventLog(',
    this['ProcessCommandLine']) or grep('.Delete(', this['ProcessCommandLine']) or
    grep('.DeleteEx(', this['ProcessCommandLine']) or grep('.Rename(', this['ProcessCommandLine'])
    or grep('.TakeOwnerShip(', this['ProcessCommandLine']) or grep('.TakeOwnerShipEx(',
    this['ProcessCommandLine']))
  sigma_id: caf201a9-c2ce-4a26-9c3a-2b9525413711
- name: Use Short Name Path in Command Line
  query: (grep('~1\\', this['ProcessCommandLine']) or grep('~2\\', this['ProcessCommandLine']))
    and not (this['InitiatingProcessFolderPath'] in ['C:\\Windows\\System32\\Dism.exe',
    'C:\\Windows\\System32\\cleanmgr.exe', 'C:\\Program Files\\GPSoftware\\Directory
    Opus\\dopus.exe'] or grep('\\WebEx\\WebexHost.exe', this['InitiatingProcessFolderPath'])
    or grep('\\thor\\thor64.exe', this['InitiatingProcessFolderPath']) or grep('\\veam.backup.shell.exe',
    this['InitiatingProcessFolderPath']) or grep('\\winget.exe', this['InitiatingProcessFolderPath'])
    or grep('\\Everything\\Everything.exe', this['InitiatingProcessFolderPath']) or
    grep('\\AppData\\Local\\Temp\\WinGet\\', this['InitiatingProcessFolderPath'])
    or grep('\\appdata\\local\\webex\\webex64\\meetings\\wbxreport.exe', this['ProcessCommandLine'])
    or grep('C:\\Program Files\\Git\\post-install.bat', this['ProcessCommandLine'])
    or grep('C:\\Program Files\\Git\\cmd\\scalar.exe', this['ProcessCommandLine']))
  sigma_id: 349d891d-fef0-4fe4-bc53-eee623a15969
- name: Use Short Name Path in Image
  query: (grep('~1\\', this['FolderPath']) or grep('~2\\', this['FolderPath'])) and
    not (this['InitiatingProcessFolderPath'] in ['C:\\Windows\\System32\\Dism.exe',
    'C:\\Windows\\System32\\cleanmgr.exe'] or grep('\\WebEx\\WebexHost.exe', this['InitiatingProcessFolderPath'])
    or grep('\\thor\\thor64.exe', this['InitiatingProcessFolderPath']) or grep('InstallShield
    (R)', this['ProcessVersionInfoProductName']) or grep('InstallShield (R) Setup
    Engine', this['ProcessVersionInfoFileDescription']) or grep('InstallShield Software
    Corporation', this['ProcessVersionInfoCompanyName']) or grep('\\AppData\\', this['FolderPath'])
    and grep('\\Temp\\', this['FolderPath']) or grep('~1\\unzip.exe', this['FolderPath'])
    or grep('~1\\7zG.exe', this['FolderPath']))
  sigma_id: a96970af-f126-420d-90e1-d37bf25e50e1
- name: Use NTFS Short Name in Command Line
  query: (grep('~1.exe', this['ProcessCommandLine']) or grep('~1.bat', this['ProcessCommandLine'])
    or grep('~1.msi', this['ProcessCommandLine']) or grep('~1.vbe', this['ProcessCommandLine'])
    or grep('~1.vbs', this['ProcessCommandLine']) or grep('~1.dll', this['ProcessCommandLine'])
    or grep('~1.ps1', this['ProcessCommandLine']) or grep('~1.js', this['ProcessCommandLine'])
    or grep('~1.hta', this['ProcessCommandLine']) or grep('~2.exe', this['ProcessCommandLine'])
    or grep('~2.bat', this['ProcessCommandLine']) or grep('~2.msi', this['ProcessCommandLine'])
    or grep('~2.vbe', this['ProcessCommandLine']) or grep('~2.vbs', this['ProcessCommandLine'])
    or grep('~2.dll', this['ProcessCommandLine']) or grep('~2.ps1', this['ProcessCommandLine'])
    or grep('~2.js', this['ProcessCommandLine']) or grep('~2.hta', this['ProcessCommandLine']))
    and not (grep('\\WebEx\\WebexHost.exe', this['InitiatingProcessFolderPath']) or
    grep('\\thor\\thor64.exe', this['InitiatingProcessFolderPath']) or grep('C:\\xampp\\vcredist\\VCREDI~1.EXE',
    this['ProcessCommandLine']))
  sigma_id: dd6b39d9-d9be-4a3b-8fe0-fe3c6a5c1795
- name: Use NTFS Short Name in Image
  query: (grep('~1.bat', this['FolderPath']) or grep('~1.dll', this['FolderPath'])
    or grep('~1.exe', this['FolderPath']) or grep('~1.hta', this['FolderPath']) or
    grep('~1.js', this['FolderPath']) or grep('~1.msi', this['FolderPath']) or grep('~1.ps1',
    this['FolderPath']) or grep('~1.tmp', this['FolderPath']) or grep('~1.vbe', this['FolderPath'])
    or grep('~1.vbs', this['FolderPath']) or grep('~2.bat', this['FolderPath']) or
    grep('~2.dll', this['FolderPath']) or grep('~2.exe', this['FolderPath']) or grep('~2.hta',
    this['FolderPath']) or grep('~2.js', this['FolderPath']) or grep('~2.msi', this['FolderPath'])
    or grep('~2.ps1', this['FolderPath']) or grep('~2.tmp', this['FolderPath']) or
    grep('~2.vbe', this['FolderPath']) or grep('~2.vbs', this['FolderPath'])) and
    not grep('C:\\Windows\\explorer.exe', this['InitiatingProcessFolderPath']) and
    not (grep('\\WebEx\\WebexHost.exe', this['InitiatingProcessFolderPath']) or grep('\\thor\\thor64.exe',
    this['InitiatingProcessFolderPath']) or grep('C:\\PROGRA~1\\WinZip\\WZPREL~1.EXE',
    this['FolderPath']) or grep('\\VCREDI~1.EXE', this['FolderPath']))
  sigma_id: 3ef5605c-9eb9-47b0-9a71-b727e6aa5c3b
- name: Suspicious Process Parents
  query: grep('\\minesweeper.exe', this['InitiatingProcessFolderPath']) or grep('\\winver.exe',
    this['InitiatingProcessFolderPath']) or grep('\\bitsadmin.exe', this['InitiatingProcessFolderPath'])
    or (grep('\\csrss.exe', this['InitiatingProcessFolderPath']) or grep('\\certutil.exe',
    this['InitiatingProcessFolderPath']) or grep('\\eventvwr.exe', this['InitiatingProcessFolderPath'])
    or grep('\\calc.exe', this['InitiatingProcessFolderPath']) or grep('\\notepad.exe',
    this['InitiatingProcessFolderPath'])) and not (grep('\\WerFault.exe', this['FolderPath'])
    or grep('\\wermgr.exe', this['FolderPath']) or grep('\\conhost.exe', this['FolderPath'])
    or grep('\\mmc.exe', this['FolderPath']) or grep('\\win32calc.exe', this['FolderPath'])
    or grep('\\notepad.exe', this['FolderPath']) or this['FolderPath']==null)
  sigma_id: cbec226f-63d9-4eca-9f52-dfb6652f24df
- name: Potential PowerShell Execution Via DLL
  query: (grep('\\InstallUtil.exe', this['FolderPath']) or grep('\\RegAsm.exe', this['FolderPath'])
    or grep('\\RegSvcs.exe', this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath'])
    or grep('\\rundll32.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['InstallUtil.exe', 'RegAsm.exe', 'RegSvcs.exe', 'REGSVR32.EXE', 'RUNDLL32.EXE'])
    and (grep('Default.GetString', this['ProcessCommandLine']) or grep('DownloadString',
    this['ProcessCommandLine']) or grep('FromBase64String', this['ProcessCommandLine'])
    or grep('ICM ', this['ProcessCommandLine']) or grep('IEX ', this['ProcessCommandLine'])
    or grep('Invoke-Command', this['ProcessCommandLine']) or grep('Invoke-Expression',
    this['ProcessCommandLine']))
  sigma_id: 6812a10b-60ea-420c-832f-dfcc33b646ba
- name: Privilege Escalation via Named Pipe Impersonation
  query: (grep('\\cmd.exe', this['FolderPath']) or grep('\\powershell.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['Cmd.Exe', 'PowerShell.EXE'])
    and grep('echo', this['ProcessCommandLine']) and grep('>', this['ProcessCommandLine'])
    and grep('\\.\\pipe\\', this['ProcessCommandLine'])
  sigma_id: 9bd04a79-dabe-4f1f-a5ff-92430265c96b
- name: Private Keys Reconnaissance Via CommandLine Tools
  query: (grep('.key', this['ProcessCommandLine']) or grep('.pgp', this['ProcessCommandLine'])
    or grep('.gpg', this['ProcessCommandLine']) or grep('.ppk', this['ProcessCommandLine'])
    or grep('.p12', this['ProcessCommandLine']) or grep('.pem', this['ProcessCommandLine'])
    or grep('.pfx', this['ProcessCommandLine']) or grep('.cer', this['ProcessCommandLine'])
    or grep('.p7b', this['ProcessCommandLine']) or grep('.asc', this['ProcessCommandLine']))
    and ((grep('\\cmd.exe', this['FolderPath']) or grep('Cmd.Exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('dir ', this['ProcessCommandLine']) or (grep('\\powershell.exe', this['FolderPath'])
    or grep('\\pwsh.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['PowerShell.EXE', 'pwsh.dll']) and grep('Get-ChildItem ', this['ProcessCommandLine'])
    or grep('\\findstr.exe', this['FolderPath']) or grep('FINDSTR.EXE', this['ProcessVersionInfoOriginalFileName']))
  sigma_id: 213d6a77-3d55-4ce8-ba74-fcfef741974e
- name: Suspicious RunAs-Like Flag Combination
  query: (grep(' -u system ', this['ProcessCommandLine']) or grep(' --user system
    ', this['ProcessCommandLine']) or grep(' -u NT', this['ProcessCommandLine']) or
    grep(' -u "NT', this['ProcessCommandLine']) or grep(' -u \'NT', this['ProcessCommandLine'])
    or grep(' --system ', this['ProcessCommandLine']) or grep(' -u administrator ',
    this['ProcessCommandLine'])) and (grep(' -c cmd', this['ProcessCommandLine'])
    or grep(' -c "cmd', this['ProcessCommandLine']) or grep(' -c powershell', this['ProcessCommandLine'])
    or grep(' -c "powershell', this['ProcessCommandLine']) or grep(' --command cmd',
    this['ProcessCommandLine']) or grep(' --command powershell', this['ProcessCommandLine'])
    or grep(' -c whoami', this['ProcessCommandLine']) or grep(' -c wscript', this['ProcessCommandLine'])
    or grep(' -c cscript', this['ProcessCommandLine']))
  sigma_id: 50d66fb0-03f8-4da0-8add-84e77d12a020
- name: Suspicious Program Names
  query: grep('\\CVE-202', this['FolderPath']) or grep('\\CVE202', this['FolderPath'])
    or grep('\\poc.exe', this['FolderPath']) or grep('\\artifact.exe', this['FolderPath'])
    or grep('\\artifact64.exe', this['FolderPath']) or grep('\\artifact_protected.exe',
    this['FolderPath']) or grep('\\artifact32.exe', this['FolderPath']) or grep('\\artifact32big.exe',
    this['FolderPath']) or grep('obfuscated.exe', this['FolderPath']) or grep('obfusc.exe',
    this['FolderPath']) or grep('\\meterpreter', this['FolderPath']) or grep('inject.ps1',
    this['ProcessCommandLine']) or grep('Invoke-CVE', this['ProcessCommandLine'])
    or grep('pupy.ps1', this['ProcessCommandLine']) or grep('payload.ps1', this['ProcessCommandLine'])
    or grep('beacon.ps1', this['ProcessCommandLine']) or grep('PowerView.ps1', this['ProcessCommandLine'])
    or grep('bypass.ps1', this['ProcessCommandLine']) or grep('obfuscated.ps1', this['ProcessCommandLine'])
    or grep('obfusc.ps1', this['ProcessCommandLine']) or grep('obfus.ps1', this['ProcessCommandLine'])
    or grep('obfs.ps1', this['ProcessCommandLine']) or grep('evil.ps1', this['ProcessCommandLine'])
    or grep('MiniDogz.ps1', this['ProcessCommandLine']) or grep('_enc.ps1', this['ProcessCommandLine'])
    or grep('\\shell.ps1', this['ProcessCommandLine']) or grep('\\rshell.ps1', this['ProcessCommandLine'])
    or grep('revshell.ps1', this['ProcessCommandLine']) or grep('\\av.ps1', this['ProcessCommandLine'])
    or grep('\\av_test.ps1', this['ProcessCommandLine']) or grep('adrecon.ps1', this['ProcessCommandLine'])
    or grep('mimikatz.ps1', this['ProcessCommandLine']) or grep('\\PowerUp_', this['ProcessCommandLine'])
    or grep('powerup.ps1', this['ProcessCommandLine']) or grep('\\Temp\\a.ps1', this['ProcessCommandLine'])
    or grep('\\Temp\\p.ps1', this['ProcessCommandLine']) or grep('\\Temp\\1.ps1',
    this['ProcessCommandLine']) or grep('Hound.ps1', this['ProcessCommandLine']) or
    grep('encode.ps1', this['ProcessCommandLine']) or grep('powercat.ps1', this['ProcessCommandLine'])
  sigma_id: efdd8dd5-cee8-4e59-9390-7d4d5e4dd6f6
- name: Recon Information for Export with Command Prompt
  query: (grep('\\tree.com', this['FolderPath']) or grep('\\WMIC.exe', this['FolderPath'])
    or grep('\\doskey.exe', this['FolderPath']) or grep('\\sc.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['wmic.exe', 'DOSKEY.EXE', 'sc.exe'])
    and (grep(' > %TEMP%\\', this['InitiatingProcessCommandLine']) or grep(' > %TMP%\\',
    this['InitiatingProcessCommandLine']))
  sigma_id: aa2efee7-34dd-446e-8a37-40790a66efd7
- name: Suspicious Process Execution From Fake Recycle.Bin Folder
  query: grep('RECYCLERS.BIN\\', this['FolderPath']) or grep('RECYCLER.BIN\\', this['FolderPath'])
  sigma_id: 5ce0f04e-3efc-42af-839d-5b3a543b76c0
- name: Suspicious Redirection to Local Admin Share
  query: grep('>', this['ProcessCommandLine']) and (grep('\\127.0.0.1\\admin$\\',
    this['ProcessCommandLine']) or grep('\\localhost\\admin$\\', this['ProcessCommandLine']))
  sigma_id: ab9e3b40-0c85-4ba1-aede-455d226fd124
- name: Potential Remote Desktop Tunneling
  query: grep(':3389', this['ProcessCommandLine']) and (grep(' -L ', this['ProcessCommandLine'])
    or grep(' -P ', this['ProcessCommandLine']) or grep(' -R ', this['ProcessCommandLine'])
    or grep(' -pw ', this['ProcessCommandLine']) or grep(' -ssh ', this['ProcessCommandLine']))
  sigma_id: 8a3038e8-9c9d-46f8-b184-66234a160f6f
- name: Potential Defense Evasion Via Right-to-Left Override
  query: "grep('\u202E', this['ProcessCommandLine'])"
  sigma_id: ad691d92-15f2-4181-9aa4-723c74f9ddc3
- name: Script Interpreter Execution From Suspicious Folder
  query: (grep('\\cscript.exe', this['FolderPath']) or grep('\\mshta.exe', this['FolderPath'])
    or grep('\\wscript.exe', this['FolderPath']) or grep(' -ep bypass ', this['ProcessCommandLine'])
    or grep(' -ExecutionPolicy bypass ', this['ProcessCommandLine']) or grep(' -w
    hidden ', this['ProcessCommandLine']) or grep('/e:javascript ', this['ProcessCommandLine'])
    or grep('/e:Jscript ', this['ProcessCommandLine']) or grep('/e:vbscript ', this['ProcessCommandLine'])
    or this['ProcessVersionInfoOriginalFileName'] in ['cscript.exe', 'mshta.exe',
    'wscript.exe']) and (grep(':\\Perflogs\\', this['ProcessCommandLine']) or grep(':\\Users\\Public\\',
    this['ProcessCommandLine']) or grep('\\AppData\\Local\\Temp', this['ProcessCommandLine'])
    or grep('\\AppData\\Roaming\\Temp', this['ProcessCommandLine']) or grep('\\Temporary
    Internet', this['ProcessCommandLine']) or grep('\\Windows\\Temp', this['ProcessCommandLine'])
    or grep(':\\Users\\', this['ProcessCommandLine']) and grep('\\Favorites\\', this['ProcessCommandLine'])
    or grep(':\\Users\\', this['ProcessCommandLine']) and grep('\\Favourites\\', this['ProcessCommandLine'])
    or grep(':\\Users\\', this['ProcessCommandLine']) and grep('\\Contacts\\', this['ProcessCommandLine']))
  sigma_id: 1228c958-e64e-4e71-92ad-7d429f4138ba
- name: Suspicious Script Execution From Temp Folder
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or grep('\\mshta.exe', this['FolderPath']) or grep('\\wscript.exe', this['FolderPath'])
    or grep('\\cscript.exe', this['FolderPath'])) and (grep('\\Windows\\Temp', this['ProcessCommandLine'])
    or grep('\\Temporary Internet', this['ProcessCommandLine']) or grep('\\AppData\\Local\\Temp',
    this['ProcessCommandLine']) or grep('\\AppData\\Roaming\\Temp', this['ProcessCommandLine'])
    or grep('%TEMP%', this['ProcessCommandLine']) or grep('%TMP%', this['ProcessCommandLine'])
    or grep('%LocalAppData%\\Temp', this['ProcessCommandLine'])) and not (grep(' >',
    this['ProcessCommandLine']) or grep('Out-File', this['ProcessCommandLine']) or
    grep('ConvertTo-Json', this['ProcessCommandLine']) or grep('-WindowStyle hidden
    -Verb runAs', this['ProcessCommandLine']) or grep('\\Windows\\system32\\config\\systemprofile\\AppData\\Local\\Temp\\Amazon\\EC2-Windows\\',
    this['ProcessCommandLine']))
  sigma_id: a6a39bdb-935c-4f0a-ab77-35f4bbf44d33
- name: Sensitive File Access Via Volume Shadow Copy Backup
  query: 'grep(''(\''\\\'', <SpecialChars.WILDCARD_SINGLE: 2>, \''\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy\'')'',
    this[''ProcessCommandLine'']) and (grep(''\\NTDS.dit'', this[''ProcessCommandLine''])
    or grep(''\\SYSTEM'', this[''ProcessCommandLine'']) or grep(''\\SECURITY'', this[''ProcessCommandLine'']))'
  sigma_id: f57f8d16-1f39-4dcb-a604-6c73d9b54b3d
- name: Suspicious New Service Creation
  query: (grep('\\sc.exe', this['FolderPath']) and grep('create', this['ProcessCommandLine'])
    and grep('binPath=', this['ProcessCommandLine']) or grep('New-Service', this['ProcessCommandLine'])
    and grep('-BinaryPathName', this['ProcessCommandLine'])) and (grep('powershell',
    this['ProcessCommandLine']) or grep('mshta', this['ProcessCommandLine']) or grep('wscript',
    this['ProcessCommandLine']) or grep('cscript', this['ProcessCommandLine']) or
    grep('svchost', this['ProcessCommandLine']) or grep('dllhost', this['ProcessCommandLine'])
    or grep('cmd ', this['ProcessCommandLine']) or grep('cmd.exe /c', this['ProcessCommandLine'])
    or grep('cmd.exe /k', this['ProcessCommandLine']) or grep('cmd.exe /r', this['ProcessCommandLine'])
    or grep('rundll32', this['ProcessCommandLine']) or grep('C:\\Users\\Public', this['ProcessCommandLine'])
    or grep('\\Downloads\\', this['ProcessCommandLine']) or grep('\\Desktop\\', this['ProcessCommandLine'])
    or grep('\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\', this['ProcessCommandLine'])
    or grep('C:\\Windows\\TEMP\\', this['ProcessCommandLine']) or grep('\\AppData\\Local\\Temp',
    this['ProcessCommandLine']))
  sigma_id: 17a1be64-8d88-40bf-b5ff-a4f7a50ebcc8
- name: Suspicious Service Binary Directory
  query: (grep('\\Users\\Public\\', this['FolderPath']) or grep('\\$Recycle.bin',
    this['FolderPath']) or grep('\\Users\\All Users\\', this['FolderPath']) or grep('\\Users\\Default\\',
    this['FolderPath']) or grep('\\Users\\Contacts\\', this['FolderPath']) or grep('\\Users\\Searches\\',
    this['FolderPath']) or grep('C:\\Perflogs\\', this['FolderPath']) or grep('\\config\\systemprofile\\',
    this['FolderPath']) or grep('\\Windows\\Fonts\\', this['FolderPath']) or grep('\\Windows\\IME\\',
    this['FolderPath']) or grep('\\Windows\\addins\\', this['FolderPath'])) and (grep('\\services.exe',
    this['InitiatingProcessFolderPath']) or grep('\\svchost.exe', this['InitiatingProcessFolderPath']))
  sigma_id: 883faa95-175a-4e22-8181-e5761aeb373c
- name: Suspicious Windows Service Tampering
  query: (this['ProcessVersionInfoOriginalFileName'] in ['net.exe', 'net1.exe', 'PowerShell.EXE',
    'psservice.exe', 'pwsh.dll', 'sc.exe'] or grep('\\net.exe', this['FolderPath'])
    or grep('\\net1.exe', this['FolderPath']) or grep('\\powershell.exe', this['FolderPath'])
    or grep('\\PsService.exe', this['FolderPath']) or grep('\\PsService64.exe', this['FolderPath'])
    or grep('\\pwsh.exe', this['FolderPath']) or grep('\\sc.exe', this['FolderPath']))
    and (grep(' delete ', this['ProcessCommandLine']) or grep(' pause ', this['ProcessCommandLine'])
    or grep(' stop ', this['ProcessCommandLine']) or grep('Stop-Service ', this['ProcessCommandLine'])
    or grep('Remove-Service ', this['ProcessCommandLine']) or grep('config', this['ProcessCommandLine'])
    and grep('start=disabled', this['ProcessCommandLine'])) and (grep('143Svc', this['ProcessCommandLine'])
    or grep('Acronis VSS Provider', this['ProcessCommandLine']) or grep('AcronisAgent',
    this['ProcessCommandLine']) or grep('AcrSch2Svc', this['ProcessCommandLine'])
    or grep('AdobeARMservice', this['ProcessCommandLine']) or grep('AHS Service',
    this['ProcessCommandLine']) or grep('Antivirus', this['ProcessCommandLine']) or
    grep('Apache4', this['ProcessCommandLine']) or grep('ARSM', this['ProcessCommandLine'])
    or grep('aswBcc', this['ProcessCommandLine']) or grep('AteraAgent', this['ProcessCommandLine'])
    or grep('Avast Business Console Client Antivirus Service', this['ProcessCommandLine'])
    or grep('avast! Antivirus', this['ProcessCommandLine']) or grep('AVG Antivirus',
    this['ProcessCommandLine']) or grep('avgAdminClient', this['ProcessCommandLine'])
    or grep('AvgAdminServer', this['ProcessCommandLine']) or grep('AVP1', this['ProcessCommandLine'])
    or grep('BackupExec', this['ProcessCommandLine']) or grep('bedbg', this['ProcessCommandLine'])
    or grep('BITS', this['ProcessCommandLine']) or grep('BrokerInfrastructure', this['ProcessCommandLine'])
    or grep('CASLicenceServer', this['ProcessCommandLine']) or grep('CASWebServer',
    this['ProcessCommandLine']) or grep('Client Agent 7.60', this['ProcessCommandLine'])
    or grep('Core Browsing Protection', this['ProcessCommandLine']) or grep('Core
    Mail Protection', this['ProcessCommandLine']) or grep('Core Scanning Server',
    this['ProcessCommandLine']) or grep('DCAgent', this['ProcessCommandLine']) or
    grep('dwmrcs', this['ProcessCommandLine']) or grep('EhttpSr', this['ProcessCommandLine'])
    or grep('ekrn', this['ProcessCommandLine']) or grep('Enterprise Client Service',
    this['ProcessCommandLine']) or grep('epag', this['ProcessCommandLine']) or grep('EPIntegrationService',
    this['ProcessCommandLine']) or grep('EPProtectedService', this['ProcessCommandLine'])
    or grep('EPRedline', this['ProcessCommandLine']) or grep('EPSecurityService',
    this['ProcessCommandLine']) or grep('EPUpdateService', this['ProcessCommandLine'])
    or grep('EraserSvc11710', this['ProcessCommandLine']) or grep('EsgShKernel', this['ProcessCommandLine'])
    or grep('ESHASRV', this['ProcessCommandLine']) or grep('FA_Scheduler', this['ProcessCommandLine'])
    or grep('FirebirdGuardianDefaultInstance', this['ProcessCommandLine']) or grep('FirebirdServerDefaultInstance',
    this['ProcessCommandLine']) or grep('FontCache3.0.0.0', this['ProcessCommandLine'])
    or grep('HealthTLService', this['ProcessCommandLine']) or grep('hmpalertsvc',
    this['ProcessCommandLine']) or grep('HMS', this['ProcessCommandLine']) or grep('HostControllerService',
    this['ProcessCommandLine']) or grep('hvdsvc', this['ProcessCommandLine']) or grep('IAStorDataMgrSvc',
    this['ProcessCommandLine']) or grep('IBMHPS', this['ProcessCommandLine']) or grep('ibmspsvc',
    this['ProcessCommandLine']) or grep('IISAdmin', this['ProcessCommandLine']) or
    grep('IMANSVC', this['ProcessCommandLine']) or grep('IMAP4Svc', this['ProcessCommandLine'])
    or grep('instance2', this['ProcessCommandLine']) or grep('KAVFS', this['ProcessCommandLine'])
    or grep('KAVFSGT', this['ProcessCommandLine']) or grep('kavfsslp', this['ProcessCommandLine'])
    or grep('KeyIso', this['ProcessCommandLine']) or grep('klbackupdisk', this['ProcessCommandLine'])
    or grep('klbackupflt', this['ProcessCommandLine']) or grep('klflt', this['ProcessCommandLine'])
    or grep('klhk', this['ProcessCommandLine']) or grep('KLIF', this['ProcessCommandLine'])
    or grep('klim6', this['ProcessCommandLine']) or grep('klkbdflt', this['ProcessCommandLine'])
    or grep('klmouflt', this['ProcessCommandLine']) or grep('klnagent', this['ProcessCommandLine'])
    or grep('klpd', this['ProcessCommandLine']) or grep('kltap', this['ProcessCommandLine'])
    or grep('KSDE1.0.0', this['ProcessCommandLine']) or grep('LogProcessorService',
    this['ProcessCommandLine']) or grep('M8EndpointAgent', this['ProcessCommandLine'])
    or grep('macmnsvc', this['ProcessCommandLine']) or grep('masvc', this['ProcessCommandLine'])
    or grep('MBAMService', this['ProcessCommandLine']) or grep('MBCloudEA', this['ProcessCommandLine'])
    or grep('MBEndpointAgent', this['ProcessCommandLine']) or grep('McAfeeDLPAgentService',
    this['ProcessCommandLine']) or grep('McAfeeEngineService', this['ProcessCommandLine'])
    or grep('MCAFEEEVENTPARSERSRV', this['ProcessCommandLine']) or grep('McAfeeFramework',
    this['ProcessCommandLine']) or grep('MCAFEETOMCATSRV530', this['ProcessCommandLine'])
    or grep('McShield', this['ProcessCommandLine']) or grep('McTaskManager', this['ProcessCommandLine'])
    or grep('mfefire', this['ProcessCommandLine']) or grep('mfemms', this['ProcessCommandLine'])
    or grep('mfevto', this['ProcessCommandLine']) or grep('mfevtp', this['ProcessCommandLine'])
    or grep('mfewc', this['ProcessCommandLine']) or grep('MMS', this['ProcessCommandLine'])
    or grep('mozyprobackup', this['ProcessCommandLine']) or grep('mpssvc', this['ProcessCommandLine'])
    or grep('MSComplianceAudit', this['ProcessCommandLine']) or grep('MSDTC', this['ProcessCommandLine'])
    or grep('MsDtsServer', this['ProcessCommandLine']) or grep('MSExchange', this['ProcessCommandLine'])
    or grep('msftesq1SPROO', this['ProcessCommandLine']) or grep('msftesql$PROD',
    this['ProcessCommandLine']) or grep('msftesql$SQLEXPRESS', this['ProcessCommandLine'])
    or grep('MSOLAP$SQL_2008', this['ProcessCommandLine']) or grep('MSOLAP$SYSTEM_BGC',
    this['ProcessCommandLine']) or grep('MSOLAP$TPS', this['ProcessCommandLine'])
    or grep('MSOLAP$TPSAMA', this['ProcessCommandLine']) or grep('MSOLAPSTPS', this['ProcessCommandLine'])
    or grep('MSOLAPSTPSAMA', this['ProcessCommandLine']) or grep('mssecflt', this['ProcessCommandLine'])
    or grep('MSSQ!I.SPROFXENGAGEMEHT', this['ProcessCommandLine']) or grep('MSSQ0SHAREPOINT',
    this['ProcessCommandLine']) or grep('MSSQ0SOPHOS', this['ProcessCommandLine'])
    or grep('MSSQL', this['ProcessCommandLine']) or grep('MSSQLFDLauncher$', this['ProcessCommandLine'])
    or grep('MySQL', this['ProcessCommandLine']) or grep('NanoServiceMain', this['ProcessCommandLine'])
    or grep('NetMsmqActivator', this['ProcessCommandLine']) or grep('NetPipeActivator',
    this['ProcessCommandLine']) or grep('netprofm', this['ProcessCommandLine']) or
    grep('NetTcpActivator', this['ProcessCommandLine']) or grep('NetTcpPortSharing',
    this['ProcessCommandLine']) or grep('ntrtscan', this['ProcessCommandLine']) or
    grep('nvspwmi', this['ProcessCommandLine']) or grep('ofcservice', this['ProcessCommandLine'])
    or grep('Online Protection System', this['ProcessCommandLine']) or grep('OracleClientCache80',
    this['ProcessCommandLine']) or grep('OracleDBConsole', this['ProcessCommandLine'])
    or grep('OracleMTSRecoveryService', this['ProcessCommandLine']) or grep('OracleOraDb11g_home1',
    this['ProcessCommandLine']) or grep('OracleService', this['ProcessCommandLine'])
    or grep('OracleVssWriter', this['ProcessCommandLine']) or grep('osppsvc', this['ProcessCommandLine'])
    or grep('PandaAetherAgent', this['ProcessCommandLine']) or grep('PccNTUpd', this['ProcessCommandLine'])
    or grep('PDVFSService', this['ProcessCommandLine']) or grep('POP3Svc', this['ProcessCommandLine'])
    or grep('postgresql-x64-9.4', this['ProcessCommandLine']) or grep('POVFSService',
    this['ProcessCommandLine']) or grep('PSUAService', this['ProcessCommandLine'])
    or grep('Quick Update Service', this['ProcessCommandLine']) or grep('RepairService',
    this['ProcessCommandLine']) or grep('ReportServer', this['ProcessCommandLine'])
    or grep('ReportServer$', this['ProcessCommandLine']) or grep('RESvc', this['ProcessCommandLine'])
    or grep('RpcEptMapper', this['ProcessCommandLine']) or grep('sacsvr', this['ProcessCommandLine'])
    or grep('SamSs', this['ProcessCommandLine']) or grep('SAVAdminService', this['ProcessCommandLine'])
    or grep('SAVService', this['ProcessCommandLine']) or grep('ScSecSvc', this['ProcessCommandLine'])
    or grep('SDRSVC', this['ProcessCommandLine']) or grep('SearchExchangeTracing',
    this['ProcessCommandLine']) or grep('sense', this['ProcessCommandLine']) or grep('SentinelAgent',
    this['ProcessCommandLine']) or grep('SentinelHelperService', this['ProcessCommandLine'])
    or grep('SepMasterService', this['ProcessCommandLine']) or grep('ShMonitor', this['ProcessCommandLine'])
    or grep('Smcinst', this['ProcessCommandLine']) or grep('SmcService', this['ProcessCommandLine'])
    or grep('SMTPSvc', this['ProcessCommandLine']) or grep('SNAC', this['ProcessCommandLine'])
    or grep('SntpService', this['ProcessCommandLine']) or grep('Sophos', this['ProcessCommandLine'])
    or grep('SQ1SafeOLRService', this['ProcessCommandLine']) or grep('SQL Backups',
    this['ProcessCommandLine']) or grep('SQL Server', this['ProcessCommandLine'])
    or grep('SQLAgent', this['ProcessCommandLine']) or grep('SQLANYs_Sage_FAS_Fixed_Assets',
    this['ProcessCommandLine']) or grep('SQLBrowser', this['ProcessCommandLine'])
    or grep('SQLsafe', this['ProcessCommandLine']) or grep('SQLSERVERAGENT', this['ProcessCommandLine'])
    or grep('SQLTELEMETRY', this['ProcessCommandLine']) or grep('SQLWriter', this['ProcessCommandLine'])
    or grep('SSISTELEMETRY130', this['ProcessCommandLine']) or grep('SstpSvc', this['ProcessCommandLine'])
    or grep('storflt', this['ProcessCommandLine']) or grep('svcGenericHost', this['ProcessCommandLine'])
    or grep('swc_service', this['ProcessCommandLine']) or grep('swi_filter', this['ProcessCommandLine'])
    or grep('swi_service', this['ProcessCommandLine']) or grep('swi_update', this['ProcessCommandLine'])
    or grep('Symantec', this['ProcessCommandLine']) or grep('sysmon', this['ProcessCommandLine'])
    or grep('TeamViewer', this['ProcessCommandLine']) or grep('Telemetryserver', this['ProcessCommandLine'])
    or grep('ThreatLockerService', this['ProcessCommandLine']) or grep('TMBMServer',
    this['ProcessCommandLine']) or grep('TmCCSF', this['ProcessCommandLine']) or grep('TmFilter',
    this['ProcessCommandLine']) or grep('TMiCRCScanService', this['ProcessCommandLine'])
    or grep('tmlisten', this['ProcessCommandLine']) or grep('TMLWCSService', this['ProcessCommandLine'])
    or grep('TmPfw', this['ProcessCommandLine']) or grep('TmPreFilter', this['ProcessCommandLine'])
    or grep('TmProxy', this['ProcessCommandLine']) or grep('TMSmartRelayService',
    this['ProcessCommandLine']) or grep('tmusa', this['ProcessCommandLine']) or grep('Tomcat',
    this['ProcessCommandLine']) or grep('Trend Micro Deep Security Manager', this['ProcessCommandLine'])
    or grep('TrueKey', this['ProcessCommandLine']) or grep('UFNet', this['ProcessCommandLine'])
    or grep('UI0Detect', this['ProcessCommandLine']) or grep('UniFi', this['ProcessCommandLine'])
    or grep('UTODetect', this['ProcessCommandLine']) or grep('vds', this['ProcessCommandLine'])
    or grep('Veeam', this['ProcessCommandLine']) or grep('VeeamDeploySvc', this['ProcessCommandLine'])
    or grep('Veritas System Recovery', this['ProcessCommandLine']) or grep('vmic',
    this['ProcessCommandLine']) or grep('VMTools', this['ProcessCommandLine']) or
    grep('vmvss', this['ProcessCommandLine']) or grep('VSApiNt', this['ProcessCommandLine'])
    or grep('VSS', this['ProcessCommandLine']) or grep('W3Svc', this['ProcessCommandLine'])
    or grep('wbengine', this['ProcessCommandLine']) or grep('WdNisSvc', this['ProcessCommandLine'])
    or grep('WeanClOudSve', this['ProcessCommandLine']) or grep('Weems JY', this['ProcessCommandLine'])
    or grep('WinDefend', this['ProcessCommandLine']) or grep('wmms', this['ProcessCommandLine'])
    or grep('wozyprobackup', this['ProcessCommandLine']) or grep('WPFFontCache_v0400',
    this['ProcessCommandLine']) or grep('WRSVC', this['ProcessCommandLine']) or grep('wsbexchange',
    this['ProcessCommandLine']) or grep('WSearch', this['ProcessCommandLine']) or
    grep('wscsvc', this['ProcessCommandLine']) or grep('Zoolz 2 Service', this['ProcessCommandLine']))
  sigma_id: ce72ef99-22f1-43d4-8695-419dcb5d9330
- name: Shadow Copies Creation Using Operating Systems Utilities
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or grep('\\wmic.exe', this['FolderPath']) or grep('\\vssadmin.exe', this['FolderPath'])
    or this['ProcessVersionInfoOriginalFileName'] in ['PowerShell.EXE', 'pwsh.dll',
    'wmic.exe', 'VSSADMIN.EXE']) and grep('shadow', this['ProcessCommandLine']) and
    grep('create', this['ProcessCommandLine'])
  sigma_id: b17ea6f7-6e90-447e-a799-e6c0a493d6ce
- name: Shadow Copies Deletion Using Operating Systems Utilities
  query: (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath'])
    or grep('\\wmic.exe', this['FolderPath']) or grep('\\vssadmin.exe', this['FolderPath'])
    or grep('\\diskshadow.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['PowerShell.EXE', 'pwsh.dll', 'wmic.exe', 'VSSADMIN.EXE', 'diskshadow.exe'])
    and grep('shadow', this['ProcessCommandLine']) and grep('delete', this['ProcessCommandLine'])
    or (grep('\\wbadmin.exe', this['FolderPath']) or grep('WBADMIN.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('delete', this['ProcessCommandLine']) and grep('catalog', this['ProcessCommandLine'])
    and grep('quiet', this['ProcessCommandLine']) or (grep('\\vssadmin.exe', this['FolderPath'])
    or grep('VSSADMIN.EXE', this['ProcessVersionInfoOriginalFileName'])) and grep('resize',
    this['ProcessCommandLine']) and grep('shadowstorage', this['ProcessCommandLine'])
    and (grep('unbounded', this['ProcessCommandLine']) or grep('/MaxSize=', this['ProcessCommandLine']))
  sigma_id: c947b146-0abc-4c87-9c64-b17e9d7274a2
- name: Windows Shell/Scripting Processes Spawning Suspicious Programs
  query: (grep('\\mshta.exe', this['InitiatingProcessFolderPath']) or grep('\\powershell.exe',
    this['InitiatingProcessFolderPath']) or grep('\\pwsh.exe', this['InitiatingProcessFolderPath'])
    or grep('\\rundll32.exe', this['InitiatingProcessFolderPath']) or grep('\\cscript.exe',
    this['InitiatingProcessFolderPath']) or grep('\\wscript.exe', this['InitiatingProcessFolderPath'])
    or grep('\\wmiprvse.exe', this['InitiatingProcessFolderPath']) or grep('\\regsvr32.exe',
    this['InitiatingProcessFolderPath'])) and (grep('\\schtasks.exe', this['FolderPath'])
    or grep('\\nslookup.exe', this['FolderPath']) or grep('\\certutil.exe', this['FolderPath'])
    or grep('\\bitsadmin.exe', this['FolderPath']) or grep('\\mshta.exe', this['FolderPath']))
    and not (grep('\\ccmcache\\', this['CurrentDirectory']) or grep('\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\setup-scheduledtask.ps1',
    this['InitiatingProcessCommandLine']) or grep('\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\set-selfhealing.ps1',
    this['InitiatingProcessCommandLine']) or grep('\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\check-workspacehealth.ps1',
    this['InitiatingProcessCommandLine']) or grep('\\nessus_', this['InitiatingProcessCommandLine'])
    or grep('\\nessus_', this['ProcessCommandLine']) or grep('\\mshta.exe', this['InitiatingProcessFolderPath'])
    and grep('\\mshta.exe', this['FolderPath']) and grep('C:\\MEM_Configmgr_', this['InitiatingProcessCommandLine'])
    and grep('\\splash.hta', this['InitiatingProcessCommandLine']) and grep('{1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}',
    this['InitiatingProcessCommandLine']) and grep('C:\\MEM_Configmgr_', this['ProcessCommandLine'])
    and grep('\\SMSSETUP\\BIN\\', this['ProcessCommandLine']) and grep('\\autorun.hta',
    this['ProcessCommandLine']) and grep('{1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}',
    this['ProcessCommandLine']))
  sigma_id: 3a6586ad-127a-4d3b-a677-1e6eacdf8fde
- name: Process Creation Using Sysnative Folder
  query: grep(':\\Windows\\Sysnative\\', this['ProcessCommandLine']) or grep(':\\Windows\\Sysnative\\',
    this['FolderPath'])
  sigma_id: 3c1b5fb0-c72f-45ba-abd1-4d4c353144ab
- name: System File Execution Location Anomaly
  query: (grep('\\atbroker.exe', this['FolderPath']) or grep('\\audiodg.exe', this['FolderPath'])
    or grep('\\bcdedit.exe', this['FolderPath']) or grep('\\bitsadmin.exe', this['FolderPath'])
    or grep('\\certreq.exe', this['FolderPath']) or grep('\\certutil.exe', this['FolderPath'])
    or grep('\\cmstp.exe', this['FolderPath']) or grep('\\conhost.exe', this['FolderPath'])
    or grep('\\consent.exe', this['FolderPath']) or grep('\\cscript.exe', this['FolderPath'])
    or grep('\\csrss.exe', this['FolderPath']) or grep('\\dashost.exe', this['FolderPath'])
    or grep('\\defrag.exe', this['FolderPath']) or grep('\\dfrgui.exe', this['FolderPath'])
    or grep('\\dism.exe', this['FolderPath']) or grep('\\dllhost.exe', this['FolderPath'])
    or grep('\\dllhst3g.exe', this['FolderPath']) or grep('\\dwm.exe', this['FolderPath'])
    or grep('\\eventvwr.exe', this['FolderPath']) or grep('\\logonui.exe', this['FolderPath'])
    or grep('\\LsaIso.exe', this['FolderPath']) or grep('\\lsass.exe', this['FolderPath'])
    or grep('\\lsm.exe', this['FolderPath']) or grep('\\msiexec.exe', this['FolderPath'])
    or grep('\\ntoskrnl.exe', this['FolderPath']) or grep('\\powershell_ise.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\rundll32.exe',
    this['FolderPath']) or grep('\\runonce.exe', this['FolderPath']) or grep('\\RuntimeBroker.exe',
    this['FolderPath']) or grep('\\schtasks.exe', this['FolderPath']) or grep('\\services.exe',
    this['FolderPath']) or grep('\\sihost.exe', this['FolderPath']) or grep('\\smartscreen.exe',
    this['FolderPath']) or grep('\\smss.exe', this['FolderPath']) or grep('\\spoolsv.exe',
    this['FolderPath']) or grep('\\svchost.exe', this['FolderPath']) or grep('\\taskhost.exe',
    this['FolderPath']) or grep('\\Taskmgr.exe', this['FolderPath']) or grep('\\userinit.exe',
    this['FolderPath']) or grep('\\wininit.exe', this['FolderPath']) or grep('\\winlogon.exe',
    this['FolderPath']) or grep('\\winver.exe', this['FolderPath']) or grep('\\wlanext.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath']) or grep('\\wsl.exe',
    this['FolderPath']) or grep('\\wsmprovhost.exe', this['FolderPath'])) and not
    (grep('C:\\$WINDOWS.~BT\\', this['FolderPath']) or grep('C:\\$WinREAgent\\', this['FolderPath'])
    or grep('C:\\Windows\\SoftwareDistribution\\', this['FolderPath']) or grep('C:\\Windows\\System32\\',
    this['FolderPath']) or grep('C:\\Windows\\SystemTemp\\', this['FolderPath']) or
    grep('C:\\Windows\\SysWOW64\\', this['FolderPath']) or grep('C:\\Windows\\uus\\',
    this['FolderPath']) or grep('C:\\Windows\\WinSxS\\', this['FolderPath']) or this['FolderPath']
    in ['C:\\Program Files\\PowerShell\\7\\pwsh.exe', 'C:\\Program Files\\PowerShell\\7-preview\\pwsh.exe']
    or grep('C:\\Program Files\\WindowsApps\\MicrosoftCorporationII.WindowsSubsystemForLinux',
    this['FolderPath']) and grep('\\wsl.exe', this['FolderPath'])) and not grep('\\SystemRoot\\System32\\',
    this['FolderPath'])
  sigma_id: e4a6b256-3e47-40fc-89d2-7a477edd6915
- name: Suspicious SYSTEM User Process Creation
  query: (this['ProcessIntegrityLevel'] in ['System', 'S-1-16-16384']) and (grep('AUTHORI',
    this['AccountName']) or grep('AUTORI', this['AccountName'])) and (grep('\\calc.exe',
    this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']) or grep('\\forfiles.exe',
    this['FolderPath']) or grep('\\hh.exe', this['FolderPath']) or grep('\\mshta.exe',
    this['FolderPath']) or grep('\\ping.exe', this['FolderPath']) or grep('\\wscript.exe',
    this['FolderPath']) or grep(' -NoP ', this['ProcessCommandLine']) or grep(' -W
    Hidden ', this['ProcessCommandLine']) or grep(' -decode ', this['ProcessCommandLine'])
    or grep(' /decode ', this['ProcessCommandLine']) or grep(' /urlcache ', this['ProcessCommandLine'])
    or grep(' -urlcache ', this['ProcessCommandLine']) or (grep(' -e', this['ProcessCommandLine'])
    or grep(' JAB', this['ProcessCommandLine'])) or (grep(' -e', this['ProcessCommandLine'])
    or grep(' SUVYI', this['ProcessCommandLine'])) or (grep(' -e', this['ProcessCommandLine'])
    or grep(' SQBFAFgA', this['ProcessCommandLine'])) or (grep(' -e', this['ProcessCommandLine'])
    or grep(' aWV4I', this['ProcessCommandLine'])) or (grep(' -e', this['ProcessCommandLine'])
    or grep(' IAB', this['ProcessCommandLine'])) or (grep(' -e', this['ProcessCommandLine'])
    or grep(' PAA', this['ProcessCommandLine'])) or (grep(' -e', this['ProcessCommandLine'])
    or grep(' aQBlAHgA', this['ProcessCommandLine'])) or grep('vssadmin delete shadows',
    this['ProcessCommandLine']) or grep('reg SAVE HKLM', this['ProcessCommandLine'])
    or grep(' -ma ', this['ProcessCommandLine']) or grep('Microsoft\\Windows\\CurrentVersion\\Run',
    this['ProcessCommandLine']) or grep('.downloadstring(', this['ProcessCommandLine'])
    or grep('.downloadfile(', this['ProcessCommandLine']) or grep(' /ticket:', this['ProcessCommandLine'])
    or grep('dpapi::', this['ProcessCommandLine']) or grep('event::clear', this['ProcessCommandLine'])
    or grep('event::drop', this['ProcessCommandLine']) or grep('id::modify', this['ProcessCommandLine'])
    or grep('kerberos::', this['ProcessCommandLine']) or grep('lsadump::', this['ProcessCommandLine'])
    or grep('misc::', this['ProcessCommandLine']) or grep('privilege::', this['ProcessCommandLine'])
    or grep('rpc::', this['ProcessCommandLine']) or grep('sekurlsa::', this['ProcessCommandLine'])
    or grep('sid::', this['ProcessCommandLine']) or grep('token::', this['ProcessCommandLine'])
    or grep('vault::cred', this['ProcessCommandLine']) or grep('vault::list', this['ProcessCommandLine'])
    or grep(' p::d ', this['ProcessCommandLine']) or grep(';iex(', this['ProcessCommandLine'])
    or grep('MiniDump', this['ProcessCommandLine']) or grep('net user ', this['ProcessCommandLine']))
    and not (grep('ping', this['ProcessCommandLine']) and grep('127.0.0.1', this['ProcessCommandLine'])
    and grep(' -n ', this['ProcessCommandLine']) or grep('\\PING.EXE', this['FolderPath'])
    and grep('\\DismFoDInstall.cmd', this['InitiatingProcessCommandLine']) or grep(':\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\',
    this['InitiatingProcessFolderPath']) or (grep(':\\Program Files (x86)\\Java\\',
    this['InitiatingProcessFolderPath']) or grep(':\\Program Files\\Java\\', this['InitiatingProcessFolderPath']))
    and grep('\\bin\\javaws.exe', this['InitiatingProcessFolderPath']) and (grep(':\\Program
    Files (x86)\\Java\\', this['FolderPath']) or grep(':\\Program Files\\Java\\',
    this['FolderPath'])) and grep('\\bin\\jp2launcher.exe', this['FolderPath']) and
    grep(' -ma ', this['ProcessCommandLine']))
  sigma_id: 2617e7ed-adb7-40ba-b0f3-8f9945fe6c09
- name: Suspicious SYSVOL Domain Group Policy Access
  query: grep('\\SYSVOL\\', this['ProcessCommandLine']) and grep('\\policies\\', this['ProcessCommandLine'])
  sigma_id: 05f3c945-dcc8-4393-9f3d-af65077a8f86
- name: Tasks Folder Evasion
  query: (grep('echo ', this['ProcessCommandLine']) or grep('copy ', this['ProcessCommandLine'])
    or grep('type ', this['ProcessCommandLine']) or grep('file createnew', this['ProcessCommandLine']))
    and (grep(' C:\\Windows\\System32\\Tasks\\', this['ProcessCommandLine']) or grep('
    C:\\Windows\\SysWow64\\Tasks\\', this['ProcessCommandLine']))
  sigma_id: cc4e02ba-9c06-48e2-b09e-2500cace9ae0
- name: Malicious PE Execution by Microsoft Visual Studio Debugger
  query: grep('\\vsjitdebugger.exe', this['InitiatingProcessFolderPath']) and not
    ((grep('\\vsimmersiveactivatehelper', this['FolderPath']) or grep('.exe', this['FolderPath']))
    or grep('\\devenv.exe', this['FolderPath']))
  sigma_id: 15c7904e-6ad1-4a45-9b46-5fb25df37fd2
- name: Suspicious Userinit Child Process
  query: grep('\\userinit.exe', this['InitiatingProcessFolderPath']) and not (grep('\\netlogon\\',
    this['ProcessCommandLine']) or grep('\\explorer.exe', this['FolderPath']) or grep('explorer.exe',
    this['ProcessVersionInfoOriginalFileName']))
  sigma_id: b655a06a-31c0-477a-95c2-3726b83d649d
- name: Weak or Abused Passwords In CLI
  query: grep('123456789', this['ProcessCommandLine']) or grep('123123qwE', this['ProcessCommandLine'])
    or grep('Asd123.aaaa', this['ProcessCommandLine']) or grep('Decryptme', this['ProcessCommandLine'])
    or grep('P@ssw0rd!', this['ProcessCommandLine']) or grep('Pass8080', this['ProcessCommandLine'])
    or grep('password123', this['ProcessCommandLine']) or grep('test@202', this['ProcessCommandLine'])
  sigma_id: 91edcfb1-2529-4ac2-9ecc-7617f895c7e4
- name: Usage Of Web Request Commands And Cmdlets
  query: grep('[System.Net.WebRequest]::create', this['ProcessCommandLine']) or grep('curl
    ', this['ProcessCommandLine']) or grep('Invoke-RestMethod', this['ProcessCommandLine'])
    or grep('Invoke-WebRequest', this['ProcessCommandLine']) or grep('iwr ', this['ProcessCommandLine'])
    or grep('Net.WebClient', this['ProcessCommandLine']) or grep('Resume-BitsTransfer',
    this['ProcessCommandLine']) or grep('Start-BitsTransfer', this['ProcessCommandLine'])
    or grep('wget ', this['ProcessCommandLine']) or grep('WinHttp.WinHttpRequest',
    this['ProcessCommandLine'])
  sigma_id: 9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d
- name: WhoAmI as Parameter
  query: grep('.exe whoami', this['ProcessCommandLine'])
  sigma_id: e9142d84-fbe0-401d-ac50-3e519fb00c89
- name: Execution via WorkFolders.exe
  query: grep('\\control.exe', this['FolderPath']) and grep('\\WorkFolders.exe', this['InitiatingProcessFolderPath'])
    and not grep('C:\\Windows\\System32\\control.exe', this['FolderPath'])
  sigma_id: 0bbc6369-43e3-453d-9944-cae58821c173
- name: Suspect Svchost Activity
  query: grep('svchost.exe', this['ProcessCommandLine']) and grep('\\svchost.exe',
    this['FolderPath']) and not (grep('\\rpcnet.exe', this['InitiatingProcessFolderPath'])
    or grep('\\rpcnetp.exe', this['InitiatingProcessFolderPath']) or this['ProcessCommandLine']==null)
  sigma_id: 16c37b52-b141-42a5-a3ea-bbe098444397
- name: Suspicious Process Masquerading As SvcHost.EXE
  query: grep('\\svchost.exe', this['FolderPath']) and not (this['FolderPath'] in
    ['C:\\Windows\\System32\\svchost.exe', 'C:\\Windows\\SysWOW64\\svchost.exe'] or
    grep('svchost.exe', this['ProcessVersionInfoOriginalFileName']))
  sigma_id: be58d2e2-06c8-4f58-b666-b99f6dc3b6cd
- name: Terminal Service Process Spawn
  query: grep('\\svchost.exe', this['InitiatingProcessCommandLine']) and grep('termsvcs',
    this['InitiatingProcessCommandLine']) and not (grep('\\rdpclip.exe', this['FolderPath'])
    or grep(':\\Windows\\System32\\csrss.exe', this['FolderPath']) or grep(':\\Windows\\System32\\wininit.exe',
    this['FolderPath']) or grep(':\\Windows\\System32\\winlogon.exe', this['FolderPath'])
    or this['FolderPath']==null)
  sigma_id: 1012f107-b8f1-4271-af30-5aed2de89b39
- name: Uncommon Svchost Parent Process
  query: grep('\\svchost.exe', this['FolderPath']) and not (grep('\\Mrt.exe', this['InitiatingProcessFolderPath'])
    or grep('\\MsMpEng.exe', this['InitiatingProcessFolderPath']) or grep('\\ngen.exe',
    this['InitiatingProcessFolderPath']) or grep('\\rpcnet.exe', this['InitiatingProcessFolderPath'])
    or grep('\\services.exe', this['InitiatingProcessFolderPath']) or grep('\\TiWorker.exe',
    this['InitiatingProcessFolderPath']) or this['InitiatingProcessFolderPath']==null
    or this['InitiatingProcessFolderPath'] in ['-', '()'])
  sigma_id: 01d2e2a1-5f09-44f7-9fc1-24faa7479b6d
- name: Permission Check Via Accesschk.EXE
  query: (grep('AccessChk', this['ProcessVersionInfoProductName']) or grep('Reports
    effective permissions', this['ProcessVersionInfoFileDescription']) or grep('\\accesschk.exe',
    this['FolderPath']) or grep('\\accesschk64.exe', this['FolderPath']) or grep('accesschk.exe',
    this['ProcessVersionInfoOriginalFileName'])) and (grep('uwcqv ', this['ProcessCommandLine'])
    or grep('kwsu ', this['ProcessCommandLine']) or grep('qwsu ', this['ProcessCommandLine'])
    or grep('uwdqs ', this['ProcessCommandLine']))
  sigma_id: c625d754-6a3d-4f65-9c9a-536aea960d37
- name: Active Directory Database Snapshot Via ADExplorer
  query: (grep('\\ADExplorer.exe', this['FolderPath']) or grep('AdExp', this['ProcessVersionInfoOriginalFileName']))
    and grep('snapshot', this['ProcessCommandLine'])
  sigma_id: 9212f354-7775-4e28-9c9f-8f0a4544e664
- name: Suspicious Active Directory Database Snapshot Via ADExplorer
  query: (grep('\\ADExplorer.exe', this['FolderPath']) or grep('AdExp', this['ProcessVersionInfoOriginalFileName']))
    and grep('snapshot', this['ProcessCommandLine']) and (grep('\\Downloads\\', this['ProcessCommandLine'])
    or grep('\\Users\\Public\\', this['ProcessCommandLine']) or grep('\\AppData\\',
    this['ProcessCommandLine']) or grep('\\Windows\\Temp\\', this['ProcessCommandLine']))
  sigma_id: ef61af62-bc74-4f58-b49b-626448227652
- name: Potential Memory Dumping Activity Via LiveKD
  query: grep('\\livekd.exe', this['FolderPath']) or grep('\\livekd64.exe', this['FolderPath'])
    or grep('livekd.exe', this['ProcessVersionInfoOriginalFileName'])
  sigma_id: a85f7765-698a-4088-afa0-ecfbf8d01fa4
- name: Kernel Memory Dump Via LiveKD
  query: "(grep('\\\\livekd.exe', this['FolderPath']) or grep('\\\\livekd64.exe',\
    \ this['FolderPath']) or grep('livekd.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep(' -m', this['ProcessCommandLine']) or grep(' /m', this['ProcessCommandLine'])\
    \ or grep(' \u2013m', this['ProcessCommandLine']) or grep(' \u2014m', this['ProcessCommandLine'])\
    \ or grep(' \u2015m', this['ProcessCommandLine']))"
  sigma_id: c7746f1c-47d3-43d6-8c45-cd1e54b6b0a2
- name: Procdump Execution
  query: grep('\\procdump.exe', this['FolderPath']) or grep('\\procdump64.exe', this['FolderPath'])
  sigma_id: 2e65275c-8288-4ab4-aeb7-6274f58b6b20
- name: Potential SysInternals ProcDump Evasion
  query: grep('copy procdump', this['ProcessCommandLine']) or grep('move procdump',
    this['ProcessCommandLine']) or grep('copy ', this['ProcessCommandLine']) and grep('.dmp
    ', this['ProcessCommandLine']) and (grep('2.dmp', this['ProcessCommandLine'])
    or grep('lsass', this['ProcessCommandLine']) or grep('out.dmp', this['ProcessCommandLine']))
    or grep('copy lsass.exe_', this['ProcessCommandLine']) or grep('move lsass.exe_',
    this['ProcessCommandLine'])
  sigma_id: 79b06761-465f-4f88-9ef2-150e24d3d737
- name: Potential LSASS Process Dump Via Procdump
  query: "(grep(' -ma ', this['ProcessCommandLine']) or grep(' /ma ', this['ProcessCommandLine'])\
    \ or grep(' \u2013ma ', this['ProcessCommandLine']) or grep(' \u2014ma ', this['ProcessCommandLine'])\
    \ or grep(' \u2015ma ', this['ProcessCommandLine'])) and grep(' ls', this['ProcessCommandLine'])"
  sigma_id: 5afee48e-67dd-4e03-a783-f74259dcf998
- name: Psexec Execution
  query: grep('\\psexec.exe', this['FolderPath']) or grep('psexec.c', this['ProcessVersionInfoOriginalFileName'])
  sigma_id: 730fc21b-eaff-474b-ad23-90fd265d4988
- name: PsExec/PAExec Escalation to LOCAL SYSTEM
  query: "(grep(' -s cmd', this['ProcessCommandLine']) or grep(' /s cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2013s cmd', this['ProcessCommandLine']) or grep(' \u2014s cmd',\
    \ this['ProcessCommandLine']) or grep(' \u2015s cmd', this['ProcessCommandLine'])\
    \ or grep(' -s -i cmd', this['ProcessCommandLine']) or grep(' -s /i cmd', this['ProcessCommandLine'])\
    \ or grep(' -s \u2013i cmd', this['ProcessCommandLine']) or grep(' -s \u2014i\
    \ cmd', this['ProcessCommandLine']) or grep(' -s \u2015i cmd', this['ProcessCommandLine'])\
    \ or grep(' /s -i cmd', this['ProcessCommandLine']) or grep(' /s /i cmd', this['ProcessCommandLine'])\
    \ or grep(' /s \u2013i cmd', this['ProcessCommandLine']) or grep(' /s \u2014i\
    \ cmd', this['ProcessCommandLine']) or grep(' /s \u2015i cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2013s -i cmd', this['ProcessCommandLine']) or grep(' \u2013s /i\
    \ cmd', this['ProcessCommandLine']) or grep(' \u2013s \u2013i cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2013s \u2014i cmd', this['ProcessCommandLine']) or grep(' \u2013\
    s \u2015i cmd', this['ProcessCommandLine']) or grep(' \u2014s -i cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2014s /i cmd', this['ProcessCommandLine']) or grep(' \u2014s \u2013\
    i cmd', this['ProcessCommandLine']) or grep(' \u2014s \u2014i cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2014s \u2015i cmd', this['ProcessCommandLine']) or grep(' \u2015\
    s -i cmd', this['ProcessCommandLine']) or grep(' \u2015s /i cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2015s \u2013i cmd', this['ProcessCommandLine']) or grep(' \u2015\
    s \u2014i cmd', this['ProcessCommandLine']) or grep(' \u2015s \u2015i cmd', this['ProcessCommandLine'])\
    \ or grep(' -i -s cmd', this['ProcessCommandLine']) or grep(' -i /s cmd', this['ProcessCommandLine'])\
    \ or grep(' -i \u2013s cmd', this['ProcessCommandLine']) or grep(' -i \u2014s\
    \ cmd', this['ProcessCommandLine']) or grep(' -i \u2015s cmd', this['ProcessCommandLine'])\
    \ or grep(' /i -s cmd', this['ProcessCommandLine']) or grep(' /i /s cmd', this['ProcessCommandLine'])\
    \ or grep(' /i \u2013s cmd', this['ProcessCommandLine']) or grep(' /i \u2014s\
    \ cmd', this['ProcessCommandLine']) or grep(' /i \u2015s cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2013i -s cmd', this['ProcessCommandLine']) or grep(' \u2013i /s\
    \ cmd', this['ProcessCommandLine']) or grep(' \u2013i \u2013s cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2013i \u2014s cmd', this['ProcessCommandLine']) or grep(' \u2013\
    i \u2015s cmd', this['ProcessCommandLine']) or grep(' \u2014i -s cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2014i /s cmd', this['ProcessCommandLine']) or grep(' \u2014i \u2013\
    s cmd', this['ProcessCommandLine']) or grep(' \u2014i \u2014s cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2014i \u2015s cmd', this['ProcessCommandLine']) or grep(' \u2015\
    i -s cmd', this['ProcessCommandLine']) or grep(' \u2015i /s cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2015i \u2013s cmd', this['ProcessCommandLine']) or grep(' \u2015\
    i \u2014s cmd', this['ProcessCommandLine']) or grep(' \u2015i \u2015s cmd', this['ProcessCommandLine'])\
    \ or grep(' -s pwsh', this['ProcessCommandLine']) or grep(' /s pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2013s pwsh', this['ProcessCommandLine']) or grep(' \u2014s pwsh',\
    \ this['ProcessCommandLine']) or grep(' \u2015s pwsh', this['ProcessCommandLine'])\
    \ or grep(' -s -i pwsh', this['ProcessCommandLine']) or grep(' -s /i pwsh', this['ProcessCommandLine'])\
    \ or grep(' -s \u2013i pwsh', this['ProcessCommandLine']) or grep(' -s \u2014\
    i pwsh', this['ProcessCommandLine']) or grep(' -s \u2015i pwsh', this['ProcessCommandLine'])\
    \ or grep(' /s -i pwsh', this['ProcessCommandLine']) or grep(' /s /i pwsh', this['ProcessCommandLine'])\
    \ or grep(' /s \u2013i pwsh', this['ProcessCommandLine']) or grep(' /s \u2014\
    i pwsh', this['ProcessCommandLine']) or grep(' /s \u2015i pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2013s -i pwsh', this['ProcessCommandLine']) or grep(' \u2013s /i\
    \ pwsh', this['ProcessCommandLine']) or grep(' \u2013s \u2013i pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2013s \u2014i pwsh', this['ProcessCommandLine']) or grep(' \u2013\
    s \u2015i pwsh', this['ProcessCommandLine']) or grep(' \u2014s -i pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2014s /i pwsh', this['ProcessCommandLine']) or grep(' \u2014s \u2013\
    i pwsh', this['ProcessCommandLine']) or grep(' \u2014s \u2014i pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2014s \u2015i pwsh', this['ProcessCommandLine']) or grep(' \u2015\
    s -i pwsh', this['ProcessCommandLine']) or grep(' \u2015s /i pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2015s \u2013i pwsh', this['ProcessCommandLine']) or grep(' \u2015\
    s \u2014i pwsh', this['ProcessCommandLine']) or grep(' \u2015s \u2015i pwsh',\
    \ this['ProcessCommandLine']) or grep(' -i -s pwsh', this['ProcessCommandLine'])\
    \ or grep(' -i /s pwsh', this['ProcessCommandLine']) or grep(' -i \u2013s pwsh',\
    \ this['ProcessCommandLine']) or grep(' -i \u2014s pwsh', this['ProcessCommandLine'])\
    \ or grep(' -i \u2015s pwsh', this['ProcessCommandLine']) or grep(' /i -s pwsh',\
    \ this['ProcessCommandLine']) or grep(' /i /s pwsh', this['ProcessCommandLine'])\
    \ or grep(' /i \u2013s pwsh', this['ProcessCommandLine']) or grep(' /i \u2014\
    s pwsh', this['ProcessCommandLine']) or grep(' /i \u2015s pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2013i -s pwsh', this['ProcessCommandLine']) or grep(' \u2013i /s\
    \ pwsh', this['ProcessCommandLine']) or grep(' \u2013i \u2013s pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2013i \u2014s pwsh', this['ProcessCommandLine']) or grep(' \u2013\
    i \u2015s pwsh', this['ProcessCommandLine']) or grep(' \u2014i -s pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2014i /s pwsh', this['ProcessCommandLine']) or grep(' \u2014i \u2013\
    s pwsh', this['ProcessCommandLine']) or grep(' \u2014i \u2014s pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2014i \u2015s pwsh', this['ProcessCommandLine']) or grep(' \u2015\
    i -s pwsh', this['ProcessCommandLine']) or grep(' \u2015i /s pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2015i \u2013s pwsh', this['ProcessCommandLine']) or grep(' \u2015\
    i \u2014s pwsh', this['ProcessCommandLine']) or grep(' \u2015i \u2015s pwsh',\
    \ this['ProcessCommandLine']) or grep(' -s powershell', this['ProcessCommandLine'])\
    \ or grep(' /s powershell', this['ProcessCommandLine']) or grep(' \u2013s powershell',\
    \ this['ProcessCommandLine']) or grep(' \u2014s powershell', this['ProcessCommandLine'])\
    \ or grep(' \u2015s powershell', this['ProcessCommandLine']) or grep(' -s -i powershell',\
    \ this['ProcessCommandLine']) or grep(' -s /i powershell', this['ProcessCommandLine'])\
    \ or grep(' -s \u2013i powershell', this['ProcessCommandLine']) or grep(' -s \u2014\
    i powershell', this['ProcessCommandLine']) or grep(' -s \u2015i powershell', this['ProcessCommandLine'])\
    \ or grep(' /s -i powershell', this['ProcessCommandLine']) or grep(' /s /i powershell',\
    \ this['ProcessCommandLine']) or grep(' /s \u2013i powershell', this['ProcessCommandLine'])\
    \ or grep(' /s \u2014i powershell', this['ProcessCommandLine']) or grep(' /s \u2015\
    i powershell', this['ProcessCommandLine']) or grep(' \u2013s -i powershell', this['ProcessCommandLine'])\
    \ or grep(' \u2013s /i powershell', this['ProcessCommandLine']) or grep(' \u2013\
    s \u2013i powershell', this['ProcessCommandLine']) or grep(' \u2013s \u2014i powershell',\
    \ this['ProcessCommandLine']) or grep(' \u2013s \u2015i powershell', this['ProcessCommandLine'])\
    \ or grep(' \u2014s -i powershell', this['ProcessCommandLine']) or grep(' \u2014\
    s /i powershell', this['ProcessCommandLine']) or grep(' \u2014s \u2013i powershell',\
    \ this['ProcessCommandLine']) or grep(' \u2014s \u2014i powershell', this['ProcessCommandLine'])\
    \ or grep(' \u2014s \u2015i powershell', this['ProcessCommandLine']) or grep('\
    \ \u2015s -i powershell', this['ProcessCommandLine']) or grep(' \u2015s /i powershell',\
    \ this['ProcessCommandLine']) or grep(' \u2015s \u2013i powershell', this['ProcessCommandLine'])\
    \ or grep(' \u2015s \u2014i powershell', this['ProcessCommandLine']) or grep('\
    \ \u2015s \u2015i powershell', this['ProcessCommandLine']) or grep(' -i -s powershell',\
    \ this['ProcessCommandLine']) or grep(' -i /s powershell', this['ProcessCommandLine'])\
    \ or grep(' -i \u2013s powershell', this['ProcessCommandLine']) or grep(' -i \u2014\
    s powershell', this['ProcessCommandLine']) or grep(' -i \u2015s powershell', this['ProcessCommandLine'])\
    \ or grep(' /i -s powershell', this['ProcessCommandLine']) or grep(' /i /s powershell',\
    \ this['ProcessCommandLine']) or grep(' /i \u2013s powershell', this['ProcessCommandLine'])\
    \ or grep(' /i \u2014s powershell', this['ProcessCommandLine']) or grep(' /i \u2015\
    s powershell', this['ProcessCommandLine']) or grep(' \u2013i -s powershell', this['ProcessCommandLine'])\
    \ or grep(' \u2013i /s powershell', this['ProcessCommandLine']) or grep(' \u2013\
    i \u2013s powershell', this['ProcessCommandLine']) or grep(' \u2013i \u2014s powershell',\
    \ this['ProcessCommandLine']) or grep(' \u2013i \u2015s powershell', this['ProcessCommandLine'])\
    \ or grep(' \u2014i -s powershell', this['ProcessCommandLine']) or grep(' \u2014\
    i /s powershell', this['ProcessCommandLine']) or grep(' \u2014i \u2013s powershell',\
    \ this['ProcessCommandLine']) or grep(' \u2014i \u2014s powershell', this['ProcessCommandLine'])\
    \ or grep(' \u2014i \u2015s powershell', this['ProcessCommandLine']) or grep('\
    \ \u2015i -s powershell', this['ProcessCommandLine']) or grep(' \u2015i /s powershell',\
    \ this['ProcessCommandLine']) or grep(' \u2015i \u2013s powershell', this['ProcessCommandLine'])\
    \ or grep(' \u2015i \u2014s powershell', this['ProcessCommandLine']) or grep('\
    \ \u2015i \u2015s powershell', this['ProcessCommandLine'])) and (grep('psexec',\
    \ this['ProcessCommandLine']) or grep('paexec', this['ProcessCommandLine']) or\
    \ grep('accepteula', this['ProcessCommandLine']))"
  sigma_id: 8834e2f7-6b4b-4f09-8906-d2276470ee23
- name: Potential PsExec Remote Execution
  query: grep('accepteula', this['ProcessCommandLine']) and grep(' -u ', this['ProcessCommandLine'])
    and grep(' -p ', this['ProcessCommandLine']) and grep(' \\', this['ProcessCommandLine'])
  sigma_id: ea011323-7045-460b-b2d7-0f7442ea6b38
- name: PsExec Service Execution
  query: grep('C:\\Windows\\PSEXESVC.exe', this['FolderPath']) or grep('psexesvc.exe',
    this['ProcessVersionInfoOriginalFileName'])
  sigma_id: fdfcbd78-48f1-4a4b-90ac-d82241e368c5
- name: PsExec Service Child Process Execution as LOCAL SYSTEM
  query: grep('C:\\Windows\\PSEXESVC.exe', this['InitiatingProcessFolderPath']) and
    (grep('AUTHORI', this['AccountName']) or grep('AUTORI', this['AccountName']))
  sigma_id: 7c0dcd3d-acf8-4f71-9570-f448b0034f94
- name: Suspicious Use of PsLogList
  query: "(grep('psloglist.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\\
    \\psloglist.exe', this['FolderPath']) or grep('\\\\psloglist64.exe', this['FolderPath']))\
    \ and (grep(' security', this['ProcessCommandLine']) or grep(' application', this['ProcessCommandLine'])\
    \ or grep(' system', this['ProcessCommandLine'])) and (grep(' -d', this['ProcessCommandLine'])\
    \ or grep(' /d', this['ProcessCommandLine']) or grep(' \u2013d', this['ProcessCommandLine'])\
    \ or grep(' \u2014d', this['ProcessCommandLine']) or grep(' \u2015d', this['ProcessCommandLine'])\
    \ or grep(' -x', this['ProcessCommandLine']) or grep(' /x', this['ProcessCommandLine'])\
    \ or grep(' \u2013x', this['ProcessCommandLine']) or grep(' \u2014x', this['ProcessCommandLine'])\
    \ or grep(' \u2015x', this['ProcessCommandLine']) or grep(' -s', this['ProcessCommandLine'])\
    \ or grep(' /s', this['ProcessCommandLine']) or grep(' \u2013s', this['ProcessCommandLine'])\
    \ or grep(' \u2014s', this['ProcessCommandLine']) or grep(' \u2015s', this['ProcessCommandLine'])\
    \ or grep(' -c', this['ProcessCommandLine']) or grep(' /c', this['ProcessCommandLine'])\
    \ or grep(' \u2013c', this['ProcessCommandLine']) or grep(' \u2014c', this['ProcessCommandLine'])\
    \ or grep(' \u2015c', this['ProcessCommandLine']) or grep(' -g', this['ProcessCommandLine'])\
    \ or grep(' /g', this['ProcessCommandLine']) or grep(' \u2013g', this['ProcessCommandLine'])\
    \ or grep(' \u2014g', this['ProcessCommandLine']) or grep(' \u2015g', this['ProcessCommandLine']))"
  sigma_id: aae1243f-d8af-40d8-ab20-33fc6d0c55bc
- name: Sysinternals PsService Execution
  query: grep('psservice.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\PsService.exe',
    this['FolderPath']) or grep('\\PsService64.exe', this['FolderPath'])
  sigma_id: 3371f518-5fe3-4cf6-a14b-2a0ae3fd8a4f
- name: Sysinternals PsSuspend Execution
  query: grep('pssuspend.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\pssuspend.exe',
    this['FolderPath']) or grep('\\pssuspend64.exe', this['FolderPath'])
  sigma_id: 48bbc537-b652-4b4e-bd1d-281172df448f
- name: Sysinternals PsSuspend Suspicious Execution
  query: (grep('pssuspend.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\pssuspend.exe',
    this['FolderPath']) or grep('\\pssuspend64.exe', this['FolderPath'])) and grep('msmpeng.exe',
    this['ProcessCommandLine'])
  sigma_id: 4beb6ae0-f85b-41e2-8f18-8668abc8af78
- name: Potential File Overwrite Via Sysinternals SDelete
  query: 'grep(''sdelete.exe'', this[''ProcessVersionInfoOriginalFileName'']) and
    not (grep('' -h'', this[''ProcessCommandLine'']) or grep('' -c'', this[''ProcessCommandLine''])
    or grep('' -z'', this[''ProcessCommandLine'']) or grep(''(\'' /\'', <SpecialChars.WILDCARD_SINGLE:
    2>)'', this[''ProcessCommandLine'']))'
  sigma_id: a4824fca-976f-4964-b334-0621379e84c4
- name: Potential Privilege Escalation To LOCAL SYSTEM
  query: "(grep(' -s cmd', this['ProcessCommandLine']) or grep(' /s cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2013s cmd', this['ProcessCommandLine']) or grep(' \u2014s cmd',\
    \ this['ProcessCommandLine']) or grep(' \u2015s cmd', this['ProcessCommandLine'])\
    \ or grep(' -s -i cmd', this['ProcessCommandLine']) or grep(' -s /i cmd', this['ProcessCommandLine'])\
    \ or grep(' -s \u2013i cmd', this['ProcessCommandLine']) or grep(' -s \u2014i\
    \ cmd', this['ProcessCommandLine']) or grep(' -s \u2015i cmd', this['ProcessCommandLine'])\
    \ or grep(' /s -i cmd', this['ProcessCommandLine']) or grep(' /s /i cmd', this['ProcessCommandLine'])\
    \ or grep(' /s \u2013i cmd', this['ProcessCommandLine']) or grep(' /s \u2014i\
    \ cmd', this['ProcessCommandLine']) or grep(' /s \u2015i cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2013s -i cmd', this['ProcessCommandLine']) or grep(' \u2013s /i\
    \ cmd', this['ProcessCommandLine']) or grep(' \u2013s \u2013i cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2013s \u2014i cmd', this['ProcessCommandLine']) or grep(' \u2013\
    s \u2015i cmd', this['ProcessCommandLine']) or grep(' \u2014s -i cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2014s /i cmd', this['ProcessCommandLine']) or grep(' \u2014s \u2013\
    i cmd', this['ProcessCommandLine']) or grep(' \u2014s \u2014i cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2014s \u2015i cmd', this['ProcessCommandLine']) or grep(' \u2015\
    s -i cmd', this['ProcessCommandLine']) or grep(' \u2015s /i cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2015s \u2013i cmd', this['ProcessCommandLine']) or grep(' \u2015\
    s \u2014i cmd', this['ProcessCommandLine']) or grep(' \u2015s \u2015i cmd', this['ProcessCommandLine'])\
    \ or grep(' -i -s cmd', this['ProcessCommandLine']) or grep(' -i /s cmd', this['ProcessCommandLine'])\
    \ or grep(' -i \u2013s cmd', this['ProcessCommandLine']) or grep(' -i \u2014s\
    \ cmd', this['ProcessCommandLine']) or grep(' -i \u2015s cmd', this['ProcessCommandLine'])\
    \ or grep(' /i -s cmd', this['ProcessCommandLine']) or grep(' /i /s cmd', this['ProcessCommandLine'])\
    \ or grep(' /i \u2013s cmd', this['ProcessCommandLine']) or grep(' /i \u2014s\
    \ cmd', this['ProcessCommandLine']) or grep(' /i \u2015s cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2013i -s cmd', this['ProcessCommandLine']) or grep(' \u2013i /s\
    \ cmd', this['ProcessCommandLine']) or grep(' \u2013i \u2013s cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2013i \u2014s cmd', this['ProcessCommandLine']) or grep(' \u2013\
    i \u2015s cmd', this['ProcessCommandLine']) or grep(' \u2014i -s cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2014i /s cmd', this['ProcessCommandLine']) or grep(' \u2014i \u2013\
    s cmd', this['ProcessCommandLine']) or grep(' \u2014i \u2014s cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2014i \u2015s cmd', this['ProcessCommandLine']) or grep(' \u2015\
    i -s cmd', this['ProcessCommandLine']) or grep(' \u2015i /s cmd', this['ProcessCommandLine'])\
    \ or grep(' \u2015i \u2013s cmd', this['ProcessCommandLine']) or grep(' \u2015\
    i \u2014s cmd', this['ProcessCommandLine']) or grep(' \u2015i \u2015s cmd', this['ProcessCommandLine'])\
    \ or grep(' -s pwsh', this['ProcessCommandLine']) or grep(' /s pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2013s pwsh', this['ProcessCommandLine']) or grep(' \u2014s pwsh',\
    \ this['ProcessCommandLine']) or grep(' \u2015s pwsh', this['ProcessCommandLine'])\
    \ or grep(' -s -i pwsh', this['ProcessCommandLine']) or grep(' -s /i pwsh', this['ProcessCommandLine'])\
    \ or grep(' -s \u2013i pwsh', this['ProcessCommandLine']) or grep(' -s \u2014\
    i pwsh', this['ProcessCommandLine']) or grep(' -s \u2015i pwsh', this['ProcessCommandLine'])\
    \ or grep(' /s -i pwsh', this['ProcessCommandLine']) or grep(' /s /i pwsh', this['ProcessCommandLine'])\
    \ or grep(' /s \u2013i pwsh', this['ProcessCommandLine']) or grep(' /s \u2014\
    i pwsh', this['ProcessCommandLine']) or grep(' /s \u2015i pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2013s -i pwsh', this['ProcessCommandLine']) or grep(' \u2013s /i\
    \ pwsh', this['ProcessCommandLine']) or grep(' \u2013s \u2013i pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2013s \u2014i pwsh', this['ProcessCommandLine']) or grep(' \u2013\
    s \u2015i pwsh', this['ProcessCommandLine']) or grep(' \u2014s -i pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2014s /i pwsh', this['ProcessCommandLine']) or grep(' \u2014s \u2013\
    i pwsh', this['ProcessCommandLine']) or grep(' \u2014s \u2014i pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2014s \u2015i pwsh', this['ProcessCommandLine']) or grep(' \u2015\
    s -i pwsh', this['ProcessCommandLine']) or grep(' \u2015s /i pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2015s \u2013i pwsh', this['ProcessCommandLine']) or grep(' \u2015\
    s \u2014i pwsh', this['ProcessCommandLine']) or grep(' \u2015s \u2015i pwsh',\
    \ this['ProcessCommandLine']) or grep(' -i -s pwsh', this['ProcessCommandLine'])\
    \ or grep(' -i /s pwsh', this['ProcessCommandLine']) or grep(' -i \u2013s pwsh',\
    \ this['ProcessCommandLine']) or grep(' -i \u2014s pwsh', this['ProcessCommandLine'])\
    \ or grep(' -i \u2015s pwsh', this['ProcessCommandLine']) or grep(' /i -s pwsh',\
    \ this['ProcessCommandLine']) or grep(' /i /s pwsh', this['ProcessCommandLine'])\
    \ or grep(' /i \u2013s pwsh', this['ProcessCommandLine']) or grep(' /i \u2014\
    s pwsh', this['ProcessCommandLine']) or grep(' /i \u2015s pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2013i -s pwsh', this['ProcessCommandLine']) or grep(' \u2013i /s\
    \ pwsh', this['ProcessCommandLine']) or grep(' \u2013i \u2013s pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2013i \u2014s pwsh', this['ProcessCommandLine']) or grep(' \u2013\
    i \u2015s pwsh', this['ProcessCommandLine']) or grep(' \u2014i -s pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2014i /s pwsh', this['ProcessCommandLine']) or grep(' \u2014i \u2013\
    s pwsh', this['ProcessCommandLine']) or grep(' \u2014i \u2014s pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2014i \u2015s pwsh', this['ProcessCommandLine']) or grep(' \u2015\
    i -s pwsh', this['ProcessCommandLine']) or grep(' \u2015i /s pwsh', this['ProcessCommandLine'])\
    \ or grep(' \u2015i \u2013s pwsh', this['ProcessCommandLine']) or grep(' \u2015\
    i \u2014s pwsh', this['ProcessCommandLine']) or grep(' \u2015i \u2015s pwsh',\
    \ this['ProcessCommandLine']) or grep(' -s powershell', this['ProcessCommandLine'])\
    \ or grep(' /s powershell', this['ProcessCommandLine']) or grep(' \u2013s powershell',\
    \ this['ProcessCommandLine']) or grep(' \u2014s powershell', this['ProcessCommandLine'])\
    \ or grep(' \u2015s powershell', this['ProcessCommandLine']) or grep(' -s -i powershell',\
    \ this['ProcessCommandLine']) or grep(' -s /i powershell', this['ProcessCommandLine'])\
    \ or grep(' -s \u2013i powershell', this['ProcessCommandLine']) or grep(' -s \u2014\
    i powershell', this['ProcessCommandLine']) or grep(' -s \u2015i powershell', this['ProcessCommandLine'])\
    \ or grep(' /s -i powershell', this['ProcessCommandLine']) or grep(' /s /i powershell',\
    \ this['ProcessCommandLine']) or grep(' /s \u2013i powershell', this['ProcessCommandLine'])\
    \ or grep(' /s \u2014i powershell', this['ProcessCommandLine']) or grep(' /s \u2015\
    i powershell', this['ProcessCommandLine']) or grep(' \u2013s -i powershell', this['ProcessCommandLine'])\
    \ or grep(' \u2013s /i powershell', this['ProcessCommandLine']) or grep(' \u2013\
    s \u2013i powershell', this['ProcessCommandLine']) or grep(' \u2013s \u2014i powershell',\
    \ this['ProcessCommandLine']) or grep(' \u2013s \u2015i powershell', this['ProcessCommandLine'])\
    \ or grep(' \u2014s -i powershell', this['ProcessCommandLine']) or grep(' \u2014\
    s /i powershell', this['ProcessCommandLine']) or grep(' \u2014s \u2013i powershell',\
    \ this['ProcessCommandLine']) or grep(' \u2014s \u2014i powershell', this['ProcessCommandLine'])\
    \ or grep(' \u2014s \u2015i powershell', this['ProcessCommandLine']) or grep('\
    \ \u2015s -i powershell', this['ProcessCommandLine']) or grep(' \u2015s /i powershell',\
    \ this['ProcessCommandLine']) or grep(' \u2015s \u2013i powershell', this['ProcessCommandLine'])\
    \ or grep(' \u2015s \u2014i powershell', this['ProcessCommandLine']) or grep('\
    \ \u2015s \u2015i powershell', this['ProcessCommandLine']) or grep(' -i -s powershell',\
    \ this['ProcessCommandLine']) or grep(' -i /s powershell', this['ProcessCommandLine'])\
    \ or grep(' -i \u2013s powershell', this['ProcessCommandLine']) or grep(' -i \u2014\
    s powershell', this['ProcessCommandLine']) or grep(' -i \u2015s powershell', this['ProcessCommandLine'])\
    \ or grep(' /i -s powershell', this['ProcessCommandLine']) or grep(' /i /s powershell',\
    \ this['ProcessCommandLine']) or grep(' /i \u2013s powershell', this['ProcessCommandLine'])\
    \ or grep(' /i \u2014s powershell', this['ProcessCommandLine']) or grep(' /i \u2015\
    s powershell', this['ProcessCommandLine']) or grep(' \u2013i -s powershell', this['ProcessCommandLine'])\
    \ or grep(' \u2013i /s powershell', this['ProcessCommandLine']) or grep(' \u2013\
    i \u2013s powershell', this['ProcessCommandLine']) or grep(' \u2013i \u2014s powershell',\
    \ this['ProcessCommandLine']) or grep(' \u2013i \u2015s powershell', this['ProcessCommandLine'])\
    \ or grep(' \u2014i -s powershell', this['ProcessCommandLine']) or grep(' \u2014\
    i /s powershell', this['ProcessCommandLine']) or grep(' \u2014i \u2013s powershell',\
    \ this['ProcessCommandLine']) or grep(' \u2014i \u2014s powershell', this['ProcessCommandLine'])\
    \ or grep(' \u2014i \u2015s powershell', this['ProcessCommandLine']) or grep('\
    \ \u2015i -s powershell', this['ProcessCommandLine']) or grep(' \u2015i /s powershell',\
    \ this['ProcessCommandLine']) or grep(' \u2015i \u2013s powershell', this['ProcessCommandLine'])\
    \ or grep(' \u2015i \u2014s powershell', this['ProcessCommandLine']) or grep('\
    \ \u2015i \u2015s powershell', this['ProcessCommandLine'])) and not (grep('paexec',\
    \ this['ProcessCommandLine']) or grep('PsExec', this['ProcessCommandLine']) or\
    \ grep('accepteula', this['ProcessCommandLine']))"
  sigma_id: 207b0396-3689-42d9-8399-4222658efc99
- name: Sysmon Configuration Update
  query: "(grep('\\\\Sysmon64.exe', this['FolderPath']) or grep('\\\\Sysmon.exe',\
    \ this['FolderPath']) or grep('System activity monitor', this['ProcessVersionInfoFileDescription']))\
    \ and (grep('-c', this['ProcessCommandLine']) or grep('/c', this['ProcessCommandLine'])\
    \ or grep('\u2013c', this['ProcessCommandLine']) or grep('\u2014c', this['ProcessCommandLine'])\
    \ or grep('\u2015c', this['ProcessCommandLine']))"
  sigma_id: 87911521-7098-470b-a459-9a57fc80bdfd
- name: Uninstall Sysinternals Sysmon
  query: "(grep('\\\\Sysmon64.exe', this['FolderPath']) or grep('\\\\Sysmon.exe',\
    \ this['FolderPath']) or grep('System activity monitor', this['ProcessVersionInfoFileDescription']))\
    \ and (grep('-u', this['ProcessCommandLine']) or grep('/u', this['ProcessCommandLine'])\
    \ or grep('\u2013u', this['ProcessCommandLine']) or grep('\u2014u', this['ProcessCommandLine'])\
    \ or grep('\u2015u', this['ProcessCommandLine']))"
  sigma_id: 6a5f68d1-c4b5-46b9-94ee-5324892ea939
- name: Potential Binary Impersonating Sysinternals Tools
  query: (grep('\\accesschk.exe', this['FolderPath']) or grep('\\accesschk64.exe',
    this['FolderPath']) or grep('\\AccessEnum.exe', this['FolderPath']) or grep('\\ADExplorer.exe',
    this['FolderPath']) or grep('\\ADExplorer64.exe', this['FolderPath']) or grep('\\ADInsight.exe',
    this['FolderPath']) or grep('\\ADInsight64.exe', this['FolderPath']) or grep('\\adrestore.exe',
    this['FolderPath']) or grep('\\adrestore64.exe', this['FolderPath']) or grep('\\Autologon.exe',
    this['FolderPath']) or grep('\\Autologon64.exe', this['FolderPath']) or grep('\\Autoruns.exe',
    this['FolderPath']) or grep('\\Autoruns64.exe', this['FolderPath']) or grep('\\autorunsc.exe',
    this['FolderPath']) or grep('\\autorunsc64.exe', this['FolderPath']) or grep('\\Bginfo.exe',
    this['FolderPath']) or grep('\\Bginfo64.exe', this['FolderPath']) or grep('\\Cacheset.exe',
    this['FolderPath']) or grep('\\Cacheset64.exe', this['FolderPath']) or grep('\\Clockres.exe',
    this['FolderPath']) or grep('\\Clockres64.exe', this['FolderPath']) or grep('\\Contig.exe',
    this['FolderPath']) or grep('\\Contig64.exe', this['FolderPath']) or grep('\\Coreinfo.exe',
    this['FolderPath']) or grep('\\Coreinfo64.exe', this['FolderPath']) or grep('\\CPUSTRES.EXE',
    this['FolderPath']) or grep('\\CPUSTRES64.EXE', this['FolderPath']) or grep('\\ctrl2cap.exe',
    this['FolderPath']) or grep('\\Dbgview.exe', this['FolderPath']) or grep('\\dbgview64.exe',
    this['FolderPath']) or grep('\\Desktops.exe', this['FolderPath']) or grep('\\Desktops64.exe',
    this['FolderPath']) or grep('\\disk2vhd.exe', this['FolderPath']) or grep('\\disk2vhd64.exe',
    this['FolderPath']) or grep('\\diskext.exe', this['FolderPath']) or grep('\\diskext64.exe',
    this['FolderPath']) or grep('\\Diskmon.exe', this['FolderPath']) or grep('\\Diskmon64.exe',
    this['FolderPath']) or grep('\\DiskView.exe', this['FolderPath']) or grep('\\DiskView64.exe',
    this['FolderPath']) or grep('\\du.exe', this['FolderPath']) or grep('\\du64.exe',
    this['FolderPath']) or grep('\\efsdump.exe', this['FolderPath']) or grep('\\FindLinks.exe',
    this['FolderPath']) or grep('\\FindLinks64.exe', this['FolderPath']) or grep('\\handle.exe',
    this['FolderPath']) or grep('\\handle64.exe', this['FolderPath']) or grep('\\hex2dec.exe',
    this['FolderPath']) or grep('\\hex2dec64.exe', this['FolderPath']) or grep('\\junction.exe',
    this['FolderPath']) or grep('\\junction64.exe', this['FolderPath']) or grep('\\ldmdump.exe',
    this['FolderPath']) or grep('\\listdlls.exe', this['FolderPath']) or grep('\\listdlls64.exe',
    this['FolderPath']) or grep('\\livekd.exe', this['FolderPath']) or grep('\\livekd64.exe',
    this['FolderPath']) or grep('\\loadOrd.exe', this['FolderPath']) or grep('\\loadOrd64.exe',
    this['FolderPath']) or grep('\\loadOrdC.exe', this['FolderPath']) or grep('\\loadOrdC64.exe',
    this['FolderPath']) or grep('\\logonsessions.exe', this['FolderPath']) or grep('\\logonsessions64.exe',
    this['FolderPath']) or grep('\\movefile.exe', this['FolderPath']) or grep('\\movefile64.exe',
    this['FolderPath']) or grep('\\notmyfault.exe', this['FolderPath']) or grep('\\notmyfault64.exe',
    this['FolderPath']) or grep('\\notmyfaultc.exe', this['FolderPath']) or grep('\\notmyfaultc64.exe',
    this['FolderPath']) or grep('\\ntfsinfo.exe', this['FolderPath']) or grep('\\ntfsinfo64.exe',
    this['FolderPath']) or grep('\\pendmoves.exe', this['FolderPath']) or grep('\\pendmoves64.exe',
    this['FolderPath']) or grep('\\pipelist.exe', this['FolderPath']) or grep('\\pipelist64.exe',
    this['FolderPath']) or grep('\\portmon.exe', this['FolderPath']) or grep('\\procdump.exe',
    this['FolderPath']) or grep('\\procdump64.exe', this['FolderPath']) or grep('\\procexp.exe',
    this['FolderPath']) or grep('\\procexp64.exe', this['FolderPath']) or grep('\\Procmon.exe',
    this['FolderPath']) or grep('\\Procmon64.exe', this['FolderPath']) or grep('\\psExec.exe',
    this['FolderPath']) or grep('\\psExec64.exe', this['FolderPath']) or grep('\\psfile.exe',
    this['FolderPath']) or grep('\\psfile64.exe', this['FolderPath']) or grep('\\psGetsid.exe',
    this['FolderPath']) or grep('\\psGetsid64.exe', this['FolderPath']) or grep('\\psInfo.exe',
    this['FolderPath']) or grep('\\psInfo64.exe', this['FolderPath']) or grep('\\pskill.exe',
    this['FolderPath']) or grep('\\pskill64.exe', this['FolderPath']) or grep('\\pslist.exe',
    this['FolderPath']) or grep('\\pslist64.exe', this['FolderPath']) or grep('\\psLoggedon.exe',
    this['FolderPath']) or grep('\\psLoggedon64.exe', this['FolderPath']) or grep('\\psloglist.exe',
    this['FolderPath']) or grep('\\psloglist64.exe', this['FolderPath']) or grep('\\pspasswd.exe',
    this['FolderPath']) or grep('\\pspasswd64.exe', this['FolderPath']) or grep('\\psping.exe',
    this['FolderPath']) or grep('\\psping64.exe', this['FolderPath']) or grep('\\psService.exe',
    this['FolderPath']) or grep('\\psService64.exe', this['FolderPath']) or grep('\\psshutdown.exe',
    this['FolderPath']) or grep('\\psshutdown64.exe', this['FolderPath']) or grep('\\pssuspend.exe',
    this['FolderPath']) or grep('\\pssuspend64.exe', this['FolderPath']) or grep('\\RAMMap.exe',
    this['FolderPath']) or grep('\\RDCMan.exe', this['FolderPath']) or grep('\\RegDelNull.exe',
    this['FolderPath']) or grep('\\RegDelNull64.exe', this['FolderPath']) or grep('\\regjump.exe',
    this['FolderPath']) or grep('\\ru.exe', this['FolderPath']) or grep('\\ru64.exe',
    this['FolderPath']) or grep('\\sdelete.exe', this['FolderPath']) or grep('\\sdelete64.exe',
    this['FolderPath']) or grep('\\ShareEnum.exe', this['FolderPath']) or grep('\\ShareEnum64.exe',
    this['FolderPath']) or grep('\\shellRunas.exe', this['FolderPath']) or grep('\\sigcheck.exe',
    this['FolderPath']) or grep('\\sigcheck64.exe', this['FolderPath']) or grep('\\streams.exe',
    this['FolderPath']) or grep('\\streams64.exe', this['FolderPath']) or grep('\\strings.exe',
    this['FolderPath']) or grep('\\strings64.exe', this['FolderPath']) or grep('\\sync.exe',
    this['FolderPath']) or grep('\\sync64.exe', this['FolderPath']) or grep('\\Sysmon.exe',
    this['FolderPath']) or grep('\\Sysmon64.exe', this['FolderPath']) or grep('\\tcpvcon.exe',
    this['FolderPath']) or grep('\\tcpvcon64.exe', this['FolderPath']) or grep('\\tcpview.exe',
    this['FolderPath']) or grep('\\tcpview64.exe', this['FolderPath']) or grep('\\Testlimit.exe',
    this['FolderPath']) or grep('\\Testlimit64.exe', this['FolderPath']) or grep('\\vmmap.exe',
    this['FolderPath']) or grep('\\vmmap64.exe', this['FolderPath']) or grep('\\Volumeid.exe',
    this['FolderPath']) or grep('\\Volumeid64.exe', this['FolderPath']) or grep('\\whois.exe',
    this['FolderPath']) or grep('\\whois64.exe', this['FolderPath']) or grep('\\Winobj.exe',
    this['FolderPath']) or grep('\\Winobj64.exe', this['FolderPath']) or grep('\\ZoomIt.exe',
    this['FolderPath']) or grep('\\ZoomIt64.exe', this['FolderPath'])) and not (this['ProcessVersionInfoCompanyName']
    in ['Sysinternals - www.sysinternals.com', 'Sysinternals'] or this['ProcessVersionInfoCompanyName']==null)
  sigma_id: 7cce6fc8-a07f-4d84-a53e-96e1879843c9
- name: Sysprep on AppData Folder
  query: grep('\\sysprep.exe', this['FolderPath']) and grep('\\AppData\\', this['ProcessCommandLine'])
  sigma_id: d5b9ae7a-e6fc-405e-80ff-2ff9dcc64e7e
- name: Potential Signing Bypass Via Windows Developer Features
  query: (grep('\\SystemSettingsAdminFlows.exe', this['FolderPath']) or grep('SystemSettingsAdminFlows.EXE',
    this['ProcessVersionInfoOriginalFileName'])) and grep('TurnOnDeveloperFeatures',
    this['ProcessCommandLine']) and (grep('DeveloperUnlock', this['ProcessCommandLine'])
    or grep('EnableSideloading', this['ProcessCommandLine']))
  sigma_id: a383dec4-deec-4e6e-913b-ed9249670848
- name: Suspicious Recursive Takeown
  query: grep('\\takeown.exe', this['FolderPath']) and grep('/f ', this['ProcessCommandLine'])
    and grep('/r', this['ProcessCommandLine'])
  sigma_id: 554601fb-9b71-4bcc-abf4-21a611be4fde
- name: Tap Installer Execution
  query: grep('\\tapinstall.exe', this['FolderPath']) and not (grep(':\\Program Files\\Avast
    Software\\SecureLine VPN\\', this['FolderPath']) or grep(':\\Program Files (x86)\\Avast
    Software\\SecureLine VPN\\', this['FolderPath']) or grep(':\\Program Files\\OpenVPN
    Connect\\drivers\\tap\\', this['FolderPath']) or grep(':\\Program Files (x86)\\Proton
    Technologies\\ProtonVPNTap\\installer\\', this['FolderPath']))
  sigma_id: 99793437-3e16-439b-be0f-078782cf953d
- name: Taskkill Symantec Endpoint Protection
  query: grep('taskkill', this['ProcessCommandLine']) and grep(' /F ', this['ProcessCommandLine'])
    and grep(' /IM ', this['ProcessCommandLine']) and grep('ccSvcHst.exe', this['ProcessCommandLine'])
  sigma_id: 4a6713f6-3331-11ed-a261-0242ac120002
- name: Loaded Module Enumeration Via Tasklist.EXE
  query: "(grep('\\\\tasklist.exe', this['FolderPath']) or grep('tasklist.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep('-m', this['ProcessCommandLine']) or grep('/m', this['ProcessCommandLine'])\
    \ or grep('\u2013m', this['ProcessCommandLine']) or grep('\u2014m', this['ProcessCommandLine'])\
    \ or grep('\u2015m', this['ProcessCommandLine'])) and grep('rdpcorets.dll', this['ProcessCommandLine'])"
  sigma_id: 34275eb8-fa19-436b-b959-3d9ecd53fa1f
- name: Taskmgr as LOCAL_SYSTEM
  query: (grep('AUTHORI', this['AccountName']) or grep('AUTORI', this['AccountName']))
    and grep('\\taskmgr.exe', this['FolderPath'])
  sigma_id: 9fff585c-c33e-4a86-b3cd-39312079a65f
- name: Potentially Suspicious Command Targeting Teams Sensitive Files
  query: (grep('\\Microsoft\\Teams\\Cookies', this['ProcessCommandLine']) or grep('\\Microsoft\\Teams\\Local
    Storage\\leveldb', this['ProcessCommandLine'])) and not grep('\\Microsoft\\Teams\\current\\Teams.exe',
    this['FolderPath'])
  sigma_id: d2eb17db-1d39-41dc-b57f-301f6512fa75
- name: New Virtual Smart Card Created Via TpmVscMgr.EXE
  query: grep('\\tpmvscmgr.exe', this['FolderPath']) and grep('TpmVscMgr.exe', this['ProcessVersionInfoOriginalFileName'])
    and grep('create', this['ProcessCommandLine'])
  sigma_id: c633622e-cab9-4eaa-bb13-66a1d68b3e47
- name: Suspicious TSCON Start as SYSTEM
  query: (grep('AUTHORI', this['AccountName']) or grep('AUTORI', this['AccountName']))
    and grep('\\tscon.exe', this['FolderPath'])
  sigma_id: 9847f263-4a81-424f-970c-875dab15b79b
- name: Suspicious RDP Redirect Using TSCON
  query: grep(' /dest:rdp-tcp#', this['ProcessCommandLine'])
  sigma_id: f72aa3e8-49f9-4c7d-bd74-f8ab84ff9bbb
- name: Potential RDP Session Hijacking Activity
  query: (grep('\\tscon.exe', this['FolderPath']) or grep('tscon.exe', this['ProcessVersionInfoOriginalFileName']))
    and (this['ProcessIntegrityLevel'] in ['System', 'S-1-16-16384'])
  sigma_id: 224f140f-3553-4cd1-af78-13d81bf9f7cc
- name: UAC Bypass Using ChangePK and SLUI
  query: grep('\\changepk.exe', this['FolderPath']) and grep('\\slui.exe', this['InitiatingProcessFolderPath'])
    and (this['ProcessIntegrityLevel'] in ['High', 'System', 'S-1-16-16384', 'S-1-16-12288'])
  sigma_id: 503d581c-7df0-4bbe-b9be-5840c0ecc1fc
- name: UAC Bypass Using Disk Cleanup
  query: grep('"\\system32\\cleanmgr.exe /autoclean /d C:', this['ProcessCommandLine'])
    and grep('C:\\Windows\\system32\\svchost.exe -k netsvcs -p -s Schedule', this['InitiatingProcessCommandLine'])
    and (this['ProcessIntegrityLevel'] in ['High', 'System', 'S-1-16-16384', 'S-1-16-12288'])
  sigma_id: b697e69c-746f-4a86-9f59-7bfff8eab881
- name: Bypass UAC via CMSTP
  query: (grep('\\cmstp.exe', this['FolderPath']) or grep('CMSTP.EXE', this['ProcessVersionInfoOriginalFileName']))
    and (grep('/s', this['ProcessCommandLine']) or grep('-s', this['ProcessCommandLine'])
    or grep('/au', this['ProcessCommandLine']) or grep('-au', this['ProcessCommandLine'])
    or grep('/ni', this['ProcessCommandLine']) or grep('-ni', this['ProcessCommandLine']))
  sigma_id: e66779cc-383e-4224-a3a4-267eeb585c40
- name: CMSTP UAC Bypass via COM Object Access
  query: grep('\\DllHost.exe', this['InitiatingProcessFolderPath']) and (grep(' /Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}',
    this['InitiatingProcessCommandLine']) or grep(' /Processid:{3E000D72-A845-4CD9-BD83-80C07C3B881F}',
    this['InitiatingProcessCommandLine']) or grep(' /Processid:{BD54C901-076B-434E-B6C7-17C531F4AB41}',
    this['InitiatingProcessCommandLine']) or grep(' /Processid:{D2E7041B-2927-42FB-8E9F-7CE93B6DC937}',
    this['InitiatingProcessCommandLine']) or grep(' /Processid:{E9495B87-D950-4AB5-87A5-FF6D70BF3E90}',
    this['InitiatingProcessCommandLine'])) and (this['ProcessIntegrityLevel'] in ['High',
    'System', 'S-1-16-16384', 'S-1-16-12288'])
  sigma_id: 4b60e6f2-bf39-47b4-b4ea-398e33cfe253
- name: UAC Bypass Tools Using ComputerDefaults
  query: (this['ProcessIntegrityLevel'] in ['High', 'System', 'S-1-16-16384', 'S-1-16-12288'])
    and grep('C:\\Windows\\System32\\ComputerDefaults.exe', this['FolderPath']) and
    not (grep(':\\Windows\\System32', this['InitiatingProcessFolderPath']) or grep(':\\Program
    Files', this['InitiatingProcessFolderPath']))
  sigma_id: 3c05e90d-7eba-4324-9972-5d7f711a60a8
- name: UAC Bypass Using Consent and Comctl32 - Process
  query: grep('\\consent.exe', this['InitiatingProcessFolderPath']) and grep('\\werfault.exe',
    this['FolderPath']) and (this['ProcessIntegrityLevel'] in ['High', 'System', 'S-1-16-16384',
    'S-1-16-12288'])
  sigma_id: 1ca6bd18-0ba0-44ca-851c-92ed89a61085
- name: UAC Bypass Using DismHost
  query: grep('C:\\Users\\', this['InitiatingProcessFolderPath']) and grep('\\AppData\\Local\\Temp\\',
    this['InitiatingProcessFolderPath']) and grep('\\DismHost.exe', this['InitiatingProcessFolderPath'])
    and (this['ProcessIntegrityLevel'] in ['High', 'System', 'S-1-16-16384', 'S-1-16-12288'])
  sigma_id: 853e74f9-9392-4935-ad3b-2e8c040dae86
- name: UAC Bypass Using Event Viewer RecentViews
  query: (grep('\\Event Viewer\\RecentViews', this['ProcessCommandLine']) or grep('\\EventV~1\\RecentViews',
    this['ProcessCommandLine'])) and grep('>', this['ProcessCommandLine'])
  sigma_id: 30fc8de7-d833-40c4-96b6-28319fbc4f6c
- name: Bypass UAC via Fodhelper.exe
  query: grep('\\fodhelper.exe', this['InitiatingProcessFolderPath'])
  sigma_id: 7f741dcf-fc22-4759-87b4-9ae8376676a2
- name: UAC Bypass via Windows Firewall Snap-In Hijack
  query: grep('\\mmc.exe', this['InitiatingProcessFolderPath']) and grep('WF.msc',
    this['InitiatingProcessCommandLine']) and not grep('\\WerFault.exe', this['FolderPath'])
  sigma_id: e52cb31c-10ed-4aea-bcb7-593c9f4a315b
- name: UAC Bypass via ICMLuaUtil
  query: grep('\\dllhost.exe', this['InitiatingProcessFolderPath']) and (grep('/Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}',
    this['InitiatingProcessCommandLine']) or grep('/Processid:{D2E7041B-2927-42FB-8E9F-7CE93B6DC937}',
    this['InitiatingProcessCommandLine'])) and not (grep('\\WerFault.exe', this['FolderPath'])
    or grep('WerFault.exe', this['ProcessVersionInfoOriginalFileName']))
  sigma_id: 49f2f17b-b4c8-4172-a68b-d5bf95d05130
- name: UAC Bypass Using IDiagnostic Profile
  query: grep('\\DllHost.exe', this['InitiatingProcessFolderPath']) and grep(' /Processid:{12C21EA7-2EB8-4B55-9249-AC243DA8C666}',
    this['InitiatingProcessCommandLine']) and (this['ProcessIntegrityLevel'] in ['High',
    'System', 'S-1-16-16384', 'S-1-16-12288'])
  sigma_id: 4cbef972-f347-4170-b62a-8253f6168e6d
- name: UAC Bypass Using IEInstal - Process
  query: (this['ProcessIntegrityLevel'] in ['High', 'System', 'S-1-16-16384', 'S-1-16-12288'])
    and grep('\\ieinstal.exe', this['InitiatingProcessFolderPath']) and grep('\\AppData\\Local\\Temp\\',
    this['FolderPath']) and grep('consent.exe', this['FolderPath'])
  sigma_id: 80fc36aa-945e-4181-89f2-2f907ab6775d
- name: UAC Bypass Using MSConfig Token Modification - Process
  query: (this['ProcessIntegrityLevel'] in ['High', 'System', 'S-1-16-16384', 'S-1-16-12288'])
    and grep('\\AppData\\Local\\Temp\\pkgmgr.exe', this['InitiatingProcessFolderPath'])
    and grep('"C:\\Windows\\system32\\msconfig.exe" -5', this['ProcessCommandLine'])
  sigma_id: ad92e3f9-7eb6-460e-96b1-582b0ccbb980
- name: UAC Bypass Using NTFS Reparse Point - Process
  query: grep('"C:\\Windows\\system32\\wusa.exe"  /quiet C:\\Users\\', this['ProcessCommandLine'])
    and grep('\\AppData\\Local\\Temp\\update.msu', this['ProcessCommandLine']) and
    (this['ProcessIntegrityLevel'] in ['High', 'System', 'S-1-16-16384', 'S-1-16-12288'])
    or grep('"C:\\Windows\\system32\\dism.exe" /online /quiet /norestart /add-package
    /packagepath:"C:\\Windows\\system32\\pe386" /ignorecheck', this['InitiatingProcessCommandLine'])
    and (this['ProcessIntegrityLevel'] in ['High', 'System']) and grep('C:\\Users\\',
    this['ProcessCommandLine']) and grep('\\AppData\\Local\\Temp\\', this['ProcessCommandLine'])
    and grep('\\dismhost.exe {', this['ProcessCommandLine']) and grep('\\DismHost.exe',
    this['FolderPath'])
  sigma_id: 39ed3c80-e6a1-431b-9df3-911ac53d08a7
- name: UAC Bypass Using PkgMgr and DISM
  query: grep('\\pkgmgr.exe', this['InitiatingProcessFolderPath']) and grep('\\dism.exe',
    this['FolderPath']) and (this['ProcessIntegrityLevel'] in ['High', 'System', 'S-1-16-16384',
    'S-1-16-12288'])
  sigma_id: a743ceba-c771-4d75-97eb-8a90f7f4844c
- name: Potential UAC Bypass Via Sdclt.EXE
  query: grep('sdclt.exe', this['FolderPath']) and (this['ProcessIntegrityLevel']
    in ['High', 'S-1-16-12288'])
  sigma_id: 40f9af16-589d-4984-b78d-8c2aec023197
- name: TrustedPath UAC Bypass Pattern
  query: grep('C:\\Windows \\System32\\', this['FolderPath'])
  sigma_id: 4ac47ed3-44c2-4b1f-9d51-bf46e8914126
- name: UAC Bypass Abusing Winsat Path Parsing - Process
  query: (this['ProcessIntegrityLevel'] in ['High', 'System', 'S-1-16-16384', 'S-1-16-12288'])
    and grep('\\AppData\\Local\\Temp\\system32\\winsat.exe', this['InitiatingProcessFolderPath'])
    and grep('C:\\Windows \\system32\\winsat.exe', this['InitiatingProcessCommandLine'])
  sigma_id: 7a01183d-71a2-46ad-ad5c-acd989ac1793
- name: UAC Bypass Using Windows Media Player - Process
  query: (grep('C:\\Program Files\\Windows Media Player\\osk.exe', this['FolderPath'])
    or grep('C:\\Windows\\System32\\cmd.exe', this['FolderPath']) and grep('"C:\\Windows\\system32\\mmc.exe"
    "C:\\Windows\\system32\\eventvwr.msc" /s', this['InitiatingProcessCommandLine']))
    and (this['ProcessIntegrityLevel'] in ['High', 'System', 'S-1-16-16384', 'S-1-16-12288'])
  sigma_id: 0058b9e5-bcd7-40d4-9205-95ca5a16d7b2
- name: Bypass UAC via WSReset.exe
  query: grep('\\wsreset.exe', this['InitiatingProcessFolderPath']) and not (grep('\\conhost.exe',
    this['FolderPath']) or grep('CONHOST.EXE', this['ProcessVersionInfoOriginalFileName']))
  sigma_id: d797268e-28a9-49a7-b9a8-2f5039011c5c
- name: UAC Bypass WSReset
  query: grep('\\wsreset.exe', this['FolderPath']) and (this['ProcessIntegrityLevel']
    in ['High', 'System', 'S-1-16-16384', 'S-1-16-12288'])
  sigma_id: 89a9a0e0-f61a-42e5-8957-b1479565a658
- name: Use of UltraVNC Remote Access Software
  query: grep('VNCViewer', this['ProcessVersionInfoFileDescription']) or grep('UltraVNC
    VNCViewer', this['ProcessVersionInfoProductName']) or grep('UltraVNC', this['ProcessVersionInfoCompanyName'])
    or grep('VNCViewer.exe', this['ProcessVersionInfoOriginalFileName'])
  sigma_id: 145322e4-0fd3-486b-81ca-9addc75736d8
- name: Suspicious UltraVNC Execution
  query: grep('-autoreconnect ', this['ProcessCommandLine']) and grep('-connect ',
    this['ProcessCommandLine']) and grep('-id:', this['ProcessCommandLine'])
  sigma_id: 871b9555-69ca-4993-99d3-35a59f9f3599
- name: Uninstall Crowdstrike Falcon Sensor
  query: grep('\\WindowsSensor.exe', this['ProcessCommandLine']) and grep(' /uninstall',
    this['ProcessCommandLine']) and grep(' /quiet', this['ProcessCommandLine'])
  sigma_id: f0f7be61-9cf5-43be-9836-99d6ef448a18
- name: Uncommon Userinit Child Process
  query: grep('\\userinit.exe', this['InitiatingProcessFolderPath']) and not grep(':\\WINDOWS\\explorer.exe',
    this['FolderPath']) and not (grep('netlogon.bat', this['ProcessCommandLine'])
    or grep('UsrLogon.cmd', this['ProcessCommandLine']) or grep('PowerShell.exe',
    this['ProcessCommandLine']) or grep(':\\Windows\\System32\\proquota.exe', this['FolderPath'])
    or grep(':\\Windows\\SysWOW64\\proquota.exe', this['FolderPath']) or grep(':\\Program
    Files (x86)\\Citrix\\HDX\\bin\\cmstart.exe', this['FolderPath']) or grep(':\\Program
    Files (x86)\\Citrix\\HDX\\bin\\icast.exe', this['FolderPath']) or grep(':\\Program
    Files (x86)\\Citrix\\System32\\icast.exe', this['FolderPath']) or grep(':\\Program
    Files\\Citrix\\HDX\\bin\\cmstart.exe', this['FolderPath']) or grep(':\\Program
    Files\\Citrix\\HDX\\bin\\icast.exe', this['FolderPath']) or grep(':\\Program Files\\Citrix\\System32\\icast.exe',
    this['FolderPath']) or this['FolderPath']==null)
  sigma_id: 0a98a10c-685d-4ab0-bddc-b6bdd1d48458
- name: Windows Credential Manager Access via VaultCmd
  query: (grep('\\VaultCmd.exe', this['FolderPath']) or grep('VAULTCMD.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('/listcreds:', this['ProcessCommandLine'])
  sigma_id: 58f50261-c53b-4c88-bd12-1d71f12eda4c
- name: Verclsid.exe Runs COM Object
  query: (grep('\\verclsid.exe', this['FolderPath']) or grep('verclsid.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('/S', this['ProcessCommandLine']) and grep('/C', this['ProcessCommandLine'])
  sigma_id: d06be4b9-8045-428b-a567-740a26d9db25
- name: Suspicious VBoxDrvInst.exe Parameters
  query: grep('\\VBoxDrvInst.exe', this['FolderPath']) and grep('driver', this['ProcessCommandLine'])
    and grep('executeinf', this['ProcessCommandLine'])
  sigma_id: b7b19cb6-9b32-4fc4-a108-73f19acfe262
- name: Potential Persistence Via VMwareToolBoxCmd.EXE VM State Change Script
  query: (grep('\\VMwareToolBoxCmd.exe', this['FolderPath']) or grep('toolbox-cmd.exe',
    this['ProcessVersionInfoOriginalFileName'])) and grep(' script ', this['ProcessCommandLine'])
    and grep(' set ', this['ProcessCommandLine'])
  sigma_id: 7aa4e81a-a65c-4e10-9f81-b200eb229d7d
- name: Suspicious Persistence Via VMwareToolBoxCmd.EXE VM State Change Script
  query: (grep('\\VMwareToolBoxCmd.exe', this['FolderPath']) or grep('toolbox-cmd.exe',
    this['ProcessVersionInfoOriginalFileName'])) and grep(' script ', this['ProcessCommandLine'])
    and grep(' set ', this['ProcessCommandLine']) and (grep(':\\PerfLogs\\', this['ProcessCommandLine'])
    or grep(':\\Temp\\', this['ProcessCommandLine']) or grep(':\\Windows\\System32\\Tasks\\',
    this['ProcessCommandLine']) or grep(':\\Windows\\Tasks\\', this['ProcessCommandLine'])
    or grep(':\\Windows\\Temp\\', this['ProcessCommandLine']) or grep('\\AppData\\Local\\Temp',
    this['ProcessCommandLine']))
  sigma_id: 236d8e89-ed95-4789-a982-36f4643738ba
- name: VMToolsd Suspicious Child Process
  query: grep('\\vmtoolsd.exe', this['InitiatingProcessFolderPath']) and (grep('\\cmd.exe',
    this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']) or grep('\\mshta.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\rundll32.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['Cmd.Exe', 'cscript.exe', 'MSHTA.EXE', 'PowerShell.EXE', 'pwsh.dll', 'REGSVR32.EXE',
    'RUNDLL32.EXE', 'wscript.exe']) and not (grep('\\cmd.exe', this['FolderPath'])
    and (grep('\\VMware\\VMware Tools\\poweron-vm-default.bat', this['ProcessCommandLine'])
    or grep('\\VMware\\VMware Tools\\poweroff-vm-default.bat', this['ProcessCommandLine'])
    or grep('\\VMware\\VMware Tools\\resume-vm-default.bat', this['ProcessCommandLine'])
    or grep('\\VMware\\VMware Tools\\suspend-vm-default.bat', this['ProcessCommandLine']))
    or grep('\\cmd.exe', this['FolderPath']) and false or grep('\\cmd.exe', this['FolderPath'])
    and this['ProcessCommandLine']==null)
  sigma_id: 5687f942-867b-4578-ade7-1e341c46e99a
- name: Potentially Suspicious Child Process Of VsCode
  query: grep('\\code.exe', this['InitiatingProcessFolderPath']) and (grep('\\calc.exe',
    this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\rundll32.exe',
    this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']) or grep('\\wscript.exe',
    this['FolderPath']) or (grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\cmd.exe', this['FolderPath'])) and (grep('Invoke-Expressions',
    this['ProcessCommandLine']) or grep('IEX', this['ProcessCommandLine']) or grep('Invoke-Command',
    this['ProcessCommandLine']) or grep('ICM', this['ProcessCommandLine']) or grep('DownloadString',
    this['ProcessCommandLine']) or grep('rundll32', this['ProcessCommandLine']) or
    grep('regsvr32', this['ProcessCommandLine']) or grep('wscript', this['ProcessCommandLine'])
    or grep('cscript', this['ProcessCommandLine'])) or grep(':\\Users\\Public\\',
    this['FolderPath']) or grep(':\\Windows\\Temp\\', this['FolderPath']) or grep(':\\Temp\\',
    this['FolderPath']))
  sigma_id: 5a3164f2-b373-4152-93cf-090b13c12d27
- name: Visual Studio Code Tunnel Execution
  query: this['ProcessVersionInfoOriginalFileName']==null and grep('.exe tunnel',
    this['ProcessCommandLine']) or grep('.exe tunnel', this['ProcessCommandLine'])
    and grep('--name ', this['ProcessCommandLine']) and grep('--accept-server-license-terms',
    this['ProcessCommandLine']) or grep(' tunnel', this['InitiatingProcessCommandLine'])
    and grep('\\cmd.exe', this['FolderPath']) and grep('/d /c ', this['ProcessCommandLine'])
    and grep('\\servers\\Stable-', this['ProcessCommandLine']) and grep('code-server.cmd',
    this['ProcessCommandLine'])
  sigma_id: 90d6bd71-dffb-4989-8d86-a827fedd6624
- name: Visual Studio Code Tunnel Shell Execution
  query: grep('\\servers\\Stable-', this['InitiatingProcessFolderPath']) and grep('\\server\\node.exe',
    this['InitiatingProcessFolderPath']) and grep('.vscode-server', this['InitiatingProcessCommandLine'])
    and ((grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']))
    and grep('\\terminal\\browser\\media\\shellIntegration.ps1', this['ProcessCommandLine'])
    or grep('\\wsl.exe', this['FolderPath']) or grep('\\bash.exe', this['FolderPath']))
  sigma_id: f4a623c2-4ef5-4c33-b811-0642f702c9f1
- name: Renamed Visual Studio Code Tunnel Execution
  query: (this['ProcessVersionInfoOriginalFileName']==null and grep('.exe tunnel',
    this['ProcessCommandLine']) or grep('.exe tunnel', this['ProcessCommandLine'])
    and grep('--name ', this['ProcessCommandLine']) and grep('--accept-server-license-terms',
    this['ProcessCommandLine']) or grep('tunnel ', this['ProcessCommandLine']) and
    grep('service', this['ProcessCommandLine']) and grep('internal-run', this['ProcessCommandLine'])
    and grep('tunnel-service.log', this['ProcessCommandLine'])) and not (grep('\\code-tunnel.exe',
    this['FolderPath']) or grep('\\code.exe', this['FolderPath'])) or grep(' tunnel',
    this['InitiatingProcessCommandLine']) and grep('\\cmd.exe', this['FolderPath'])
    and grep('/d /c ', this['ProcessCommandLine']) and grep('\\servers\\Stable-',
    this['ProcessCommandLine']) and grep('code-server.cmd', this['ProcessCommandLine'])
    and not (grep('\\code-tunnel.exe', this['InitiatingProcessFolderPath']) or grep('\\code.exe',
    this['InitiatingProcessFolderPath']))
  sigma_id: 2cf29f11-e356-4f61-98c0-1bdb9393d6da
- name: Visual Studio Code Tunnel Service Installation
  query: grep('tunnel ', this['ProcessCommandLine']) and grep('service', this['ProcessCommandLine'])
    and grep('internal-run', this['ProcessCommandLine']) and grep('tunnel-service.log',
    this['ProcessCommandLine'])
  sigma_id: 30bf1789-379d-4fdc-900f-55cd0a90a801
- name: Potential Binary Proxy Execution Via VSDiagnostics.EXE
  query: (grep('\\VSDiagnostics.exe', this['FolderPath']) or grep('VSDiagnostics.exe',
    this['ProcessVersionInfoOriginalFileName'])) and grep('start', this['ProcessCommandLine'])
    and (grep(' /launch:', this['ProcessCommandLine']) or grep(' -launch:', this['ProcessCommandLine']))
  sigma_id: ac1c92b4-ac81-405a-9978-4604d78cc47e
- name: Suspicious Vsls-Agent Command With AgentExtensionPath Load
  query: grep('\\vsls-agent.exe', this['FolderPath']) and grep('--agentExtensionPath',
    this['ProcessCommandLine']) and not grep('Microsoft.VisualStudio.LiveShare.Agent.',
    this['ProcessCommandLine'])
  sigma_id: 43103702-5886-11ed-9b6a-0242ac120002
- name: Use of W32tm as Timer
  query: (grep('\\w32tm.exe', this['FolderPath']) or grep('w32time.dll', this['ProcessVersionInfoOriginalFileName']))
    and grep('/stripchart', this['ProcessCommandLine']) and grep('/computer:', this['ProcessCommandLine'])
    and grep('/period:', this['ProcessCommandLine']) and grep('/dataonly', this['ProcessCommandLine'])
    and grep('/samples:', this['ProcessCommandLine'])
  sigma_id: 6da2c9f5-7c53-401b-aacb-92c040ce1215
- name: Wab Execution From Non Default Location
  query: (grep('\\wab.exe', this['FolderPath']) or grep('\\wabmig.exe', this['FolderPath']))
    and not (grep('C:\\Windows\\WinSxS\\', this['FolderPath']) or grep('C:\\Program
    Files\\Windows Mail\\', this['FolderPath']) or grep('C:\\Program Files (x86)\\Windows
    Mail\\', this['FolderPath']))
  sigma_id: 395907ee-96e5-4666-af2e-2ca91688e151
- name: Wab/Wabmig Unusual Parent Or Child Processes
  query: (grep('\\WmiPrvSE.exe', this['InitiatingProcessFolderPath']) or grep('\\svchost.exe',
    this['InitiatingProcessFolderPath']) or grep('\\dllhost.exe', this['InitiatingProcessFolderPath']))
    and (grep('\\wab.exe', this['FolderPath']) or grep('\\wabmig.exe', this['FolderPath']))
    or grep('\\wab.exe', this['InitiatingProcessFolderPath']) or grep('\\wabmig.exe',
    this['InitiatingProcessFolderPath'])
  sigma_id: 63d1ccc0-2a43-4f4b-9289-361b308991ff
- name: All Backups Deleted Via Wbadmin.EXE
  query: (grep('\\wbadmin.exe', this['FolderPath']) or grep('WBADMIN.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('delete', this['ProcessCommandLine']) and grep('backup', this['ProcessCommandLine'])
    and grep('keepVersions:0', this['ProcessCommandLine'])
  sigma_id: 639c9081-f482-47d3-a0bd-ddee3d4ecd76
- name: Windows Backup Deleted Via Wbadmin.EXE
  query: (grep('\\wbadmin.exe', this['FolderPath']) or grep('WBADMIN.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep('delete ', this['ProcessCommandLine']) and grep('backup', this['ProcessCommandLine'])
    and not grep('keepVersions:0', this['ProcessCommandLine'])
  sigma_id: 89f75308-5b1b-4390-b2d8-d6b2340efaf8
- name: Sensitive File Dump Via Wbadmin.EXE
  query: (grep('\\wbadmin.exe', this['FolderPath']) or grep('WBADMIN.EXE', this['ProcessVersionInfoOriginalFileName']))
    and (grep('start', this['ProcessCommandLine']) or grep('backup', this['ProcessCommandLine']))
    and (grep('\\config\\SAM', this['ProcessCommandLine']) or grep('\\config\\SECURITY',
    this['ProcessCommandLine']) or grep('\\config\\SYSTEM', this['ProcessCommandLine'])
    or grep('\\Windows\\NTDS\\NTDS.dit', this['ProcessCommandLine']))
  sigma_id: 8b93a509-1cb8-42e1-97aa-ee24224cdc15
- name: File Recovery From Backup Via Wbadmin.EXE
  query: (grep('\\wbadmin.exe', this['FolderPath']) or grep('WBADMIN.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep(' recovery', this['ProcessCommandLine']) and grep('recoveryTarget', this['ProcessCommandLine'])
    and grep('itemtype:File', this['ProcessCommandLine'])
  sigma_id: 6fe4aa1e-0531-4510-8be2-782154b73b48
- name: Sensitive File Recovery From Backup Via Wbadmin.EXE
  query: (grep('\\wbadmin.exe', this['FolderPath']) or grep('WBADMIN.EXE', this['ProcessVersionInfoOriginalFileName']))
    and grep(' recovery', this['ProcessCommandLine']) and grep('recoveryTarget', this['ProcessCommandLine'])
    and grep('itemtype:File', this['ProcessCommandLine']) and (grep('\\config\\SAM',
    this['ProcessCommandLine']) or grep('\\config\\SECURITY', this['ProcessCommandLine'])
    or grep('\\config\\SYSTEM', this['ProcessCommandLine']) or grep('\\Windows\\NTDS\\NTDS.dit',
    this['ProcessCommandLine']))
  sigma_id: 84972c80-251c-4c3a-9079-4f00aad93938
- name: Potentially Suspicious WebDAV LNK Execution
  query: grep('\\explorer.exe', this['InitiatingProcessFolderPath']) and (grep('\\cmd.exe',
    this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']) or grep('\\mshta.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath'])) and grep('\\DavWWWRoot\\',
    this['ProcessCommandLine'])
  sigma_id: 1412aa78-a24c-4abd-83df-767dfb2c5bbe
- name: Chopper Webshell Process Pattern
  query: (grep('\\w3wp.exe', this['FolderPath']) or grep('\\w3wp.exe', this['InitiatingProcessFolderPath']))
    and (grep('&ipconfig&echo', this['ProcessCommandLine']) or grep('&quser&echo',
    this['ProcessCommandLine']) or grep('&whoami&echo', this['ProcessCommandLine'])
    or grep('&c:&echo', this['ProcessCommandLine']) or grep('&cd&echo', this['ProcessCommandLine'])
    or grep('&dir&echo', this['ProcessCommandLine']) or grep('&echo [E]', this['ProcessCommandLine'])
    or grep('&echo [S]', this['ProcessCommandLine']))
  sigma_id: fa3c117a-bc0d-416e-a31b-0c0e80653efb
- name: Webshell Hacking Activity Patterns
  query: (grep('\\caddy.exe', this['InitiatingProcessFolderPath']) or grep('\\httpd.exe',
    this['InitiatingProcessFolderPath']) or grep('\\nginx.exe', this['InitiatingProcessFolderPath'])
    or grep('\\php-cgi.exe', this['InitiatingProcessFolderPath']) or grep('\\w3wp.exe',
    this['InitiatingProcessFolderPath']) or grep('\\ws_tomcatservice.exe', this['InitiatingProcessFolderPath'])
    or (grep('\\java.exe', this['InitiatingProcessFolderPath']) or grep('\\javaw.exe',
    this['InitiatingProcessFolderPath'])) and (grep('-tomcat-', this['InitiatingProcessFolderPath'])
    or grep('\\tomcat', this['InitiatingProcessFolderPath'])) or (grep('\\java.exe',
    this['InitiatingProcessFolderPath']) or grep('\\javaw.exe', this['InitiatingProcessFolderPath']))
    and (grep('catalina.jar', this['ProcessCommandLine']) or grep('CATALINA_HOME',
    this['ProcessCommandLine']))) and (grep('rundll32', this['ProcessCommandLine'])
    and grep('comsvcs', this['ProcessCommandLine']) or grep(' -hp', this['ProcessCommandLine'])
    and grep(' a ', this['ProcessCommandLine']) and grep(' -m', this['ProcessCommandLine'])
    or grep('net', this['ProcessCommandLine']) and grep(' user ', this['ProcessCommandLine'])
    and grep(' /add', this['ProcessCommandLine']) or grep('net', this['ProcessCommandLine'])
    and grep(' localgroup ', this['ProcessCommandLine']) and grep(' administrators
    ', this['ProcessCommandLine']) and grep('/add', this['ProcessCommandLine']) or
    grep('\\ntdsutil.exe', this['FolderPath']) or grep('\\ldifde.exe', this['FolderPath'])
    or grep('\\adfind.exe', this['FolderPath']) or grep('\\procdump.exe', this['FolderPath'])
    or grep('\\Nanodump.exe', this['FolderPath']) or grep('\\vssadmin.exe', this['FolderPath'])
    or grep('\\fsutil.exe', this['FolderPath']) or grep(' -decode ', this['ProcessCommandLine'])
    or grep(' -NoP ', this['ProcessCommandLine']) or grep(' -W Hidden ', this['ProcessCommandLine'])
    or grep(' /decode ', this['ProcessCommandLine']) or grep(' /ticket:', this['ProcessCommandLine'])
    or grep(' sekurlsa', this['ProcessCommandLine']) or grep('.dmp full', this['ProcessCommandLine'])
    or grep('.downloadfile(', this['ProcessCommandLine']) or grep('.downloadstring(',
    this['ProcessCommandLine']) or grep('FromBase64String', this['ProcessCommandLine'])
    or grep('process call create', this['ProcessCommandLine']) or grep('reg save ',
    this['ProcessCommandLine']) or grep('whoami /priv', this['ProcessCommandLine']))
  sigma_id: 4ebc877f-4612-45cb-b3a5-8e3834db36c9
- name: Webshell Detection With Command Line Keywords
  query: (grep('\\w3wp.exe', this['InitiatingProcessFolderPath']) or grep('\\php-cgi.exe',
    this['InitiatingProcessFolderPath']) or grep('\\nginx.exe', this['InitiatingProcessFolderPath'])
    or grep('\\httpd.exe', this['InitiatingProcessFolderPath']) or grep('\\caddy.exe',
    this['InitiatingProcessFolderPath']) or grep('\\ws_tomcatservice.exe', this['InitiatingProcessFolderPath'])
    or (grep('\\java.exe', this['InitiatingProcessFolderPath']) or grep('\\javaw.exe',
    this['InitiatingProcessFolderPath'])) and (grep('-tomcat-', this['InitiatingProcessFolderPath'])
    or grep('\\tomcat', this['InitiatingProcessFolderPath'])) or (grep('\\java.exe',
    this['InitiatingProcessFolderPath']) or grep('\\javaw.exe', this['InitiatingProcessFolderPath']))
    and (grep('catalina.jar', this['ProcessCommandLine']) or grep('CATALINA_HOME',
    this['ProcessCommandLine']))) and ((this['ProcessVersionInfoOriginalFileName']
    in ['net.exe', 'net1.exe']) and (grep(' user ', this['ProcessCommandLine']) or
    grep(' use ', this['ProcessCommandLine']) or grep(' group ', this['ProcessCommandLine']))
    or grep('ping.exe', this['ProcessVersionInfoOriginalFileName']) and grep(' -n
    ', this['ProcessCommandLine']) or grep('&cd&echo', this['ProcessCommandLine'])
    or grep('cd /d ', this['ProcessCommandLine']) or grep('wmic.exe', this['ProcessVersionInfoOriginalFileName'])
    and grep(' /node:', this['ProcessCommandLine']) or (grep('\\cmd.exe', this['FolderPath'])
    or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']))
    and (grep(' -enc ', this['ProcessCommandLine']) or grep(' -EncodedCommand ', this['ProcessCommandLine'])
    or grep(' -w hidden ', this['ProcessCommandLine']) or grep(' -windowstyle hidden',
    this['ProcessCommandLine']) or grep('.WebClient).Download', this['ProcessCommandLine']))
    or grep('\\dsquery.exe', this['FolderPath']) or grep('\\find.exe', this['FolderPath'])
    or grep('\\findstr.exe', this['FolderPath']) or grep('\\ipconfig.exe', this['FolderPath'])
    or grep('\\netstat.exe', this['FolderPath']) or grep('\\nslookup.exe', this['FolderPath'])
    or grep('\\pathping.exe', this['FolderPath']) or grep('\\quser.exe', this['FolderPath'])
    or grep('\\schtasks.exe', this['FolderPath']) or grep('\\systeminfo.exe', this['FolderPath'])
    or grep('\\tasklist.exe', this['FolderPath']) or grep('\\tracert.exe', this['FolderPath'])
    or grep('\\ver.exe', this['FolderPath']) or grep('\\wevtutil.exe', this['FolderPath'])
    or grep('\\whoami.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['dsquery.exe', 'find.exe', 'findstr.exe', 'ipconfig.exe', 'netstat.exe', 'nslookup.exe',
    'pathping.exe', 'quser.exe', 'schtasks.exe', 'sysinfo.exe', 'tasklist.exe', 'tracert.exe',
    'ver.exe', 'VSSADMIN.EXE', 'wevtutil.exe', 'whoami.exe'] or grep(' Test-NetConnection
    ', this['ProcessCommandLine']) or grep('dir \\', this['ProcessCommandLine']))
  sigma_id: bed2a484-9348-4143-8a8a-b801c979301c
- name: Suspicious Process By Web Server Process
  query: (grep('\\caddy.exe', this['InitiatingProcessFolderPath']) or grep('\\httpd.exe',
    this['InitiatingProcessFolderPath']) or grep('\\nginx.exe', this['InitiatingProcessFolderPath'])
    or grep('\\php-cgi.exe', this['InitiatingProcessFolderPath']) or grep('\\php.exe',
    this['InitiatingProcessFolderPath']) or grep('\\tomcat.exe', this['InitiatingProcessFolderPath'])
    or grep('\\UMWorkerProcess.exe', this['InitiatingProcessFolderPath']) or grep('\\w3wp.exe',
    this['InitiatingProcessFolderPath']) or grep('\\ws_TomcatService.exe', this['InitiatingProcessFolderPath'])
    or (grep('\\java.exe', this['InitiatingProcessFolderPath']) or grep('\\javaw.exe',
    this['InitiatingProcessFolderPath'])) and (grep('-tomcat-', this['InitiatingProcessFolderPath'])
    or grep('\\tomcat', this['InitiatingProcessFolderPath'])) or (grep('\\java.exe',
    this['InitiatingProcessFolderPath']) or grep('\\javaw.exe', this['InitiatingProcessFolderPath']))
    and (grep('CATALINA_HOME', this['InitiatingProcessCommandLine']) or grep('catalina.home',
    this['InitiatingProcessCommandLine']) or grep('catalina.jar', this['InitiatingProcessCommandLine'])))
    and (grep('\\arp.exe', this['FolderPath']) or grep('\\at.exe', this['FolderPath'])
    or grep('\\bash.exe', this['FolderPath']) or grep('\\bitsadmin.exe', this['FolderPath'])
    or grep('\\certutil.exe', this['FolderPath']) or grep('\\cmd.exe', this['FolderPath'])
    or grep('\\cscript.exe', this['FolderPath']) or grep('\\dsget.exe', this['FolderPath'])
    or grep('\\hostname.exe', this['FolderPath']) or grep('\\nbtstat.exe', this['FolderPath'])
    or grep('\\net.exe', this['FolderPath']) or grep('\\net1.exe', this['FolderPath'])
    or grep('\\netdom.exe', this['FolderPath']) or grep('\\netsh.exe', this['FolderPath'])
    or grep('\\nltest.exe', this['FolderPath']) or grep('\\ntdsutil.exe', this['FolderPath'])
    or grep('\\powershell_ise.exe', this['FolderPath']) or grep('\\powershell.exe',
    this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']) or grep('\\qprocess.exe',
    this['FolderPath']) or grep('\\query.exe', this['FolderPath']) or grep('\\qwinsta.exe',
    this['FolderPath']) or grep('\\reg.exe', this['FolderPath']) or grep('\\rundll32.exe',
    this['FolderPath']) or grep('\\sc.exe', this['FolderPath']) or grep('\\sh.exe',
    this['FolderPath']) or grep('\\wmic.exe', this['FolderPath']) or grep('\\wscript.exe',
    this['FolderPath']) or grep('\\wusa.exe', this['FolderPath'])) and not (grep('\\java.exe',
    this['InitiatingProcessFolderPath']) and grep('Windows\\system32\\cmd.exe /c C:\\ManageEngine\\ADManager
    "Plus\\ES\\bin\\elasticsearch.bat -Enode.name=RMP-NODE1 -pelasticsearch-pid.txt',
    this['ProcessCommandLine']) or grep('\\java.exe', this['InitiatingProcessFolderPath'])
    and grep('sc query', this['ProcessCommandLine']) and grep('ADManager Plus', this['ProcessCommandLine']))
  sigma_id: 8202070f-edeb-4d31-a010-a26c72ac5600
- name: Webshell Tool Reconnaissance Activity
  query: (grep('\\caddy.exe', this['InitiatingProcessFolderPath']) or grep('\\httpd.exe',
    this['InitiatingProcessFolderPath']) or grep('\\nginx.exe', this['InitiatingProcessFolderPath'])
    or grep('\\php-cgi.exe', this['InitiatingProcessFolderPath']) or grep('\\w3wp.exe',
    this['InitiatingProcessFolderPath']) or grep('\\ws_tomcatservice.exe', this['InitiatingProcessFolderPath'])
    or (grep('\\java.exe', this['InitiatingProcessFolderPath']) or grep('\\javaw.exe',
    this['InitiatingProcessFolderPath'])) and (grep('-tomcat-', this['InitiatingProcessFolderPath'])
    or grep('\\tomcat', this['InitiatingProcessFolderPath'])) or (grep('\\java.exe',
    this['InitiatingProcessFolderPath']) or grep('\\javaw.exe', this['InitiatingProcessFolderPath']))
    and (grep('CATALINA_HOME', this['ProcessCommandLine']) or grep('catalina.jar',
    this['ProcessCommandLine']))) and (grep('perl --help', this['ProcessCommandLine'])
    or grep('perl -h', this['ProcessCommandLine']) or grep('python --help', this['ProcessCommandLine'])
    or grep('python -h', this['ProcessCommandLine']) or grep('python3 --help', this['ProcessCommandLine'])
    or grep('python3 -h', this['ProcessCommandLine']) or grep('wget --help', this['ProcessCommandLine']))
  sigma_id: f64e5c19-879c-4bae-b471-6d84c8339677
- name: Potential Credential Dumping Via WER
  query: (grep('\\Werfault.exe', this['FolderPath']) or grep('WerFault.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('AUTHORI', this['InitiatingProcessAccountName']) or grep('AUTORI', this['InitiatingProcessAccountName']))
    and (grep('AUTHORI', this['AccountName']) or grep('AUTORI', this['AccountName']))
    and grep(' -u -p ', this['ProcessCommandLine']) and grep(' -ip ', this['ProcessCommandLine'])
    and grep(' -s ', this['ProcessCommandLine']) and not grep('C:\\Windows\\System32\\lsass.exe',
    this['InitiatingProcessFolderPath'])
  sigma_id: 9a4ccd1a-3526-4d99-b980-9f9c5d3a6ff3
- name: Potential ReflectDebugger Content Execution Via WerFault.EXE
  query: (grep('\\WerFault.exe', this['FolderPath']) or grep('WerFault.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep(' -pr ', this['ProcessCommandLine'])
  sigma_id: fabfb3a7-3ce1-4445-9c7c-3c27f1051cdd
- name: Suspicious Child Process Of Wermgr.EXE
  query: grep('\\wermgr.exe', this['InitiatingProcessFolderPath']) and (grep('\\cmd.exe',
    this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']) or grep('\\ipconfig.exe',
    this['FolderPath']) or grep('\\mshta.exe', this['FolderPath']) or grep('\\net.exe',
    this['FolderPath']) or grep('\\net1.exe', this['FolderPath']) or grep('\\netstat.exe',
    this['FolderPath']) or grep('\\nslookup.exe', this['FolderPath']) or grep('\\powershell_ise.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\rundll32.exe',
    this['FolderPath']) or grep('\\systeminfo.exe', this['FolderPath']) or grep('\\whoami.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath'])) and not (grep('\\rundll32.exe',
    this['FolderPath']) and grep('C:\\Windows\\system32\\WerConCpl.dll', this['ProcessCommandLine'])
    and grep('LaunchErcApp ', this['ProcessCommandLine']) and (grep('-queuereporting',
    this['ProcessCommandLine']) or grep('-responsepester', this['ProcessCommandLine'])))
  sigma_id: 396f6630-f3ac-44e3-bfc8-1b161bc00c4e
- name: Suspicious Execution Location Of Wermgr.EXE
  query: grep('\\wermgr.exe', this['FolderPath']) and not (grep('C:\\Windows\\System32\\',
    this['FolderPath']) or grep('C:\\Windows\\SysWOW64\\', this['FolderPath']) or
    grep('C:\\Windows\\WinSxS\\', this['FolderPath']))
  sigma_id: 5394fcc7-aeb2-43b5-9a09-cac9fc5edcd5
- name: Enumerate All Information With Whoami.EXE
  query: "(grep('\\\\whoami.exe', this['FolderPath']) or grep('whoami.exe', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep(' -all', this['ProcessCommandLine']) or grep(' /all', this['ProcessCommandLine'])\
    \ or grep(' \u2013all', this['ProcessCommandLine']) or grep(' \u2014all', this['ProcessCommandLine'])\
    \ or grep(' \u2015all', this['ProcessCommandLine']))"
  sigma_id: c248c896-e412-4279-8c15-1c558067b6fa
- name: Whoami.EXE Execution From Privileged Process
  query: (grep('whoami.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\whoami.exe',
    this['FolderPath'])) and (grep('AUTHORI', this['AccountName']) or grep('AUTORI',
    this['AccountName']) or grep('TrustedInstaller', this['AccountName']))
  sigma_id: 79ce34ca-af29-4d0e-b832-fc1b377020db
- name: Group Membership Reconnaissance Via Whoami.EXE
  query: (grep('\\whoami.exe', this['FolderPath']) or grep('whoami.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' /groups', this['ProcessCommandLine']) or grep(' -groups', this['ProcessCommandLine']))
  sigma_id: bd8b828d-0dca-48e1-8a63-8a58ecf2644f
- name: Whoami.EXE Execution With Output Option
  query: (grep('\\whoami.exe', this['FolderPath']) or grep('whoami.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' /FO CSV', this['ProcessCommandLine']) or grep(' -FO CSV', this['ProcessCommandLine']))
    or (grep('whoami', this['ProcessCommandLine']) or grep('>', this['ProcessCommandLine']))
  sigma_id: c30fb093-1109-4dc8-88a8-b30d11c95a5d
- name: Whoami.EXE Execution Anomaly
  query: (grep('\\whoami.exe', this['FolderPath']) or grep('whoami.exe', this['ProcessVersionInfoOriginalFileName']))
    and not (grep('\\cmd.exe', this['InitiatingProcessFolderPath']) or grep('\\powershell_ise.exe',
    this['InitiatingProcessFolderPath']) or grep('\\powershell.exe', this['InitiatingProcessFolderPath'])
    or grep('\\pwsh.exe', this['InitiatingProcessFolderPath']) or this['InitiatingProcessFolderPath']==null
    or false) and not grep(':\\Program Files\\Microsoft Monitoring Agent\\Agent\\MonitoringHost.exe',
    this['InitiatingProcessFolderPath'])
  sigma_id: 8de1cbe8-d6f5-496d-8237-5f44a721c7a0
- name: Security Privileges Enumeration Via Whoami.EXE
  query: (grep('\\whoami.exe', this['FolderPath']) or grep('whoami.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep(' /priv', this['ProcessCommandLine']) or grep(' -priv', this['ProcessCommandLine']))
  sigma_id: 97a80ec7-0e2f-4d05-9ef4-65760e634f6b
- name: Suspicious WindowsTerminal Child Processes
  query: (grep('\\WindowsTerminal.exe', this['InitiatingProcessFolderPath']) or grep('\\wt.exe',
    this['InitiatingProcessFolderPath'])) and (grep('\\rundll32.exe', this['FolderPath'])
    or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\certutil.exe', this['FolderPath'])
    or grep('\\cscript.exe', this['FolderPath']) or grep('\\wscript.exe', this['FolderPath'])
    or grep('\\csc.exe', this['FolderPath']) or grep('C:\\Users\\Public\\', this['FolderPath'])
    or grep('\\Downloads\\', this['FolderPath']) or grep('\\Desktop\\', this['FolderPath'])
    or grep('\\AppData\\Local\\Temp\\', this['FolderPath']) or grep('\\Windows\\TEMP\\',
    this['FolderPath']) or grep(' iex ', this['ProcessCommandLine']) or grep(' icm',
    this['ProcessCommandLine']) or grep('Invoke-', this['ProcessCommandLine']) or
    grep('Import-Module ', this['ProcessCommandLine']) or grep('ipmo ', this['ProcessCommandLine'])
    or grep('DownloadString(', this['ProcessCommandLine']) or grep(' /c ', this['ProcessCommandLine'])
    or grep(' /k ', this['ProcessCommandLine']) or grep(' /r ', this['ProcessCommandLine']))
    and not (grep('Import-Module', this['ProcessCommandLine']) and grep('Microsoft.VisualStudio.DevShell.dll',
    this['ProcessCommandLine']) and grep('Enter-VsDevShell', this['ProcessCommandLine'])
    or grep('\\AppData\\Local\\Packages\\Microsoft.WindowsTerminal_', this['ProcessCommandLine'])
    and grep('\\LocalState\\settings.json', this['ProcessCommandLine']) or grep('C:\\Program
    Files\\Microsoft Visual Studio\\', this['ProcessCommandLine']) and grep('\\Common7\\Tools\\VsDevCmd.bat',
    this['ProcessCommandLine']))
  sigma_id: 8de89e52-f6e1-4b5b-afd1-41ecfa300d48
- name: Add New Download Source To Winget
  query: (grep('\\winget.exe', this['FolderPath']) or grep('winget.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('source ', this['ProcessCommandLine']) and grep('add ', this['ProcessCommandLine'])
  sigma_id: 05ebafc8-7aa2-4bcd-a269-2aec93f9e842
- name: Add Insecure Download Source To Winget
  query: (grep('\\winget.exe', this['FolderPath']) or grep('winget.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('source ', this['ProcessCommandLine']) and grep('add ', this['ProcessCommandLine'])
    and grep('http://', this['ProcessCommandLine'])
  sigma_id: 81a0ecb5-0a41-4ba1-b2ba-c944eb92bfa2
- name: Install New Package Via Winget Local Manifest
  query: (grep('\\winget.exe', this['FolderPath']) or grep('winget.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('install', this['ProcessCommandLine']) or grep(' add ', this['ProcessCommandLine']))
    and (grep('-m ', this['ProcessCommandLine']) or grep('--manifest', this['ProcessCommandLine']))
  sigma_id: 313d6012-51a0-4d93-8dfc-de8553239e25
- name: Winrar Compressing Dump Files
  query: (grep('\\rar.exe', this['FolderPath']) or grep('\\winrar.exe', this['FolderPath'])
    or grep('Command line RAR', this['ProcessVersionInfoFileDescription'])) and (grep('.dmp',
    this['ProcessCommandLine']) or grep('.dump', this['ProcessCommandLine']) or grep('.hdmp',
    this['ProcessCommandLine']))
  sigma_id: 1ac14d38-3dfc-4635-92c7-e3fd1c5f5bfc
- name: Potentially Suspicious Child Process Of WinRAR.EXE
  query: grep('\\WinRAR.exe', this['InitiatingProcessFolderPath']) and (grep('\\cmd.exe',
    this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']) or grep('\\mshta.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath']) or grep('\\rundll32.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['Cmd.Exe', 'cscript.exe', 'mshta.exe', 'PowerShell.EXE', 'pwsh.dll', 'regsvr32.exe',
    'RUNDLL32.EXE', 'wscript.exe'])
  sigma_id: 146aace8-9bd6-42ba-be7a-0070d8027b76
- name: Winrar Execution in Non-Standard Folder
  query: (grep('\\rar.exe', this['FolderPath']) or grep('\\winrar.exe', this['FolderPath'])
    or grep('Command line RAR', this['ProcessVersionInfoFileDescription'])) and not
    (grep('\\UnRAR.exe', this['FolderPath']) or grep(':\\Program Files (x86)\\WinRAR\\',
    this['FolderPath']) or grep(':\\Program Files\\WinRAR\\', this['FolderPath']))
    and not grep(':\\Windows\\Temp\\', this['FolderPath'])
  sigma_id: 4ede543c-e098-43d9-a28f-dd784a13132f
- name: AWL Bypass with Winrm.vbs and Malicious WsmPty.xsl/WsmTxt.xsl
  query: grep('winrm', this['ProcessCommandLine']) and (grep('format:pretty', this['ProcessCommandLine'])
    or grep('format:"pretty"', this['ProcessCommandLine']) or grep('format:"text"',
    this['ProcessCommandLine']) or grep('format:text', this['ProcessCommandLine']))
    and not (grep('C:\\Windows\\System32\\', this['FolderPath']) or grep('C:\\Windows\\SysWOW64\\',
    this['FolderPath']))
  sigma_id: 074e0ded-6ced-4ebd-8b4d-53f55908119d
- name: Remote Code Execute via Winrm.vbs
  query: (grep('\\cscript.exe', this['FolderPath']) or grep('cscript.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('winrm', this['ProcessCommandLine']) and grep('invoke Create wmicimv2/Win32_',
    this['ProcessCommandLine']) and grep('-r:http', this['ProcessCommandLine'])
  sigma_id: 9df0dd3a-1a5c-47e3-a2bc-30ed177646a0
- name: Remote PowerShell Session Host Process (WinRM)
  query: grep('\\wsmprovhost.exe', this['FolderPath']) or grep('\\wsmprovhost.exe',
    this['InitiatingProcessFolderPath'])
  sigma_id: 734f8d9b-42b8-41b2-bcf5-abaf49d5a3c8
- name: Suspicious Processes Spawned by WinRM
  query: grep('\\wsmprovhost.exe', this['InitiatingProcessFolderPath']) and (grep('\\cmd.exe',
    this['FolderPath']) or grep('\\sh.exe', this['FolderPath']) or grep('\\bash.exe',
    this['FolderPath']) or grep('\\powershell.exe', this['FolderPath']) or grep('\\pwsh.exe',
    this['FolderPath']) or grep('\\wsl.exe', this['FolderPath']) or grep('\\schtasks.exe',
    this['FolderPath']) or grep('\\certutil.exe', this['FolderPath']) or grep('\\whoami.exe',
    this['FolderPath']) or grep('\\bitsadmin.exe', this['FolderPath']))
  sigma_id: 5cc2cda8-f261-4d88-a2de-e9e193c86716
- name: Compress Data and Lock With Password for Exfiltration With WINZIP
  query: (grep('winzip.exe', this['ProcessCommandLine']) or grep('winzip64.exe', this['ProcessCommandLine']))
    and grep('-s"', this['ProcessCommandLine']) and (grep(' -min ', this['ProcessCommandLine'])
    or grep(' -a ', this['ProcessCommandLine']))
  sigma_id: e2e80da2-8c66-4e00-ae3c-2eebd29f6b6d
- name: Wlrmdr.EXE Uncommon Argument Or Child Process
  query: "grep('\\\\wlrmdr.exe', this['InitiatingProcessFolderPath']) or (grep('\\\
    \\wlrmdr.exe', this['FolderPath']) or grep('WLRMNDR.EXE', this['ProcessVersionInfoOriginalFileName']))\
    \ and (grep('-s ', this['ProcessCommandLine']) or grep('/s ', this['ProcessCommandLine'])\
    \ or grep('\u2013s ', this['ProcessCommandLine']) or grep('\u2014s ', this['ProcessCommandLine'])\
    \ or grep('\u2015s ', this['ProcessCommandLine'])) and (grep('-f ', this['ProcessCommandLine'])\
    \ or grep('/f ', this['ProcessCommandLine']) or grep('\u2013f ', this['ProcessCommandLine'])\
    \ or grep('\u2014f ', this['ProcessCommandLine']) or grep('\u2015f ', this['ProcessCommandLine']))\
    \ and (grep('-t ', this['ProcessCommandLine']) or grep('/t ', this['ProcessCommandLine'])\
    \ or grep('\u2013t ', this['ProcessCommandLine']) or grep('\u2014t ', this['ProcessCommandLine'])\
    \ or grep('\u2015t ', this['ProcessCommandLine'])) and (grep('-m ', this['ProcessCommandLine'])\
    \ or grep('/m ', this['ProcessCommandLine']) or grep('\u2013m ', this['ProcessCommandLine'])\
    \ or grep('\u2014m ', this['ProcessCommandLine']) or grep('\u2015m ', this['ProcessCommandLine']))\
    \ and (grep('-a ', this['ProcessCommandLine']) or grep('/a ', this['ProcessCommandLine'])\
    \ or grep('\u2013a ', this['ProcessCommandLine']) or grep('\u2014a ', this['ProcessCommandLine'])\
    \ or grep('\u2015a ', this['ProcessCommandLine'])) and (grep('-u ', this['ProcessCommandLine'])\
    \ or grep('/u ', this['ProcessCommandLine']) or grep('\u2013u ', this['ProcessCommandLine'])\
    \ or grep('\u2014u ', this['ProcessCommandLine']) or grep('\u2015u ', this['ProcessCommandLine']))\
    \ and not (grep('C:\\\\Windows\\\\System32\\\\winlogon.exe', this['InitiatingProcessFolderPath'])\
    \ or this['InitiatingProcessFolderPath'] in ['()', '-'] or this['InitiatingProcessFolderPath']==null)"
  sigma_id: 9cfc00b6-bfb7-49ce-9781-ef78503154bb
- name: WMI Backdoor Exchange Transport Agent
  query: grep('\\EdgeTransport.exe', this['InitiatingProcessFolderPath']) and not
    (grep('C:\\Windows\\System32\\conhost.exe', this['FolderPath']) or grep('C:\\Program
    Files\\Microsoft\\Exchange Server\\', this['FolderPath']) and grep('\\Bin\\OleConverter.exe',
    this['FolderPath']))
  sigma_id: 797011dc-44f4-4e6f-9f10-a8ceefbe566b
- name: WMI Persistence - Script Event Consumer
  query: grep('C:\\WINDOWS\\system32\\wbem\\scrcons.exe', this['FolderPath']) and
    grep('C:\\Windows\\System32\\svchost.exe', this['InitiatingProcessFolderPath'])
  sigma_id: ec1d5e28-8f3b-4188-a6f8-6e8df81dc28e
- name: New ActiveScriptEventConsumer Created Via Wmic.EXE
  query: grep('ActiveScriptEventConsumer', this['ProcessCommandLine']) and grep('
    CREATE ', this['ProcessCommandLine'])
  sigma_id: ebef4391-1a81-4761-a40a-1db446c0e625
- name: Potential Windows Defender Tampering Via Wmic.EXE
  query: (grep('wmic.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\WMIC.exe',
    this['FolderPath'])) and grep('/Namespace:\\root\\Microsoft\\Windows\\Defender',
    this['ProcessCommandLine'])
  sigma_id: 51cbac1e-eee3-4a90-b1b7-358efb81fa0a
- name: New Process Created Via Wmic.EXE
  query: (grep('\\wmic.exe', this['FolderPath']) or grep('wmic.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('process', this['ProcessCommandLine']) and grep('call', this['ProcessCommandLine'])
    and grep('create', this['ProcessCommandLine'])
  sigma_id: 526be59f-a573-4eea-b5f7-f0973207634d
- name: Computer System Reconnaissance Via Wmic.EXE
  query: (grep('\\wmic.exe', this['FolderPath']) or grep('wmic.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('computersystem', this['ProcessCommandLine'])
  sigma_id: 9d7ca793-f6bd-471c-8d0f-11e68b2f0d2f
- name: Hardware Model Reconnaissance Via Wmic.EXE
  query: (grep('\\wmic.exe', this['FolderPath']) or grep('wmic.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('csproduct', this['ProcessCommandLine'])
  sigma_id: 3e3ceccd-6c06-48b8-b5ff-ab1d25db8c1d
- name: Windows Hotfix Updates Reconnaissance Via Wmic.EXE
  query: (grep('wmic.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\WMIC.exe',
    this['FolderPath'])) and grep(' qfe', this['ProcessCommandLine'])
  sigma_id: dfd2fcb7-8bd5-4daa-b132-5adb61d6ad45
- name: Process Reconnaissance Via Wmic.EXE
  query: (grep('\\WMIC.exe', this['FolderPath']) or grep('wmic.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('process', this['ProcessCommandLine']) and not (grep('call', this['ProcessCommandLine'])
    and grep('create', this['ProcessCommandLine']))
  sigma_id: 221b251a-357a-49a9-920a-271802777cc0
- name: Potential Product Reconnaissance Via Wmic.EXE
  query: (grep('\\wmic.exe', this['FolderPath']) or grep('wmic.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('Product', this['ProcessCommandLine'])
  sigma_id: 15434e33-5027-4914-88d5-3d4145ec25a9
- name: Potential Product Class Reconnaissance Via Wmic.EXE
  query: (grep('\\wmic.exe', this['FolderPath']) or grep('wmic.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('AntiVirusProduct', this['ProcessCommandLine']) or grep('FirewallProduct',
    this['ProcessCommandLine']))
  sigma_id: e568650b-5dcd-4658-8f34-ded0b1e13992
- name: Service Reconnaissance Via Wmic.EXE
  query: (grep('\\WMIC.exe', this['FolderPath']) or grep('wmic.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('service', this['ProcessCommandLine'])
  sigma_id: 76f55eaa-d27f-4213-9d45-7b0e4b60bbae
- name: Uncommon System Information Discovery Via Wmic.EXE
  query: (grep('WMI Commandline Utility', this['ProcessVersionInfoFileDescription'])
    or grep('wmic.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\WMIC.exe',
    this['FolderPath'])) and (grep('LOGICALDISK get Name,Size,FreeSpace', this['ProcessCommandLine'])
    or grep('os get Caption,OSArchitecture,Version', this['ProcessCommandLine']))
  sigma_id: 9d5a1274-922a-49d0-87f3-8c653483b909
- name: Potential Unquoted Service Path Reconnaissance Via Wmic.EXE
  query: (grep('wmic.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\WMIC.exe',
    this['FolderPath'])) and grep(' service get ', this['ProcessCommandLine']) and
    grep('name,displayname,pathname,startmode', this['ProcessCommandLine'])
  sigma_id: 68bcd73b-37ef-49cb-95fc-edc809730be6
- name: System Disk And Volume Reconnaissance Via Wmic.EXE
  query: (grep('\\WMIC.exe', this['FolderPath']) or grep('wmic.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('volume', this['ProcessCommandLine']) or grep('path win32_logicaldisk',
    this['ProcessCommandLine']))
  sigma_id: c79da740-5030-45ec-a2e0-479e824a562c
- name: WMIC Remote Command Execution
  query: (grep('\\WMIC.exe', this['FolderPath']) or grep('wmic.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('/node:', this['ProcessCommandLine']) and not (grep('/node:127.0.0.1
    ', this['ProcessCommandLine']) or grep('/node:localhost ', this['ProcessCommandLine']))
  sigma_id: 7773b877-5abb-4a3e-b9c9-fd0369b59b00
- name: Service Started/Stopped Via Wmic.EXE
  query: (grep('wmic.exe', this['ProcessVersionInfoOriginalFileName']) or grep('\\WMIC.exe',
    this['FolderPath'])) and grep(' service ', this['ProcessCommandLine']) and grep('
    call ', this['ProcessCommandLine']) and (grep('stopservice', this['ProcessCommandLine'])
    or grep('startservice', this['ProcessCommandLine']))
  sigma_id: 0b7163dc-7eee-4960-af17-c0cd517f92da
- name: Potential SquiblyTwo Technique Execution
  query: (grep('\\wmic.exe', this['FolderPath']) or grep('wmic.exe', this['ProcessVersionInfoOriginalFileName'])
    or grep('IMPHASH=1B1A3F43BF37B5BFE60751F2EE2F326E', this['Hashes']) or grep('IMPHASH=37777A96245A3C74EB217308F3546F4C',
    this['Hashes']) or grep('IMPHASH=9D87C9D67CE724033C0B40CC4CA1B206', this['Hashes']))
    and grep('format:', this['ProcessCommandLine']) and grep('http', this['ProcessCommandLine'])
  sigma_id: 8d63dadf-b91b-4187-87b6-34a1114577ea
- name: Suspicious WMIC Execution Via Office Process
  query: (grep('\\WINWORD.EXE', this['InitiatingProcessFolderPath']) or grep('\\EXCEL.EXE',
    this['InitiatingProcessFolderPath']) or grep('\\POWERPNT.exe', this['InitiatingProcessFolderPath'])
    or grep('\\MSPUB.exe', this['InitiatingProcessFolderPath']) or grep('\\VISIO.exe',
    this['InitiatingProcessFolderPath']) or grep('\\MSACCESS.EXE', this['InitiatingProcessFolderPath'])
    or grep('\\EQNEDT32.EXE', this['InitiatingProcessFolderPath']) or grep('\\ONENOTE.EXE',
    this['InitiatingProcessFolderPath']) or grep('\\wordpad.exe', this['InitiatingProcessFolderPath'])
    or grep('\\wordview.exe', this['InitiatingProcessFolderPath'])) and (grep('\\wbem\\WMIC.exe',
    this['FolderPath']) or grep('wmic.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('process', this['ProcessCommandLine']) and grep('create', this['ProcessCommandLine'])
    and grep('call', this['ProcessCommandLine']) and (grep('regsvr32', this['ProcessCommandLine'])
    or grep('rundll32', this['ProcessCommandLine']) or grep('msiexec', this['ProcessCommandLine'])
    or grep('mshta', this['ProcessCommandLine']) or grep('verclsid', this['ProcessCommandLine'])
    or grep('wscript', this['ProcessCommandLine']) or grep('cscript', this['ProcessCommandLine']))
  sigma_id: e1693bc8-7168-4eab-8718-cdcaa68a1738
- name: Suspicious Process Created Via Wmic.EXE
  query: grep('process ', this['ProcessCommandLine']) and grep('call ', this['ProcessCommandLine'])
    and grep('create ', this['ProcessCommandLine']) and (grep('rundll32', this['ProcessCommandLine'])
    or grep('bitsadmin', this['ProcessCommandLine']) or grep('regsvr32', this['ProcessCommandLine'])
    or grep('cmd.exe /c ', this['ProcessCommandLine']) or grep('cmd.exe /k ', this['ProcessCommandLine'])
    or grep('cmd.exe /r ', this['ProcessCommandLine']) or grep('cmd /c ', this['ProcessCommandLine'])
    or grep('cmd /k ', this['ProcessCommandLine']) or grep('cmd /r ', this['ProcessCommandLine'])
    or grep('powershell', this['ProcessCommandLine']) or grep('pwsh', this['ProcessCommandLine'])
    or grep('certutil', this['ProcessCommandLine']) or grep('cscript', this['ProcessCommandLine'])
    or grep('wscript', this['ProcessCommandLine']) or grep('mshta', this['ProcessCommandLine'])
    or grep('\\Users\\Public\\', this['ProcessCommandLine']) or grep('\\Windows\\Temp\\',
    this['ProcessCommandLine']) or grep('\\AppData\\Local\\', this['ProcessCommandLine'])
    or grep('%temp%', this['ProcessCommandLine']) or grep('%tmp%', this['ProcessCommandLine'])
    or grep('%ProgramData%', this['ProcessCommandLine']) or grep('%appdata%', this['ProcessCommandLine'])
    or grep('%comspec%', this['ProcessCommandLine']) or grep('%localappdata%', this['ProcessCommandLine']))
  sigma_id: 3c89a1e8-0fba-449e-8f1b-8409d6267ec8
- name: Application Terminated Via Wmic.EXE
  query: (grep('\\WMIC.exe', this['FolderPath']) or grep('wmic.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('call', this['ProcessCommandLine']) and grep('terminate', this['ProcessCommandLine'])
  sigma_id: 49d9671b-0a0a-4c09-8280-d215bfd30662
- name: Application Removed Via Wmic.EXE
  query: (grep('\\WMIC.exe', this['FolderPath']) or grep('wmic.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('call', this['ProcessCommandLine']) and grep('uninstall', this['ProcessCommandLine'])
  sigma_id: b53317a0-8acf-4fd1-8de8-a5401e776b96
- name: Potential Tampering With Security Products Via WMIC
  query: (grep('wmic', this['ProcessCommandLine']) and grep('product where ', this['ProcessCommandLine'])
    and grep('call', this['ProcessCommandLine']) and grep('uninstall', this['ProcessCommandLine'])
    and grep('/nointeractive', this['ProcessCommandLine']) or grep('wmic', this['ProcessCommandLine'])
    and grep('caption like ', this['ProcessCommandLine']) and (grep('call delete',
    this['ProcessCommandLine']) or grep('call terminate', this['ProcessCommandLine']))
    or grep('process ', this['ProcessCommandLine']) and grep('where ', this['ProcessCommandLine'])
    and grep('delete', this['ProcessCommandLine'])) and (grep('%carbon%', this['ProcessCommandLine'])
    or grep('%cylance%', this['ProcessCommandLine']) or grep('%endpoint%', this['ProcessCommandLine'])
    or grep('%eset%', this['ProcessCommandLine']) or grep('%malware%', this['ProcessCommandLine'])
    or grep('%Sophos%', this['ProcessCommandLine']) or grep('%symantec%', this['ProcessCommandLine'])
    or grep('Antivirus', this['ProcessCommandLine']) or grep('AVG ', this['ProcessCommandLine'])
    or grep('Carbon Black', this['ProcessCommandLine']) or grep('CarbonBlack', this['ProcessCommandLine'])
    or grep('Cb Defense Sensor 64-bit', this['ProcessCommandLine']) or grep('Crowdstrike
    Sensor', this['ProcessCommandLine']) or grep('Cylance ', this['ProcessCommandLine'])
    or grep('Dell Threat Defense', this['ProcessCommandLine']) or grep('DLP Endpoint',
    this['ProcessCommandLine']) or grep('Endpoint Detection', this['ProcessCommandLine'])
    or grep('Endpoint Protection', this['ProcessCommandLine']) or grep('Endpoint Security',
    this['ProcessCommandLine']) or grep('Endpoint Sensor', this['ProcessCommandLine'])
    or grep('ESET File Security', this['ProcessCommandLine']) or grep('LogRhythm System
    Monitor Service', this['ProcessCommandLine']) or grep('Malwarebytes', this['ProcessCommandLine'])
    or grep('McAfee Agent', this['ProcessCommandLine']) or grep('Microsoft Security
    Client', this['ProcessCommandLine']) or grep('Sophos Anti-Virus', this['ProcessCommandLine'])
    or grep('Sophos AutoUpdate', this['ProcessCommandLine']) or grep('Sophos Credential
    Store', this['ProcessCommandLine']) or grep('Sophos Management Console', this['ProcessCommandLine'])
    or grep('Sophos Management Database', this['ProcessCommandLine']) or grep('Sophos
    Management Server', this['ProcessCommandLine']) or grep('Sophos Remote Management
    System', this['ProcessCommandLine']) or grep('Sophos Update Manager', this['ProcessCommandLine'])
    or grep('Threat Protection', this['ProcessCommandLine']) or grep('VirusScan',
    this['ProcessCommandLine']) or grep('Webroot SecureAnywhere', this['ProcessCommandLine'])
    or grep('Windows Defender', this['ProcessCommandLine']))
  sigma_id: 847d5ff3-8a31-4737-a970-aeae8fe21765
- name: XSL Script Execution Via WMIC.EXE
  query: "grep('\\\\wmic.exe', this['FolderPath']) and (grep('-format', this['ProcessCommandLine'])\
    \ or grep('/format', this['ProcessCommandLine']) or grep('\u2013format', this['ProcessCommandLine'])\
    \ or grep('\u2014format', this['ProcessCommandLine']) or grep('\u2015format',\
    \ this['ProcessCommandLine'])) and not (grep('Format:List', this['ProcessCommandLine'])\
    \ or grep('Format:htable', this['ProcessCommandLine']) or grep('Format:hform',\
    \ this['ProcessCommandLine']) or grep('Format:table', this['ProcessCommandLine'])\
    \ or grep('Format:mof', this['ProcessCommandLine']) or grep('Format:value', this['ProcessCommandLine'])\
    \ or grep('Format:rawxml', this['ProcessCommandLine']) or grep('Format:xml', this['ProcessCommandLine'])\
    \ or grep('Format:csv', this['ProcessCommandLine']))"
  sigma_id: 05c36dd6-79d6-4a9a-97da-3db20298ab2d
- name: WmiPrvSE Spawned A Process
  query: grep('\\WmiPrvSe.exe', this['InitiatingProcessFolderPath']) and not (this['LogonId']
    in ['0x3e7', 'null'] or grep('AUTHORI', this['AccountName']) or grep('AUTORI',
    this['AccountName']) or grep('\\WmiPrvSE.exe', this['FolderPath']) or grep('\\WerFault.exe',
    this['FolderPath']) or this['LogonId']==null)
  sigma_id: d21374ff-f574-44a7-9998-4a8c8bf33d7d
- name: Potential WMI Lateral Movement WmiPrvSE Spawned PowerShell
  query: grep('\\WmiPrvSE.exe', this['InitiatingProcessFolderPath']) and (grep('\\powershell.exe',
    this['FolderPath']) or grep('\\pwsh.exe', this['FolderPath']) or this['ProcessVersionInfoOriginalFileName']
    in ['PowerShell.EXE', 'pwsh.dll'])
  sigma_id: 692f0bec-83ba-4d04-af7e-e884a96059b6
- name: Suspicious WmiPrvSE Child Process
  query: grep('\\wbem\\WmiPrvSE.exe', this['InitiatingProcessFolderPath']) and (grep('\\certutil.exe',
    this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']) or grep('\\mshta.exe',
    this['FolderPath']) or grep('\\msiexec.exe', this['FolderPath']) or grep('\\regsvr32.exe',
    this['FolderPath']) or grep('\\rundll32.exe', this['FolderPath']) or grep('\\verclsid.exe',
    this['FolderPath']) or grep('\\wscript.exe', this['FolderPath']) or grep('\\cmd.exe',
    this['FolderPath']) and (grep('cscript', this['ProcessCommandLine']) or grep('mshta',
    this['ProcessCommandLine']) or grep('powershell', this['ProcessCommandLine'])
    or grep('pwsh', this['ProcessCommandLine']) or grep('regsvr32', this['ProcessCommandLine'])
    or grep('rundll32', this['ProcessCommandLine']) or grep('wscript', this['ProcessCommandLine'])))
    and not (grep('\\WerFault.exe', this['FolderPath']) or grep('\\WmiPrvSE.exe',
    this['FolderPath']) or grep('\\msiexec.exe', this['FolderPath']) and grep('/i
    ', this['ProcessCommandLine']))
  sigma_id: 8a582fe2-0882-4b89-a82a-da6b2dc32937
- name: UEFI Persistence Via Wpbbin - ProcessCreation
  query: grep('C:\\Windows\\System32\\wpbbin.exe', this['FolderPath'])
  sigma_id: 4abc0ec4-db5a-412f-9632-26659cddf145
- name: Potential Dropper Script Execution Via WScript/CScript
  query: (grep('\\wscript.exe', this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']))
    and (grep(':\\Temp\\', this['ProcessCommandLine']) or grep(':\\Tmp\\', this['ProcessCommandLine'])
    or grep(':\\Users\\Public\\', this['ProcessCommandLine']) or grep(':\\Windows\\Temp\\',
    this['ProcessCommandLine']) or grep('\\AppData\\Local\\Temp\\', this['ProcessCommandLine']))
    and (grep('.js', this['ProcessCommandLine']) or grep('.jse', this['ProcessCommandLine'])
    or grep('.vba', this['ProcessCommandLine']) or grep('.vbe', this['ProcessCommandLine'])
    or grep('.vbs', this['ProcessCommandLine']) or grep('.wsf', this['ProcessCommandLine']))
  sigma_id: cea72823-df4d-4567-950c-0b579eaf0846
- name: Cscript/Wscript Potentially Suspicious Child Process
  query: (grep('\\wscript.exe', this['InitiatingProcessFolderPath']) or grep('\\cscript.exe',
    this['InitiatingProcessFolderPath'])) and (grep('\\rundll32.exe', this['FolderPath'])
    or (grep('\\cmd.exe', this['FolderPath']) or grep('\\powershell.exe', this['FolderPath'])
    or grep('\\pwsh.exe', this['FolderPath'])) and (grep('mshta', this['ProcessCommandLine'])
    and grep('http', this['ProcessCommandLine']) or grep('rundll32', this['ProcessCommandLine'])
    or grep('regsvr32', this['ProcessCommandLine']) or grep('msiexec', this['ProcessCommandLine'])))
    and not (grep('\\rundll32.exe', this['FolderPath']) and (grep('UpdatePerUserSystemParameters',
    this['ProcessCommandLine']) or grep('PrintUIEntry', this['ProcessCommandLine'])
    or grep('ClearMyTracksByProcess', this['ProcessCommandLine'])))
  sigma_id: b6676963-0353-4f88-90f5-36c20d443c6a
- name: Cscript/Wscript Uncommon Script Extension Execution
  query: (this['ProcessVersionInfoOriginalFileName'] in ['wscript.exe', 'cscript.exe']
    or grep('\\wscript.exe', this['FolderPath']) or grep('\\cscript.exe', this['FolderPath']))
    and (grep('.csv', this['ProcessCommandLine']) or grep('.dat', this['ProcessCommandLine'])
    or grep('.doc', this['ProcessCommandLine']) or grep('.gif', this['ProcessCommandLine'])
    or grep('.jpeg', this['ProcessCommandLine']) or grep('.jpg', this['ProcessCommandLine'])
    or grep('.png', this['ProcessCommandLine']) or grep('.ppt', this['ProcessCommandLine'])
    or grep('.txt', this['ProcessCommandLine']) or grep('.xls', this['ProcessCommandLine'])
    or grep('.xml', this['ProcessCommandLine']))
  sigma_id: 99b7460d-c9f1-40d7-a316-1f36f61d52ee
- name: WSL Child Process Anomaly
  query: (grep('\\wsl.exe', this['InitiatingProcessFolderPath']) or grep('\\wslhost.exe',
    this['InitiatingProcessFolderPath'])) and (grep('\\calc.exe', this['FolderPath'])
    or grep('\\cmd.exe', this['FolderPath']) or grep('\\cscript.exe', this['FolderPath'])
    or grep('\\mshta.exe', this['FolderPath']) or grep('\\powershell.exe', this['FolderPath'])
    or grep('\\pwsh.exe', this['FolderPath']) or grep('\\regsvr32.exe', this['FolderPath'])
    or grep('\\rundll32.exe', this['FolderPath']) or grep('\\wscript.exe', this['FolderPath'])
    or grep('\\AppData\\Local\\Temp\\', this['FolderPath']) or grep('C:\\Users\\Public\\',
    this['FolderPath']) or grep('C:\\Windows\\Temp\\', this['FolderPath']) or grep('C:\\Temp\\',
    this['FolderPath']) or grep('\\Downloads\\', this['FolderPath']) or grep('\\Desktop\\',
    this['FolderPath']))
  sigma_id: 2267fe65-0681-42ad-9a6d-46553d3f3480
- name: Proxy Execution Via Wuauclt.EXE
  query: (grep('\\wuauclt.exe', this['FolderPath']) or grep('wuauclt.exe', this['ProcessVersionInfoOriginalFileName']))
    and grep('UpdateDeploymentProvider', this['ProcessCommandLine']) and grep('RunHandlerComServer',
    this['ProcessCommandLine']) and not (grep(' /UpdateDeploymentProvider UpdateDeploymentProvider.dll
    ', this['ProcessCommandLine']) or grep(' wuaueng.dll ', this['ProcessCommandLine'])
    or grep(':\\Windows\\UUS\\Packages\\Preview\\amd64\\updatedeploy.dll /ClassId',
    this['ProcessCommandLine']) or grep(':\\Windows\\UUS\\amd64\\UpdateDeploy.dll
    /ClassId', this['ProcessCommandLine']) or grep(':\\Windows\\WinSxS\\', this['ProcessCommandLine'])
    and grep('\\UpdateDeploy.dll /ClassId ', this['ProcessCommandLine']))
  sigma_id: af77cf95-c469-471c-b6a0-946c685c4798
- name: Suspicious Windows Update Agent Empty Cmdline
  query: (grep('\\Wuauclt.exe', this['FolderPath']) or grep('Wuauclt.exe', this['ProcessVersionInfoOriginalFileName']))
    and (grep('Wuauclt', this['ProcessCommandLine']) or grep('Wuauclt.exe', this['ProcessCommandLine']))
  sigma_id: 52d097e2-063e-4c9c-8fbb-855c8948d135
- name: Cab File Extraction Via Wusa.EXE From Potentially Suspicious Paths
  query: grep('\\wusa.exe', this['FolderPath']) and grep('/extract:', this['ProcessCommandLine'])
    and (grep(':\\PerfLogs\\', this['ProcessCommandLine']) or grep(':\\Users\\Public\\',
    this['ProcessCommandLine']) or grep(':\\Windows\\Temp\\', this['ProcessCommandLine'])
    or grep('\\Appdata\\Local\\Temp\\', this['ProcessCommandLine']))
  sigma_id: c74c0390-3e20-41fd-a69a-128f0275a5ea
- name: Wusa.EXE Executed By Parent Process Located In Suspicious Location
  query: grep('\\wusa.exe', this['FolderPath']) and (grep(':\\Perflogs\\', this['InitiatingProcessFolderPath'])
    or grep(':\\Users\\Public\\', this['InitiatingProcessFolderPath']) or grep(':\\Windows\\Temp\\',
    this['InitiatingProcessFolderPath']) or grep('\\Appdata\\Local\\Temp\\', this['InitiatingProcessFolderPath'])
    or grep('\\Temporary Internet', this['InitiatingProcessFolderPath']) or grep(':\\Users\\',
    this['InitiatingProcessFolderPath']) and grep('\\Favorites\\', this['InitiatingProcessFolderPath'])
    or grep(':\\Users\\', this['InitiatingProcessFolderPath']) and grep('\\Favourites\\',
    this['InitiatingProcessFolderPath']) or grep(':\\Users\\', this['InitiatingProcessFolderPath'])
    and grep('\\Contacts\\', this['InitiatingProcessFolderPath']) or grep(':\\Users\\',
    this['InitiatingProcessFolderPath']) and grep('\\Pictures\\', this['InitiatingProcessFolderPath']))
    and not grep('.msu', this['ProcessCommandLine'])
  sigma_id: ef64fc9c-a45e-43cc-8fd8-7d75d73b4c99
- name: Xwizard.EXE Execution From Non-Default Location
  query: (grep('\\xwizard.exe', this['FolderPath']) or grep('xwizard.exe', this['ProcessVersionInfoOriginalFileName']))
    and not (grep('C:\\Windows\\System32\\', this['FolderPath']) or grep('C:\\Windows\\SysWOW64\\',
    this['FolderPath']) or grep('C:\\Windows\\WinSxS\\', this['FolderPath']))
  sigma_id: 193d5ccd-6f59-40c6-b5b0-8e32d5ddd3d1
